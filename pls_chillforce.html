<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 23 PLS regression with agroclimatic metrics | Tree phenology analysis with R</title>
  <meta name="description" content="This lecture introduces the chillR package for R." />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 23 PLS regression with agroclimatic metrics | Tree phenology analysis with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This lecture introduces the chillR package for R." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 23 PLS regression with agroclimatic metrics | Tree phenology analysis with R" />
  
  <meta name="twitter:description" content="This lecture introduces the chillR package for R." />
  

<meta name="author" content="Eike Luedeling" />


<meta name="date" content="2025-01-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="pls_reflection.html"/>
<link rel="next" href="pls_chillforce_ex.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.2/leaflet.js"></script>
<script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/font-awesome-6.5.2/js/script.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 1em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Tree phenology analysis with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#objectives"><i class="fa fa-check"></i><b>1.1</b> Objectives</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#performance-assessment"><i class="fa fa-check"></i><b>1.2</b> Performance assessment</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#house-rules"><i class="fa fa-check"></i><b>1.3</b> House rules</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="the-tools-we-use.html"><a href="the-tools-we-use.html"><i class="fa fa-check"></i><b>2</b> The tools we use</a>
<ul>
<li class="chapter" data-level="2.1" data-path="the-tools-we-use.html"><a href="the-tools-we-use.html#r-and-rstudio"><i class="fa fa-check"></i><b>2.1</b> R and RStudio</a></li>
<li class="chapter" data-level="2.2" data-path="the-tools-we-use.html"><a href="the-tools-we-use.html#git-and-github"><i class="fa fa-check"></i><b>2.2</b> git and github</a></li>
<li class="chapter" data-level="2.3" data-path="the-tools-we-use.html"><a href="the-tools-we-use.html#rmarkdown"><i class="fa fa-check"></i><b>2.3</b> Rmarkdown</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tree-dormancy.html"><a href="tree-dormancy.html"><i class="fa fa-check"></i><b>3</b> Tree dormancy</a>
<ul>
<li class="chapter" data-level="3.1" data-path="tree-dormancy.html"><a href="tree-dormancy.html#learning-goals-for-this-lesson"><i class="fa fa-check"></i><b>3.1</b> Learning goals for this lesson:</a></li>
<li class="chapter" data-level="3.2" data-path="tree-dormancy.html"><a href="tree-dormancy.html#introduction-to-dormancy"><i class="fa fa-check"></i><b>3.2</b> Introduction to dormancy</a></li>
<li class="chapter" data-level="3.3" data-path="tree-dormancy.html"><a href="tree-dormancy.html#dormancy-physiology"><i class="fa fa-check"></i><b>3.3</b> Dormancy physiology</a></li>
<li class="chapter" data-level="3.4" data-path="tree-dormancy.html"><a href="tree-dormancy.html#experimental-and-statistical-determination-of-the-chilling-and-forcing-periods"><i class="fa fa-check"></i><b>3.4</b> Experimental and statistical determination of the chilling and forcing periods</a></li>
<li class="chapter" data-level="3.5" data-path="tree-dormancy.html"><a href="tree-dormancy.html#phenology-record-and-bbch-scale"><i class="fa fa-check"></i><b>3.5</b> Phenology record and BBCH scale</a></li>
<li class="chapter" data-level="" data-path="tree-dormancy.html"><a href="tree-dormancy.html#exercises_dormancy"><i class="fa fa-check"></i><code>Exercises</code> on tree dormancy</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html"><i class="fa fa-check"></i><b>4</b> Climate change and impact projection</a>
<ul>
<li class="chapter" data-level="4.1" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#the-drivers-of-climate-change"><i class="fa fa-check"></i><b>4.1</b> The drivers of climate change</a></li>
<li class="chapter" data-level="4.2" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#what-weve-already-seen"><i class="fa fa-check"></i><b>4.2</b> What we’ve already seen</a></li>
<li class="chapter" data-level="4.3" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#future-scenarios"><i class="fa fa-check"></i><b>4.3</b> Future scenarios</a></li>
<li class="chapter" data-level="4.4" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#impact-projection-approaches"><i class="fa fa-check"></i><b>4.4</b> Impact projection approaches</a></li>
<li class="chapter" data-level="" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#exercises_climate_change"><i class="fa fa-check"></i><code>Exercises</code> on climate change</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html"><i class="fa fa-check"></i><b>5</b> Winter chill projections</a>
<ul>
<li class="chapter" data-level="" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#goals_analysis_examples"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="5.1" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-projections-1"><i class="fa fa-check"></i><b>5.1</b> Winter chill projections</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-oman"><i class="fa fa-check"></i><b>5.1.1</b> Winter chill in Oman</a></li>
<li class="chapter" data-level="5.1.2" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-model-sensitivity"><i class="fa fa-check"></i><b>5.1.2</b> Chill model sensitivity</a></li>
<li class="chapter" data-level="5.1.3" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-california"><i class="fa fa-check"></i><b>5.1.3</b> Winter chill in California</a></li>
<li class="chapter" data-level="5.1.4" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-ratios"><i class="fa fa-check"></i><b>5.1.4</b> Winter chill ratios</a></li>
<li class="chapter" data-level="5.1.5" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#a-global-projection-of-future-winter-chill"><i class="fa fa-check"></i><b>5.1.5</b> A global projection of future winter chill</a></li>
<li class="chapter" data-level="5.1.6" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-germany"><i class="fa fa-check"></i><b>5.1.6</b> Winter chill in Germany</a></li>
<li class="chapter" data-level="5.1.7" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-tunisia"><i class="fa fa-check"></i><b>5.1.7</b> Winter chill in Tunisia</a></li>
<li class="chapter" data-level="5.1.8" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-chile"><i class="fa fa-check"></i><b>5.1.8</b> Winter chill in Chile</a></li>
<li class="chapter" data-level="5.1.9" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-projection-for-patagonia"><i class="fa fa-check"></i><b>5.1.9</b> Chill projection for Patagonia</a></li>
<li class="chapter" data-level="5.1.10" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-model-comparison"><i class="fa fa-check"></i><b>5.1.10</b> Chill model comparison</a></li>
<li class="chapter" data-level="5.1.11" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-projection-for-all-of-tunisia"><i class="fa fa-check"></i><b>5.1.11</b> Chill projection for all of Tunisia</a></li>
<li class="chapter" data-level="5.1.12" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#revisiting-chill-accumulation-in-oman"><i class="fa fa-check"></i><b>5.1.12</b> Revisiting chill accumulation in Oman</a></li>
<li class="chapter" data-level="5.1.13" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#future-studies"><i class="fa fa-check"></i><b>5.1.13</b> Future studies?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#exercises_past_studies"><i class="fa fa-check"></i><code>Exercises</code> on past chill projections</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="manual-chill-analysis.html"><a href="manual-chill-analysis.html"><i class="fa fa-check"></i><b>6</b> Manual chill analysis</a>
<ul>
<li class="chapter" data-level="" data-path="manual-chill-analysis.html"><a href="manual-chill-analysis.html#goals_manual_chill_analysis"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="6.1" data-path="manual-chill-analysis.html"><a href="manual-chill-analysis.html#computing-chilling-hours-from-hourly-temperature-data"><i class="fa fa-check"></i><b>6.1</b> Computing Chilling Hours from hourly temperature data</a></li>
<li class="chapter" data-level="6.2" data-path="manual-chill-analysis.html"><a href="manual-chill-analysis.html#our-first-chill-function"><i class="fa fa-check"></i><b>6.2</b> Our first chill function</a></li>
<li class="chapter" data-level="" data-path="manual-chill-analysis.html"><a href="manual-chill-analysis.html#exercises_manual_chill_analysis"><i class="fa fa-check"></i><code>Exercises</code> on basic chill modeling</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chill-models.html"><a href="chill-models.html"><i class="fa fa-check"></i><b>7</b> Chill models</a>
<ul>
<li class="chapter" data-level="" data-path="chill-models.html"><a href="chill-models.html#goals_chill_models"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="7.1" data-path="chill-models.html"><a href="chill-models.html#chill-models-in-chillr"><i class="fa fa-check"></i><b>7.1</b> Chill models in <code>chillR</code></a></li>
<li class="chapter" data-level="" data-path="chill-models.html"><a href="chill-models.html#exercises_chill_models"><i class="fa fa-check"></i><code>Exercises</code> on chill models</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html"><i class="fa fa-check"></i><b>8</b> Making hourly temperatures</a>
<ul>
<li class="chapter" data-level="" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#goals_hourly"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="8.1" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#generating-hourly-temperatures"><i class="fa fa-check"></i><b>8.1</b> Generating hourly temperatures</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#idealized-daily-temperature-curves"><i class="fa fa-check"></i><b>8.1.1</b> Idealized daily temperature curves</a></li>
<li class="chapter" data-level="8.1.2" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#empirical-daily-temperature-curves"><i class="fa fa-check"></i><b>8.1.2</b> Empirical daily temperature curves</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#exercises_hourly"><i class="fa fa-check"></i><code>Exercises</code> on hourly temperatures</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html"><i class="fa fa-check"></i><b>9</b> Some useful tools in R</a>
<ul>
<li class="chapter" data-level="" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#goals_R_tools"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="9.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#an-evolving-language---and-a-lifelong-learning-process"><i class="fa fa-check"></i><b>9.1</b> An evolving language - and a lifelong learning process</a></li>
<li class="chapter" data-level="9.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-tidyverse"><i class="fa fa-check"></i><b>9.2</b> The <code>tidyverse</code></a></li>
<li class="chapter" data-level="9.3" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-ggplot2-package"><i class="fa fa-check"></i><b>9.3</b> The <code>ggplot2</code> package</a></li>
<li class="chapter" data-level="9.4" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-tibble-package"><i class="fa fa-check"></i><b>9.4</b> The <code>tibble</code> package</a></li>
<li class="chapter" data-level="9.5" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-magrittr-package---pipes"><i class="fa fa-check"></i><b>9.5</b> The <code>magrittr</code> package - pipes</a></li>
<li class="chapter" data-level="9.6" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-tidyr-package"><i class="fa fa-check"></i><b>9.6</b> The <code>tidyr</code> package</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#pivot_longer"><i class="fa fa-check"></i><b>9.6.1</b> <code>pivot_longer</code></a></li>
<li class="chapter" data-level="9.6.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#pivot_wider"><i class="fa fa-check"></i><b>9.6.2</b> <code>pivot_wider</code></a></li>
<li class="chapter" data-level="9.6.3" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#select"><i class="fa fa-check"></i><b>9.6.3</b> <code>select</code></a></li>
<li class="chapter" data-level="9.6.4" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#filter"><i class="fa fa-check"></i><b>9.6.4</b> <code>filter</code></a></li>
<li class="chapter" data-level="9.6.5" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#mutate"><i class="fa fa-check"></i><b>9.6.5</b> <code>mutate</code></a></li>
<li class="chapter" data-level="9.6.6" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#arrange"><i class="fa fa-check"></i><b>9.6.6</b> <code>arrange</code></a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#loops"><i class="fa fa-check"></i><b>9.7</b> Loops</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#for-loops"><i class="fa fa-check"></i><b>9.7.1</b> <em>For</em> loops</a></li>
<li class="chapter" data-level="9.7.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#while-loops"><i class="fa fa-check"></i><b>9.7.2</b> <em>While</em> loops</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#apply-functions"><i class="fa fa-check"></i><b>9.8</b> <code>apply</code> functions</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#sapply"><i class="fa fa-check"></i><b>9.8.1</b> <code>sapply</code></a></li>
<li class="chapter" data-level="9.8.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#lapply"><i class="fa fa-check"></i><b>9.8.2</b> <code>lapply</code></a></li>
<li class="chapter" data-level="9.8.3" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#apply"><i class="fa fa-check"></i><b>9.8.3</b> <code>apply</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#exercises_R_tools"><i class="fa fa-check"></i><code>Exercises</code> on useful R tools</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="get_temp_data.html"><a href="get_temp_data.html"><i class="fa fa-check"></i><b>10</b> Getting temperature data</a>
<ul>
<li class="chapter" data-level="" data-path="get_temp_data.html"><a href="get_temp_data.html#goals_get_temps"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="10.1" data-path="get_temp_data.html"><a href="get_temp_data.html#temperature-data-needs"><i class="fa fa-check"></i><b>10.1</b> Temperature data needs</a></li>
<li class="chapter" data-level="10.2" data-path="get_temp_data.html"><a href="get_temp_data.html#the-global-summary-of-the-day-database"><i class="fa fa-check"></i><b>10.2</b> The Global Summary of the Day database</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="get_temp_data.html"><a href="get_temp_data.html#actionlist_stations"><i class="fa fa-check"></i><b>10.2.1</b> <code>action=list_stations</code></a></li>
<li class="chapter" data-level="10.2.2" data-path="get_temp_data.html"><a href="get_temp_data.html#actiondownload_weather"><i class="fa fa-check"></i><b>10.2.2</b> <code>action="download_weather"</code></a></li>
<li class="chapter" data-level="10.2.3" data-path="get_temp_data.html"><a href="get_temp_data.html#downloaded-weather-as-action-argument"><i class="fa fa-check"></i><b>10.2.3</b> downloaded weather as <code>action</code> argument</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="get_temp_data.html"><a href="get_temp_data.html#exercises_getting"><i class="fa fa-check"></i><code>Exercises</code> on getting temperature data</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html"><i class="fa fa-check"></i><b>11</b> Filling gaps in temperature records</a>
<ul>
<li class="chapter" data-level="" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#goals_gaps"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="11.1" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#gaps"><i class="fa fa-check"></i><b>11.1</b> Gaps</a></li>
<li class="chapter" data-level="11.2" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#filling-short-gaps-in-daily-records"><i class="fa fa-check"></i><b>11.2</b> Filling short gaps in daily records</a></li>
<li class="chapter" data-level="11.3" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#filling-long-gaps-in-daily-records"><i class="fa fa-check"></i><b>11.3</b> Filling long gaps in daily records</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#bias-correction-for-shorter-intervals"><i class="fa fa-check"></i><b>11.3.1</b> Bias-correction for shorter intervals</a></li>
<li class="chapter" data-level="11.3.2" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#saving-the-data-for-later"><i class="fa fa-check"></i><b>11.3.2</b> Saving the data for later</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#filling-gaps-in-hourly-records"><i class="fa fa-check"></i><b>11.4</b> Filling gaps in hourly records</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#accuracy-assessment"><i class="fa fa-check"></i><b>11.4.1</b> Accuracy assessment</a></li>
<li class="chapter" data-level="11.4.2" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#computing-agroclimatic-metrics"><i class="fa fa-check"></i><b>11.4.2</b> Computing agroclimatic metrics</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#exercises_patching"><i class="fa fa-check"></i><code>Exercises</code> on filling gaps</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html"><i class="fa fa-check"></i><b>12</b> Generating temperature scenarios</a>
<ul>
<li class="chapter" data-level="" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html#goals_temperature_scenarios"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="12.1" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html#chill-scenarios"><i class="fa fa-check"></i><b>12.1</b> Chill scenarios</a></li>
<li class="chapter" data-level="12.2" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html#risk-assessment-in-orchard-planning"><i class="fa fa-check"></i><b>12.2</b> Risk assessment in orchard planning</a></li>
<li class="chapter" data-level="12.3" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html#weather-generators"><i class="fa fa-check"></i><b>12.3</b> Weather generators</a></li>
<li class="chapter" data-level="12.4" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html#weather-generation-in-chillr"><i class="fa fa-check"></i><b>12.4</b> Weather generation in <code>chillR</code></a></li>
<li class="chapter" data-level="" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html#weather_generation_exercises"><i class="fa fa-check"></i><code>Exercises</code> on temperature generation</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="saving-and-loading-data-and-hiding-this-in-markdown.html"><a href="saving-and-loading-data-and-hiding-this-in-markdown.html"><i class="fa fa-check"></i><b>13</b> Saving and loading data (and hiding this in markdown)</a>
<ul>
<li class="chapter" data-level="13.1" data-path="saving-and-loading-data-and-hiding-this-in-markdown.html"><a href="saving-and-loading-data-and-hiding-this-in-markdown.html#learning-goals-for-this-lesson-1"><i class="fa fa-check"></i><b>13.1</b> Learning Goals for this lesson:</a></li>
<li class="chapter" data-level="13.2" data-path="saving-and-loading-data-and-hiding-this-in-markdown.html"><a href="saving-and-loading-data-and-hiding-this-in-markdown.html#saving-and-loading-data"><i class="fa fa-check"></i><b>13.2</b> Saving and loading data</a></li>
<li class="chapter" data-level="13.3" data-path="saving-and-loading-data-and-hiding-this-in-markdown.html"><a href="saving-and-loading-data-and-hiding-this-in-markdown.html#hiding-all-this-from-the-readers-of-our-markdown-file"><i class="fa fa-check"></i><b>13.3</b> Hiding all this from the readers of our markdown file</a></li>
<li class="chapter" data-level="" data-path="saving-and-loading-data-and-hiding-this-in-markdown.html"><a href="saving-and-loading-data-and-hiding-this-in-markdown.html#exercises_saveLoad"><i class="fa fa-check"></i><code>Exercises</code> on saving and loading data</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="historic-temperature-scenarios.html"><a href="historic-temperature-scenarios.html"><i class="fa fa-check"></i><b>14</b> Historic temperature scenarios</a>
<ul>
<li class="chapter" data-level="" data-path="historic-temperature-scenarios.html"><a href="historic-temperature-scenarios.html#goals_hist_temp_scen"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="14.1" data-path="historic-temperature-scenarios.html"><a href="historic-temperature-scenarios.html#climate-change-scenarios"><i class="fa fa-check"></i><b>14.1</b> Climate change scenarios</a></li>
<li class="chapter" data-level="14.2" data-path="historic-temperature-scenarios.html"><a href="historic-temperature-scenarios.html#making-historic-temperature-scenarios"><i class="fa fa-check"></i><b>14.2</b> Making historic temperature scenarios</a></li>
<li class="chapter" data-level="" data-path="historic-temperature-scenarios.html"><a href="historic-temperature-scenarios.html#exercises_historic_scenarios"><i class="fa fa-check"></i><code>Exercises</code> on generating historic temperature scenarios</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="future-temperature-scenarios.html"><a href="future-temperature-scenarios.html"><i class="fa fa-check"></i><b>15</b> Future temperature scenarios</a>
<ul>
<li class="chapter" data-level="" data-path="future-temperature-scenarios.html"><a href="future-temperature-scenarios.html#goals_future_temp_scen"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="15.1" data-path="future-temperature-scenarios.html"><a href="future-temperature-scenarios.html#impacts-of-future-climate-change"><i class="fa fa-check"></i><b>15.1</b> Impacts of future climate change</a></li>
<li class="chapter" data-level="15.2" data-path="future-temperature-scenarios.html"><a href="future-temperature-scenarios.html#future-climate-scenarios"><i class="fa fa-check"></i><b>15.2</b> Future climate scenarios</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="future-temperature-scenarios.html"><a href="future-temperature-scenarios.html#some-background-on-climate-models-and-warming-pathways"><i class="fa fa-check"></i><b>15.2.1</b> Some background on climate models and warming pathways</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="future-temperature-scenarios.html"><a href="future-temperature-scenarios.html#exercises_future_scenarios"><i class="fa fa-check"></i><code>Exercises</code> on future temperature scenarios</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html"><i class="fa fa-check"></i><b>16</b> Making CMIP6 scenarios</a>
<ul>
<li class="chapter" data-level="" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html#goals_CMIP6"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="16.1" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html#accessing-gridded-climate-data-from-the-copernicus-climate-data-store"><i class="fa fa-check"></i><b>16.1</b> Accessing gridded climate data from the Copernicus climate data store</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html#downloading-future-climate-data"><i class="fa fa-check"></i><b>16.1.1</b> Downloading future climate data</a></li>
<li class="chapter" data-level="16.1.2" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html#generating-change-scenarios"><i class="fa fa-check"></i><b>16.1.2</b> Generating change scenarios</a></li>
<li class="chapter" data-level="16.1.3" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html#extracting-data-from-the-grids"><i class="fa fa-check"></i><b>16.1.3</b> Extracting data from the grids</a></li>
<li class="chapter" data-level="16.1.4" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html#baseline-adjustment"><i class="fa fa-check"></i><b>16.1.4</b> Baseline adjustment</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html#exercises_CMIP6"><i class="fa fa-check"></i><code>Exercises</code> on generating CMIP6 temperature scenarios</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="making-cmip5-scenarios-with-the-climatewizard.html"><a href="making-cmip5-scenarios-with-the-climatewizard.html"><i class="fa fa-check"></i><b>17</b> Making CMIP5 scenarios with the <code>ClimateWizard</code></a>
<ul>
<li class="chapter" data-level="" data-path="making-cmip5-scenarios-with-the-climatewizard.html"><a href="making-cmip5-scenarios-with-the-climatewizard.html#goals_ClimateWizard"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="17.1" data-path="making-cmip5-scenarios-with-the-climatewizard.html"><a href="making-cmip5-scenarios-with-the-climatewizard.html#using-the-climatewizard"><i class="fa fa-check"></i><b>17.1</b> Using the <code>ClimateWizard</code></a></li>
<li class="chapter" data-level="" data-path="making-cmip5-scenarios-with-the-climatewizard.html"><a href="making-cmip5-scenarios-with-the-climatewizard.html#exercises_ClimateWizard"><i class="fa fa-check"></i><code>Exercises</code> on generating CMIP5 temperature scenarios</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="plot_future.html"><a href="plot_future.html"><i class="fa fa-check"></i><b>18</b> Plotting future scenarios</a>
<ul>
<li class="chapter" data-level="" data-path="plot_future.html"><a href="plot_future.html#goals_future_plots"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="18.1" data-path="plot_future.html"><a href="plot_future.html#making-attractive-plots"><i class="fa fa-check"></i><b>18.1</b> Making attractive plots</a></li>
<li class="chapter" data-level="18.2" data-path="plot_future.html"><a href="plot_future.html#the-results"><i class="fa fa-check"></i><b>18.2</b> The results</a></li>
<li class="chapter" data-level="" data-path="plot_future.html"><a href="plot_future.html#exercises_future_plots"><i class="fa fa-check"></i><code>Exercises</code> on plotting future projections</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="chill_model_comparison.html"><a href="chill_model_comparison.html"><i class="fa fa-check"></i><b>19</b> Chill model comparison</a>
<ul>
<li class="chapter" data-level="" data-path="chill_model_comparison.html"><a href="chill_model_comparison.html#goals_chill_model"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="19.1" data-path="chill_model_comparison.html"><a href="chill_model_comparison.html#safe-winter-chill"><i class="fa fa-check"></i><b>19.1</b> Safe Winter Chill</a></li>
<li class="chapter" data-level="19.2" data-path="chill_model_comparison.html"><a href="chill_model_comparison.html#chill-metrics"><i class="fa fa-check"></i><b>19.2</b> Chill metrics</a></li>
<li class="chapter" data-level="19.3" data-path="chill_model_comparison.html"><a href="chill_model_comparison.html#an-animated-plot-of-relative-changes-in-safe-winter-chill"><i class="fa fa-check"></i><b>19.3</b> An animated plot of relative changes in Safe Winter Chill</a></li>
<li class="chapter" data-level="" data-path="chill_model_comparison.html"><a href="chill_model_comparison.html#exercises_chill_model_comparison"><i class="fa fa-check"></i><code>Exercises</code> on chill model comparison</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="simple_phenology.html"><a href="simple_phenology.html"><i class="fa fa-check"></i><b>20</b> Simple phenology analysis</a>
<ul>
<li class="chapter" data-level="" data-path="simple_phenology.html"><a href="simple_phenology.html#goals_simple_phenology"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="20.1" data-path="simple_phenology.html"><a href="simple_phenology.html#phenology-analysis"><i class="fa fa-check"></i><b>20.1</b> Phenology analysis</a></li>
<li class="chapter" data-level="20.2" data-path="simple_phenology.html"><a href="simple_phenology.html#time-series-analysis"><i class="fa fa-check"></i><b>20.2</b> Time series analysis</a></li>
<li class="chapter" data-level="20.3" data-path="simple_phenology.html"><a href="simple_phenology.html#p-hacking"><i class="fa fa-check"></i><b>20.3</b> p-hacking</a></li>
<li class="chapter" data-level="20.4" data-path="simple_phenology.html"><a href="simple_phenology.html#the-process-that-generates-the-data"><i class="fa fa-check"></i><b>20.4</b> The process that generates the data</a></li>
<li class="chapter" data-level="20.5" data-path="simple_phenology.html"><a href="simple_phenology.html#an-ecological-theory-to-guide-our-analysis"><i class="fa fa-check"></i><b>20.5</b> An ecological theory to guide our analysis</a></li>
<li class="chapter" data-level="20.6" data-path="simple_phenology.html"><a href="simple_phenology.html#temperature-correlations"><i class="fa fa-check"></i><b>20.6</b> Temperature correlations</a></li>
<li class="chapter" data-level="" data-path="simple_phenology.html"><a href="simple_phenology.html#exercises_simple_analysis"><i class="fa fa-check"></i><code>Exercises</code> on simple phenology analysis</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="pls_intro.html"><a href="pls_intro.html"><i class="fa fa-check"></i><b>21</b> Delineating temperature response phases with PLS regression</a>
<ul>
<li class="chapter" data-level="" data-path="pls_intro.html"><a href="pls_intro.html#goals_PLS_intro"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="21.1" data-path="pls_intro.html"><a href="pls_intro.html#detecting-temperature-response-phases"><i class="fa fa-check"></i><b>21.1</b> Detecting temperature response phases</a></li>
<li class="chapter" data-level="21.2" data-path="pls_intro.html"><a href="pls_intro.html#finding-signals-in-hyperspectral-remote-sensing-data"><i class="fa fa-check"></i><b>21.2</b> Finding signals in hyperspectral remote sensing data</a></li>
<li class="chapter" data-level="21.3" data-path="pls_intro.html"><a href="pls_intro.html#pls-regression-for-phenology-analysis"><i class="fa fa-check"></i><b>21.3</b> PLS regression for phenology analysis</a></li>
<li class="chapter" data-level="21.4" data-path="pls_intro.html"><a href="pls_intro.html#a-note-of-caution-about-pls-results"><i class="fa fa-check"></i><b>21.4</b> A note of caution about PLS results</a></li>
<li class="chapter" data-level="21.5" data-path="pls_intro.html"><a href="pls_intro.html#pls-analysis-of-alexander-lucas-pears-in-klein-altendorf"><i class="fa fa-check"></i><b>21.5</b> PLS analysis of ‘Alexander Lucas’ pears in Klein-Altendorf</a></li>
<li class="chapter" data-level="" data-path="pls_intro.html"><a href="pls_intro.html#exercises_first_PLS"><i class="fa fa-check"></i><code>Exercises</code> on chill model comparison</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="pls_reflection.html"><a href="pls_reflection.html"><i class="fa fa-check"></i><b>22</b> Successes and limitations of PLS regression analysis</a>
<ul>
<li class="chapter" data-level="" data-path="pls_reflection.html"><a href="pls_reflection.html#goals_PLS_reflection"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="22.1" data-path="pls_reflection.html"><a href="pls_reflection.html#pls-regression"><i class="fa fa-check"></i><b>22.1</b> PLS regression</a></li>
<li class="chapter" data-level="22.2" data-path="pls_reflection.html"><a href="pls_reflection.html#pls-examples"><i class="fa fa-check"></i><b>22.2</b> PLS examples</a>
<ul>
<li class="chapter" data-level="22.2.1" data-path="pls_reflection.html"><a href="pls_reflection.html#grasslands-on-the-tibetan-plateau"><i class="fa fa-check"></i><b>22.2.1</b> Grasslands on the Tibetan Plateau</a></li>
<li class="chapter" data-level="22.2.2" data-path="pls_reflection.html"><a href="pls_reflection.html#deciduous-trees"><i class="fa fa-check"></i><b>22.2.2</b> Deciduous trees</a></li>
<li class="chapter" data-level="22.2.3" data-path="pls_reflection.html"><a href="pls_reflection.html#why-were-not-seeing-the-chilling-phase"><i class="fa fa-check"></i><b>22.2.3</b> Why we’re not seeing the chilling phase</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="pls_reflection.html"><a href="pls_reflection.html#exercises_PLS_reflection"><i class="fa fa-check"></i><code>Exercises</code> on chill model comparison</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="pls_chillforce.html"><a href="pls_chillforce.html"><i class="fa fa-check"></i><b>23</b> PLS regression with agroclimatic metrics</a>
<ul>
<li class="chapter" data-level="" data-path="pls_chillforce.html"><a href="pls_chillforce.html#goals_PLS_chillforce"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="23.1" data-path="pls_chillforce.html"><a href="pls_chillforce.html#adjusting-pls-for-use-with-non-monotonic-relationships"><i class="fa fa-check"></i><b>23.1</b> Adjusting PLS for use with non-monotonic relationships</a></li>
<li class="chapter" data-level="23.2" data-path="pls_chillforce.html"><a href="pls_chillforce.html#pls-analysis-with-chilling-and-forcing-data"><i class="fa fa-check"></i><b>23.2</b> PLS analysis with chilling and forcing data</a></li>
<li class="chapter" data-level="23.3" data-path="pls_chillforce.html"><a href="pls_chillforce.html#delineating-chilling-and-forcing-periods"><i class="fa fa-check"></i><b>23.3</b> Delineating chilling and forcing periods</a></li>
<li class="chapter" data-level="23.4" data-path="pls_chillforce.html"><a href="pls_chillforce.html#ggplotting-the-results"><i class="fa fa-check"></i><b>23.4</b> <code>ggplot</code>ting the results</a></li>
<li class="chapter" data-level="" data-path="pls_chillforce.html"><a href="pls_chillforce.html#exercises_PLS_chill_force"><i class="fa fa-check"></i><code>Exercises</code> on chill model comparison</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html"><i class="fa fa-check"></i><b>24</b> Examples of PLS regression with agroclimatic metrics</a>
<ul>
<li class="chapter" data-level="" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#goals_PLS_chillforce_ex"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="24.1" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#pls-regression-across-species-and-agroclimatic-contexts"><i class="fa fa-check"></i><b>24.1</b> PLS regression across species and agroclimatic contexts</a>
<ul>
<li class="chapter" data-level="24.1.1" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#chestnut-jujube-and-apricot-in-beijing"><i class="fa fa-check"></i><b>24.1.1</b> Chestnut, jujube and apricot in Beijing</a></li>
<li class="chapter" data-level="24.1.2" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#apples-in-shaanxi-province-china"><i class="fa fa-check"></i><b>24.1.2</b> Apples in Shaanxi Province, China</a></li>
<li class="chapter" data-level="24.1.3" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#cherries-in-klein-altendorf"><i class="fa fa-check"></i><b>24.1.3</b> Cherries in Klein-Altendorf</a></li>
<li class="chapter" data-level="24.1.4" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#apricots-in-the-uk"><i class="fa fa-check"></i><b>24.1.4</b> Apricots in the UK</a></li>
<li class="chapter" data-level="24.1.5" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#grapevine-in-croatia"><i class="fa fa-check"></i><b>24.1.5</b> Grapevine in Croatia</a></li>
<li class="chapter" data-level="24.1.6" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#walnuts-in-california"><i class="fa fa-check"></i><b>24.1.6</b> Walnuts in California</a></li>
<li class="chapter" data-level="24.1.7" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#almonds-in-tunisia"><i class="fa fa-check"></i><b>24.1.7</b> Almonds in Tunisia</a></li>
<li class="chapter" data-level="24.1.8" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#pistachios-in-tunisia"><i class="fa fa-check"></i><b>24.1.8</b> Pistachios in Tunisia</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#exercises_PLS_chill_force_ex"><i class="fa fa-check"></i><code>Exercises</code> on examples of PLS regression with agroclimatic metrics</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html"><i class="fa fa-check"></i><b>25</b> Why PLS doesn’t always work</a>
<ul>
<li class="chapter" data-level="" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#goals_PLS_chillforce_reflection"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="25.1" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#disappointing-pls-performance"><i class="fa fa-check"></i><b>25.1</b> Disappointing PLS performance</a></li>
<li class="chapter" data-level="25.2" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#what-pls-regression-can-find"><i class="fa fa-check"></i><b>25.2</b> What PLS regression can find</a></li>
<li class="chapter" data-level="25.3" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#chill-model-sensitivity-vs.-observed-temperature"><i class="fa fa-check"></i><b>25.3</b> Chill model sensitivity vs. observed temperature</a>
<ul>
<li class="chapter" data-level="25.3.1" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#beijing-china"><i class="fa fa-check"></i><b>25.3.1</b> Beijing, China</a></li>
<li class="chapter" data-level="25.3.2" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#klein-altendorf-germany"><i class="fa fa-check"></i><b>25.3.2</b> Klein-Altendorf, Germany</a></li>
<li class="chapter" data-level="25.3.3" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#davis-california"><i class="fa fa-check"></i><b>25.3.3</b> Davis, California</a></li>
<li class="chapter" data-level="25.3.4" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#sfax-tunisia"><i class="fa fa-check"></i><b>25.3.4</b> Sfax, Tunisia</a></li>
</ul></li>
<li class="chapter" data-level="25.4" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#heat-model-sensitivity-vs.-observed-temperature"><i class="fa fa-check"></i><b>25.4</b> Heat model sensitivity vs. observed temperature</a></li>
<li class="chapter" data-level="" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#exercises_PLS_chillforce_reflection"><i class="fa fa-check"></i><code>Exercises</code> on expected PLS responsiveness</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="pls_eval_PLS.html"><a href="pls_eval_PLS.html"><i class="fa fa-check"></i><b>26</b> Evaluating PLS outputs</a>
<ul>
<li class="chapter" data-level="" data-path="pls_eval_PLS.html"><a href="pls_eval_PLS.html#goals_PLS_eval"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="26.1" data-path="pls_eval_PLS.html"><a href="pls_eval_PLS.html#chilling-and-forcing-requirements"><i class="fa fa-check"></i><b>26.1</b> Chilling and forcing requirements</a></li>
<li class="chapter" data-level="26.2" data-path="pls_eval_PLS.html"><a href="pls_eval_PLS.html#response-to-seasonal-temperature"><i class="fa fa-check"></i><b>26.2</b> Response to seasonal temperature</a></li>
<li class="chapter" data-level="26.3" data-path="pls_eval_PLS.html"><a href="pls_eval_PLS.html#applying-our-functions-to-california-walnuts"><i class="fa fa-check"></i><b>26.3</b> Applying our functions to California walnuts</a></li>
<li class="chapter" data-level="" data-path="pls_eval_PLS.html"><a href="pls_eval_PLS.html#exercises_PLS_eval"><i class="fa fa-check"></i><code>Exercises</code> on evaluating PLS regression results</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="pls_chillforce_relimp.html"><a href="pls_chillforce_relimp.html"><i class="fa fa-check"></i><b>27</b> The relative importance of chill and heat</a>
<ul>
<li class="chapter" data-level="" data-path="pls_chillforce_relimp.html"><a href="pls_chillforce_relimp.html#goals_PLS_chillforce_relimp"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="27.1" data-path="pls_chillforce_relimp.html"><a href="pls_chillforce_relimp.html#chilling-vs.-forcing-temperatures"><i class="fa fa-check"></i><b>27.1</b> Chilling vs. forcing temperatures</a></li>
<li class="chapter" data-level="27.2" data-path="pls_chillforce_relimp.html"><a href="pls_chillforce_relimp.html#patterns-in-temperature-responses"><i class="fa fa-check"></i><b>27.2</b> Patterns in temperature responses</a></li>
<li class="chapter" data-level="27.3" data-path="pls_chillforce_relimp.html"><a href="pls_chillforce_relimp.html#the-warm-end-of-the-spectrum"><i class="fa fa-check"></i><b>27.3</b> The warm end of the spectrum</a></li>
<li class="chapter" data-level="27.4" data-path="pls_chillforce_relimp.html"><a href="pls_chillforce_relimp.html#implications-of-our-hypothesis"><i class="fa fa-check"></i><b>27.4</b> Implications of our hypothesis</a></li>
<li class="chapter" data-level="" data-path="pls_chillforce_relimp.html"><a href="pls_chillforce_relimp.html#exercises_PLS_chillforce_relimp"><i class="fa fa-check"></i><code>Exercises</code> on the relative importance of chill and heat</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="exp_PLS.html"><a href="exp_PLS.html"><i class="fa fa-check"></i><b>28</b> Experimentally enhanced PLS</a>
<ul>
<li class="chapter" data-level="" data-path="exp_PLS.html"><a href="exp_PLS.html#goals_exp_PLS"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="28.1" data-path="exp_PLS.html"><a href="exp_PLS.html#enhanced-phenology-data"><i class="fa fa-check"></i><b>28.1</b> Enhanced phenology data</a></li>
<li class="chapter" data-level="" data-path="exp_PLS.html"><a href="exp_PLS.html#exc_exp_PLS"><i class="fa fa-check"></i><code>Exercises</code> on experimental PLS</a></li>
</ul></li>
<li class="chapter" data-level="29" data-path="model_validity.html"><a href="model_validity.html"><i class="fa fa-check"></i><b>29</b> Making valid tree phenology models</a>
<ul>
<li class="chapter" data-level="" data-path="model_validity.html"><a href="model_validity.html#goals_model_validity"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="29.1" data-path="model_validity.html"><a href="model_validity.html#the-modeling-challenge"><i class="fa fa-check"></i><b>29.1</b> The modeling challenge</a></li>
<li class="chapter" data-level="29.2" data-path="model_validity.html"><a href="model_validity.html#validating-models"><i class="fa fa-check"></i><b>29.2</b> Validating models</a></li>
<li class="chapter" data-level="29.3" data-path="model_validity.html"><a href="model_validity.html#mapping-validity-domains"><i class="fa fa-check"></i><b>29.3</b> Mapping validity domains</a></li>
<li class="chapter" data-level="29.4" data-path="model_validity.html"><a href="model_validity.html#one-last-thought-on-model-validity"><i class="fa fa-check"></i><b>29.4</b> One last thought on model validity</a></li>
<li class="chapter" data-level="" data-path="model_validity.html"><a href="model_validity.html#ex_model_validity"><i class="fa fa-check"></i><code>Exercises</code> on making valid tree phenology models</a></li>
</ul></li>
<li class="chapter" data-level="30" data-path="phenoflex.html"><a href="phenoflex.html"><i class="fa fa-check"></i><b>30</b> The <code>PhenoFlex</code> model</a>
<ul>
<li class="chapter" data-level="" data-path="phenoflex.html"><a href="phenoflex.html#goals_phenoflex"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="30.1" data-path="phenoflex.html"><a href="phenoflex.html#ingredients-of-this-lesson"><i class="fa fa-check"></i><b>30.1</b> Ingredients of this lesson</a></li>
<li class="chapter" data-level="30.2" data-path="phenoflex.html"><a href="phenoflex.html#towards-credible-phenology-models"><i class="fa fa-check"></i><b>30.2</b> Towards credible phenology models</a></li>
<li class="chapter" data-level="30.3" data-path="phenoflex.html"><a href="phenoflex.html#the-phenoflex-framework"><i class="fa fa-check"></i><b>30.3</b> The PhenoFlex framework</a></li>
<li class="chapter" data-level="30.4" data-path="phenoflex.html"><a href="phenoflex.html#running-phenoflex"><i class="fa fa-check"></i><b>30.4</b> Running <code>PhenoFlex</code></a></li>
<li class="chapter" data-level="30.5" data-path="phenoflex.html"><a href="phenoflex.html#parameterizing-phenoflex"><i class="fa fa-check"></i><b>30.5</b> Parameterizing <code>PhenoFlex</code></a></li>
<li class="chapter" data-level="30.6" data-path="phenoflex.html"><a href="phenoflex.html#conclusions-on-phenoflex"><i class="fa fa-check"></i><b>30.6</b> Conclusions on <code>PhenoFlex</code></a></li>
<li class="chapter" data-level="" data-path="phenoflex.html"><a href="phenoflex.html#ex_model_phenoflex"><i class="fa fa-check"></i><code>Exercises</code> on the <code>PhenoFlex</code> model</a></li>
</ul></li>
<li class="chapter" data-level="31" data-path="phenoflex2.html"><a href="phenoflex2.html"><i class="fa fa-check"></i><b>31</b> The <code>PhenoFlex</code> model - a second look</a>
<ul>
<li class="chapter" data-level="" data-path="phenoflex2.html"><a href="phenoflex2.html#goals_phenoflex2"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="31.1" data-path="phenoflex2.html"><a href="phenoflex2.html#some-basic-diagnostics-for-our-phenoflex-fit"><i class="fa fa-check"></i><b>31.1</b> Some basic diagnostics for our <code>PhenoFlex</code> fit</a></li>
<li class="chapter" data-level="31.2" data-path="phenoflex2.html"><a href="phenoflex2.html#temperature-response-of-the-phenoflex-components"><i class="fa fa-check"></i><b>31.2</b> Temperature response of the <code>PhenoFlex</code> components</a></li>
<li class="chapter" data-level="31.3" data-path="phenoflex2.html"><a href="phenoflex2.html#overall-impression"><i class="fa fa-check"></i><b>31.3</b> Overall impression</a></li>
<li class="chapter" data-level="31.4" data-path="phenoflex2.html"><a href="phenoflex2.html#caveats-and-assumptions"><i class="fa fa-check"></i><b>31.4</b> Caveats and assumptions</a></li>
<li class="chapter" data-level="31.5" data-path="phenoflex2.html"><a href="phenoflex2.html#outlook"><i class="fa fa-check"></i><b>31.5</b> Outlook</a></li>
<li class="chapter" data-level="" data-path="phenoflex2.html"><a href="phenoflex2.html#ex_phenoflex2"><i class="fa fa-check"></i><code>Exercises</code> on basic <code>PhenoFlex</code> diagnostics</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="phenoflex3.html"><a href="phenoflex3.html"><i class="fa fa-check"></i><b>32</b> Can we improve the performance of <code>PhenoFlex</code>?</a>
<ul>
<li class="chapter" data-level="" data-path="phenoflex3.html"><a href="phenoflex3.html#goals_phenoflex3"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="32.1" data-path="phenoflex3.html"><a href="phenoflex3.html#the-motivation"><i class="fa fa-check"></i><b>32.1</b> The motivation</a></li>
<li class="chapter" data-level="32.2" data-path="phenoflex3.html"><a href="phenoflex3.html#using-experimental-phenology-data-for-assessing-the-performance-of-phenoflex"><i class="fa fa-check"></i><b>32.2</b> Using experimental phenology data for assessing the performance of <code>PhenoFlex</code></a></li>
<li class="chapter" data-level="32.3" data-path="phenoflex3.html"><a href="phenoflex3.html#validation"><i class="fa fa-check"></i><b>32.3</b> Validation</a></li>
<li class="chapter" data-level="32.4" data-path="phenoflex3.html"><a href="phenoflex3.html#conclusions"><i class="fa fa-check"></i><b>32.4</b> Conclusions</a></li>
<li class="chapter" data-level="" data-path="phenoflex3.html"><a href="phenoflex3.html#ex_phenoflex3"><i class="fa fa-check"></i><code>Exercises</code> on improving the performance of <code>PhenoFlex</code></a></li>
</ul></li>
<li class="chapter" data-level="33" data-path="frost-risk-analysis.html"><a href="frost-risk-analysis.html"><i class="fa fa-check"></i><b>33</b> Frost risk analysis</a>
<ul>
<li class="chapter" data-level="" data-path="frost-risk-analysis.html"><a href="frost-risk-analysis.html#goals_frost_risk"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="33.1" data-path="frost-risk-analysis.html"><a href="frost-risk-analysis.html#spring-frost"><i class="fa fa-check"></i><b>33.1</b> Spring frost</a></li>
<li class="chapter" data-level="33.2" data-path="frost-risk-analysis.html"><a href="frost-risk-analysis.html#phenology-trend-analysis"><i class="fa fa-check"></i><b>33.2</b> Phenology trend analysis</a></li>
<li class="chapter" data-level="33.3" data-path="frost-risk-analysis.html"><a href="frost-risk-analysis.html#frost-risk"><i class="fa fa-check"></i><b>33.3</b> Frost risk</a></li>
<li class="chapter" data-level="" data-path="frost-risk-analysis.html"><a href="frost-risk-analysis.html#exercises_frost_risk"><i class="fa fa-check"></i><code>Exercises</code> on frost risk analysis</a></li>
</ul></li>
<li class="chapter" data-level="34" data-path="a-robust-method-to-estimate-future-frost-risks.html"><a href="a-robust-method-to-estimate-future-frost-risks.html"><i class="fa fa-check"></i><b>34</b> A robust method to estimate future frost risks (?)</a>
<ul>
<li class="chapter" data-level="" data-path="a-robust-method-to-estimate-future-frost-risks.html"><a href="a-robust-method-to-estimate-future-frost-risks.html#goals_future_frost_risk"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="34.1" data-path="a-robust-method-to-estimate-future-frost-risks.html"><a href="a-robust-method-to-estimate-future-frost-risks.html#frost-risk-for-future-scenarios"><i class="fa fa-check"></i><b>34.1</b> Frost risk for future scenarios</a></li>
<li class="chapter" data-level="34.2" data-path="a-robust-method-to-estimate-future-frost-risks.html"><a href="a-robust-method-to-estimate-future-frost-risks.html#validation-1"><i class="fa fa-check"></i><b>34.2</b> Validation</a></li>
<li class="chapter" data-level="34.3" data-path="a-robust-method-to-estimate-future-frost-risks.html"><a href="a-robust-method-to-estimate-future-frost-risks.html#exercises-for-this-chapter"><i class="fa fa-check"></i><b>34.3</b> <code>Exercises</code> for this chapter</a></li>
</ul></li>
<li class="chapter" data-level="35" data-path="major_concepts.html"><a href="major_concepts.html"><i class="fa fa-check"></i><b>35</b> Major concepts</a>
<ul>
<li class="chapter" data-level="" data-path="major_concepts.html"><a href="major_concepts.html#goals_major_concepts"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="35.1" data-path="major_concepts.html"><a href="major_concepts.html#key-insights"><i class="fa fa-check"></i><b>35.1</b> Key insights</a>
<ul>
<li class="chapter" data-level="35.1.1" data-path="major_concepts.html"><a href="major_concepts.html#tree-dormancy-1"><i class="fa fa-check"></i><b>35.1.1</b> Tree dormancy</a></li>
<li class="chapter" data-level="35.1.2" data-path="major_concepts.html"><a href="major_concepts.html#climate-change"><i class="fa fa-check"></i><b>35.1.2</b> Climate change</a></li>
<li class="chapter" data-level="35.1.3" data-path="major_concepts.html"><a href="major_concepts.html#phenology-modeling"><i class="fa fa-check"></i><b>35.1.3</b> Phenology modeling</a></li>
<li class="chapter" data-level="35.1.4" data-path="major_concepts.html"><a href="major_concepts.html#phenology-responses-to-global-warming"><i class="fa fa-check"></i><b>35.1.4</b> Phenology responses to global warming</a></li>
<li class="chapter" data-level="35.1.5" data-path="major_concepts.html"><a href="major_concepts.html#the-phenoflex-modeling-framework"><i class="fa fa-check"></i><b>35.1.5</b> The <code>PhenoFlex</code> modeling framework</a></li>
</ul></li>
<li class="chapter" data-level="35.2" data-path="major_concepts.html"><a href="major_concepts.html#major-concepts-weve-encountered"><i class="fa fa-check"></i><b>35.2</b> Major concepts we’ve encountered</a>
<ul>
<li class="chapter" data-level="35.2.1" data-path="major_concepts.html"><a href="major_concepts.html#reproducibility-and-transparency"><i class="fa fa-check"></i><b>35.2.1</b> Reproducibility and transparency</a></li>
<li class="chapter" data-level="35.2.2" data-path="major_concepts.html"><a href="major_concepts.html#tools"><i class="fa fa-check"></i><b>35.2.2</b> Tools</a></li>
<li class="chapter" data-level="35.2.3" data-path="major_concepts.html"><a href="major_concepts.html#automate-and-move-on"><i class="fa fa-check"></i><b>35.2.3</b> Automate and move on</a></li>
<li class="chapter" data-level="35.2.4" data-path="major_concepts.html"><a href="major_concepts.html#the-power-of-r"><i class="fa fa-check"></i><b>35.2.4</b> The power of R</a></li>
<li class="chapter" data-level="35.2.5" data-path="major_concepts.html"><a href="major_concepts.html#curiosity-and-interdisciplinarity"><i class="fa fa-check"></i><b>35.2.5</b> Curiosity and interdisciplinarity</a></li>
<li class="chapter" data-level="35.2.6" data-path="major_concepts.html"><a href="major_concepts.html#uncertainty"><i class="fa fa-check"></i><b>35.2.6</b> Uncertainty</a></li>
<li class="chapter" data-level="35.2.7" data-path="major_concepts.html"><a href="major_concepts.html#p-hacking-1"><i class="fa fa-check"></i><b>35.2.7</b> p-hacking</a></li>
<li class="chapter" data-level="35.2.8" data-path="major_concepts.html"><a href="major_concepts.html#the-dangers-of-machine-learning"><i class="fa fa-check"></i><b>35.2.8</b> The dangers of machine learning</a></li>
<li class="chapter" data-level="35.2.9" data-path="major_concepts.html"><a href="major_concepts.html#rationalizing"><i class="fa fa-check"></i><b>35.2.9</b> Rationalizing</a></li>
<li class="chapter" data-level="35.2.10" data-path="major_concepts.html"><a href="major_concepts.html#overfitting"><i class="fa fa-check"></i><b>35.2.10</b> Overfitting</a></li>
<li class="chapter" data-level="35.2.11" data-path="major_concepts.html"><a href="major_concepts.html#the-process-that-generated-the-data"><i class="fa fa-check"></i><b>35.2.11</b> The process that generated the data</a></li>
<li class="chapter" data-level="35.2.12" data-path="major_concepts.html"><a href="major_concepts.html#the-importance-of-theory"><i class="fa fa-check"></i><b>35.2.12</b> The importance of theory</a></li>
<li class="chapter" data-level="35.2.13" data-path="major_concepts.html"><a href="major_concepts.html#conceptual-modeling"><i class="fa fa-check"></i><b>35.2.13</b> Conceptual modeling</a></li>
<li class="chapter" data-level="35.2.14" data-path="major_concepts.html"><a href="major_concepts.html#consistency-with-existing-theory-and-prior-knowledge"><i class="fa fa-check"></i><b>35.2.14</b> Consistency with existing theory and prior knowledge</a></li>
<li class="chapter" data-level="35.2.15" data-path="major_concepts.html"><a href="major_concepts.html#model-validity-and-model-validation"><i class="fa fa-check"></i><b>35.2.15</b> Model validity and model validation</a></li>
<li class="chapter" data-level="35.2.16" data-path="major_concepts.html"><a href="major_concepts.html#our-role-in-research"><i class="fa fa-check"></i><b>35.2.16</b> Our role in research</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="major_concepts.html"><a href="major_concepts.html#ex_majorconcepts"><i class="fa fa-check"></i><code>Exercises</code> on major concepts</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="refs.html"><a href="refs.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tree phenology analysis with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="pls_chillforce" class="section level1 hasAnchor" number="23">
<h1><span class="header-section-number">Chapter 23</span> PLS regression with agroclimatic metrics<a href="pls_chillforce.html#pls_chillforce" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="goals_PLS_chillforce" class="section level2 unnumbered hasAnchor">
<h2>Learning goals for this lesson<a href="pls_chillforce.html#goals_PLS_chillforce" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Learn how we can make use of chill and heat models when looking for temperature response phases</li>
<li>Learn how to produce daily chill accumulation data and plots</li>
<li>Learn how to use the <code>PLS_chill_force</code> function to run a PLS analysis with chilling and forcing data</li>
<li>Be able to delineate chilling and forcing phases based on PLS outputs</li>
<li>Learn how to produce a complex PLS output figure using <code>ggplot2</code></li>
</ul>
</div>
<div id="adjusting-pls-for-use-with-non-monotonic-relationships" class="section level2 hasAnchor" number="23.1">
<h2><span class="header-section-number">23.1</span> Adjusting PLS for use with non-monotonic relationships<a href="pls_chillforce.html#adjusting-pls-for-use-with-non-monotonic-relationships" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As we saw at the end of the previous lesson, the most likely reason why PLS regression failed to pick up the chilling period in relatively cold locations is that there is no monotonic relationship between temperature and chill effectiveness, i.e. warmer temperatures may either lead to less chill (when it’s fairly warm) or more chill (when it’s cold). To overcome this problem, we need to convert temperature into something that is monotonically related to chill accumulation. Maybe we can make use of the chill models we already learned about.</p>
<p>If PLS holds its promise to identify chilling periods, it should be responsive to the daily rate of chill accumulation. This brings us back to an old problem - we don’t really know how to quantify chill accumulation accurately, and we don’t really trust the models we have. But let’s swallow these concerns for now and do such an analysis anyway. Note that if you’re ever tempted to do such a thing - swallow concerns that you know to be valid - don’t hide this from your audience. Clearly and explicitly state what you’ve done, as well as what problems may be associated with your strategy.</p>
<p>So we’ll make this very clear here:</p>
<p><strong><em>We’ll be converting temperature data to chill (and heat) accumulation to run PLS analyses. This strategy assumes that the respective chill and heat models are reasonable approximations of the underlying biology.</em></strong></p>
</div>
<div id="pls-analysis-with-chilling-and-forcing-data" class="section level2 hasAnchor" number="23.2">
<h2><span class="header-section-number">23.2</span> PLS analysis with chilling and forcing data<a href="pls_chillforce.html#pls-analysis-with-chilling-and-forcing-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>chillR</code> package has a function called <code>PLS_chill_force</code> that implements PLS analysis based on daily chill and heat accumulation rates. Let’s use this on our dataset of first bloom dates of ‘Alexander Lucas’ pears in Klein-Altendorf.</p>
<p>When you look at the documentation of the <code>PLS_chill_force</code> function (e.g. by typing <code>?PLS_chill_force</code>), you’ll see that this function requires a daily chill object (<code>daily_chill_obj</code>) as an input. This object contains daily chill and heat accumulation rates, as well as mean temperature data. Check out the documentation of <code>daily_chill</code> for more information on this.</p>
<p>So we’ll start by applying the <code>daily_chill</code> function to produce such a daily chill object. We’ll also use a standard function in <code>chillR</code> (<code>make_daily_chill_plot2</code>) to plot daily chill accumulation:</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="pls_chillforce.html#cb334-1" tabindex="-1"></a><span class="fu">library</span>(chillR)</span>
<span id="cb334-2"><a href="pls_chillforce.html#cb334-2" tabindex="-1"></a></span>
<span id="cb334-3"><a href="pls_chillforce.html#cb334-3" tabindex="-1"></a>temps_hourly <span class="ot">&lt;-</span> <span class="fu">read_tab</span>(<span class="st">&quot;data/TMaxTMin1958-2019_patched.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb334-4"><a href="pls_chillforce.html#cb334-4" tabindex="-1"></a>  <span class="fu">stack_hourly_temps</span>(<span class="at">latitude =</span> <span class="fl">50.6</span>)</span></code></pre></div>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="pls_chillforce.html#cb335-1" tabindex="-1"></a><span class="fu">head</span>(temps_hourly<span class="sc">$</span>hourtemps)</span></code></pre></div>
<table class="table table-striped" style="font-size: 8px; ">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
DATE
</th>
<th style="text-align:right;">
YEARMODA
</th>
<th style="text-align:right;">
Year
</th>
<th style="text-align:right;">
Month
</th>
<th style="text-align:right;">
Day
</th>
<th style="text-align:right;">
Tmin
</th>
<th style="text-align:right;">
Tmax
</th>
<th style="text-align:left;">
Tmin_source
</th>
<th style="text-align:left;">
Tmax_source
</th>
<th style="text-align:left;">
no_Tmin
</th>
<th style="text-align:left;">
no_Tmax
</th>
<th style="text-align:right;">
JDay
</th>
<th style="text-align:right;">
Hour
</th>
<th style="text-align:right;">
Temp
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
01-01-58
</td>
<td style="text-align:right;">
19580101
</td>
<td style="text-align:right;">
1958
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
7.5
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
22452
</td>
<td style="text-align:left;">
01-01-58
</td>
<td style="text-align:right;">
19580101
</td>
<td style="text-align:right;">
1958
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
7.5
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
44903
</td>
<td style="text-align:left;">
01-01-58
</td>
<td style="text-align:right;">
19580101
</td>
<td style="text-align:right;">
1958
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
7.5
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
67354
</td>
<td style="text-align:left;">
01-01-58
</td>
<td style="text-align:right;">
19580101
</td>
<td style="text-align:right;">
1958
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
7.5
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
89805
</td>
<td style="text-align:left;">
01-01-58
</td>
<td style="text-align:right;">
19580101
</td>
<td style="text-align:right;">
1958
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
7.5
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
112256
</td>
<td style="text-align:left;">
01-01-58
</td>
<td style="text-align:right;">
19580101
</td>
<td style="text-align:right;">
1958
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
7.5
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="pls_chillforce.html#cb336-1" tabindex="-1"></a>daychill <span class="ot">&lt;-</span> <span class="fu">daily_chill</span>(<span class="at">hourtemps =</span> temps_hourly,</span>
<span id="cb336-2"><a href="pls_chillforce.html#cb336-2" tabindex="-1"></a>                        <span class="at">running_mean =</span> <span class="dv">1</span>,</span>
<span id="cb336-3"><a href="pls_chillforce.html#cb336-3" tabindex="-1"></a>                        <span class="at">models =</span> <span class="fu">list</span>(</span>
<span id="cb336-4"><a href="pls_chillforce.html#cb336-4" tabindex="-1"></a>                          <span class="at">Chilling_Hours =</span> Chilling_Hours,</span>
<span id="cb336-5"><a href="pls_chillforce.html#cb336-5" tabindex="-1"></a>                          <span class="at">Utah_Chill_Units =</span> Utah_Model,</span>
<span id="cb336-6"><a href="pls_chillforce.html#cb336-6" tabindex="-1"></a>                          <span class="at">Chill_Portions =</span> Dynamic_Model,</span>
<span id="cb336-7"><a href="pls_chillforce.html#cb336-7" tabindex="-1"></a>                          <span class="at">GDH =</span> GDH)</span>
<span id="cb336-8"><a href="pls_chillforce.html#cb336-8" tabindex="-1"></a>                        )</span></code></pre></div>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="pls_chillforce.html#cb337-1" tabindex="-1"></a><span class="fu">head</span>(daychill<span class="sc">$</span>daily_chill)</span></code></pre></div>
<table class="table table-striped" style="font-size: 8px; ">
<thead>
<tr>
<th style="text-align:right;">
YYMMDD
</th>
<th style="text-align:right;">
Year
</th>
<th style="text-align:right;">
Month
</th>
<th style="text-align:right;">
Day
</th>
<th style="text-align:right;">
Chilling_Hours
</th>
<th style="text-align:right;">
Utah_Chill_Units
</th>
<th style="text-align:right;">
Chill_Portions
</th>
<th style="text-align:right;">
GDH
</th>
<th style="text-align:right;">
Tmean
</th>
<th style="text-align:left;">
no_Tmin
</th>
<th style="text-align:left;">
no_Tmax
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
19580101
</td>
<td style="text-align:right;">
1958
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
24.0
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
9.7845597
</td>
<td style="text-align:right;">
5.391120
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:right;">
19580102
</td>
<td style="text-align:right;">
1958
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
16.0
</td>
<td style="text-align:right;">
0.4444896
</td>
<td style="text-align:right;">
12.7332663
</td>
<td style="text-align:right;">
3.399713
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:right;">
19580103
</td>
<td style="text-align:right;">
1958
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0383026
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
-2.601803
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:right;">
19580104
</td>
<td style="text-align:right;">
1958
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
3.0
</td>
<td style="text-align:right;">
0.3292715
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
-1.676056
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:right;">
19580105
</td>
<td style="text-align:right;">
1958
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
24.0
</td>
<td style="text-align:right;">
1.3920031
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
3.020140
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:right;">
19580106
</td>
<td style="text-align:right;">
1958
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
21.5
</td>
<td style="text-align:right;">
1.1161587
</td>
<td style="text-align:right;">
0.4716365
</td>
<td style="text-align:right;">
3.284117
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="pls_chillforce.html#cb338-1" tabindex="-1"></a>dc <span class="ot">&lt;-</span> <span class="fu">make_daily_chill_plot2</span>(daychill,</span>
<span id="cb338-2"><a href="pls_chillforce.html#cb338-2" tabindex="-1"></a>                             <span class="at">metrics =</span> <span class="fu">c</span>(<span class="st">&quot;Chill_Portions&quot;</span>),</span>
<span id="cb338-3"><a href="pls_chillforce.html#cb338-3" tabindex="-1"></a>                             <span class="at">cumulative =</span> <span class="cn">FALSE</span>,</span>
<span id="cb338-4"><a href="pls_chillforce.html#cb338-4" tabindex="-1"></a>                             <span class="at">startdate =</span> <span class="dv">300</span>,</span>
<span id="cb338-5"><a href="pls_chillforce.html#cb338-5" tabindex="-1"></a>                             <span class="at">enddate =</span> <span class="dv">30</span>,</span>
<span id="cb338-6"><a href="pls_chillforce.html#cb338-6" tabindex="-1"></a>                             <span class="at">focusyears =</span> <span class="fu">c</span>(<span class="dv">2008</span>), </span>
<span id="cb338-7"><a href="pls_chillforce.html#cb338-7" tabindex="-1"></a>                             <span class="at">metriclabels =</span> <span class="st">&quot;Chill Portions&quot;</span>)</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-209-1.png" width="672" /></p>
<p>In this plot, we can highlight specific years (with the <code>focusyears</code> parameter). We can also switch to cumulative view to illustrate how chill accumulation in a particular year differs from historic accumulation patterns.</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="pls_chillforce.html#cb339-1" tabindex="-1"></a>dc <span class="ot">&lt;-</span> <span class="fu">make_daily_chill_plot2</span>(daychill,</span>
<span id="cb339-2"><a href="pls_chillforce.html#cb339-2" tabindex="-1"></a>                             <span class="at">metrics =</span> <span class="fu">c</span>(<span class="st">&quot;Chill_Portions&quot;</span>),</span>
<span id="cb339-3"><a href="pls_chillforce.html#cb339-3" tabindex="-1"></a>                             <span class="at">cumulative =</span> <span class="cn">TRUE</span>,</span>
<span id="cb339-4"><a href="pls_chillforce.html#cb339-4" tabindex="-1"></a>                             <span class="at">startdate =</span> <span class="dv">300</span>,</span>
<span id="cb339-5"><a href="pls_chillforce.html#cb339-5" tabindex="-1"></a>                             <span class="at">enddate =</span> <span class="dv">30</span>,</span>
<span id="cb339-6"><a href="pls_chillforce.html#cb339-6" tabindex="-1"></a>                             <span class="at">focusyears =</span> <span class="fu">c</span>(<span class="dv">2008</span>),</span>
<span id="cb339-7"><a href="pls_chillforce.html#cb339-7" tabindex="-1"></a>                             <span class="at">metriclabels =</span> <span class="st">&quot;Chill Portions&quot;</span>)</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-210-1.png" width="672" /></p>
<p>One special feature in this plot are the double ticks on the x-axis. These account for the additional day (29<sup>th</sup> February) that is added to the year in leap years. These leap days make Julian dates not map to precisely the same calendar dates in each year. The double ticks are an attempt to do justice to this ambiguity</p>
<p>We can now feed this daily chill object to the <code>PLS_chill_force</code> function. We’ll also need the pear bloom data again:</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="pls_chillforce.html#cb340-1" tabindex="-1"></a>Alex_first <span class="ot">&lt;-</span> <span class="fu">read_tab</span>(<span class="st">&quot;data/Alexander_Lucas_bloom_1958_2019.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb340-2"><a href="pls_chillforce.html#cb340-2" tabindex="-1"></a>  <span class="fu">select</span>(Pheno_year, First_bloom) <span class="sc">%&gt;%</span></span>
<span id="cb340-3"><a href="pls_chillforce.html#cb340-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(First_bloom, <span class="dv">1</span>, <span class="dv">4</span>)),</span>
<span id="cb340-4"><a href="pls_chillforce.html#cb340-4" tabindex="-1"></a>         <span class="at">Month =</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(First_bloom, <span class="dv">5</span>, <span class="dv">6</span>)),</span>
<span id="cb340-5"><a href="pls_chillforce.html#cb340-5" tabindex="-1"></a>         <span class="at">Day =</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(First_bloom, <span class="dv">7</span>, <span class="dv">8</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb340-6"><a href="pls_chillforce.html#cb340-6" tabindex="-1"></a>  <span class="fu">make_JDay</span>() <span class="sc">%&gt;%</span></span>
<span id="cb340-7"><a href="pls_chillforce.html#cb340-7" tabindex="-1"></a>  <span class="fu">select</span>(Pheno_year, </span>
<span id="cb340-8"><a href="pls_chillforce.html#cb340-8" tabindex="-1"></a>         JDay) <span class="sc">%&gt;%</span></span>
<span id="cb340-9"><a href="pls_chillforce.html#cb340-9" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Year =</span> Pheno_year,</span>
<span id="cb340-10"><a href="pls_chillforce.html#cb340-10" tabindex="-1"></a>         <span class="at">pheno =</span> JDay)</span>
<span id="cb340-11"><a href="pls_chillforce.html#cb340-11" tabindex="-1"></a></span>
<span id="cb340-12"><a href="pls_chillforce.html#cb340-12" tabindex="-1"></a></span>
<span id="cb340-13"><a href="pls_chillforce.html#cb340-13" tabindex="-1"></a></span>
<span id="cb340-14"><a href="pls_chillforce.html#cb340-14" tabindex="-1"></a>plscf <span class="ot">&lt;-</span> <span class="fu">PLS_chill_force</span>(<span class="at">daily_chill_obj =</span> daychill,</span>
<span id="cb340-15"><a href="pls_chillforce.html#cb340-15" tabindex="-1"></a>                         <span class="at">bio_data_frame =</span> Alex_first,</span>
<span id="cb340-16"><a href="pls_chillforce.html#cb340-16" tabindex="-1"></a>                         <span class="at">split_month =</span> <span class="dv">6</span>,</span>
<span id="cb340-17"><a href="pls_chillforce.html#cb340-17" tabindex="-1"></a>                         <span class="at">chill_models =</span> <span class="st">&quot;Chill_Portions&quot;</span>,</span>
<span id="cb340-18"><a href="pls_chillforce.html#cb340-18" tabindex="-1"></a>                         <span class="at">heat_models =</span> <span class="st">&quot;GDH&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="pls_chillforce.html#cb341-1" tabindex="-1"></a><span class="fu">head</span>(plscf<span class="sc">$</span>Chill_Portions<span class="sc">$</span>GDH<span class="sc">$</span>PLS_summary)</span></code></pre></div>
<table class="table table-striped" style="font-size: 10px; ">
<thead>
<tr>
<th style="text-align:right;">
Date
</th>
<th style="text-align:left;">
Type
</th>
<th style="text-align:right;">
JDay
</th>
<th style="text-align:right;">
Coef
</th>
<th style="text-align:right;">
VIP
</th>
<th style="text-align:right;">
MetricMean
</th>
<th style="text-align:right;">
MetricStdev
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
701
</td>
<td style="text-align:left;">
Chill
</td>
<td style="text-align:right;">
-183
</td>
<td style="text-align:right;">
0.0006500
</td>
<td style="text-align:right;">
0.3088661
</td>
<td style="text-align:right;">
0.0501720
</td>
<td style="text-align:right;">
0.2205416
</td>
</tr>
<tr>
<td style="text-align:right;">
702
</td>
<td style="text-align:left;">
Chill
</td>
<td style="text-align:right;">
-182
</td>
<td style="text-align:right;">
-0.0828120
</td>
<td style="text-align:right;">
0.5363662
</td>
<td style="text-align:right;">
0.0499267
</td>
<td style="text-align:right;">
0.2194706
</td>
</tr>
<tr>
<td style="text-align:right;">
703
</td>
<td style="text-align:left;">
Chill
</td>
<td style="text-align:right;">
-181
</td>
<td style="text-align:right;">
0.0169911
</td>
<td style="text-align:right;">
0.6376308
</td>
<td style="text-align:right;">
0.0501616
</td>
<td style="text-align:right;">
0.2204947
</td>
</tr>
<tr>
<td style="text-align:right;">
704
</td>
<td style="text-align:left;">
Chill
</td>
<td style="text-align:right;">
-180
</td>
<td style="text-align:right;">
-0.1470842
</td>
<td style="text-align:right;">
0.7171508
</td>
<td style="text-align:right;">
0.0671167
</td>
<td style="text-align:right;">
0.2532628
</td>
</tr>
<tr>
<td style="text-align:right;">
705
</td>
<td style="text-align:left;">
Chill
</td>
<td style="text-align:right;">
-179
</td>
<td style="text-align:right;">
0.2099085
</td>
<td style="text-align:right;">
1.7366297
</td>
<td style="text-align:right;">
0.0834634
</td>
<td style="text-align:right;">
0.2792043
</td>
</tr>
<tr>
<td style="text-align:right;">
706
</td>
<td style="text-align:left;">
Chill
</td>
<td style="text-align:right;">
-178
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
</tbody>
</table>
<p>We could have specified multiple chill and heat models, and the function would have evaluated all combinations of these models. This is why, to find the results, we have to look at <code>plscf$Chill_Portions$GDH$PLS_summary</code>. We can plot the results with the inbuilt function <code>plot_PLS</code>. Here’s how this is done:</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="pls_chillforce.html#cb342-1" tabindex="-1"></a><span class="fu">plot_PLS</span>(plscf,</span>
<span id="cb342-2"><a href="pls_chillforce.html#cb342-2" tabindex="-1"></a>         <span class="at">PLS_results_path =</span> <span class="st">&quot;data/plscf_outputs&quot;</span>)</span></code></pre></div>
<p>Once again, this is a fairly old function that writes an image in a place you can specify. We’ll redo this with <code>ggplot2</code> later.</p>
<div class="float">
<img src="data/plscf_outputs_Chill_Portions_GDH.png" alt="Plot of results from the PLS_chill_force procedure, as plotted with chillR’s standard plotting function" />
<div class="figcaption">Plot of results from the <code>PLS_chill_force</code> procedure, as plotted with <code>chillR</code>’s standard plotting function</div>
</div>
<p>We’ll reproduce this with <code>ggplot2</code> soon, but you may already notice that the results don’t look very clear quite yet. To a considerable extent, this is because we didn’t use a running mean to smooth the chill and heat data. Especially for the Dynamic Model, this is worth considering, because Chill Portions accumulate in a stepwise manner, rather than continuously. Such steps aren’t reached every day, which adds a random element to estimations of daily rates. Let’s apply an 11-day running mean and plot the results again:</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="pls_chillforce.html#cb343-1" tabindex="-1"></a>plscf <span class="ot">&lt;-</span> <span class="fu">PLS_chill_force</span>(<span class="at">daily_chill_obj =</span> daychill,</span>
<span id="cb343-2"><a href="pls_chillforce.html#cb343-2" tabindex="-1"></a>                         <span class="at">bio_data_frame=</span>Alex_first,</span>
<span id="cb343-3"><a href="pls_chillforce.html#cb343-3" tabindex="-1"></a>                         <span class="at">split_month =</span> <span class="dv">6</span>,</span>
<span id="cb343-4"><a href="pls_chillforce.html#cb343-4" tabindex="-1"></a>                         <span class="at">chill_models =</span> <span class="st">&quot;Chill_Portions&quot;</span>,</span>
<span id="cb343-5"><a href="pls_chillforce.html#cb343-5" tabindex="-1"></a>                         <span class="at">heat_models =</span> <span class="st">&quot;GDH&quot;</span>,</span>
<span id="cb343-6"><a href="pls_chillforce.html#cb343-6" tabindex="-1"></a>                         <span class="at">runn_means =</span> <span class="dv">11</span>)</span></code></pre></div>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="pls_chillforce.html#cb344-1" tabindex="-1"></a><span class="fu">plot_PLS</span>(plscf,</span>
<span id="cb344-2"><a href="pls_chillforce.html#cb344-2" tabindex="-1"></a>         <span class="at">PLS_results_path =</span> <span class="st">&quot;data/plscf_outputs_11days&quot;</span>)</span></code></pre></div>
<div class="float">
<img src="data/plscf_outputs_11days_Chill_Portions_GDH.png" alt="Plot of results from the PLS_chill_force procedure, with an 11-day running mean applied to chill and heat inputs, as plotted with chillR’s standard plotting function" />
<div class="figcaption">Plot of results from the <code>PLS_chill_force</code> procedure, with an 11-day running mean applied to chill and heat inputs, as plotted with <code>chillR</code>’s standard plotting function</div>
</div>
<p>This looks a lot clearer now. We see two plots here, with the one on the left showing the relationship between bloom dates and chill accumulation, and the one on the right showing the same for heat accumulation. Note that these are plotted in different panels, but they emerged from the same PLS analysis, which thus related bloom dates to a total of 730 independent variables - chill and heat accumulation dates for each calendar day (if you set <code>end_at_pheno_end = TRUE</code>, minus all days after the latest bloom date).</p>
<p>To find the chilling and forcing periods, we should now look for consistent periods of negative model coefficients on both sides of the figure. For the chilling period, we’ll look on the left, where the relationship of bloom dates with daily chill accumulation rates is shown, and for the forcing period, we’ll look right, where the same is shown for daily heat accumulation rates.</p>
<p>Again, the forcing period is easier to see than the chilling phase. It’s approximately between early January and the bloom date (between mid-March and early May). The chilling period is still a bit hard to see, but we can now detect a phase between some point in November or early December and February where high chill accumulation rates are correlated with early bloom.</p>
<p>In these delineations, I recommend to not focus too narrowly on ‘important’ values, but rather take a broad perspective in evaluating model coefficient dynamics. Always remember that PLS regression with small datasets may struggle to distinguish signals from noise, with random effects easily creeping in. We also need to remember that our chill and heat models aren’t perfect and that they don’t actually include much knowledge on dormancy physiology.</p>
<p>We’ll discuss some more reasons for poor chilling period delineations later.</p>
</div>
<div id="delineating-chilling-and-forcing-periods" class="section level2 hasAnchor" number="23.3">
<h2><span class="header-section-number">23.3</span> Delineating chilling and forcing periods<a href="pls_chillforce.html#delineating-chilling-and-forcing-periods" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The precise delineations of chilling and forcing periods are often a bit debatable, and there have often been slight disagreements about the precise dates to use. I would recommend taking both the plot and the detailed results table into account in deciding when periods start and end. More importantly, consider what you know about tree dormancy! Never lose sight of the ecological theory behind your analysis when you evaluate the results.</p>
<p>My call on the present dataset would be a chilling period between 13<sup>th</sup> November and 3<sup>rd</sup> March (Julian dates -48 to 62) and a forcing period between 3<sup>rd</sup> January and the date of bloom (Julian dates 3 to 105.5, which represents the median of all bloom dates). We can illustrate these periods in the plot:</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="pls_chillforce.html#cb345-1" tabindex="-1"></a><span class="fu">plot_PLS</span>(plscf,</span>
<span id="cb345-2"><a href="pls_chillforce.html#cb345-2" tabindex="-1"></a>         <span class="at">PLS_results_path =</span> <span class="st">&quot;data/plscf_outputs_11days_periods&quot;</span>,</span>
<span id="cb345-3"><a href="pls_chillforce.html#cb345-3" tabindex="-1"></a>         <span class="at">add_chill =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">48</span>,<span class="dv">62</span>),</span>
<span id="cb345-4"><a href="pls_chillforce.html#cb345-4" tabindex="-1"></a>         <span class="at">add_heat =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="fl">105.5</span>))</span></code></pre></div>
<div class="float">
<img src="data/plscf_outputs_11days_periods_Chill_Portions_GDH.png" alt="Plot of PLS_chill_force results, with our delineations of chilling (light blue) and forcing (light red) phases highlighted" />
<div class="figcaption">Plot of <code>PLS_chill_force</code> results, with our delineations of chilling (light blue) and forcing (light red) phases highlighted</div>
</div>
</div>
<div id="ggplotting-the-results" class="section level2 hasAnchor" number="23.4">
<h2><span class="header-section-number">23.4</span> <code>ggplot</code>ting the results<a href="pls_chillforce.html#ggplotting-the-results" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We’ve gone through most of what we need here already when we made the original PLS plots, but let’s do this again for the <code>PLS_chill_force</code> outputs. The only real change is that we need to split the results according to chill vs. heat analysis. We’ll use <code>facet_wrap</code> for this.</p>
<p>First we need to prepare the data for <code>ggplot</code>ting:</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="pls_chillforce.html#cb346-1" tabindex="-1"></a>PLS_gg <span class="ot">&lt;-</span> plscf<span class="sc">$</span>Chill_Portions<span class="sc">$</span>GDH<span class="sc">$</span>PLS_summary <span class="sc">%&gt;%</span></span>
<span id="cb346-2"><a href="pls_chillforce.html#cb346-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">trunc</span>(Date<span class="sc">/</span><span class="dv">100</span>),</span>
<span id="cb346-3"><a href="pls_chillforce.html#cb346-3" tabindex="-1"></a>         <span class="at">Day =</span> Date <span class="sc">-</span> Month <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb346-4"><a href="pls_chillforce.html#cb346-4" tabindex="-1"></a>         <span class="at">Date =</span> <span class="fu">ISOdate</span>(<span class="dv">2002</span>,</span>
<span id="cb346-5"><a href="pls_chillforce.html#cb346-5" tabindex="-1"></a>                        Month,</span>
<span id="cb346-6"><a href="pls_chillforce.html#cb346-6" tabindex="-1"></a>                        Day))</span>
<span id="cb346-7"><a href="pls_chillforce.html#cb346-7" tabindex="-1"></a></span>
<span id="cb346-8"><a href="pls_chillforce.html#cb346-8" tabindex="-1"></a>PLS_gg[PLS_gg<span class="sc">$</span>JDay <span class="sc">&lt;=</span> <span class="dv">0</span>,<span class="st">&quot;Date&quot;</span>]<span class="ot">&lt;-</span></span>
<span id="cb346-9"><a href="pls_chillforce.html#cb346-9" tabindex="-1"></a>  <span class="fu">ISOdate</span>(<span class="dv">2001</span>,</span>
<span id="cb346-10"><a href="pls_chillforce.html#cb346-10" tabindex="-1"></a>          PLS_gg<span class="sc">$</span>Month[PLS_gg<span class="sc">$</span>JDay <span class="sc">&lt;=</span> <span class="dv">0</span>],</span>
<span id="cb346-11"><a href="pls_chillforce.html#cb346-11" tabindex="-1"></a>          PLS_gg<span class="sc">$</span>Day[PLS_gg<span class="sc">$</span>JDay <span class="sc">&lt;=</span> <span class="dv">0</span>])</span>
<span id="cb346-12"><a href="pls_chillforce.html#cb346-12" tabindex="-1"></a></span>
<span id="cb346-13"><a href="pls_chillforce.html#cb346-13" tabindex="-1"></a>PLS_gg <span class="ot">&lt;-</span> PLS_gg <span class="sc">%&gt;%</span></span>
<span id="cb346-14"><a href="pls_chillforce.html#cb346-14" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">VIP_importance =</span> VIP <span class="sc">&gt;=</span> <span class="fl">0.8</span>,</span>
<span id="cb346-15"><a href="pls_chillforce.html#cb346-15" tabindex="-1"></a>         <span class="at">VIP_Coeff =</span> <span class="fu">factor</span>(<span class="fu">sign</span>(Coef) <span class="sc">*</span> VIP_importance))</span>
<span id="cb346-16"><a href="pls_chillforce.html#cb346-16" tabindex="-1"></a></span>
<span id="cb346-17"><a href="pls_chillforce.html#cb346-17" tabindex="-1"></a>chill_start_JDay <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">48</span></span>
<span id="cb346-18"><a href="pls_chillforce.html#cb346-18" tabindex="-1"></a>chill_end_JDay <span class="ot">&lt;-</span> <span class="dv">62</span></span>
<span id="cb346-19"><a href="pls_chillforce.html#cb346-19" tabindex="-1"></a>heat_start_JDay <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb346-20"><a href="pls_chillforce.html#cb346-20" tabindex="-1"></a>heat_end_JDay <span class="ot">&lt;-</span> <span class="fl">105.5</span></span>
<span id="cb346-21"><a href="pls_chillforce.html#cb346-21" tabindex="-1"></a></span>
<span id="cb346-22"><a href="pls_chillforce.html#cb346-22" tabindex="-1"></a>chill_start_date <span class="ot">&lt;-</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,</span>
<span id="cb346-23"><a href="pls_chillforce.html#cb346-23" tabindex="-1"></a>                            <span class="dv">12</span>,</span>
<span id="cb346-24"><a href="pls_chillforce.html#cb346-24" tabindex="-1"></a>                            <span class="dv">31</span>) <span class="sc">+</span> chill_start_JDay <span class="sc">*</span> <span class="dv">24</span> <span class="sc">*</span> <span class="dv">3600</span></span>
<span id="cb346-25"><a href="pls_chillforce.html#cb346-25" tabindex="-1"></a>chill_end_date <span class="ot">&lt;-</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,</span>
<span id="cb346-26"><a href="pls_chillforce.html#cb346-26" tabindex="-1"></a>                          <span class="dv">12</span>,</span>
<span id="cb346-27"><a href="pls_chillforce.html#cb346-27" tabindex="-1"></a>                          <span class="dv">31</span>) <span class="sc">+</span> chill_end_JDay <span class="sc">*</span> <span class="dv">24</span> <span class="sc">*</span> <span class="dv">3600</span></span>
<span id="cb346-28"><a href="pls_chillforce.html#cb346-28" tabindex="-1"></a>heat_start_date <span class="ot">&lt;-</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,</span>
<span id="cb346-29"><a href="pls_chillforce.html#cb346-29" tabindex="-1"></a>                           <span class="dv">12</span>,</span>
<span id="cb346-30"><a href="pls_chillforce.html#cb346-30" tabindex="-1"></a>                           <span class="dv">31</span>) <span class="sc">+</span> heat_start_JDay <span class="sc">*</span> <span class="dv">24</span> <span class="sc">*</span> <span class="dv">3600</span></span>
<span id="cb346-31"><a href="pls_chillforce.html#cb346-31" tabindex="-1"></a>heat_end_date <span class="ot">&lt;-</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,</span>
<span id="cb346-32"><a href="pls_chillforce.html#cb346-32" tabindex="-1"></a>                         <span class="dv">12</span>,</span>
<span id="cb346-33"><a href="pls_chillforce.html#cb346-33" tabindex="-1"></a>                         <span class="dv">31</span>) <span class="sc">+</span> heat_end_JDay <span class="sc">*</span> <span class="dv">24</span> <span class="sc">*</span> <span class="dv">3600</span></span></code></pre></div>
<p>This time we’ll start with the bottom plot, because that’s the most complicated one. It’s complicated, because we need to put different labels on the y-axes of the two facets. Since the daily chill accumulation rate is between 0 and ~1 Chill Portions, and the daily heat accumulation rate can reach 300 GDH and more, we also need different scales for the axes. We’ll start with the hardest plot, because the way we solve these problems may have implications for how we have to construct the other plots.</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="pls_chillforce.html#cb347-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb347-2"><a href="pls_chillforce.html#cb347-2" tabindex="-1"></a></span>
<span id="cb347-3"><a href="pls_chillforce.html#cb347-3" tabindex="-1"></a>temp_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(PLS_gg,</span>
<span id="cb347-4"><a href="pls_chillforce.html#cb347-4" tabindex="-1"></a>                    <span class="at">x =</span> Date) <span class="sc">+</span></span>
<span id="cb347-5"><a href="pls_chillforce.html#cb347-5" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb347-6"><a href="pls_chillforce.html#cb347-6" tabindex="-1"></a>           <span class="at">xmin =</span> chill_start_date,</span>
<span id="cb347-7"><a href="pls_chillforce.html#cb347-7" tabindex="-1"></a>           <span class="at">xmax =</span> chill_end_date,</span>
<span id="cb347-8"><a href="pls_chillforce.html#cb347-8" tabindex="-1"></a>           <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb347-9"><a href="pls_chillforce.html#cb347-9" tabindex="-1"></a>           <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb347-10"><a href="pls_chillforce.html#cb347-10" tabindex="-1"></a>           <span class="at">alpha =</span> .<span class="dv">1</span>,</span>
<span id="cb347-11"><a href="pls_chillforce.html#cb347-11" tabindex="-1"></a>           <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb347-12"><a href="pls_chillforce.html#cb347-12" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb347-13"><a href="pls_chillforce.html#cb347-13" tabindex="-1"></a>           <span class="at">xmin =</span> heat_start_date,</span>
<span id="cb347-14"><a href="pls_chillforce.html#cb347-14" tabindex="-1"></a>           <span class="at">xmax =</span> heat_end_date,</span>
<span id="cb347-15"><a href="pls_chillforce.html#cb347-15" tabindex="-1"></a>           <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb347-16"><a href="pls_chillforce.html#cb347-16" tabindex="-1"></a>           <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb347-17"><a href="pls_chillforce.html#cb347-17" tabindex="-1"></a>           <span class="at">alpha =</span> .<span class="dv">1</span>,</span>
<span id="cb347-18"><a href="pls_chillforce.html#cb347-18" tabindex="-1"></a>           <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb347-19"><a href="pls_chillforce.html#cb347-19" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb347-20"><a href="pls_chillforce.html#cb347-20" tabindex="-1"></a>           <span class="at">xmin =</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,</span>
<span id="cb347-21"><a href="pls_chillforce.html#cb347-21" tabindex="-1"></a>                          <span class="dv">12</span>,</span>
<span id="cb347-22"><a href="pls_chillforce.html#cb347-22" tabindex="-1"></a>                          <span class="dv">31</span>) <span class="sc">+</span></span>
<span id="cb347-23"><a href="pls_chillforce.html#cb347-23" tabindex="-1"></a>             <span class="fu">min</span>(plscf<span class="sc">$</span>pheno<span class="sc">$</span>pheno,</span>
<span id="cb347-24"><a href="pls_chillforce.html#cb347-24" tabindex="-1"></a>                 <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">24</span> <span class="sc">*</span> <span class="dv">3600</span>,</span>
<span id="cb347-25"><a href="pls_chillforce.html#cb347-25" tabindex="-1"></a>           <span class="at">xmax =</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,</span>
<span id="cb347-26"><a href="pls_chillforce.html#cb347-26" tabindex="-1"></a>                          <span class="dv">12</span>,</span>
<span id="cb347-27"><a href="pls_chillforce.html#cb347-27" tabindex="-1"></a>                          <span class="dv">31</span>) <span class="sc">+</span></span>
<span id="cb347-28"><a href="pls_chillforce.html#cb347-28" tabindex="-1"></a>             <span class="fu">max</span>(plscf<span class="sc">$</span>pheno<span class="sc">$</span>pheno,</span>
<span id="cb347-29"><a href="pls_chillforce.html#cb347-29" tabindex="-1"></a>                 <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">24</span> <span class="sc">*</span> <span class="dv">3600</span>,</span>
<span id="cb347-30"><a href="pls_chillforce.html#cb347-30" tabindex="-1"></a>           <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb347-31"><a href="pls_chillforce.html#cb347-31" tabindex="-1"></a>           <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb347-32"><a href="pls_chillforce.html#cb347-32" tabindex="-1"></a>           <span class="at">alpha =</span> .<span class="dv">1</span>,</span>
<span id="cb347-33"><a href="pls_chillforce.html#cb347-33" tabindex="-1"></a>           <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb347-34"><a href="pls_chillforce.html#cb347-34" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,</span>
<span id="cb347-35"><a href="pls_chillforce.html#cb347-35" tabindex="-1"></a>                                  <span class="dv">12</span>,</span>
<span id="cb347-36"><a href="pls_chillforce.html#cb347-36" tabindex="-1"></a>                                  <span class="dv">31</span>) <span class="sc">+</span></span>
<span id="cb347-37"><a href="pls_chillforce.html#cb347-37" tabindex="-1"></a>               <span class="fu">median</span>(plscf<span class="sc">$</span>pheno<span class="sc">$</span>pheno,</span>
<span id="cb347-38"><a href="pls_chillforce.html#cb347-38" tabindex="-1"></a>                      <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">24</span> <span class="sc">*</span> <span class="dv">3600</span>,</span>
<span id="cb347-39"><a href="pls_chillforce.html#cb347-39" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb347-40"><a href="pls_chillforce.html#cb347-40" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> Date,</span>
<span id="cb347-41"><a href="pls_chillforce.html#cb347-41" tabindex="-1"></a>                  <span class="at">ymin =</span> MetricMean <span class="sc">-</span> MetricStdev ,</span>
<span id="cb347-42"><a href="pls_chillforce.html#cb347-42" tabindex="-1"></a>                  <span class="at">ymax =</span> MetricMean <span class="sc">+</span> MetricStdev),</span>
<span id="cb347-43"><a href="pls_chillforce.html#cb347-43" tabindex="-1"></a>              <span class="at">fill=</span><span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb347-44"><a href="pls_chillforce.html#cb347-44" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> Date,</span>
<span id="cb347-45"><a href="pls_chillforce.html#cb347-45" tabindex="-1"></a>                  <span class="at">ymin =</span> MetricMean <span class="sc">-</span> MetricStdev <span class="sc">*</span> (VIP_Coeff <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb347-46"><a href="pls_chillforce.html#cb347-46" tabindex="-1"></a>                  <span class="at">ymax =</span> MetricMean <span class="sc">+</span> MetricStdev <span class="sc">*</span> (VIP_Coeff <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>)),</span>
<span id="cb347-47"><a href="pls_chillforce.html#cb347-47" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb347-48"><a href="pls_chillforce.html#cb347-48" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> Date,</span>
<span id="cb347-49"><a href="pls_chillforce.html#cb347-49" tabindex="-1"></a>                  <span class="at">ymin =</span> MetricMean <span class="sc">-</span> MetricStdev <span class="sc">*</span> (VIP_Coeff <span class="sc">==</span> <span class="dv">1</span>),</span>
<span id="cb347-50"><a href="pls_chillforce.html#cb347-50" tabindex="-1"></a>                  <span class="at">ymax =</span> MetricMean <span class="sc">+</span> MetricStdev <span class="sc">*</span> (VIP_Coeff <span class="sc">==</span> <span class="dv">1</span>)),</span>
<span id="cb347-51"><a href="pls_chillforce.html#cb347-51" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">&quot;dark green&quot;</span>) <span class="sc">+</span></span>
<span id="cb347-52"><a href="pls_chillforce.html#cb347-52" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> Date,</span>
<span id="cb347-53"><a href="pls_chillforce.html#cb347-53" tabindex="-1"></a>                <span class="at">y =</span> MetricMean ))</span>
<span id="cb347-54"><a href="pls_chillforce.html#cb347-54" tabindex="-1"></a></span>
<span id="cb347-55"><a href="pls_chillforce.html#cb347-55" tabindex="-1"></a>temp_plot</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-219-1.png" width="672" /></p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="pls_chillforce.html#cb348-1" tabindex="-1"></a>temp_plot <span class="ot">&lt;-</span> temp_plot <span class="sc">+</span></span>
<span id="cb348-2"><a href="pls_chillforce.html#cb348-2" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(Type),</span>
<span id="cb348-3"><a href="pls_chillforce.html#cb348-3" tabindex="-1"></a>             <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>,</span>
<span id="cb348-4"><a href="pls_chillforce.html#cb348-4" tabindex="-1"></a>             <span class="at">strip.position =</span> <span class="st">&quot;left&quot;</span>,</span>
<span id="cb348-5"><a href="pls_chillforce.html#cb348-5" tabindex="-1"></a>             <span class="at">labeller =</span></span>
<span id="cb348-6"><a href="pls_chillforce.html#cb348-6" tabindex="-1"></a>               <span class="fu">labeller</span>(<span class="at">Type =</span> <span class="fu">as_labeller</span>(</span>
<span id="cb348-7"><a href="pls_chillforce.html#cb348-7" tabindex="-1"></a>               <span class="fu">c</span>(<span class="at">Chill =</span> <span class="st">&quot;Chill (CP)&quot;</span>,</span>
<span id="cb348-8"><a href="pls_chillforce.html#cb348-8" tabindex="-1"></a>                 <span class="at">Heat =</span> <span class="st">&quot;Heat (GDH)&quot;</span>)))) <span class="sc">+</span></span>
<span id="cb348-9"><a href="pls_chillforce.html#cb348-9" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Daily chill and heat accumulation rates&quot;</span>) <span class="sc">+</span></span>
<span id="cb348-10"><a href="pls_chillforce.html#cb348-10" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span> </span>
<span id="cb348-11"><a href="pls_chillforce.html#cb348-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb348-12"><a href="pls_chillforce.html#cb348-12" tabindex="-1"></a>        <span class="at">strip.placement =</span> <span class="st">&quot;outside&quot;</span>,</span>
<span id="cb348-13"><a href="pls_chillforce.html#cb348-13" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span><span class="dv">12</span>),</span>
<span id="cb348-14"><a href="pls_chillforce.html#cb348-14" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb348-15"><a href="pls_chillforce.html#cb348-15" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb348-16"><a href="pls_chillforce.html#cb348-16" tabindex="-1"></a>        )</span>
<span id="cb348-17"><a href="pls_chillforce.html#cb348-17" tabindex="-1"></a></span>
<span id="cb348-18"><a href="pls_chillforce.html#cb348-18" tabindex="-1"></a>temp_plot</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-219-2.png" width="672" /></p>
<p>I looked around a bit for an honest way to customize the y-axis labels for each facet, but didn’t find a viable solution. So I used the facet labels instead and moved them to the left side, using them as y-axis labels. The <code>labeller</code> element in <code>facet_wrap</code> can easily be customized with text of your choice. I also added a title to the plot.</p>
<p>We can now use the same strategy to make the VIP and model coefficient plots (this is important, because the plots should have similar structures when we combine them later).</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="pls_chillforce.html#cb349-1" tabindex="-1"></a>VIP_plot<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(PLS_gg,</span>
<span id="cb349-2"><a href="pls_chillforce.html#cb349-2" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">x =</span> Date,</span>
<span id="cb349-3"><a href="pls_chillforce.html#cb349-3" tabindex="-1"></a>                      <span class="at">y =</span> VIP)) <span class="sc">+</span></span>
<span id="cb349-4"><a href="pls_chillforce.html#cb349-4" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb349-5"><a href="pls_chillforce.html#cb349-5" tabindex="-1"></a>           <span class="at">xmin =</span> chill_start_date,</span>
<span id="cb349-6"><a href="pls_chillforce.html#cb349-6" tabindex="-1"></a>           <span class="at">xmax =</span> chill_end_date,</span>
<span id="cb349-7"><a href="pls_chillforce.html#cb349-7" tabindex="-1"></a>           <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb349-8"><a href="pls_chillforce.html#cb349-8" tabindex="-1"></a>           <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb349-9"><a href="pls_chillforce.html#cb349-9" tabindex="-1"></a>           <span class="at">alpha =</span> .<span class="dv">1</span>,</span>
<span id="cb349-10"><a href="pls_chillforce.html#cb349-10" tabindex="-1"></a>           <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb349-11"><a href="pls_chillforce.html#cb349-11" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb349-12"><a href="pls_chillforce.html#cb349-12" tabindex="-1"></a>           <span class="at">xmin =</span> heat_start_date,</span>
<span id="cb349-13"><a href="pls_chillforce.html#cb349-13" tabindex="-1"></a>           <span class="at">xmax =</span> heat_end_date,</span>
<span id="cb349-14"><a href="pls_chillforce.html#cb349-14" tabindex="-1"></a>           <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb349-15"><a href="pls_chillforce.html#cb349-15" tabindex="-1"></a>           <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb349-16"><a href="pls_chillforce.html#cb349-16" tabindex="-1"></a>           <span class="at">alpha =</span> .<span class="dv">1</span>,</span>
<span id="cb349-17"><a href="pls_chillforce.html#cb349-17" tabindex="-1"></a>           <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb349-18"><a href="pls_chillforce.html#cb349-18" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb349-19"><a href="pls_chillforce.html#cb349-19" tabindex="-1"></a>           <span class="at">xmin =</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,</span>
<span id="cb349-20"><a href="pls_chillforce.html#cb349-20" tabindex="-1"></a>                          <span class="dv">12</span>,</span>
<span id="cb349-21"><a href="pls_chillforce.html#cb349-21" tabindex="-1"></a>                          <span class="dv">31</span>) <span class="sc">+</span></span>
<span id="cb349-22"><a href="pls_chillforce.html#cb349-22" tabindex="-1"></a>             <span class="fu">min</span>(plscf<span class="sc">$</span>pheno<span class="sc">$</span>pheno,</span>
<span id="cb349-23"><a href="pls_chillforce.html#cb349-23" tabindex="-1"></a>                 <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">24</span> <span class="sc">*</span> <span class="dv">3600</span>,</span>
<span id="cb349-24"><a href="pls_chillforce.html#cb349-24" tabindex="-1"></a>           <span class="at">xmax =</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,</span>
<span id="cb349-25"><a href="pls_chillforce.html#cb349-25" tabindex="-1"></a>                          <span class="dv">12</span>,</span>
<span id="cb349-26"><a href="pls_chillforce.html#cb349-26" tabindex="-1"></a>                          <span class="dv">31</span>) <span class="sc">+</span></span>
<span id="cb349-27"><a href="pls_chillforce.html#cb349-27" tabindex="-1"></a>             <span class="fu">max</span>(plscf<span class="sc">$</span>pheno<span class="sc">$</span>pheno,</span>
<span id="cb349-28"><a href="pls_chillforce.html#cb349-28" tabindex="-1"></a>                 <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">24</span> <span class="sc">*</span> <span class="dv">3600</span>,</span>
<span id="cb349-29"><a href="pls_chillforce.html#cb349-29" tabindex="-1"></a>           <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb349-30"><a href="pls_chillforce.html#cb349-30" tabindex="-1"></a>           <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb349-31"><a href="pls_chillforce.html#cb349-31" tabindex="-1"></a>           <span class="at">alpha =</span> .<span class="dv">1</span>,</span>
<span id="cb349-32"><a href="pls_chillforce.html#cb349-32" tabindex="-1"></a>           <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb349-33"><a href="pls_chillforce.html#cb349-33" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,</span>
<span id="cb349-34"><a href="pls_chillforce.html#cb349-34" tabindex="-1"></a>                                  <span class="dv">12</span>,</span>
<span id="cb349-35"><a href="pls_chillforce.html#cb349-35" tabindex="-1"></a>                                  <span class="dv">31</span>) <span class="sc">+</span></span>
<span id="cb349-36"><a href="pls_chillforce.html#cb349-36" tabindex="-1"></a>               <span class="fu">median</span>(plscf<span class="sc">$</span>pheno<span class="sc">$</span>pheno,</span>
<span id="cb349-37"><a href="pls_chillforce.html#cb349-37" tabindex="-1"></a>                      <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">24</span> <span class="sc">*</span> <span class="dv">3600</span>,</span>
<span id="cb349-38"><a href="pls_chillforce.html#cb349-38" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb349-39"><a href="pls_chillforce.html#cb349-39" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>,</span>
<span id="cb349-40"><a href="pls_chillforce.html#cb349-40" tabindex="-1"></a>           <span class="fu">aes</span>(<span class="at">fill =</span> VIP <span class="sc">&gt;</span> <span class="fl">0.8</span>))</span>
<span id="cb349-41"><a href="pls_chillforce.html#cb349-41" tabindex="-1"></a></span>
<span id="cb349-42"><a href="pls_chillforce.html#cb349-42" tabindex="-1"></a>VIP_plot</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-220-1.png" width="672" /></p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="pls_chillforce.html#cb350-1" tabindex="-1"></a>VIP_plot <span class="ot">&lt;-</span> VIP_plot <span class="sc">+</span> </span>
<span id="cb350-2"><a href="pls_chillforce.html#cb350-2" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(Type),</span>
<span id="cb350-3"><a href="pls_chillforce.html#cb350-3" tabindex="-1"></a>             <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>,</span>
<span id="cb350-4"><a href="pls_chillforce.html#cb350-4" tabindex="-1"></a>             <span class="at">strip.position =</span> <span class="st">&quot;left&quot;</span>,</span>
<span id="cb350-5"><a href="pls_chillforce.html#cb350-5" tabindex="-1"></a>             <span class="at">labeller =</span> </span>
<span id="cb350-6"><a href="pls_chillforce.html#cb350-6" tabindex="-1"></a>               <span class="fu">labeller</span>(<span class="at">Type =</span> <span class="fu">as_labeller</span>(</span>
<span id="cb350-7"><a href="pls_chillforce.html#cb350-7" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="at">Chill =</span> <span class="st">&quot;VIP for chill&quot;</span>,</span>
<span id="cb350-8"><a href="pls_chillforce.html#cb350-8" tabindex="-1"></a>                   <span class="at">Heat =</span> <span class="st">&quot;VIP for heat&quot;</span>)))) <span class="sc">+</span></span>
<span id="cb350-9"><a href="pls_chillforce.html#cb350-9" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb350-10"><a href="pls_chillforce.html#cb350-10" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,</span>
<span id="cb350-11"><a href="pls_chillforce.html#cb350-11" tabindex="-1"></a>               <span class="fu">max</span>(plscf<span class="sc">$</span>Chill_Portions<span class="sc">$</span>GDH<span class="sc">$</span>PLS_summary<span class="sc">$</span>VIP))) <span class="sc">+</span></span>
<span id="cb350-12"><a href="pls_chillforce.html#cb350-12" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Variable Importance in the Projection (VIP) scores&quot;</span>) <span class="sc">+</span></span>
<span id="cb350-13"><a href="pls_chillforce.html#cb350-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span> </span>
<span id="cb350-14"><a href="pls_chillforce.html#cb350-14" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb350-15"><a href="pls_chillforce.html#cb350-15" tabindex="-1"></a>        <span class="at">strip.placement =</span> <span class="st">&quot;outside&quot;</span>,</span>
<span id="cb350-16"><a href="pls_chillforce.html#cb350-16" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb350-17"><a href="pls_chillforce.html#cb350-17" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb350-18"><a href="pls_chillforce.html#cb350-18" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb350-19"><a href="pls_chillforce.html#cb350-19" tabindex="-1"></a>        )</span>
<span id="cb350-20"><a href="pls_chillforce.html#cb350-20" tabindex="-1"></a>  </span>
<span id="cb350-21"><a href="pls_chillforce.html#cb350-21" tabindex="-1"></a>VIP_plot</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-220-2.png" width="672" /></p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="pls_chillforce.html#cb351-1" tabindex="-1"></a>VIP_plot <span class="ot">&lt;-</span> VIP_plot <span class="sc">+</span></span>
<span id="cb351-2"><a href="pls_chillforce.html#cb351-2" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">&quot;VIP&quot;</span>, </span>
<span id="cb351-3"><a href="pls_chillforce.html#cb351-3" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;&lt;0.8&quot;</span>, <span class="st">&quot;&gt;0.8&quot;</span>), </span>
<span id="cb351-4"><a href="pls_chillforce.html#cb351-4" tabindex="-1"></a>                    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;FALSE&quot;</span> <span class="ot">=</span> <span class="st">&quot;grey&quot;</span>,</span>
<span id="cb351-5"><a href="pls_chillforce.html#cb351-5" tabindex="-1"></a>                               <span class="st">&quot;TRUE&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>)) <span class="sc">+</span></span>
<span id="cb351-6"><a href="pls_chillforce.html#cb351-6" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb351-7"><a href="pls_chillforce.html#cb351-7" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb351-8"><a href="pls_chillforce.html#cb351-8" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb351-9"><a href="pls_chillforce.html#cb351-9" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>())</span>
<span id="cb351-10"><a href="pls_chillforce.html#cb351-10" tabindex="-1"></a></span>
<span id="cb351-11"><a href="pls_chillforce.html#cb351-11" tabindex="-1"></a>VIP_plot</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-220-3.png" width="672" /></p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="pls_chillforce.html#cb352-1" tabindex="-1"></a>coeff_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(PLS_gg,</span>
<span id="cb352-2"><a href="pls_chillforce.html#cb352-2" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> Date,</span>
<span id="cb352-3"><a href="pls_chillforce.html#cb352-3" tabindex="-1"></a>                         <span class="at">y =</span> Coef)) <span class="sc">+</span></span>
<span id="cb352-4"><a href="pls_chillforce.html#cb352-4" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb352-5"><a href="pls_chillforce.html#cb352-5" tabindex="-1"></a>           <span class="at">xmin =</span> chill_start_date,</span>
<span id="cb352-6"><a href="pls_chillforce.html#cb352-6" tabindex="-1"></a>           <span class="at">xmax =</span> chill_end_date,</span>
<span id="cb352-7"><a href="pls_chillforce.html#cb352-7" tabindex="-1"></a>           <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb352-8"><a href="pls_chillforce.html#cb352-8" tabindex="-1"></a>           <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb352-9"><a href="pls_chillforce.html#cb352-9" tabindex="-1"></a>           <span class="at">alpha =</span> .<span class="dv">1</span>,</span>
<span id="cb352-10"><a href="pls_chillforce.html#cb352-10" tabindex="-1"></a>           <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb352-11"><a href="pls_chillforce.html#cb352-11" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb352-12"><a href="pls_chillforce.html#cb352-12" tabindex="-1"></a>           <span class="at">xmin =</span> heat_start_date,</span>
<span id="cb352-13"><a href="pls_chillforce.html#cb352-13" tabindex="-1"></a>           <span class="at">xmax =</span> heat_end_date,</span>
<span id="cb352-14"><a href="pls_chillforce.html#cb352-14" tabindex="-1"></a>           <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb352-15"><a href="pls_chillforce.html#cb352-15" tabindex="-1"></a>           <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb352-16"><a href="pls_chillforce.html#cb352-16" tabindex="-1"></a>           <span class="at">alpha =</span> .<span class="dv">1</span>,</span>
<span id="cb352-17"><a href="pls_chillforce.html#cb352-17" tabindex="-1"></a>           <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb352-18"><a href="pls_chillforce.html#cb352-18" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb352-19"><a href="pls_chillforce.html#cb352-19" tabindex="-1"></a>           <span class="at">xmin =</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,</span>
<span id="cb352-20"><a href="pls_chillforce.html#cb352-20" tabindex="-1"></a>                          <span class="dv">12</span>,</span>
<span id="cb352-21"><a href="pls_chillforce.html#cb352-21" tabindex="-1"></a>                          <span class="dv">31</span>) <span class="sc">+</span></span>
<span id="cb352-22"><a href="pls_chillforce.html#cb352-22" tabindex="-1"></a>             <span class="fu">min</span>(plscf<span class="sc">$</span>pheno<span class="sc">$</span>pheno,</span>
<span id="cb352-23"><a href="pls_chillforce.html#cb352-23" tabindex="-1"></a>                 <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">24</span> <span class="sc">*</span> <span class="dv">3600</span>,</span>
<span id="cb352-24"><a href="pls_chillforce.html#cb352-24" tabindex="-1"></a>           <span class="at">xmax =</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,</span>
<span id="cb352-25"><a href="pls_chillforce.html#cb352-25" tabindex="-1"></a>                          <span class="dv">12</span>,</span>
<span id="cb352-26"><a href="pls_chillforce.html#cb352-26" tabindex="-1"></a>                          <span class="dv">31</span>) <span class="sc">+</span></span>
<span id="cb352-27"><a href="pls_chillforce.html#cb352-27" tabindex="-1"></a>             <span class="fu">max</span>(plscf<span class="sc">$</span>pheno<span class="sc">$</span>pheno,</span>
<span id="cb352-28"><a href="pls_chillforce.html#cb352-28" tabindex="-1"></a>                 <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">24</span> <span class="sc">*</span> <span class="dv">3600</span>,</span>
<span id="cb352-29"><a href="pls_chillforce.html#cb352-29" tabindex="-1"></a>           <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb352-30"><a href="pls_chillforce.html#cb352-30" tabindex="-1"></a>           <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb352-31"><a href="pls_chillforce.html#cb352-31" tabindex="-1"></a>           <span class="at">alpha =</span> .<span class="dv">1</span>,</span>
<span id="cb352-32"><a href="pls_chillforce.html#cb352-32" tabindex="-1"></a>           <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb352-33"><a href="pls_chillforce.html#cb352-33" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,</span>
<span id="cb352-34"><a href="pls_chillforce.html#cb352-34" tabindex="-1"></a>                                  <span class="dv">12</span>,</span>
<span id="cb352-35"><a href="pls_chillforce.html#cb352-35" tabindex="-1"></a>                                  <span class="dv">31</span>) <span class="sc">+</span></span>
<span id="cb352-36"><a href="pls_chillforce.html#cb352-36" tabindex="-1"></a>               <span class="fu">median</span>(plscf<span class="sc">$</span>pheno<span class="sc">$</span>pheno,</span>
<span id="cb352-37"><a href="pls_chillforce.html#cb352-37" tabindex="-1"></a>                      <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">24</span> <span class="sc">*</span> <span class="dv">3600</span>,</span>
<span id="cb352-38"><a href="pls_chillforce.html#cb352-38" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb352-39"><a href="pls_chillforce.html#cb352-39" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>,</span>
<span id="cb352-40"><a href="pls_chillforce.html#cb352-40" tabindex="-1"></a>           <span class="fu">aes</span>(<span class="at">fill =</span> VIP_Coeff))</span>
<span id="cb352-41"><a href="pls_chillforce.html#cb352-41" tabindex="-1"></a></span>
<span id="cb352-42"><a href="pls_chillforce.html#cb352-42" tabindex="-1"></a>coeff_plot</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-220-4.png" width="672" /></p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="pls_chillforce.html#cb353-1" tabindex="-1"></a>coeff_plot <span class="ot">&lt;-</span> coeff_plot <span class="sc">+</span></span>
<span id="cb353-2"><a href="pls_chillforce.html#cb353-2" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(Type),</span>
<span id="cb353-3"><a href="pls_chillforce.html#cb353-3" tabindex="-1"></a>             <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>,</span>
<span id="cb353-4"><a href="pls_chillforce.html#cb353-4" tabindex="-1"></a>             <span class="at">strip.position =</span> <span class="st">&quot;left&quot;</span>,</span>
<span id="cb353-5"><a href="pls_chillforce.html#cb353-5" tabindex="-1"></a>             <span class="at">labeller =</span></span>
<span id="cb353-6"><a href="pls_chillforce.html#cb353-6" tabindex="-1"></a>               <span class="fu">labeller</span>(</span>
<span id="cb353-7"><a href="pls_chillforce.html#cb353-7" tabindex="-1"></a>                 <span class="at">Type =</span> <span class="fu">as_labeller</span>(</span>
<span id="cb353-8"><a href="pls_chillforce.html#cb353-8" tabindex="-1"></a>                   <span class="fu">c</span>(<span class="at">Chill =</span> <span class="st">&quot;MC for chill&quot;</span>,</span>
<span id="cb353-9"><a href="pls_chillforce.html#cb353-9" tabindex="-1"></a>                     <span class="at">Heat =</span> <span class="st">&quot;MC for heat&quot;</span>)))) <span class="sc">+</span></span>
<span id="cb353-10"><a href="pls_chillforce.html#cb353-10" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb353-11"><a href="pls_chillforce.html#cb353-11" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(plscf<span class="sc">$</span>Chill_Portions<span class="sc">$</span>GDH<span class="sc">$</span>PLS_summary<span class="sc">$</span>Coef),</span>
<span id="cb353-12"><a href="pls_chillforce.html#cb353-12" tabindex="-1"></a>               <span class="fu">max</span>(plscf<span class="sc">$</span>Chill_Portions<span class="sc">$</span>GDH<span class="sc">$</span>PLS_summary<span class="sc">$</span>Coef))) <span class="sc">+</span></span>
<span id="cb353-13"><a href="pls_chillforce.html#cb353-13" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Model coefficients (MC)&quot;</span>) <span class="sc">+</span></span>
<span id="cb353-14"><a href="pls_chillforce.html#cb353-14" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span> </span>
<span id="cb353-15"><a href="pls_chillforce.html#cb353-15" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb353-16"><a href="pls_chillforce.html#cb353-16" tabindex="-1"></a>        <span class="at">strip.placement =</span> <span class="st">&quot;outside&quot;</span>,</span>
<span id="cb353-17"><a href="pls_chillforce.html#cb353-17" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb353-18"><a href="pls_chillforce.html#cb353-18" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb353-19"><a href="pls_chillforce.html#cb353-19" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb353-20"><a href="pls_chillforce.html#cb353-20" tabindex="-1"></a>        )</span>
<span id="cb353-21"><a href="pls_chillforce.html#cb353-21" tabindex="-1"></a>  </span>
<span id="cb353-22"><a href="pls_chillforce.html#cb353-22" tabindex="-1"></a>coeff_plot </span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-220-5.png" width="672" /></p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="pls_chillforce.html#cb354-1" tabindex="-1"></a>coeff_plot <span class="ot">&lt;-</span> coeff_plot <span class="sc">+</span>  </span>
<span id="cb354-2"><a href="pls_chillforce.html#cb354-2" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name=</span><span class="st">&quot;Effect direction&quot;</span>, </span>
<span id="cb354-3"><a href="pls_chillforce.html#cb354-3" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Advancing&quot;</span>,</span>
<span id="cb354-4"><a href="pls_chillforce.html#cb354-4" tabindex="-1"></a>                               <span class="st">&quot;Unimportant&quot;</span>,</span>
<span id="cb354-5"><a href="pls_chillforce.html#cb354-5" tabindex="-1"></a>                               <span class="st">&quot;Delaying&quot;</span>), </span>
<span id="cb354-6"><a href="pls_chillforce.html#cb354-6" tabindex="-1"></a>                    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;-1&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb354-7"><a href="pls_chillforce.html#cb354-7" tabindex="-1"></a>                               <span class="st">&quot;0&quot;</span> <span class="ot">=</span> <span class="st">&quot;grey&quot;</span>,</span>
<span id="cb354-8"><a href="pls_chillforce.html#cb354-8" tabindex="-1"></a>                               <span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;dark green&quot;</span>)) <span class="sc">+</span></span>
<span id="cb354-9"><a href="pls_chillforce.html#cb354-9" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;PLS coefficient&quot;</span>) <span class="sc">+</span></span>
<span id="cb354-10"><a href="pls_chillforce.html#cb354-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb354-11"><a href="pls_chillforce.html#cb354-11" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb354-12"><a href="pls_chillforce.html#cb354-12" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb354-13"><a href="pls_chillforce.html#cb354-13" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>())</span>
<span id="cb354-14"><a href="pls_chillforce.html#cb354-14" tabindex="-1"></a></span>
<span id="cb354-15"><a href="pls_chillforce.html#cb354-15" tabindex="-1"></a>coeff_plot</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-220-6.png" width="672" /></p>
<p>Now it’s time to combine the plots. We’ll use the <code>patchwork</code> package again.</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="pls_chillforce.html#cb355-1" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb355-2"><a href="pls_chillforce.html#cb355-2" tabindex="-1"></a></span>
<span id="cb355-3"><a href="pls_chillforce.html#cb355-3" tabindex="-1"></a>plot<span class="ot">&lt;-</span> (VIP_plot <span class="sc">+</span></span>
<span id="cb355-4"><a href="pls_chillforce.html#cb355-4" tabindex="-1"></a>          coeff_plot <span class="sc">+</span></span>
<span id="cb355-5"><a href="pls_chillforce.html#cb355-5" tabindex="-1"></a>          temp_plot <span class="sc">+</span></span>
<span id="cb355-6"><a href="pls_chillforce.html#cb355-6" tabindex="-1"></a>          <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>,</span>
<span id="cb355-7"><a href="pls_chillforce.html#cb355-7" tabindex="-1"></a>            <span class="at">guides =</span> <span class="st">&quot;collect&quot;</span>)</span>
<span id="cb355-8"><a href="pls_chillforce.html#cb355-8" tabindex="-1"></a>        ) <span class="sc">&amp;</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb355-9"><a href="pls_chillforce.html#cb355-9" tabindex="-1"></a>                  <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb355-10"><a href="pls_chillforce.html#cb355-10" tabindex="-1"></a>                  <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb355-11"><a href="pls_chillforce.html#cb355-11" tabindex="-1"></a>                  <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb355-12"><a href="pls_chillforce.html#cb355-12" tabindex="-1"></a></span>
<span id="cb355-13"><a href="pls_chillforce.html#cb355-13" tabindex="-1"></a>plot</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-221-1.png" width="672" /></p>
<p>Since I like what we’ve produced here, I’ll make a function out of it.</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="pls_chillforce.html#cb356-1" tabindex="-1"></a>plot_PLS_chill_force <span class="ot">&lt;-</span> <span class="cf">function</span>(plscf,</span>
<span id="cb356-2"><a href="pls_chillforce.html#cb356-2" tabindex="-1"></a>                                 <span class="at">chill_metric =</span> <span class="st">&quot;Chill_Portions&quot;</span>,</span>
<span id="cb356-3"><a href="pls_chillforce.html#cb356-3" tabindex="-1"></a>                                 <span class="at">heat_metric =</span> <span class="st">&quot;GDH&quot;</span>,</span>
<span id="cb356-4"><a href="pls_chillforce.html#cb356-4" tabindex="-1"></a>                                 <span class="at">chill_label =</span> <span class="st">&quot;CP&quot;</span>,</span>
<span id="cb356-5"><a href="pls_chillforce.html#cb356-5" tabindex="-1"></a>                                 <span class="at">heat_label =</span> <span class="st">&quot;GDH&quot;</span>,</span>
<span id="cb356-6"><a href="pls_chillforce.html#cb356-6" tabindex="-1"></a>                                 <span class="at">chill_phase =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">48</span>, <span class="dv">62</span>),</span>
<span id="cb356-7"><a href="pls_chillforce.html#cb356-7" tabindex="-1"></a>                                 <span class="at">heat_phase =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="fl">105.5</span>))</span>
<span id="cb356-8"><a href="pls_chillforce.html#cb356-8" tabindex="-1"></a>{</span>
<span id="cb356-9"><a href="pls_chillforce.html#cb356-9" tabindex="-1"></a>  PLS_gg <span class="ot">&lt;-</span> plscf[[chill_metric]][[heat_metric]]<span class="sc">$</span>PLS_summary <span class="sc">%&gt;%</span></span>
<span id="cb356-10"><a href="pls_chillforce.html#cb356-10" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">trunc</span>(Date<span class="sc">/</span><span class="dv">100</span>),</span>
<span id="cb356-11"><a href="pls_chillforce.html#cb356-11" tabindex="-1"></a>           <span class="at">Day =</span> Date <span class="sc">-</span> Month <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb356-12"><a href="pls_chillforce.html#cb356-12" tabindex="-1"></a>           <span class="at">Date =</span> <span class="fu">ISOdate</span>(<span class="dv">2002</span>,</span>
<span id="cb356-13"><a href="pls_chillforce.html#cb356-13" tabindex="-1"></a>                          Month,</span>
<span id="cb356-14"><a href="pls_chillforce.html#cb356-14" tabindex="-1"></a>                          Day))</span>
<span id="cb356-15"><a href="pls_chillforce.html#cb356-15" tabindex="-1"></a>  </span>
<span id="cb356-16"><a href="pls_chillforce.html#cb356-16" tabindex="-1"></a>  PLS_gg[PLS_gg<span class="sc">$</span>JDay <span class="sc">&lt;=</span> <span class="dv">0</span>,<span class="st">&quot;Date&quot;</span>]<span class="ot">&lt;-</span></span>
<span id="cb356-17"><a href="pls_chillforce.html#cb356-17" tabindex="-1"></a>    <span class="fu">ISOdate</span>(<span class="dv">2001</span>,</span>
<span id="cb356-18"><a href="pls_chillforce.html#cb356-18" tabindex="-1"></a>            PLS_gg<span class="sc">$</span>Month[PLS_gg<span class="sc">$</span>JDay <span class="sc">&lt;=</span> <span class="dv">0</span>],</span>
<span id="cb356-19"><a href="pls_chillforce.html#cb356-19" tabindex="-1"></a>            PLS_gg<span class="sc">$</span>Day[PLS_gg<span class="sc">$</span>JDay <span class="sc">&lt;=</span> <span class="dv">0</span>])</span>
<span id="cb356-20"><a href="pls_chillforce.html#cb356-20" tabindex="-1"></a>  </span>
<span id="cb356-21"><a href="pls_chillforce.html#cb356-21" tabindex="-1"></a>  PLS_gg <span class="ot">&lt;-</span> PLS_gg <span class="sc">%&gt;%</span></span>
<span id="cb356-22"><a href="pls_chillforce.html#cb356-22" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">VIP_importance =</span> VIP <span class="sc">&gt;=</span> <span class="fl">0.8</span>,</span>
<span id="cb356-23"><a href="pls_chillforce.html#cb356-23" tabindex="-1"></a>           <span class="at">VIP_Coeff =</span> <span class="fu">factor</span>(<span class="fu">sign</span>(Coef) <span class="sc">*</span> VIP_importance))</span>
<span id="cb356-24"><a href="pls_chillforce.html#cb356-24" tabindex="-1"></a>  </span>
<span id="cb356-25"><a href="pls_chillforce.html#cb356-25" tabindex="-1"></a>  chill_start_date <span class="ot">&lt;-</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,</span>
<span id="cb356-26"><a href="pls_chillforce.html#cb356-26" tabindex="-1"></a>                              <span class="dv">12</span>,</span>
<span id="cb356-27"><a href="pls_chillforce.html#cb356-27" tabindex="-1"></a>                              <span class="dv">31</span>) <span class="sc">+</span> chill_phase[<span class="dv">1</span>] <span class="sc">*</span> <span class="dv">24</span> <span class="sc">*</span> <span class="dv">3600</span></span>
<span id="cb356-28"><a href="pls_chillforce.html#cb356-28" tabindex="-1"></a>  chill_end_date <span class="ot">&lt;-</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,</span>
<span id="cb356-29"><a href="pls_chillforce.html#cb356-29" tabindex="-1"></a>                            <span class="dv">12</span>,</span>
<span id="cb356-30"><a href="pls_chillforce.html#cb356-30" tabindex="-1"></a>                            <span class="dv">31</span>) <span class="sc">+</span> chill_phase[<span class="dv">2</span>] <span class="sc">*</span> <span class="dv">24</span> <span class="sc">*</span> <span class="dv">3600</span></span>
<span id="cb356-31"><a href="pls_chillforce.html#cb356-31" tabindex="-1"></a>  heat_start_date <span class="ot">&lt;-</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,</span>
<span id="cb356-32"><a href="pls_chillforce.html#cb356-32" tabindex="-1"></a>                             <span class="dv">12</span>,</span>
<span id="cb356-33"><a href="pls_chillforce.html#cb356-33" tabindex="-1"></a>                             <span class="dv">31</span>) <span class="sc">+</span> heat_phase[<span class="dv">1</span>] <span class="sc">*</span> <span class="dv">24</span> <span class="sc">*</span> <span class="dv">3600</span></span>
<span id="cb356-34"><a href="pls_chillforce.html#cb356-34" tabindex="-1"></a>  heat_end_date <span class="ot">&lt;-</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,</span>
<span id="cb356-35"><a href="pls_chillforce.html#cb356-35" tabindex="-1"></a>                           <span class="dv">12</span>,</span>
<span id="cb356-36"><a href="pls_chillforce.html#cb356-36" tabindex="-1"></a>                           <span class="dv">31</span>) <span class="sc">+</span> heat_phase[<span class="dv">2</span>] <span class="sc">*</span> <span class="dv">24</span> <span class="sc">*</span> <span class="dv">3600</span></span>
<span id="cb356-37"><a href="pls_chillforce.html#cb356-37" tabindex="-1"></a></span>
<span id="cb356-38"><a href="pls_chillforce.html#cb356-38" tabindex="-1"></a></span>
<span id="cb356-39"><a href="pls_chillforce.html#cb356-39" tabindex="-1"></a></span>
<span id="cb356-40"><a href="pls_chillforce.html#cb356-40" tabindex="-1"></a></span>
<span id="cb356-41"><a href="pls_chillforce.html#cb356-41" tabindex="-1"></a>  temp_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(PLS_gg) <span class="sc">+</span></span>
<span id="cb356-42"><a href="pls_chillforce.html#cb356-42" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb356-43"><a href="pls_chillforce.html#cb356-43" tabindex="-1"></a>             <span class="at">xmin =</span> chill_start_date,</span>
<span id="cb356-44"><a href="pls_chillforce.html#cb356-44" tabindex="-1"></a>             <span class="at">xmax =</span> chill_end_date,</span>
<span id="cb356-45"><a href="pls_chillforce.html#cb356-45" tabindex="-1"></a>             <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb356-46"><a href="pls_chillforce.html#cb356-46" tabindex="-1"></a>             <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb356-47"><a href="pls_chillforce.html#cb356-47" tabindex="-1"></a>             <span class="at">alpha =</span> .<span class="dv">1</span>,</span>
<span id="cb356-48"><a href="pls_chillforce.html#cb356-48" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb356-49"><a href="pls_chillforce.html#cb356-49" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb356-50"><a href="pls_chillforce.html#cb356-50" tabindex="-1"></a>             <span class="at">xmin =</span> heat_start_date,</span>
<span id="cb356-51"><a href="pls_chillforce.html#cb356-51" tabindex="-1"></a>             <span class="at">xmax =</span> heat_end_date,</span>
<span id="cb356-52"><a href="pls_chillforce.html#cb356-52" tabindex="-1"></a>             <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb356-53"><a href="pls_chillforce.html#cb356-53" tabindex="-1"></a>             <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb356-54"><a href="pls_chillforce.html#cb356-54" tabindex="-1"></a>             <span class="at">alpha =</span> .<span class="dv">1</span>,</span>
<span id="cb356-55"><a href="pls_chillforce.html#cb356-55" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb356-56"><a href="pls_chillforce.html#cb356-56" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb356-57"><a href="pls_chillforce.html#cb356-57" tabindex="-1"></a>             <span class="at">xmin =</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,</span>
<span id="cb356-58"><a href="pls_chillforce.html#cb356-58" tabindex="-1"></a>                            <span class="dv">12</span>,</span>
<span id="cb356-59"><a href="pls_chillforce.html#cb356-59" tabindex="-1"></a>                            <span class="dv">31</span>) <span class="sc">+</span></span>
<span id="cb356-60"><a href="pls_chillforce.html#cb356-60" tabindex="-1"></a>               <span class="fu">min</span>(plscf<span class="sc">$</span>pheno<span class="sc">$</span>pheno,</span>
<span id="cb356-61"><a href="pls_chillforce.html#cb356-61" tabindex="-1"></a>                   <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">24</span> <span class="sc">*</span> <span class="dv">3600</span>,</span>
<span id="cb356-62"><a href="pls_chillforce.html#cb356-62" tabindex="-1"></a>             <span class="at">xmax =</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,</span>
<span id="cb356-63"><a href="pls_chillforce.html#cb356-63" tabindex="-1"></a>                            <span class="dv">12</span>,</span>
<span id="cb356-64"><a href="pls_chillforce.html#cb356-64" tabindex="-1"></a>                            <span class="dv">31</span>) <span class="sc">+</span></span>
<span id="cb356-65"><a href="pls_chillforce.html#cb356-65" tabindex="-1"></a>               <span class="fu">max</span>(plscf<span class="sc">$</span>pheno<span class="sc">$</span>pheno,</span>
<span id="cb356-66"><a href="pls_chillforce.html#cb356-66" tabindex="-1"></a>                   <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">24</span> <span class="sc">*</span> <span class="dv">3600</span>,</span>
<span id="cb356-67"><a href="pls_chillforce.html#cb356-67" tabindex="-1"></a>             <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb356-68"><a href="pls_chillforce.html#cb356-68" tabindex="-1"></a>             <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb356-69"><a href="pls_chillforce.html#cb356-69" tabindex="-1"></a>             <span class="at">alpha =</span> .<span class="dv">1</span>,</span>
<span id="cb356-70"><a href="pls_chillforce.html#cb356-70" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb356-71"><a href="pls_chillforce.html#cb356-71" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,</span>
<span id="cb356-72"><a href="pls_chillforce.html#cb356-72" tabindex="-1"></a>                                    <span class="dv">12</span>,</span>
<span id="cb356-73"><a href="pls_chillforce.html#cb356-73" tabindex="-1"></a>                                    <span class="dv">31</span>) <span class="sc">+</span></span>
<span id="cb356-74"><a href="pls_chillforce.html#cb356-74" tabindex="-1"></a>                 <span class="fu">median</span>(plscf<span class="sc">$</span>pheno<span class="sc">$</span>pheno,</span>
<span id="cb356-75"><a href="pls_chillforce.html#cb356-75" tabindex="-1"></a>                        <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">24</span> <span class="sc">*</span> <span class="dv">3600</span>,</span>
<span id="cb356-76"><a href="pls_chillforce.html#cb356-76" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb356-77"><a href="pls_chillforce.html#cb356-77" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> Date,</span>
<span id="cb356-78"><a href="pls_chillforce.html#cb356-78" tabindex="-1"></a>                    <span class="at">ymin =</span> MetricMean <span class="sc">-</span> MetricStdev ,</span>
<span id="cb356-79"><a href="pls_chillforce.html#cb356-79" tabindex="-1"></a>                    <span class="at">ymax =</span> MetricMean <span class="sc">+</span> MetricStdev ),</span>
<span id="cb356-80"><a href="pls_chillforce.html#cb356-80" tabindex="-1"></a>                <span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb356-81"><a href="pls_chillforce.html#cb356-81" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> Date,</span>
<span id="cb356-82"><a href="pls_chillforce.html#cb356-82" tabindex="-1"></a>                    <span class="at">ymin =</span> MetricMean <span class="sc">-</span> MetricStdev <span class="sc">*</span> (VIP_Coeff <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb356-83"><a href="pls_chillforce.html#cb356-83" tabindex="-1"></a>                    <span class="at">ymax =</span> MetricMean <span class="sc">+</span> MetricStdev <span class="sc">*</span> (VIP_Coeff <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>)),</span>
<span id="cb356-84"><a href="pls_chillforce.html#cb356-84" tabindex="-1"></a>                <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb356-85"><a href="pls_chillforce.html#cb356-85" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> Date,</span>
<span id="cb356-86"><a href="pls_chillforce.html#cb356-86" tabindex="-1"></a>                    <span class="at">ymin =</span> MetricMean <span class="sc">-</span> MetricStdev <span class="sc">*</span> (VIP_Coeff <span class="sc">==</span> <span class="dv">1</span>),</span>
<span id="cb356-87"><a href="pls_chillforce.html#cb356-87" tabindex="-1"></a>                    <span class="at">ymax =</span> MetricMean <span class="sc">+</span> MetricStdev <span class="sc">*</span> (VIP_Coeff <span class="sc">==</span> <span class="dv">1</span>)),</span>
<span id="cb356-88"><a href="pls_chillforce.html#cb356-88" tabindex="-1"></a>                <span class="at">fill =</span> <span class="st">&quot;dark green&quot;</span>) <span class="sc">+</span></span>
<span id="cb356-89"><a href="pls_chillforce.html#cb356-89" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> Date,</span>
<span id="cb356-90"><a href="pls_chillforce.html#cb356-90" tabindex="-1"></a>                  <span class="at">y =</span> MetricMean)) <span class="sc">+</span></span>
<span id="cb356-91"><a href="pls_chillforce.html#cb356-91" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(Type),</span>
<span id="cb356-92"><a href="pls_chillforce.html#cb356-92" tabindex="-1"></a>               <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>,</span>
<span id="cb356-93"><a href="pls_chillforce.html#cb356-93" tabindex="-1"></a>               <span class="at">strip.position =</span> <span class="st">&quot;left&quot;</span>,</span>
<span id="cb356-94"><a href="pls_chillforce.html#cb356-94" tabindex="-1"></a>               <span class="at">labeller =</span> </span>
<span id="cb356-95"><a href="pls_chillforce.html#cb356-95" tabindex="-1"></a>                 <span class="fu">labeller</span>(</span>
<span id="cb356-96"><a href="pls_chillforce.html#cb356-96" tabindex="-1"></a>                   <span class="at">Type =</span></span>
<span id="cb356-97"><a href="pls_chillforce.html#cb356-97" tabindex="-1"></a>                     <span class="fu">as_labeller</span>(<span class="fu">c</span>(<span class="at">Chill =</span> <span class="fu">paste0</span>(<span class="st">&quot;Chill (&quot;</span>,</span>
<span id="cb356-98"><a href="pls_chillforce.html#cb356-98" tabindex="-1"></a>                                                  chill_label,</span>
<span id="cb356-99"><a href="pls_chillforce.html#cb356-99" tabindex="-1"></a>                                                  <span class="st">&quot;)&quot;</span>),</span>
<span id="cb356-100"><a href="pls_chillforce.html#cb356-100" tabindex="-1"></a>                                   <span class="at">Heat =</span> <span class="fu">paste0</span>(<span class="st">&quot;Heat (&quot;</span>,</span>
<span id="cb356-101"><a href="pls_chillforce.html#cb356-101" tabindex="-1"></a>                                                 heat_label,</span>
<span id="cb356-102"><a href="pls_chillforce.html#cb356-102" tabindex="-1"></a>                                                 <span class="st">&quot;)&quot;</span>))))) <span class="sc">+</span></span>
<span id="cb356-103"><a href="pls_chillforce.html#cb356-103" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Daily chill and heat accumulation rates&quot;</span>) <span class="sc">+</span></span>
<span id="cb356-104"><a href="pls_chillforce.html#cb356-104" tabindex="-1"></a>    <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span> </span>
<span id="cb356-105"><a href="pls_chillforce.html#cb356-105" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb356-106"><a href="pls_chillforce.html#cb356-106" tabindex="-1"></a>          <span class="at">strip.placement =</span> <span class="st">&quot;outside&quot;</span>,</span>
<span id="cb356-107"><a href="pls_chillforce.html#cb356-107" tabindex="-1"></a>          <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb356-108"><a href="pls_chillforce.html#cb356-108" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb356-109"><a href="pls_chillforce.html#cb356-109" tabindex="-1"></a>          <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb356-110"><a href="pls_chillforce.html#cb356-110" tabindex="-1"></a>          )</span>
<span id="cb356-111"><a href="pls_chillforce.html#cb356-111" tabindex="-1"></a>  </span>
<span id="cb356-112"><a href="pls_chillforce.html#cb356-112" tabindex="-1"></a>  VIP_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(PLS_gg,</span>
<span id="cb356-113"><a href="pls_chillforce.html#cb356-113" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> Date,</span>
<span id="cb356-114"><a href="pls_chillforce.html#cb356-114" tabindex="-1"></a>                         <span class="at">y =</span> VIP)) <span class="sc">+</span></span>
<span id="cb356-115"><a href="pls_chillforce.html#cb356-115" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb356-116"><a href="pls_chillforce.html#cb356-116" tabindex="-1"></a>             <span class="at">xmin =</span> chill_start_date,</span>
<span id="cb356-117"><a href="pls_chillforce.html#cb356-117" tabindex="-1"></a>             <span class="at">xmax =</span> chill_end_date,</span>
<span id="cb356-118"><a href="pls_chillforce.html#cb356-118" tabindex="-1"></a>             <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb356-119"><a href="pls_chillforce.html#cb356-119" tabindex="-1"></a>             <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb356-120"><a href="pls_chillforce.html#cb356-120" tabindex="-1"></a>             <span class="at">alpha =</span> .<span class="dv">1</span>,</span>
<span id="cb356-121"><a href="pls_chillforce.html#cb356-121" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb356-122"><a href="pls_chillforce.html#cb356-122" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb356-123"><a href="pls_chillforce.html#cb356-123" tabindex="-1"></a>             <span class="at">xmin =</span> heat_start_date,</span>
<span id="cb356-124"><a href="pls_chillforce.html#cb356-124" tabindex="-1"></a>             <span class="at">xmax =</span> heat_end_date,</span>
<span id="cb356-125"><a href="pls_chillforce.html#cb356-125" tabindex="-1"></a>             <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb356-126"><a href="pls_chillforce.html#cb356-126" tabindex="-1"></a>             <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb356-127"><a href="pls_chillforce.html#cb356-127" tabindex="-1"></a>             <span class="at">alpha =</span> .<span class="dv">1</span>,</span>
<span id="cb356-128"><a href="pls_chillforce.html#cb356-128" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb356-129"><a href="pls_chillforce.html#cb356-129" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb356-130"><a href="pls_chillforce.html#cb356-130" tabindex="-1"></a>             <span class="at">xmin =</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,</span>
<span id="cb356-131"><a href="pls_chillforce.html#cb356-131" tabindex="-1"></a>                            <span class="dv">12</span>,</span>
<span id="cb356-132"><a href="pls_chillforce.html#cb356-132" tabindex="-1"></a>                            <span class="dv">31</span>) <span class="sc">+</span> <span class="fu">min</span>(plscf<span class="sc">$</span>pheno<span class="sc">$</span>pheno,</span>
<span id="cb356-133"><a href="pls_chillforce.html#cb356-133" tabindex="-1"></a>                                      <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">24</span> <span class="sc">*</span> <span class="dv">3600</span>,</span>
<span id="cb356-134"><a href="pls_chillforce.html#cb356-134" tabindex="-1"></a>             <span class="at">xmax =</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,</span>
<span id="cb356-135"><a href="pls_chillforce.html#cb356-135" tabindex="-1"></a>                            <span class="dv">12</span>,</span>
<span id="cb356-136"><a href="pls_chillforce.html#cb356-136" tabindex="-1"></a>                            <span class="dv">31</span>) <span class="sc">+</span> <span class="fu">max</span>(plscf<span class="sc">$</span>pheno<span class="sc">$</span>pheno,</span>
<span id="cb356-137"><a href="pls_chillforce.html#cb356-137" tabindex="-1"></a>                                      <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">24</span> <span class="sc">*</span> <span class="dv">3600</span>,</span>
<span id="cb356-138"><a href="pls_chillforce.html#cb356-138" tabindex="-1"></a>             <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb356-139"><a href="pls_chillforce.html#cb356-139" tabindex="-1"></a>             <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb356-140"><a href="pls_chillforce.html#cb356-140" tabindex="-1"></a>             <span class="at">alpha =</span> .<span class="dv">1</span>,</span>
<span id="cb356-141"><a href="pls_chillforce.html#cb356-141" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb356-142"><a href="pls_chillforce.html#cb356-142" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,</span>
<span id="cb356-143"><a href="pls_chillforce.html#cb356-143" tabindex="-1"></a>                                    <span class="dv">12</span>,</span>
<span id="cb356-144"><a href="pls_chillforce.html#cb356-144" tabindex="-1"></a>                                    <span class="dv">31</span>) <span class="sc">+</span> <span class="fu">median</span>(plscf<span class="sc">$</span>pheno<span class="sc">$</span>pheno,</span>
<span id="cb356-145"><a href="pls_chillforce.html#cb356-145" tabindex="-1"></a>                                                 <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">24</span> <span class="sc">*</span> <span class="dv">3600</span>,</span>
<span id="cb356-146"><a href="pls_chillforce.html#cb356-146" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb356-147"><a href="pls_chillforce.html#cb356-147" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>,</span>
<span id="cb356-148"><a href="pls_chillforce.html#cb356-148" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">fill =</span> VIP<span class="sc">&gt;</span><span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb356-149"><a href="pls_chillforce.html#cb356-149" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(Type), </span>
<span id="cb356-150"><a href="pls_chillforce.html#cb356-150" tabindex="-1"></a>               <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>,</span>
<span id="cb356-151"><a href="pls_chillforce.html#cb356-151" tabindex="-1"></a>               <span class="at">strip.position =</span> <span class="st">&quot;left&quot;</span>,</span>
<span id="cb356-152"><a href="pls_chillforce.html#cb356-152" tabindex="-1"></a>               <span class="at">labeller =</span> </span>
<span id="cb356-153"><a href="pls_chillforce.html#cb356-153" tabindex="-1"></a>                 <span class="fu">labeller</span>(</span>
<span id="cb356-154"><a href="pls_chillforce.html#cb356-154" tabindex="-1"></a>                   <span class="at">Type =</span> <span class="fu">as_labeller</span>(<span class="fu">c</span>(<span class="at">Chill=</span><span class="st">&quot;VIP for chill&quot;</span>,</span>
<span id="cb356-155"><a href="pls_chillforce.html#cb356-155" tabindex="-1"></a>                                        <span class="at">Heat=</span><span class="st">&quot;VIP for heat&quot;</span>)))) <span class="sc">+</span></span>
<span id="cb356-156"><a href="pls_chillforce.html#cb356-156" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(</span>
<span id="cb356-157"><a href="pls_chillforce.html#cb356-157" tabindex="-1"></a>      <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,</span>
<span id="cb356-158"><a href="pls_chillforce.html#cb356-158" tabindex="-1"></a>                 <span class="fu">max</span>(plscf[[chill_metric]][[heat_metric]]<span class="sc">$</span>PLS_summary<span class="sc">$</span>VIP))) <span class="sc">+</span></span>
<span id="cb356-159"><a href="pls_chillforce.html#cb356-159" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Variable Importance in the Projection (VIP) scores&quot;</span>) <span class="sc">+</span></span>
<span id="cb356-160"><a href="pls_chillforce.html#cb356-160" tabindex="-1"></a>    <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span> </span>
<span id="cb356-161"><a href="pls_chillforce.html#cb356-161" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb356-162"><a href="pls_chillforce.html#cb356-162" tabindex="-1"></a>          <span class="at">strip.placement =</span> <span class="st">&quot;outside&quot;</span>,</span>
<span id="cb356-163"><a href="pls_chillforce.html#cb356-163" tabindex="-1"></a>          <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb356-164"><a href="pls_chillforce.html#cb356-164" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb356-165"><a href="pls_chillforce.html#cb356-165" tabindex="-1"></a>          <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb356-166"><a href="pls_chillforce.html#cb356-166" tabindex="-1"></a>          ) <span class="sc">+</span></span>
<span id="cb356-167"><a href="pls_chillforce.html#cb356-167" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">&quot;VIP&quot;</span>, </span>
<span id="cb356-168"><a href="pls_chillforce.html#cb356-168" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;&lt;0.8&quot;</span>, <span class="st">&quot;&gt;0.8&quot;</span>), </span>
<span id="cb356-169"><a href="pls_chillforce.html#cb356-169" tabindex="-1"></a>                      <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;FALSE&quot;</span> <span class="ot">=</span> <span class="st">&quot;grey&quot;</span>,</span>
<span id="cb356-170"><a href="pls_chillforce.html#cb356-170" tabindex="-1"></a>                                 <span class="st">&quot;TRUE&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>)) <span class="sc">+</span></span>
<span id="cb356-171"><a href="pls_chillforce.html#cb356-171" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb356-172"><a href="pls_chillforce.html#cb356-172" tabindex="-1"></a>          <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb356-173"><a href="pls_chillforce.html#cb356-173" tabindex="-1"></a>          <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb356-174"><a href="pls_chillforce.html#cb356-174" tabindex="-1"></a>          <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>())</span>
<span id="cb356-175"><a href="pls_chillforce.html#cb356-175" tabindex="-1"></a>  </span>
<span id="cb356-176"><a href="pls_chillforce.html#cb356-176" tabindex="-1"></a>  coeff_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(PLS_gg,</span>
<span id="cb356-177"><a href="pls_chillforce.html#cb356-177" tabindex="-1"></a>                       <span class="fu">aes</span>(<span class="at">x =</span> Date,</span>
<span id="cb356-178"><a href="pls_chillforce.html#cb356-178" tabindex="-1"></a>                           <span class="at">y =</span> Coef)) <span class="sc">+</span></span>
<span id="cb356-179"><a href="pls_chillforce.html#cb356-179" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb356-180"><a href="pls_chillforce.html#cb356-180" tabindex="-1"></a>             <span class="at">xmin =</span> chill_start_date,</span>
<span id="cb356-181"><a href="pls_chillforce.html#cb356-181" tabindex="-1"></a>             <span class="at">xmax =</span> chill_end_date,</span>
<span id="cb356-182"><a href="pls_chillforce.html#cb356-182" tabindex="-1"></a>             <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb356-183"><a href="pls_chillforce.html#cb356-183" tabindex="-1"></a>             <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb356-184"><a href="pls_chillforce.html#cb356-184" tabindex="-1"></a>             <span class="at">alpha =</span> .<span class="dv">1</span>,</span>
<span id="cb356-185"><a href="pls_chillforce.html#cb356-185" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb356-186"><a href="pls_chillforce.html#cb356-186" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb356-187"><a href="pls_chillforce.html#cb356-187" tabindex="-1"></a>             <span class="at">xmin =</span> heat_start_date,</span>
<span id="cb356-188"><a href="pls_chillforce.html#cb356-188" tabindex="-1"></a>             <span class="at">xmax =</span> heat_end_date,</span>
<span id="cb356-189"><a href="pls_chillforce.html#cb356-189" tabindex="-1"></a>             <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb356-190"><a href="pls_chillforce.html#cb356-190" tabindex="-1"></a>             <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb356-191"><a href="pls_chillforce.html#cb356-191" tabindex="-1"></a>             <span class="at">alpha =</span> .<span class="dv">1</span>,</span>
<span id="cb356-192"><a href="pls_chillforce.html#cb356-192" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb356-193"><a href="pls_chillforce.html#cb356-193" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb356-194"><a href="pls_chillforce.html#cb356-194" tabindex="-1"></a>             <span class="at">xmin =</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,</span>
<span id="cb356-195"><a href="pls_chillforce.html#cb356-195" tabindex="-1"></a>                            <span class="dv">12</span>,</span>
<span id="cb356-196"><a href="pls_chillforce.html#cb356-196" tabindex="-1"></a>                            <span class="dv">31</span>) <span class="sc">+</span> <span class="fu">min</span>(plscf<span class="sc">$</span>pheno<span class="sc">$</span>pheno,</span>
<span id="cb356-197"><a href="pls_chillforce.html#cb356-197" tabindex="-1"></a>                                      <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">24</span> <span class="sc">*</span> <span class="dv">3600</span>,</span>
<span id="cb356-198"><a href="pls_chillforce.html#cb356-198" tabindex="-1"></a>             <span class="at">xmax =</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,</span>
<span id="cb356-199"><a href="pls_chillforce.html#cb356-199" tabindex="-1"></a>                            <span class="dv">12</span>,</span>
<span id="cb356-200"><a href="pls_chillforce.html#cb356-200" tabindex="-1"></a>                            <span class="dv">31</span>) <span class="sc">+</span> <span class="fu">max</span>(plscf<span class="sc">$</span>pheno<span class="sc">$</span>pheno,</span>
<span id="cb356-201"><a href="pls_chillforce.html#cb356-201" tabindex="-1"></a>                                      <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">24</span> <span class="sc">*</span> <span class="dv">3600</span>,</span>
<span id="cb356-202"><a href="pls_chillforce.html#cb356-202" tabindex="-1"></a>             <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb356-203"><a href="pls_chillforce.html#cb356-203" tabindex="-1"></a>             <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb356-204"><a href="pls_chillforce.html#cb356-204" tabindex="-1"></a>             <span class="at">alpha =</span> .<span class="dv">1</span>,</span>
<span id="cb356-205"><a href="pls_chillforce.html#cb356-205" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb356-206"><a href="pls_chillforce.html#cb356-206" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">ISOdate</span>(<span class="dv">2001</span>,</span>
<span id="cb356-207"><a href="pls_chillforce.html#cb356-207" tabindex="-1"></a>                                    <span class="dv">12</span>,</span>
<span id="cb356-208"><a href="pls_chillforce.html#cb356-208" tabindex="-1"></a>                                    <span class="dv">31</span>) <span class="sc">+</span> <span class="fu">median</span>(plscf<span class="sc">$</span>pheno<span class="sc">$</span>pheno,</span>
<span id="cb356-209"><a href="pls_chillforce.html#cb356-209" tabindex="-1"></a>                                                 <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">24</span> <span class="sc">*</span> <span class="dv">3600</span>,</span>
<span id="cb356-210"><a href="pls_chillforce.html#cb356-210" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb356-211"><a href="pls_chillforce.html#cb356-211" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>,</span>
<span id="cb356-212"><a href="pls_chillforce.html#cb356-212" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">fill =</span> VIP_Coeff)) <span class="sc">+</span></span>
<span id="cb356-213"><a href="pls_chillforce.html#cb356-213" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(Type),</span>
<span id="cb356-214"><a href="pls_chillforce.html#cb356-214" tabindex="-1"></a>               <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>,</span>
<span id="cb356-215"><a href="pls_chillforce.html#cb356-215" tabindex="-1"></a>               <span class="at">strip.position =</span> <span class="st">&quot;left&quot;</span>,</span>
<span id="cb356-216"><a href="pls_chillforce.html#cb356-216" tabindex="-1"></a>               <span class="at">labeller =</span></span>
<span id="cb356-217"><a href="pls_chillforce.html#cb356-217" tabindex="-1"></a>                 <span class="fu">labeller</span>(</span>
<span id="cb356-218"><a href="pls_chillforce.html#cb356-218" tabindex="-1"></a>                   <span class="at">Type =</span> <span class="fu">as_labeller</span>(<span class="fu">c</span>(<span class="at">Chill =</span> <span class="st">&quot;MC for chill&quot;</span>,</span>
<span id="cb356-219"><a href="pls_chillforce.html#cb356-219" tabindex="-1"></a>                                        <span class="at">Heat =</span> <span class="st">&quot;MC for heat&quot;</span>)))) <span class="sc">+</span></span>
<span id="cb356-220"><a href="pls_chillforce.html#cb356-220" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(</span>
<span id="cb356-221"><a href="pls_chillforce.html#cb356-221" tabindex="-1"></a>      <span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(plscf[[chill_metric]][[heat_metric]]<span class="sc">$</span>PLS_summary<span class="sc">$</span>Coef),</span>
<span id="cb356-222"><a href="pls_chillforce.html#cb356-222" tabindex="-1"></a>                 <span class="fu">max</span>(plscf[[chill_metric]][[heat_metric]]<span class="sc">$</span>PLS_summary<span class="sc">$</span>Coef))) <span class="sc">+</span></span>
<span id="cb356-223"><a href="pls_chillforce.html#cb356-223" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Model coefficients (MC)&quot;</span>) <span class="sc">+</span></span>
<span id="cb356-224"><a href="pls_chillforce.html#cb356-224" tabindex="-1"></a>    <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span> </span>
<span id="cb356-225"><a href="pls_chillforce.html#cb356-225" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb356-226"><a href="pls_chillforce.html#cb356-226" tabindex="-1"></a>          <span class="at">strip.placement =</span> <span class="st">&quot;outside&quot;</span>,</span>
<span id="cb356-227"><a href="pls_chillforce.html#cb356-227" tabindex="-1"></a>          <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb356-228"><a href="pls_chillforce.html#cb356-228" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb356-229"><a href="pls_chillforce.html#cb356-229" tabindex="-1"></a>          <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb356-230"><a href="pls_chillforce.html#cb356-230" tabindex="-1"></a>          ) <span class="sc">+</span></span>
<span id="cb356-231"><a href="pls_chillforce.html#cb356-231" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">&quot;Effect direction&quot;</span>, </span>
<span id="cb356-232"><a href="pls_chillforce.html#cb356-232" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Advancing&quot;</span>,</span>
<span id="cb356-233"><a href="pls_chillforce.html#cb356-233" tabindex="-1"></a>                                 <span class="st">&quot;Unimportant&quot;</span>,</span>
<span id="cb356-234"><a href="pls_chillforce.html#cb356-234" tabindex="-1"></a>                                 <span class="st">&quot;Delaying&quot;</span>), </span>
<span id="cb356-235"><a href="pls_chillforce.html#cb356-235" tabindex="-1"></a>                      <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;-1&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb356-236"><a href="pls_chillforce.html#cb356-236" tabindex="-1"></a>                                 <span class="st">&quot;0&quot;</span> <span class="ot">=</span> <span class="st">&quot;grey&quot;</span>,</span>
<span id="cb356-237"><a href="pls_chillforce.html#cb356-237" tabindex="-1"></a>                                 <span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;dark green&quot;</span>)) <span class="sc">+</span></span>
<span id="cb356-238"><a href="pls_chillforce.html#cb356-238" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;PLS coefficient&quot;</span>) <span class="sc">+</span></span>
<span id="cb356-239"><a href="pls_chillforce.html#cb356-239" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb356-240"><a href="pls_chillforce.html#cb356-240" tabindex="-1"></a>          <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb356-241"><a href="pls_chillforce.html#cb356-241" tabindex="-1"></a>          <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb356-242"><a href="pls_chillforce.html#cb356-242" tabindex="-1"></a>          <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>())</span>
<span id="cb356-243"><a href="pls_chillforce.html#cb356-243" tabindex="-1"></a>  </span>
<span id="cb356-244"><a href="pls_chillforce.html#cb356-244" tabindex="-1"></a>  <span class="fu">library</span>(patchwork)</span>
<span id="cb356-245"><a href="pls_chillforce.html#cb356-245" tabindex="-1"></a>  </span>
<span id="cb356-246"><a href="pls_chillforce.html#cb356-246" tabindex="-1"></a>  plot <span class="ot">&lt;-</span> (VIP_plot <span class="sc">+</span></span>
<span id="cb356-247"><a href="pls_chillforce.html#cb356-247" tabindex="-1"></a>             coeff_plot <span class="sc">+</span></span>
<span id="cb356-248"><a href="pls_chillforce.html#cb356-248" tabindex="-1"></a>             temp_plot <span class="sc">+</span></span>
<span id="cb356-249"><a href="pls_chillforce.html#cb356-249" tabindex="-1"></a>             <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>,</span>
<span id="cb356-250"><a href="pls_chillforce.html#cb356-250" tabindex="-1"></a>                         <span class="at">guides =</span> <span class="st">&quot;collect&quot;</span>)</span>
<span id="cb356-251"><a href="pls_chillforce.html#cb356-251" tabindex="-1"></a>           ) <span class="sc">&amp;</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb356-252"><a href="pls_chillforce.html#cb356-252" tabindex="-1"></a>                     <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb356-253"><a href="pls_chillforce.html#cb356-253" tabindex="-1"></a>                     <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb356-254"><a href="pls_chillforce.html#cb356-254" tabindex="-1"></a>                     <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb356-255"><a href="pls_chillforce.html#cb356-255" tabindex="-1"></a></span>
<span id="cb356-256"><a href="pls_chillforce.html#cb356-256" tabindex="-1"></a>plot</span>
<span id="cb356-257"><a href="pls_chillforce.html#cb356-257" tabindex="-1"></a></span>
<span id="cb356-258"><a href="pls_chillforce.html#cb356-258" tabindex="-1"></a>}</span>
<span id="cb356-259"><a href="pls_chillforce.html#cb356-259" tabindex="-1"></a></span>
<span id="cb356-260"><a href="pls_chillforce.html#cb356-260" tabindex="-1"></a><span class="fu">plot_PLS_chill_force</span>(plscf)</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-222-1.png" width="672" /></p>
<p>Now that we’ve automated the plot production, we can easily look at how useful other chill models would be in delineating chilling and forcing periods.</p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="pls_chillforce.html#cb357-1" tabindex="-1"></a>daychill <span class="ot">&lt;-</span> <span class="fu">daily_chill</span>(<span class="at">hourtemps =</span> temps_hourly,</span>
<span id="cb357-2"><a href="pls_chillforce.html#cb357-2" tabindex="-1"></a>                        <span class="at">running_mean =</span> <span class="dv">11</span>,</span>
<span id="cb357-3"><a href="pls_chillforce.html#cb357-3" tabindex="-1"></a>                        <span class="at">models =</span> <span class="fu">list</span>(<span class="at">Chilling_Hours =</span> Chilling_Hours,</span>
<span id="cb357-4"><a href="pls_chillforce.html#cb357-4" tabindex="-1"></a>                                      <span class="at">Utah_Chill_Units =</span> Utah_Model,</span>
<span id="cb357-5"><a href="pls_chillforce.html#cb357-5" tabindex="-1"></a>                                      <span class="at">Chill_Portions =</span> Dynamic_Model,</span>
<span id="cb357-6"><a href="pls_chillforce.html#cb357-6" tabindex="-1"></a>                                      <span class="at">GDH =</span> GDH)</span>
<span id="cb357-7"><a href="pls_chillforce.html#cb357-7" tabindex="-1"></a>                        )</span>
<span id="cb357-8"><a href="pls_chillforce.html#cb357-8" tabindex="-1"></a></span>
<span id="cb357-9"><a href="pls_chillforce.html#cb357-9" tabindex="-1"></a>plscf <span class="ot">&lt;-</span> <span class="fu">PLS_chill_force</span>(<span class="at">daily_chill_obj =</span> daychill,</span>
<span id="cb357-10"><a href="pls_chillforce.html#cb357-10" tabindex="-1"></a>                         <span class="at">bio_data_frame =</span> Alex_first,</span>
<span id="cb357-11"><a href="pls_chillforce.html#cb357-11" tabindex="-1"></a>                         <span class="at">split_month =</span> <span class="dv">6</span>,</span>
<span id="cb357-12"><a href="pls_chillforce.html#cb357-12" tabindex="-1"></a>                         <span class="at">chill_models =</span> <span class="fu">c</span>(<span class="st">&quot;Chilling_Hours&quot;</span>,</span>
<span id="cb357-13"><a href="pls_chillforce.html#cb357-13" tabindex="-1"></a>                                          <span class="st">&quot;Utah_Chill_Units&quot;</span>,</span>
<span id="cb357-14"><a href="pls_chillforce.html#cb357-14" tabindex="-1"></a>                                          <span class="st">&quot;Chill_Portions&quot;</span>),</span>
<span id="cb357-15"><a href="pls_chillforce.html#cb357-15" tabindex="-1"></a>                       <span class="at">heat_models =</span> <span class="fu">c</span>(<span class="st">&quot;GDH&quot;</span>))</span>
<span id="cb357-16"><a href="pls_chillforce.html#cb357-16" tabindex="-1"></a></span>
<span id="cb357-17"><a href="pls_chillforce.html#cb357-17" tabindex="-1"></a><span class="fu">plot_PLS_chill_force</span>(plscf,</span>
<span id="cb357-18"><a href="pls_chillforce.html#cb357-18" tabindex="-1"></a>                     <span class="at">chill_metric =</span> <span class="st">&quot;Chilling_Hours&quot;</span>,</span>
<span id="cb357-19"><a href="pls_chillforce.html#cb357-19" tabindex="-1"></a>                     <span class="at">heat_metric =</span> <span class="st">&quot;GDH&quot;</span>,</span>
<span id="cb357-20"><a href="pls_chillforce.html#cb357-20" tabindex="-1"></a>                     <span class="at">chill_label =</span> <span class="st">&quot;CH&quot;</span>,</span>
<span id="cb357-21"><a href="pls_chillforce.html#cb357-21" tabindex="-1"></a>                     <span class="at">heat_label =</span> <span class="st">&quot;GDH&quot;</span>,</span>
<span id="cb357-22"><a href="pls_chillforce.html#cb357-22" tabindex="-1"></a>                     <span class="at">chill_phase =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb357-23"><a href="pls_chillforce.html#cb357-23" tabindex="-1"></a>                     <span class="at">heat_phase =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-223-1.png" width="672" /></p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="pls_chillforce.html#cb358-1" tabindex="-1"></a><span class="fu">plot_PLS_chill_force</span>(plscf,</span>
<span id="cb358-2"><a href="pls_chillforce.html#cb358-2" tabindex="-1"></a>                     <span class="at">chill_metric =</span> <span class="st">&quot;Utah_Chill_Units&quot;</span>,</span>
<span id="cb358-3"><a href="pls_chillforce.html#cb358-3" tabindex="-1"></a>                     <span class="at">heat_metric =</span> <span class="st">&quot;GDH&quot;</span>,</span>
<span id="cb358-4"><a href="pls_chillforce.html#cb358-4" tabindex="-1"></a>                     <span class="at">chill_label =</span> <span class="st">&quot;CU&quot;</span>,</span>
<span id="cb358-5"><a href="pls_chillforce.html#cb358-5" tabindex="-1"></a>                     <span class="at">heat_label =</span> <span class="st">&quot;GDH&quot;</span>,</span>
<span id="cb358-6"><a href="pls_chillforce.html#cb358-6" tabindex="-1"></a>                     <span class="at">chill_phase =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb358-7"><a href="pls_chillforce.html#cb358-7" tabindex="-1"></a>                     <span class="at">heat_phase =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-223-2.png" width="672" /></p>
<p>So the other two common models aren’t so great at picking up the chilling period either. We’ll reflect on why this is happening later.</p>
</div>
<div id="exercises_PLS_chill_force" class="section level2 unnumbered hasAnchor">
<h2><code>Exercises</code> on chill model comparison<a href="pls_chillforce.html#exercises_PLS_chill_force" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Please document all results of the following assignments in your <code>learning logbook</code>.</p>
<ol style="list-style-type: decimal">
<li>Repeat the <code>PLS_chill_force</code> procedure for the ‘Roter Boskoop’ dataset. Include plots of daily chill and heat accumulation.</li>
<li>Run <code>PLS_chill_force</code> analyses for all three major chill models. Delineate your best estimates of chilling and forcing phases for all of them.</li>
<li>Plot results for all three analyses, including shaded plot areas for the chilling and forcing periods you estimated.</li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="pls_reflection.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="pls_chillforce_ex.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Book.pdf", "Book.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
