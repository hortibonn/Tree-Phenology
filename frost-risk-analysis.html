<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 33 Frost risk analysis | Tree phenology analysis with R</title>
  <meta name="description" content="This lecture introduces the chillR package for R." />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 33 Frost risk analysis | Tree phenology analysis with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This lecture introduces the chillR package for R." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 33 Frost risk analysis | Tree phenology analysis with R" />
  
  <meta name="twitter:description" content="This lecture introduces the chillR package for R." />
  

<meta name="author" content="Eike Luedeling" />


<meta name="date" content="2024-11-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="phenoflex3.html"/>
<link rel="next" href="a-robust-method-to-estimate-future-frost-risks.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.2/leaflet.js"></script>
<script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/font-awesome-6.5.2/js/script.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 1em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Tree phenology analysis with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#objectives"><i class="fa fa-check"></i><b>1.1</b> Objectives</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#performance-assessment"><i class="fa fa-check"></i><b>1.2</b> Performance assessment</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#house-rules"><i class="fa fa-check"></i><b>1.3</b> House rules</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="the-tools-we-use.html"><a href="the-tools-we-use.html"><i class="fa fa-check"></i><b>2</b> The tools we use</a>
<ul>
<li class="chapter" data-level="2.1" data-path="the-tools-we-use.html"><a href="the-tools-we-use.html#r-and-rstudio"><i class="fa fa-check"></i><b>2.1</b> R and RStudio</a></li>
<li class="chapter" data-level="2.2" data-path="the-tools-we-use.html"><a href="the-tools-we-use.html#git-and-github"><i class="fa fa-check"></i><b>2.2</b> git and github</a></li>
<li class="chapter" data-level="2.3" data-path="the-tools-we-use.html"><a href="the-tools-we-use.html#rmarkdown"><i class="fa fa-check"></i><b>2.3</b> Rmarkdown</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tree-dormancy.html"><a href="tree-dormancy.html"><i class="fa fa-check"></i><b>3</b> Tree dormancy</a>
<ul>
<li class="chapter" data-level="3.1" data-path="tree-dormancy.html"><a href="tree-dormancy.html#learning-goals-for-this-lesson"><i class="fa fa-check"></i><b>3.1</b> Learning goals for this lesson:</a></li>
<li class="chapter" data-level="3.2" data-path="tree-dormancy.html"><a href="tree-dormancy.html#introduction-to-dormancy"><i class="fa fa-check"></i><b>3.2</b> Introduction to dormancy</a></li>
<li class="chapter" data-level="3.3" data-path="tree-dormancy.html"><a href="tree-dormancy.html#dormancy-physiology"><i class="fa fa-check"></i><b>3.3</b> Dormancy physiology</a></li>
<li class="chapter" data-level="3.4" data-path="tree-dormancy.html"><a href="tree-dormancy.html#experimental-and-statistical-determination-of-the-chilling-and-forcing-periods"><i class="fa fa-check"></i><b>3.4</b> Experimental and statistical determination of the chilling and forcing periods</a></li>
<li class="chapter" data-level="3.5" data-path="tree-dormancy.html"><a href="tree-dormancy.html#phenology-record-and-bbch-scale"><i class="fa fa-check"></i><b>3.5</b> Phenology record and BBCH scale</a></li>
<li class="chapter" data-level="" data-path="tree-dormancy.html"><a href="tree-dormancy.html#exercises_dormancy"><i class="fa fa-check"></i><code>Exercises</code> on tree dormancy</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html"><i class="fa fa-check"></i><b>4</b> Climate change and impact projection</a>
<ul>
<li class="chapter" data-level="4.1" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#the-drivers-of-climate-change"><i class="fa fa-check"></i><b>4.1</b> The drivers of climate change</a></li>
<li class="chapter" data-level="4.2" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#what-weve-already-seen"><i class="fa fa-check"></i><b>4.2</b> What we’ve already seen</a></li>
<li class="chapter" data-level="4.3" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#future-scenarios"><i class="fa fa-check"></i><b>4.3</b> Future scenarios</a></li>
<li class="chapter" data-level="4.4" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#impact-projection-approaches"><i class="fa fa-check"></i><b>4.4</b> Impact projection approaches</a></li>
<li class="chapter" data-level="" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#exercises_climate_change"><i class="fa fa-check"></i><code>Exercises</code> on climate change</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html"><i class="fa fa-check"></i><b>5</b> Winter chill projections</a>
<ul>
<li class="chapter" data-level="" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#goals_analysis_examples"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="5.1" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-projections-1"><i class="fa fa-check"></i><b>5.1</b> Winter chill projections</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-oman"><i class="fa fa-check"></i><b>5.1.1</b> Winter chill in Oman</a></li>
<li class="chapter" data-level="5.1.2" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-model-sensitivity"><i class="fa fa-check"></i><b>5.1.2</b> Chill model sensitivity</a></li>
<li class="chapter" data-level="5.1.3" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-california"><i class="fa fa-check"></i><b>5.1.3</b> Winter chill in California</a></li>
<li class="chapter" data-level="5.1.4" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-ratios"><i class="fa fa-check"></i><b>5.1.4</b> Winter chill ratios</a></li>
<li class="chapter" data-level="5.1.5" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#a-global-projection-of-future-winter-chill"><i class="fa fa-check"></i><b>5.1.5</b> A global projection of future winter chill</a></li>
<li class="chapter" data-level="5.1.6" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-germany"><i class="fa fa-check"></i><b>5.1.6</b> Winter chill in Germany</a></li>
<li class="chapter" data-level="5.1.7" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-tunisia"><i class="fa fa-check"></i><b>5.1.7</b> Winter chill in Tunisia</a></li>
<li class="chapter" data-level="5.1.8" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-chile"><i class="fa fa-check"></i><b>5.1.8</b> Winter chill in Chile</a></li>
<li class="chapter" data-level="5.1.9" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-projection-for-patagonia"><i class="fa fa-check"></i><b>5.1.9</b> Chill projection for Patagonia</a></li>
<li class="chapter" data-level="5.1.10" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-model-comparison"><i class="fa fa-check"></i><b>5.1.10</b> Chill model comparison</a></li>
<li class="chapter" data-level="5.1.11" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-projection-for-all-of-tunisia"><i class="fa fa-check"></i><b>5.1.11</b> Chill projection for all of Tunisia</a></li>
<li class="chapter" data-level="5.1.12" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#revisiting-chill-accumulation-in-oman"><i class="fa fa-check"></i><b>5.1.12</b> Revisiting chill accumulation in Oman</a></li>
<li class="chapter" data-level="5.1.13" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#future-studies"><i class="fa fa-check"></i><b>5.1.13</b> Future studies?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#exercises_past_studies"><i class="fa fa-check"></i><code>Exercises</code> on past chill projections</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="manual-chill-analysis.html"><a href="manual-chill-analysis.html"><i class="fa fa-check"></i><b>6</b> Manual chill analysis</a>
<ul>
<li class="chapter" data-level="" data-path="manual-chill-analysis.html"><a href="manual-chill-analysis.html#goals_manual_chill_analysis"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="6.1" data-path="manual-chill-analysis.html"><a href="manual-chill-analysis.html#computing-chilling-hours-from-hourly-temperature-data"><i class="fa fa-check"></i><b>6.1</b> Computing Chilling Hours from hourly temperature data</a></li>
<li class="chapter" data-level="6.2" data-path="manual-chill-analysis.html"><a href="manual-chill-analysis.html#our-first-chill-function"><i class="fa fa-check"></i><b>6.2</b> Our first chill function</a></li>
<li class="chapter" data-level="" data-path="manual-chill-analysis.html"><a href="manual-chill-analysis.html#exercises_manual_chill_analysis"><i class="fa fa-check"></i><code>Exercises</code> on basic chill modeling</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chill-models.html"><a href="chill-models.html"><i class="fa fa-check"></i><b>7</b> Chill models</a>
<ul>
<li class="chapter" data-level="" data-path="chill-models.html"><a href="chill-models.html#goals_chill_models"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="7.1" data-path="chill-models.html"><a href="chill-models.html#chill-models-in-chillr"><i class="fa fa-check"></i><b>7.1</b> Chill models in <code>chillR</code></a></li>
<li class="chapter" data-level="" data-path="chill-models.html"><a href="chill-models.html#exercises_chill_models"><i class="fa fa-check"></i><code>Exercises</code> on chill models</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html"><i class="fa fa-check"></i><b>8</b> Making hourly temperatures</a>
<ul>
<li class="chapter" data-level="" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#goals_hourly"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="8.1" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#generating-hourly-temperatures"><i class="fa fa-check"></i><b>8.1</b> Generating hourly temperatures</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#idealized-daily-temperature-curves"><i class="fa fa-check"></i><b>8.1.1</b> Idealized daily temperature curves</a></li>
<li class="chapter" data-level="8.1.2" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#empirical-daily-temperature-curves"><i class="fa fa-check"></i><b>8.1.2</b> Empirical daily temperature curves</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#exercises_hourly"><i class="fa fa-check"></i><code>Exercises</code> on hourly temperatures</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html"><i class="fa fa-check"></i><b>9</b> Some useful tools in R</a>
<ul>
<li class="chapter" data-level="" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#goals_R_tools"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="9.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#an-evolving-language---and-a-lifelong-learning-process"><i class="fa fa-check"></i><b>9.1</b> An evolving language - and a lifelong learning process</a></li>
<li class="chapter" data-level="9.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-tidyverse"><i class="fa fa-check"></i><b>9.2</b> The <code>tidyverse</code></a></li>
<li class="chapter" data-level="9.3" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-ggplot2-package"><i class="fa fa-check"></i><b>9.3</b> The <code>ggplot2</code> package</a></li>
<li class="chapter" data-level="9.4" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-tibble-package"><i class="fa fa-check"></i><b>9.4</b> The <code>tibble</code> package</a></li>
<li class="chapter" data-level="9.5" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-magrittr-package---pipes"><i class="fa fa-check"></i><b>9.5</b> The <code>magrittr</code> package - pipes</a></li>
<li class="chapter" data-level="9.6" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-tidyr-package"><i class="fa fa-check"></i><b>9.6</b> The <code>tidyr</code> package</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#pivot_longer"><i class="fa fa-check"></i><b>9.6.1</b> <code>pivot_longer</code></a></li>
<li class="chapter" data-level="9.6.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#pivot_wider"><i class="fa fa-check"></i><b>9.6.2</b> <code>pivot_wider</code></a></li>
<li class="chapter" data-level="9.6.3" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#select"><i class="fa fa-check"></i><b>9.6.3</b> <code>select</code></a></li>
<li class="chapter" data-level="9.6.4" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#filter"><i class="fa fa-check"></i><b>9.6.4</b> <code>filter</code></a></li>
<li class="chapter" data-level="9.6.5" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#mutate"><i class="fa fa-check"></i><b>9.6.5</b> <code>mutate</code></a></li>
<li class="chapter" data-level="9.6.6" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#arrange"><i class="fa fa-check"></i><b>9.6.6</b> <code>arrange</code></a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#loops"><i class="fa fa-check"></i><b>9.7</b> Loops</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#for-loops"><i class="fa fa-check"></i><b>9.7.1</b> <em>For</em> loops</a></li>
<li class="chapter" data-level="9.7.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#while-loops"><i class="fa fa-check"></i><b>9.7.2</b> <em>While</em> loops</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#apply-functions"><i class="fa fa-check"></i><b>9.8</b> <code>apply</code> functions</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#sapply"><i class="fa fa-check"></i><b>9.8.1</b> <code>sapply</code></a></li>
<li class="chapter" data-level="9.8.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#lapply"><i class="fa fa-check"></i><b>9.8.2</b> <code>lapply</code></a></li>
<li class="chapter" data-level="9.8.3" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#apply"><i class="fa fa-check"></i><b>9.8.3</b> <code>apply</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#exercises_R_tools"><i class="fa fa-check"></i><code>Exercises</code> on useful R tools</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="get_temp_data.html"><a href="get_temp_data.html"><i class="fa fa-check"></i><b>10</b> Getting temperature data</a>
<ul>
<li class="chapter" data-level="" data-path="get_temp_data.html"><a href="get_temp_data.html#goals_get_temps"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="10.1" data-path="get_temp_data.html"><a href="get_temp_data.html#temperature-data-needs"><i class="fa fa-check"></i><b>10.1</b> Temperature data needs</a></li>
<li class="chapter" data-level="10.2" data-path="get_temp_data.html"><a href="get_temp_data.html#the-global-summary-of-the-day-database"><i class="fa fa-check"></i><b>10.2</b> The Global Summary of the Day database</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="get_temp_data.html"><a href="get_temp_data.html#actionlist_stations"><i class="fa fa-check"></i><b>10.2.1</b> <code>action=list_stations</code></a></li>
<li class="chapter" data-level="10.2.2" data-path="get_temp_data.html"><a href="get_temp_data.html#actiondownload_weather"><i class="fa fa-check"></i><b>10.2.2</b> <code>action="download_weather"</code></a></li>
<li class="chapter" data-level="10.2.3" data-path="get_temp_data.html"><a href="get_temp_data.html#downloaded-weather-as-action-argument"><i class="fa fa-check"></i><b>10.2.3</b> downloaded weather as <code>action</code> argument</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="get_temp_data.html"><a href="get_temp_data.html#exercises_getting"><i class="fa fa-check"></i><code>Exercises</code> on getting temperature data</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html"><i class="fa fa-check"></i><b>11</b> Filling gaps in temperature records</a>
<ul>
<li class="chapter" data-level="" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#goals_gaps"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="11.1" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#gaps"><i class="fa fa-check"></i><b>11.1</b> Gaps</a></li>
<li class="chapter" data-level="11.2" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#filling-short-gaps-in-daily-records"><i class="fa fa-check"></i><b>11.2</b> Filling short gaps in daily records</a></li>
<li class="chapter" data-level="11.3" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#filling-long-gaps-in-daily-records"><i class="fa fa-check"></i><b>11.3</b> Filling long gaps in daily records</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#bias-correction-for-shorter-intervals"><i class="fa fa-check"></i><b>11.3.1</b> Bias-correction for shorter intervals</a></li>
<li class="chapter" data-level="11.3.2" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#saving-the-data-for-later"><i class="fa fa-check"></i><b>11.3.2</b> Saving the data for later</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#filling-gaps-in-hourly-records"><i class="fa fa-check"></i><b>11.4</b> Filling gaps in hourly records</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#accuracy-assessment"><i class="fa fa-check"></i><b>11.4.1</b> Accuracy assessment</a></li>
<li class="chapter" data-level="11.4.2" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#computing-agroclimatic-metrics"><i class="fa fa-check"></i><b>11.4.2</b> Computing agroclimatic metrics</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#exercises_patching"><i class="fa fa-check"></i><code>Exercises</code> on filling gaps</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html"><i class="fa fa-check"></i><b>12</b> Generating temperature scenarios</a>
<ul>
<li class="chapter" data-level="" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html#goals_temperature_scenarios"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="12.1" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html#chill-scenarios"><i class="fa fa-check"></i><b>12.1</b> Chill scenarios</a></li>
<li class="chapter" data-level="12.2" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html#risk-assessment-in-orchard-planning"><i class="fa fa-check"></i><b>12.2</b> Risk assessment in orchard planning</a></li>
<li class="chapter" data-level="12.3" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html#weather-generators"><i class="fa fa-check"></i><b>12.3</b> Weather generators</a></li>
<li class="chapter" data-level="12.4" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html#weather-generation-in-chillr"><i class="fa fa-check"></i><b>12.4</b> Weather generation in <code>chillR</code></a></li>
<li class="chapter" data-level="" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html#weather_generation_exercises"><i class="fa fa-check"></i><code>Exercises</code> on temperature generation</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="saving-and-loading-data-and-hiding-this-in-markdown.html"><a href="saving-and-loading-data-and-hiding-this-in-markdown.html"><i class="fa fa-check"></i><b>13</b> Saving and loading data (and hiding this in markdown)</a>
<ul>
<li class="chapter" data-level="13.1" data-path="saving-and-loading-data-and-hiding-this-in-markdown.html"><a href="saving-and-loading-data-and-hiding-this-in-markdown.html#learning-goals-for-this-lesson-1"><i class="fa fa-check"></i><b>13.1</b> Learning Goals for this lesson:</a></li>
<li class="chapter" data-level="13.2" data-path="saving-and-loading-data-and-hiding-this-in-markdown.html"><a href="saving-and-loading-data-and-hiding-this-in-markdown.html#saving-and-loading-data"><i class="fa fa-check"></i><b>13.2</b> Saving and loading data</a></li>
<li class="chapter" data-level="13.3" data-path="saving-and-loading-data-and-hiding-this-in-markdown.html"><a href="saving-and-loading-data-and-hiding-this-in-markdown.html#hiding-all-this-from-the-readers-of-our-markdown-file"><i class="fa fa-check"></i><b>13.3</b> Hiding all this from the readers of our markdown file</a></li>
<li class="chapter" data-level="" data-path="saving-and-loading-data-and-hiding-this-in-markdown.html"><a href="saving-and-loading-data-and-hiding-this-in-markdown.html#exercises_saveLoad"><i class="fa fa-check"></i><code>Exercises</code> on saving and loading data</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="historic-temperature-scenarios.html"><a href="historic-temperature-scenarios.html"><i class="fa fa-check"></i><b>14</b> Historic temperature scenarios</a>
<ul>
<li class="chapter" data-level="" data-path="historic-temperature-scenarios.html"><a href="historic-temperature-scenarios.html#goals_hist_temp_scen"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="14.1" data-path="historic-temperature-scenarios.html"><a href="historic-temperature-scenarios.html#climate-change-scenarios"><i class="fa fa-check"></i><b>14.1</b> Climate change scenarios</a></li>
<li class="chapter" data-level="14.2" data-path="historic-temperature-scenarios.html"><a href="historic-temperature-scenarios.html#making-historic-temperature-scenarios"><i class="fa fa-check"></i><b>14.2</b> Making historic temperature scenarios</a></li>
<li class="chapter" data-level="" data-path="historic-temperature-scenarios.html"><a href="historic-temperature-scenarios.html#exercises_historic_scenarios"><i class="fa fa-check"></i><code>Exercises</code> on generating historic temperature scenarios</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="future-temperature-scenarios.html"><a href="future-temperature-scenarios.html"><i class="fa fa-check"></i><b>15</b> Future temperature scenarios</a>
<ul>
<li class="chapter" data-level="" data-path="future-temperature-scenarios.html"><a href="future-temperature-scenarios.html#goals_future_temp_scen"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="15.1" data-path="future-temperature-scenarios.html"><a href="future-temperature-scenarios.html#impacts-of-future-climate-change"><i class="fa fa-check"></i><b>15.1</b> Impacts of future climate change</a></li>
<li class="chapter" data-level="15.2" data-path="future-temperature-scenarios.html"><a href="future-temperature-scenarios.html#future-climate-scenarios"><i class="fa fa-check"></i><b>15.2</b> Future climate scenarios</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="future-temperature-scenarios.html"><a href="future-temperature-scenarios.html#some-background-on-climate-models-and-warming-pathways"><i class="fa fa-check"></i><b>15.2.1</b> Some background on climate models and warming pathways</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="future-temperature-scenarios.html"><a href="future-temperature-scenarios.html#exercises_future_scenarios"><i class="fa fa-check"></i><code>Exercises</code> on future temperature scenarios</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html"><i class="fa fa-check"></i><b>16</b> Making CMIP6 scenarios</a>
<ul>
<li class="chapter" data-level="" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html#goals_CMIP6"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="16.1" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html#accessing-gridded-climate-data-from-the-copernicus-climate-data-store"><i class="fa fa-check"></i><b>16.1</b> Accessing gridded climate data from the Copernicus climate data store</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html#downloading-future-climate-data"><i class="fa fa-check"></i><b>16.1.1</b> Downloading future climate data</a></li>
<li class="chapter" data-level="16.1.2" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html#generating-change-scenarios"><i class="fa fa-check"></i><b>16.1.2</b> Generating change scenarios</a></li>
<li class="chapter" data-level="16.1.3" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html#extracting-data-from-the-grids"><i class="fa fa-check"></i><b>16.1.3</b> Extracting data from the grids</a></li>
<li class="chapter" data-level="16.1.4" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html#baseline-adjustment"><i class="fa fa-check"></i><b>16.1.4</b> Baseline adjustment</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html#exercises_CMIP6"><i class="fa fa-check"></i><code>Exercises</code> on generating CMIP6 temperature scenarios</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="making-cmip5-scenarios-with-the-climatewizard.html"><a href="making-cmip5-scenarios-with-the-climatewizard.html"><i class="fa fa-check"></i><b>17</b> Making CMIP5 scenarios with the <code>ClimateWizard</code></a>
<ul>
<li class="chapter" data-level="" data-path="making-cmip5-scenarios-with-the-climatewizard.html"><a href="making-cmip5-scenarios-with-the-climatewizard.html#goals_ClimateWizard"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="17.1" data-path="making-cmip5-scenarios-with-the-climatewizard.html"><a href="making-cmip5-scenarios-with-the-climatewizard.html#using-the-climatewizard"><i class="fa fa-check"></i><b>17.1</b> Using the <code>ClimateWizard</code></a></li>
<li class="chapter" data-level="" data-path="making-cmip5-scenarios-with-the-climatewizard.html"><a href="making-cmip5-scenarios-with-the-climatewizard.html#exercises_ClimateWizard"><i class="fa fa-check"></i><code>Exercises</code> on generating CMIP5 temperature scenarios</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="plot_future.html"><a href="plot_future.html"><i class="fa fa-check"></i><b>18</b> Plotting future scenarios</a>
<ul>
<li class="chapter" data-level="" data-path="plot_future.html"><a href="plot_future.html#goals_future_plots"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="18.1" data-path="plot_future.html"><a href="plot_future.html#making-attractive-plots"><i class="fa fa-check"></i><b>18.1</b> Making attractive plots</a></li>
<li class="chapter" data-level="18.2" data-path="plot_future.html"><a href="plot_future.html#the-results"><i class="fa fa-check"></i><b>18.2</b> The results</a></li>
<li class="chapter" data-level="" data-path="plot_future.html"><a href="plot_future.html#exercises_future_plots"><i class="fa fa-check"></i><code>Exercises</code> on plotting future projections</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="chill_model_comparison.html"><a href="chill_model_comparison.html"><i class="fa fa-check"></i><b>19</b> Chill model comparison</a>
<ul>
<li class="chapter" data-level="" data-path="chill_model_comparison.html"><a href="chill_model_comparison.html#goals_chill_model"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="19.1" data-path="chill_model_comparison.html"><a href="chill_model_comparison.html#safe-winter-chill"><i class="fa fa-check"></i><b>19.1</b> Safe Winter Chill</a></li>
<li class="chapter" data-level="19.2" data-path="chill_model_comparison.html"><a href="chill_model_comparison.html#chill-metrics"><i class="fa fa-check"></i><b>19.2</b> Chill metrics</a></li>
<li class="chapter" data-level="19.3" data-path="chill_model_comparison.html"><a href="chill_model_comparison.html#an-animated-plot-of-relative-changes-in-safe-winter-chill"><i class="fa fa-check"></i><b>19.3</b> An animated plot of relative changes in Safe Winter Chill</a></li>
<li class="chapter" data-level="" data-path="chill_model_comparison.html"><a href="chill_model_comparison.html#exercises_chill_model_comparison"><i class="fa fa-check"></i><code>Exercises</code> on chill model comparison</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="simple_phenology.html"><a href="simple_phenology.html"><i class="fa fa-check"></i><b>20</b> Simple phenology analysis</a>
<ul>
<li class="chapter" data-level="" data-path="simple_phenology.html"><a href="simple_phenology.html#goals_simple_phenology"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="20.1" data-path="simple_phenology.html"><a href="simple_phenology.html#phenology-analysis"><i class="fa fa-check"></i><b>20.1</b> Phenology analysis</a></li>
<li class="chapter" data-level="20.2" data-path="simple_phenology.html"><a href="simple_phenology.html#time-series-analysis"><i class="fa fa-check"></i><b>20.2</b> Time series analysis</a></li>
<li class="chapter" data-level="20.3" data-path="simple_phenology.html"><a href="simple_phenology.html#p-hacking"><i class="fa fa-check"></i><b>20.3</b> p-hacking</a></li>
<li class="chapter" data-level="20.4" data-path="simple_phenology.html"><a href="simple_phenology.html#the-process-that-generates-the-data"><i class="fa fa-check"></i><b>20.4</b> The process that generates the data</a></li>
<li class="chapter" data-level="20.5" data-path="simple_phenology.html"><a href="simple_phenology.html#an-ecological-theory-to-guide-our-analysis"><i class="fa fa-check"></i><b>20.5</b> An ecological theory to guide our analysis</a></li>
<li class="chapter" data-level="20.6" data-path="simple_phenology.html"><a href="simple_phenology.html#temperature-correlations"><i class="fa fa-check"></i><b>20.6</b> Temperature correlations</a></li>
<li class="chapter" data-level="" data-path="simple_phenology.html"><a href="simple_phenology.html#exercises_simple_analysis"><i class="fa fa-check"></i><code>Exercises</code> on simple phenology analysis</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="pls_intro.html"><a href="pls_intro.html"><i class="fa fa-check"></i><b>21</b> Delineating temperature response phases with PLS regression</a>
<ul>
<li class="chapter" data-level="" data-path="pls_intro.html"><a href="pls_intro.html#goals_PLS_intro"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="21.1" data-path="pls_intro.html"><a href="pls_intro.html#detecting-temperature-response-phases"><i class="fa fa-check"></i><b>21.1</b> Detecting temperature response phases</a></li>
<li class="chapter" data-level="21.2" data-path="pls_intro.html"><a href="pls_intro.html#finding-signals-in-hyperspectral-remote-sensing-data"><i class="fa fa-check"></i><b>21.2</b> Finding signals in hyperspectral remote sensing data</a></li>
<li class="chapter" data-level="21.3" data-path="pls_intro.html"><a href="pls_intro.html#pls-regression-for-phenology-analysis"><i class="fa fa-check"></i><b>21.3</b> PLS regression for phenology analysis</a></li>
<li class="chapter" data-level="21.4" data-path="pls_intro.html"><a href="pls_intro.html#a-note-of-caution-about-pls-results"><i class="fa fa-check"></i><b>21.4</b> A note of caution about PLS results</a></li>
<li class="chapter" data-level="21.5" data-path="pls_intro.html"><a href="pls_intro.html#pls-analysis-of-alexander-lucas-pears-in-klein-altendorf"><i class="fa fa-check"></i><b>21.5</b> PLS analysis of ‘Alexander Lucas’ pears in Klein-Altendorf</a></li>
<li class="chapter" data-level="" data-path="pls_intro.html"><a href="pls_intro.html#exercises_first_PLS"><i class="fa fa-check"></i><code>Exercises</code> on chill model comparison</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="pls_reflection.html"><a href="pls_reflection.html"><i class="fa fa-check"></i><b>22</b> Successes and limitations of PLS regression analysis</a>
<ul>
<li class="chapter" data-level="" data-path="pls_reflection.html"><a href="pls_reflection.html#goals_PLS_reflection"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="22.1" data-path="pls_reflection.html"><a href="pls_reflection.html#pls-regression"><i class="fa fa-check"></i><b>22.1</b> PLS regression</a></li>
<li class="chapter" data-level="22.2" data-path="pls_reflection.html"><a href="pls_reflection.html#pls-examples"><i class="fa fa-check"></i><b>22.2</b> PLS examples</a>
<ul>
<li class="chapter" data-level="22.2.1" data-path="pls_reflection.html"><a href="pls_reflection.html#grasslands-on-the-tibetan-plateau"><i class="fa fa-check"></i><b>22.2.1</b> Grasslands on the Tibetan Plateau</a></li>
<li class="chapter" data-level="22.2.2" data-path="pls_reflection.html"><a href="pls_reflection.html#deciduous-trees"><i class="fa fa-check"></i><b>22.2.2</b> Deciduous trees</a></li>
<li class="chapter" data-level="22.2.3" data-path="pls_reflection.html"><a href="pls_reflection.html#why-were-not-seeing-the-chilling-phase"><i class="fa fa-check"></i><b>22.2.3</b> Why we’re not seeing the chilling phase</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="pls_reflection.html"><a href="pls_reflection.html#exercises_PLS_reflection"><i class="fa fa-check"></i><code>Exercises</code> on chill model comparison</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="pls_chillforce.html"><a href="pls_chillforce.html"><i class="fa fa-check"></i><b>23</b> PLS regression with agroclimatic metrics</a>
<ul>
<li class="chapter" data-level="" data-path="pls_chillforce.html"><a href="pls_chillforce.html#goals_PLS_chillforce"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="23.1" data-path="pls_chillforce.html"><a href="pls_chillforce.html#adjusting-pls-for-use-with-non-monotonic-relationships"><i class="fa fa-check"></i><b>23.1</b> Adjusting PLS for use with non-monotonic relationships</a></li>
<li class="chapter" data-level="23.2" data-path="pls_chillforce.html"><a href="pls_chillforce.html#pls-analysis-with-chilling-and-forcing-data"><i class="fa fa-check"></i><b>23.2</b> PLS analysis with chilling and forcing data</a></li>
<li class="chapter" data-level="23.3" data-path="pls_chillforce.html"><a href="pls_chillforce.html#delineating-chilling-and-forcing-periods"><i class="fa fa-check"></i><b>23.3</b> Delineating chilling and forcing periods</a></li>
<li class="chapter" data-level="23.4" data-path="pls_chillforce.html"><a href="pls_chillforce.html#ggplotting-the-results"><i class="fa fa-check"></i><b>23.4</b> <code>ggplot</code>ting the results</a></li>
<li class="chapter" data-level="" data-path="pls_chillforce.html"><a href="pls_chillforce.html#exercises_PLS_chill_force"><i class="fa fa-check"></i><code>Exercises</code> on chill model comparison</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html"><i class="fa fa-check"></i><b>24</b> Examples of PLS regression with agroclimatic metrics</a>
<ul>
<li class="chapter" data-level="" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#goals_PLS_chillforce_ex"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="24.1" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#pls-regression-across-species-and-agroclimatic-contexts"><i class="fa fa-check"></i><b>24.1</b> PLS regression across species and agroclimatic contexts</a>
<ul>
<li class="chapter" data-level="24.1.1" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#chestnut-jujube-and-apricot-in-beijing"><i class="fa fa-check"></i><b>24.1.1</b> Chestnut, jujube and apricot in Beijing</a></li>
<li class="chapter" data-level="24.1.2" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#apples-in-shaanxi-province-china"><i class="fa fa-check"></i><b>24.1.2</b> Apples in Shaanxi Province, China</a></li>
<li class="chapter" data-level="24.1.3" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#cherries-in-klein-altendorf"><i class="fa fa-check"></i><b>24.1.3</b> Cherries in Klein-Altendorf</a></li>
<li class="chapter" data-level="24.1.4" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#apricots-in-the-uk"><i class="fa fa-check"></i><b>24.1.4</b> Apricots in the UK</a></li>
<li class="chapter" data-level="24.1.5" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#grapevine-in-croatia"><i class="fa fa-check"></i><b>24.1.5</b> Grapevine in Croatia</a></li>
<li class="chapter" data-level="24.1.6" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#walnuts-in-california"><i class="fa fa-check"></i><b>24.1.6</b> Walnuts in California</a></li>
<li class="chapter" data-level="24.1.7" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#almonds-in-tunisia"><i class="fa fa-check"></i><b>24.1.7</b> Almonds in Tunisia</a></li>
<li class="chapter" data-level="24.1.8" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#pistachios-in-tunisia"><i class="fa fa-check"></i><b>24.1.8</b> Pistachios in Tunisia</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#exercises_PLS_chill_force_ex"><i class="fa fa-check"></i><code>Exercises</code> on examples of PLS regression with agroclimatic metrics</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html"><i class="fa fa-check"></i><b>25</b> Why PLS doesn’t always work</a>
<ul>
<li class="chapter" data-level="" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#goals_PLS_chillforce_reflection"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="25.1" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#disappointing-pls-performance"><i class="fa fa-check"></i><b>25.1</b> Disappointing PLS performance</a></li>
<li class="chapter" data-level="25.2" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#what-pls-regression-can-find"><i class="fa fa-check"></i><b>25.2</b> What PLS regression can find</a></li>
<li class="chapter" data-level="25.3" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#chill-model-sensitivity-vs.-observed-temperature"><i class="fa fa-check"></i><b>25.3</b> Chill model sensitivity vs. observed temperature</a>
<ul>
<li class="chapter" data-level="25.3.1" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#beijing-china"><i class="fa fa-check"></i><b>25.3.1</b> Beijing, China</a></li>
<li class="chapter" data-level="25.3.2" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#klein-altendorf-germany"><i class="fa fa-check"></i><b>25.3.2</b> Klein-Altendorf, Germany</a></li>
<li class="chapter" data-level="25.3.3" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#davis-california"><i class="fa fa-check"></i><b>25.3.3</b> Davis, California</a></li>
<li class="chapter" data-level="25.3.4" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#sfax-tunisia"><i class="fa fa-check"></i><b>25.3.4</b> Sfax, Tunisia</a></li>
</ul></li>
<li class="chapter" data-level="25.4" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#heat-model-sensitivity-vs.-observed-temperature"><i class="fa fa-check"></i><b>25.4</b> Heat model sensitivity vs. observed temperature</a></li>
<li class="chapter" data-level="" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#exercises_PLS_chillforce_reflection"><i class="fa fa-check"></i><code>Exercises</code> on expected PLS responsiveness</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="pls_eval_PLS.html"><a href="pls_eval_PLS.html"><i class="fa fa-check"></i><b>26</b> Evaluating PLS outputs</a>
<ul>
<li class="chapter" data-level="" data-path="pls_eval_PLS.html"><a href="pls_eval_PLS.html#goals_PLS_eval"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="26.1" data-path="pls_eval_PLS.html"><a href="pls_eval_PLS.html#chilling-and-forcing-requirements"><i class="fa fa-check"></i><b>26.1</b> Chilling and forcing requirements</a></li>
<li class="chapter" data-level="26.2" data-path="pls_eval_PLS.html"><a href="pls_eval_PLS.html#response-to-seasonal-temperature"><i class="fa fa-check"></i><b>26.2</b> Response to seasonal temperature</a></li>
<li class="chapter" data-level="26.3" data-path="pls_eval_PLS.html"><a href="pls_eval_PLS.html#applying-our-functions-to-california-walnuts"><i class="fa fa-check"></i><b>26.3</b> Applying our functions to California walnuts</a></li>
<li class="chapter" data-level="" data-path="pls_eval_PLS.html"><a href="pls_eval_PLS.html#exercises_PLS_eval"><i class="fa fa-check"></i><code>Exercises</code> on evaluating PLS regression results</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="pls_chillforce_relimp.html"><a href="pls_chillforce_relimp.html"><i class="fa fa-check"></i><b>27</b> The relative importance of chill and heat</a>
<ul>
<li class="chapter" data-level="" data-path="pls_chillforce_relimp.html"><a href="pls_chillforce_relimp.html#goals_PLS_chillforce_relimp"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="27.1" data-path="pls_chillforce_relimp.html"><a href="pls_chillforce_relimp.html#chilling-vs.-forcing-temperatures"><i class="fa fa-check"></i><b>27.1</b> Chilling vs. forcing temperatures</a></li>
<li class="chapter" data-level="27.2" data-path="pls_chillforce_relimp.html"><a href="pls_chillforce_relimp.html#patterns-in-temperature-responses"><i class="fa fa-check"></i><b>27.2</b> Patterns in temperature responses</a></li>
<li class="chapter" data-level="27.3" data-path="pls_chillforce_relimp.html"><a href="pls_chillforce_relimp.html#the-warm-end-of-the-spectrum"><i class="fa fa-check"></i><b>27.3</b> The warm end of the spectrum</a></li>
<li class="chapter" data-level="27.4" data-path="pls_chillforce_relimp.html"><a href="pls_chillforce_relimp.html#implications-of-our-hypothesis"><i class="fa fa-check"></i><b>27.4</b> Implications of our hypothesis</a></li>
<li class="chapter" data-level="" data-path="pls_chillforce_relimp.html"><a href="pls_chillforce_relimp.html#exercises_PLS_chillforce_relimp"><i class="fa fa-check"></i><code>Exercises</code> on the relative importance of chill and heat</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="exp_PLS.html"><a href="exp_PLS.html"><i class="fa fa-check"></i><b>28</b> Experimentally enhanced PLS</a>
<ul>
<li class="chapter" data-level="" data-path="exp_PLS.html"><a href="exp_PLS.html#goals_exp_PLS"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="28.1" data-path="exp_PLS.html"><a href="exp_PLS.html#enhanced-phenology-data"><i class="fa fa-check"></i><b>28.1</b> Enhanced phenology data</a></li>
<li class="chapter" data-level="" data-path="exp_PLS.html"><a href="exp_PLS.html#exc_exp_PLS"><i class="fa fa-check"></i><code>Exercises</code> on experimental PLS</a></li>
</ul></li>
<li class="chapter" data-level="29" data-path="model_validity.html"><a href="model_validity.html"><i class="fa fa-check"></i><b>29</b> Making valid tree phenology models</a>
<ul>
<li class="chapter" data-level="" data-path="model_validity.html"><a href="model_validity.html#goals_model_validity"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="29.1" data-path="model_validity.html"><a href="model_validity.html#the-modeling-challenge"><i class="fa fa-check"></i><b>29.1</b> The modeling challenge</a></li>
<li class="chapter" data-level="29.2" data-path="model_validity.html"><a href="model_validity.html#validating-models"><i class="fa fa-check"></i><b>29.2</b> Validating models</a></li>
<li class="chapter" data-level="29.3" data-path="model_validity.html"><a href="model_validity.html#mapping-validity-domains"><i class="fa fa-check"></i><b>29.3</b> Mapping validity domains</a></li>
<li class="chapter" data-level="29.4" data-path="model_validity.html"><a href="model_validity.html#one-last-thought-on-model-validity"><i class="fa fa-check"></i><b>29.4</b> One last thought on model validity</a></li>
<li class="chapter" data-level="" data-path="model_validity.html"><a href="model_validity.html#ex_model_validity"><i class="fa fa-check"></i><code>Exercises</code> on making valid tree phenology models</a></li>
</ul></li>
<li class="chapter" data-level="30" data-path="phenoflex.html"><a href="phenoflex.html"><i class="fa fa-check"></i><b>30</b> The <code>PhenoFlex</code> model</a>
<ul>
<li class="chapter" data-level="" data-path="phenoflex.html"><a href="phenoflex.html#goals_phenoflex"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="30.1" data-path="phenoflex.html"><a href="phenoflex.html#ingredients-of-this-lesson"><i class="fa fa-check"></i><b>30.1</b> Ingredients of this lesson</a></li>
<li class="chapter" data-level="30.2" data-path="phenoflex.html"><a href="phenoflex.html#towards-credible-phenology-models"><i class="fa fa-check"></i><b>30.2</b> Towards credible phenology models</a></li>
<li class="chapter" data-level="30.3" data-path="phenoflex.html"><a href="phenoflex.html#the-phenoflex-framework"><i class="fa fa-check"></i><b>30.3</b> The PhenoFlex framework</a></li>
<li class="chapter" data-level="30.4" data-path="phenoflex.html"><a href="phenoflex.html#running-phenoflex"><i class="fa fa-check"></i><b>30.4</b> Running <code>PhenoFlex</code></a></li>
<li class="chapter" data-level="30.5" data-path="phenoflex.html"><a href="phenoflex.html#parameterizing-phenoflex"><i class="fa fa-check"></i><b>30.5</b> Parameterizing <code>PhenoFlex</code></a></li>
<li class="chapter" data-level="30.6" data-path="phenoflex.html"><a href="phenoflex.html#conclusions-on-phenoflex"><i class="fa fa-check"></i><b>30.6</b> Conclusions on <code>PhenoFlex</code></a></li>
<li class="chapter" data-level="" data-path="phenoflex.html"><a href="phenoflex.html#ex_model_phenoflex"><i class="fa fa-check"></i><code>Exercises</code> on making valid tree phenology models</a></li>
</ul></li>
<li class="chapter" data-level="31" data-path="phenoflex2.html"><a href="phenoflex2.html"><i class="fa fa-check"></i><b>31</b> The <code>PhenoFlex</code> model - a second look</a>
<ul>
<li class="chapter" data-level="" data-path="phenoflex2.html"><a href="phenoflex2.html#goals_phenoflex2"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="31.1" data-path="phenoflex2.html"><a href="phenoflex2.html#some-basic-diagnostics-for-our-phenoflex-fit"><i class="fa fa-check"></i><b>31.1</b> Some basic diagnostics for our <code>PhenoFlex</code> fit</a></li>
<li class="chapter" data-level="31.2" data-path="phenoflex2.html"><a href="phenoflex2.html#temperature-response-of-the-phenoflex-components"><i class="fa fa-check"></i><b>31.2</b> Temperature response of the <code>PhenoFlex</code> components</a></li>
<li class="chapter" data-level="31.3" data-path="phenoflex2.html"><a href="phenoflex2.html#overall-impression"><i class="fa fa-check"></i><b>31.3</b> Overall impression</a></li>
<li class="chapter" data-level="31.4" data-path="phenoflex2.html"><a href="phenoflex2.html#caveats-and-assumptions"><i class="fa fa-check"></i><b>31.4</b> Caveats and assumptions</a></li>
<li class="chapter" data-level="31.5" data-path="phenoflex2.html"><a href="phenoflex2.html#outlook"><i class="fa fa-check"></i><b>31.5</b> Outlook</a></li>
<li class="chapter" data-level="" data-path="phenoflex2.html"><a href="phenoflex2.html#ex_phenoflex2"><i class="fa fa-check"></i><code>Exercises</code> on basic <code>PhenoFlex</code> diagnostics</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="phenoflex3.html"><a href="phenoflex3.html"><i class="fa fa-check"></i><b>32</b> Can we improve the performance of <code>PhenoFlex</code>?</a>
<ul>
<li class="chapter" data-level="" data-path="phenoflex3.html"><a href="phenoflex3.html#goals_phenoflex3"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="32.1" data-path="phenoflex3.html"><a href="phenoflex3.html#the-motivation"><i class="fa fa-check"></i><b>32.1</b> The motivation</a></li>
<li class="chapter" data-level="32.2" data-path="phenoflex3.html"><a href="phenoflex3.html#using-experimental-phenology-data-for-assessing-the-performance-of-phenoflex"><i class="fa fa-check"></i><b>32.2</b> Using experimental phenology data for assessing the performance of <code>PhenoFlex</code></a></li>
<li class="chapter" data-level="32.3" data-path="phenoflex3.html"><a href="phenoflex3.html#validation"><i class="fa fa-check"></i><b>32.3</b> Validation</a></li>
<li class="chapter" data-level="32.4" data-path="phenoflex3.html"><a href="phenoflex3.html#conclusions"><i class="fa fa-check"></i><b>32.4</b> Conclusions</a></li>
<li class="chapter" data-level="" data-path="phenoflex3.html"><a href="phenoflex3.html#ex_phenoflex3"><i class="fa fa-check"></i><code>Exercises</code> on improving the performance of <code>PhenoFlex</code></a></li>
</ul></li>
<li class="chapter" data-level="33" data-path="frost-risk-analysis.html"><a href="frost-risk-analysis.html"><i class="fa fa-check"></i><b>33</b> Frost risk analysis</a>
<ul>
<li class="chapter" data-level="" data-path="frost-risk-analysis.html"><a href="frost-risk-analysis.html#goals_frost_risk"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="33.1" data-path="frost-risk-analysis.html"><a href="frost-risk-analysis.html#spring-frost"><i class="fa fa-check"></i><b>33.1</b> Spring frost</a></li>
<li class="chapter" data-level="33.2" data-path="frost-risk-analysis.html"><a href="frost-risk-analysis.html#phenology-trend-analysis"><i class="fa fa-check"></i><b>33.2</b> Phenology trend analysis</a></li>
<li class="chapter" data-level="33.3" data-path="frost-risk-analysis.html"><a href="frost-risk-analysis.html#frost-risk"><i class="fa fa-check"></i><b>33.3</b> Frost risk</a></li>
<li class="chapter" data-level="" data-path="frost-risk-analysis.html"><a href="frost-risk-analysis.html#exercises_frost_risk"><i class="fa fa-check"></i><code>Exercises</code> on frost risk analysis</a></li>
</ul></li>
<li class="chapter" data-level="34" data-path="a-robust-method-to-estimate-future-frost-risks.html"><a href="a-robust-method-to-estimate-future-frost-risks.html"><i class="fa fa-check"></i><b>34</b> A robust method to estimate future frost risks (?)</a>
<ul>
<li class="chapter" data-level="" data-path="a-robust-method-to-estimate-future-frost-risks.html"><a href="a-robust-method-to-estimate-future-frost-risks.html#goals_future_frost_risk"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="34.1" data-path="a-robust-method-to-estimate-future-frost-risks.html"><a href="a-robust-method-to-estimate-future-frost-risks.html#frost-risk-for-future-scenarios"><i class="fa fa-check"></i><b>34.1</b> Frost risk for future scenarios</a></li>
<li class="chapter" data-level="34.2" data-path="a-robust-method-to-estimate-future-frost-risks.html"><a href="a-robust-method-to-estimate-future-frost-risks.html#validation-1"><i class="fa fa-check"></i><b>34.2</b> Validation</a></li>
<li class="chapter" data-level="34.3" data-path="a-robust-method-to-estimate-future-frost-risks.html"><a href="a-robust-method-to-estimate-future-frost-risks.html#exercises-for-this-chapter"><i class="fa fa-check"></i><b>34.3</b> <code>Exercises</code> for this chapter</a></li>
</ul></li>
<li class="chapter" data-level="35" data-path="major_concepts.html"><a href="major_concepts.html"><i class="fa fa-check"></i><b>35</b> Major concepts</a>
<ul>
<li class="chapter" data-level="" data-path="major_concepts.html"><a href="major_concepts.html#goals_major_concepts"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="35.1" data-path="major_concepts.html"><a href="major_concepts.html#key-insights"><i class="fa fa-check"></i><b>35.1</b> Key insights</a>
<ul>
<li class="chapter" data-level="35.1.1" data-path="major_concepts.html"><a href="major_concepts.html#tree-dormancy-1"><i class="fa fa-check"></i><b>35.1.1</b> Tree dormancy</a></li>
<li class="chapter" data-level="35.1.2" data-path="major_concepts.html"><a href="major_concepts.html#climate-change"><i class="fa fa-check"></i><b>35.1.2</b> Climate change</a></li>
<li class="chapter" data-level="35.1.3" data-path="major_concepts.html"><a href="major_concepts.html#phenology-modeling"><i class="fa fa-check"></i><b>35.1.3</b> Phenology modeling</a></li>
<li class="chapter" data-level="35.1.4" data-path="major_concepts.html"><a href="major_concepts.html#phenology-responses-to-global-warming"><i class="fa fa-check"></i><b>35.1.4</b> Phenology responses to global warming</a></li>
<li class="chapter" data-level="35.1.5" data-path="major_concepts.html"><a href="major_concepts.html#the-phenoflex-modeling-framework"><i class="fa fa-check"></i><b>35.1.5</b> The <code>PhenoFlex</code> modeling framework</a></li>
</ul></li>
<li class="chapter" data-level="35.2" data-path="major_concepts.html"><a href="major_concepts.html#major-concepts-weve-encountered"><i class="fa fa-check"></i><b>35.2</b> Major concepts we’ve encountered</a>
<ul>
<li class="chapter" data-level="35.2.1" data-path="major_concepts.html"><a href="major_concepts.html#reproducibility-and-transparency"><i class="fa fa-check"></i><b>35.2.1</b> Reproducibility and transparency</a></li>
<li class="chapter" data-level="35.2.2" data-path="major_concepts.html"><a href="major_concepts.html#tools"><i class="fa fa-check"></i><b>35.2.2</b> Tools</a></li>
<li class="chapter" data-level="35.2.3" data-path="major_concepts.html"><a href="major_concepts.html#automate-and-move-on"><i class="fa fa-check"></i><b>35.2.3</b> Automate and move on</a></li>
<li class="chapter" data-level="35.2.4" data-path="major_concepts.html"><a href="major_concepts.html#the-power-of-r"><i class="fa fa-check"></i><b>35.2.4</b> The power of R</a></li>
<li class="chapter" data-level="35.2.5" data-path="major_concepts.html"><a href="major_concepts.html#curiosity-and-interdisciplinarity"><i class="fa fa-check"></i><b>35.2.5</b> Curiosity and interdisciplinarity</a></li>
<li class="chapter" data-level="35.2.6" data-path="major_concepts.html"><a href="major_concepts.html#uncertainty"><i class="fa fa-check"></i><b>35.2.6</b> Uncertainty</a></li>
<li class="chapter" data-level="35.2.7" data-path="major_concepts.html"><a href="major_concepts.html#p-hacking-1"><i class="fa fa-check"></i><b>35.2.7</b> p-hacking</a></li>
<li class="chapter" data-level="35.2.8" data-path="major_concepts.html"><a href="major_concepts.html#the-dangers-of-machine-learning"><i class="fa fa-check"></i><b>35.2.8</b> The dangers of machine learning</a></li>
<li class="chapter" data-level="35.2.9" data-path="major_concepts.html"><a href="major_concepts.html#rationalizing"><i class="fa fa-check"></i><b>35.2.9</b> Rationalizing</a></li>
<li class="chapter" data-level="35.2.10" data-path="major_concepts.html"><a href="major_concepts.html#overfitting"><i class="fa fa-check"></i><b>35.2.10</b> Overfitting</a></li>
<li class="chapter" data-level="35.2.11" data-path="major_concepts.html"><a href="major_concepts.html#the-process-that-generated-the-data"><i class="fa fa-check"></i><b>35.2.11</b> The process that generated the data</a></li>
<li class="chapter" data-level="35.2.12" data-path="major_concepts.html"><a href="major_concepts.html#the-importance-of-theory"><i class="fa fa-check"></i><b>35.2.12</b> The importance of theory</a></li>
<li class="chapter" data-level="35.2.13" data-path="major_concepts.html"><a href="major_concepts.html#conceptual-modeling"><i class="fa fa-check"></i><b>35.2.13</b> Conceptual modeling</a></li>
<li class="chapter" data-level="35.2.14" data-path="major_concepts.html"><a href="major_concepts.html#consistency-with-existing-theory-and-prior-knowledge"><i class="fa fa-check"></i><b>35.2.14</b> Consistency with existing theory and prior knowledge</a></li>
<li class="chapter" data-level="35.2.15" data-path="major_concepts.html"><a href="major_concepts.html#model-validity-and-model-validation"><i class="fa fa-check"></i><b>35.2.15</b> Model validity and model validation</a></li>
<li class="chapter" data-level="35.2.16" data-path="major_concepts.html"><a href="major_concepts.html#our-role-in-research"><i class="fa fa-check"></i><b>35.2.16</b> Our role in research</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="major_concepts.html"><a href="major_concepts.html#ex_majorconcepts"><i class="fa fa-check"></i><code>Exercises</code> on major concepts</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="refs.html"><a href="refs.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tree phenology analysis with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="frost-risk-analysis" class="section level1 hasAnchor" number="33">
<h1><span class="header-section-number">Chapter 33</span> Frost risk analysis<a href="frost-risk-analysis.html#frost-risk-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="goals_frost_risk" class="section level2 unnumbered hasAnchor">
<h2>Learning goals for this lesson<a href="frost-risk-analysis.html#goals_frost_risk" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Appreciate the danger of spring frost for orchard crops</li>
<li>Learn how to plot bloom data over time</li>
<li>Consolidate skills from earlier lessons by defining a temperature response model and applying it to a temperature dataset</li>
<li>Evaluate frost occurrence at a location</li>
<li>Plot frost occurrences in relation to bloom dates</li>
<li>Quantitatively evaluate long-term trends in the risk of frost events during bloom</li>
</ul>
</div>
<div id="spring-frost" class="section level2 hasAnchor" number="33.1">
<h2><span class="header-section-number">33.1</span> Spring frost<a href="frost-risk-analysis.html#spring-frost" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Today we’ll look at an application of some of the procedures we looked at. The challenge we’re addressing is the risk of spring frost during flowering. After budbreak, trees are very sensitive to frost, and especially the emerging flowers can be severely damaged by freezing temperatures. As you (should) know, all tree fruits develop from flowers, so severely damaged flowers is bad news. In fact, spring frost events at an unfortunate time can lead to complete crop failure in many orchard crops. The following table illustrates the extent of such losses:</p>
<div class="float">
<img src="pictures/frost_damage_Germany.png" alt="Area, production and yield of major fruit trees in Germany in 2017 and 2018. Note the dramatic yield difference between these years. In 2017, orchards in much of the country were hit by a major spring frost event, which caused severe damage to tree flowers DESTATIS; Statistisches Bundesamt." />
<div class="figcaption">Area, production and yield of major fruit trees in Germany in 2017 and 2018. Note the dramatic yield difference between these years. In 2017, orchards in much of the country were hit by a major spring frost event, which caused severe damage to tree flowers <a href="https://www.destatis.de/DE/Themen/Branchen-Unternehmen/Landwirtschaft-Forstwirtschaft-Fischerei/Obst-Gemuese-Gartenbau/Tabellen/flaechen-erntemengen-marktobstanbau.html">DESTATIS; Statistisches Bundesamt</a>.</div>
</div>
<p>A serious spring frost event in April of 2017, with several consecutive nights of considerable frost (around -5°C) led to strong reductions in the number of viable flowers, which translated into very low final yields. This event caused serious hardship for many fruit growers. Even though this was surely not the first such event ever recorded, it raised concerns about the possible impact of climate change on the risk of frost damage.</p>
<p>In this day and age, whenever an unusual weather event happens, we quickly jump to the conclusion that climate change may be at play. This may often be a correct guess, but of course weather has always been variable, with a certain interannual variation being part of our ‘normal’ climate. A critical question in this context is whether 2017 was a freak outlier event or a harbinger of a ‘new normal’, where growers will suffer increasingly from losses due to spring frost events. This is the question we’re trying to address today.</p>
<p>The reason why answering this question is worth a bit of effort is that the risk of spring frost should factor into two important strategic decisions in fruit production:</p>
<ul>
<li>Investment in frost protection: Growers can protect themselves from frost damage by choosing among a limited number of frost protection strategies. In most settings, the most effective strategy is the use of frost protection sprinklers, but some growers also use ‘candles’ or wind machines (incl. in some cases helicopters). Each of these strategies requires investing in infrastructure or other materials (such as candles), which will only produce benefits in years with spring frost events. The profitability of such investments thus depends strongly on the likelihood of such events.</li>
<li>Cultivar choice: Some tree species or cultivars flower early, and some flower late. Obviously, late-flowering cultivars usually have a lower risk of suffering from spring frost damage than early-flowering ones. However, their fruits may also tend to mature later, at a time when market prices are low, or there may be other reasons for wanting to plant trees with early bloom dates. Also for this decision, knowledge of the risk of spring frost would be very helpful.</li>
</ul>
<p>So let’s see how we can address this. We’ll be focusing on the experimental station of the University of Bonn at Klein-Altendorf. Here it is:</p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="frost-risk-analysis.html#cb443-1" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb443-2"><a href="frost-risk-analysis.html#cb443-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="frost-risk-analysis.html#cb444-1" tabindex="-1"></a><span class="fu">leaflet</span>() <span class="sc">%&gt;%</span></span>
<span id="cb444-2"><a href="frost-risk-analysis.html#cb444-2" tabindex="-1"></a>  <span class="fu">setView</span>(<span class="at">lng =</span> <span class="fl">6.99</span>,</span>
<span id="cb444-3"><a href="frost-risk-analysis.html#cb444-3" tabindex="-1"></a>          <span class="at">lat =</span> <span class="fl">50.625</span>,</span>
<span id="cb444-4"><a href="frost-risk-analysis.html#cb444-4" tabindex="-1"></a>          <span class="at">zoom=</span><span class="dv">12</span>) <span class="sc">%&gt;%</span></span>
<span id="cb444-5"><a href="frost-risk-analysis.html#cb444-5" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb444-6"><a href="frost-risk-analysis.html#cb444-6" tabindex="-1"></a>  <span class="fu">addMarkers</span>(<span class="at">lng =</span> <span class="fl">6.99</span>,</span>
<span id="cb444-7"><a href="frost-risk-analysis.html#cb444-7" tabindex="-1"></a>             <span class="at">lat =</span> <span class="fl">50.625</span>,</span>
<span id="cb444-8"><a href="frost-risk-analysis.html#cb444-8" tabindex="-1"></a>             <span class="at">popup =</span> <span class="st">&quot;Campus Klein-Altendorf&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-300"></span>
<div class="leaflet html-widget html-fill-item" id="htmlwidget-d55dddaad1446235b83a" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-d55dddaad1446235b83a">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"setView":[[50.625,6.99],12,[]],"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addMarkers","args":[50.625,6.99,null,null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},"Campus Klein-Altendorf",null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[50.625,50.625],"lng":[6.99,6.99]}},"evals":[],"jsHooks":[]}</script>
<p class="caption">
Figure 33.1: Location of Campus Klein-Altendorf, an experimental station of the University of Bonn
</p>
</div>
<p>By the way, it took me just about 1 minute to find out, using just an internet search engine, how to include an interactive map in a markdown document. This is how easy it is to get impressive things done in markdown (sometimes)!</p>
<p>One of the remarkable features of this experimental station is that a few generations of technical staff have been diligently recording phenology data since the 1950s. We also have very good weather data for this entire period. Let’s use this information and the knowledge we’ve already gained in this module to produce a state-of-the-art frost risk assessment (focusing for now only on historic data).</p>
<p>Let’s first load long-term weather and bloom datasets into R.</p>
<a href="data/Alexander_Lucas_bloom_1958_2019.csv">
<button class="btn btn-warning"><i class="fa fa-save"></i> Download bloom data for Alexander Lucas pears (1958-2019)</button>
</a>
<a href="data/TMaxTMin1958-2019_patched.csv">
<button class="btn btn-warning"><i class="fa fa-save"></i> Download weather data for Campus Klein Altendorf (1958-2019)</button>
</a>
<p>Please download the files and save them in your <code>data</code> directory. Now we can load them.</p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="frost-risk-analysis.html#cb445-1" tabindex="-1"></a>CKA_Alexander_Lucas <span class="ot">&lt;-</span> <span class="fu">read_tab</span>(<span class="st">&quot;data/Alexander_Lucas_bloom_1958_2019.csv&quot;</span>)</span>
<span id="cb445-2"><a href="frost-risk-analysis.html#cb445-2" tabindex="-1"></a>CKA_weather <span class="ot">&lt;-</span> <span class="fu">read_tab</span>(<span class="st">&quot;data/TMaxTMin1958-2019_patched.csv&quot;</span>)</span></code></pre></div>
<p>The <code>CKA_weather</code> dataset looks like the patched weather datasets we’ve seen before.</p>
</div>
<div id="phenology-trend-analysis" class="section level2 hasAnchor" number="33.2">
<h2><span class="header-section-number">33.2</span> Phenology trend analysis<a href="frost-risk-analysis.html#phenology-trend-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here’s what the bloom dataset <code>CKA_Alexander_Lucas</code> looks like:</p>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="frost-risk-analysis.html#cb446-1" tabindex="-1"></a><span class="fu">head</span>(CKA_Alexander_Lucas)</span></code></pre></div>
<table class="table table-striped" style="font-size: 10px; ">
<thead>
<tr>
<th style="text-align:right;">
Pheno_year
</th>
<th style="text-align:right;">
First_bloom
</th>
<th style="text-align:right;">
Full_bloom
</th>
<th style="text-align:right;">
Last_bloom
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1958
</td>
<td style="text-align:right;">
19580502
</td>
<td style="text-align:right;">
19580503
</td>
<td style="text-align:right;">
19580507
</td>
</tr>
<tr>
<td style="text-align:right;">
1959
</td>
<td style="text-align:right;">
19590408
</td>
<td style="text-align:right;">
19590413
</td>
<td style="text-align:right;">
19590421
</td>
</tr>
<tr>
<td style="text-align:right;">
1960
</td>
<td style="text-align:right;">
19600410
</td>
<td style="text-align:right;">
19600415
</td>
<td style="text-align:right;">
19600421
</td>
</tr>
<tr>
<td style="text-align:right;">
1961
</td>
<td style="text-align:right;">
19610330
</td>
<td style="text-align:right;">
19610408
</td>
<td style="text-align:right;">
19610415
</td>
</tr>
<tr>
<td style="text-align:right;">
1962
</td>
<td style="text-align:right;">
19620427
</td>
<td style="text-align:right;">
19620505
</td>
<td style="text-align:right;">
19620510
</td>
</tr>
<tr>
<td style="text-align:right;">
1963
</td>
<td style="text-align:right;">
19630428
</td>
<td style="text-align:right;">
19630504
</td>
<td style="text-align:right;">
19630513
</td>
</tr>
</tbody>
</table>
<p>We’ll want to plot this with <code>ggplot</code> again later, and by now you may have a good idea of what type of data structure can most effectively do this. We’ll use the <code>pivot_longer</code> function to get our <code>data.frame</code> into the right structure. We’ll also calculate our usual <code>Year</code>, <code>Month</code> and <code>Day</code> columns. Finally, we’ll use a special <code>chillR</code> function (<code>make_JDay</code>) that adds the Julian date to the <code>data.frame</code>. The Julian date is simply the day of the year, i.e. a Julian date of 1 corresponds to <span class="math inline">\(1^{st}\)</span> January, 2 to <span class="math inline">\(2^{nd}\)</span> January, and 32 to <span class="math inline">\(1^{st}\)</span> February etc.</p>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="frost-risk-analysis.html#cb447-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb447-2"><a href="frost-risk-analysis.html#cb447-2" tabindex="-1"></a></span>
<span id="cb447-3"><a href="frost-risk-analysis.html#cb447-3" tabindex="-1"></a>Alexander_Lucas <span class="ot">&lt;-</span> </span>
<span id="cb447-4"><a href="frost-risk-analysis.html#cb447-4" tabindex="-1"></a>  CKA_Alexander_Lucas <span class="sc">%&gt;%</span></span>
<span id="cb447-5"><a href="frost-risk-analysis.html#cb447-5" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="st">&quot;First_bloom&quot;</span><span class="sc">:</span><span class="st">&quot;Last_bloom&quot;</span>,</span>
<span id="cb447-6"><a href="frost-risk-analysis.html#cb447-6" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;variable&quot;</span>,</span>
<span id="cb447-7"><a href="frost-risk-analysis.html#cb447-7" tabindex="-1"></a>               <span class="at">values_to=</span><span class="st">&quot;YEARMODA&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb447-8"><a href="frost-risk-analysis.html#cb447-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(YEARMODA, <span class="dv">1</span>, <span class="dv">4</span>)),</span>
<span id="cb447-9"><a href="frost-risk-analysis.html#cb447-9" tabindex="-1"></a>         <span class="at">Month =</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(YEARMODA, <span class="dv">5</span>, <span class="dv">6</span>)),</span>
<span id="cb447-10"><a href="frost-risk-analysis.html#cb447-10" tabindex="-1"></a>         <span class="at">Day =</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(YEARMODA, <span class="dv">7</span>, <span class="dv">8</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb447-11"><a href="frost-risk-analysis.html#cb447-11" tabindex="-1"></a>  <span class="fu">make_JDay</span>() </span></code></pre></div>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="frost-risk-analysis.html#cb448-1" tabindex="-1"></a><span class="fu">head</span>(Alexander_Lucas)</span></code></pre></div>
<table class="table table-striped" style="font-size: 10px; ">
<thead>
<tr>
<th style="text-align:right;">
Pheno_year
</th>
<th style="text-align:left;">
variable
</th>
<th style="text-align:right;">
YEARMODA
</th>
<th style="text-align:right;">
Year
</th>
<th style="text-align:right;">
Month
</th>
<th style="text-align:right;">
Day
</th>
<th style="text-align:right;">
JDay
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1958
</td>
<td style="text-align:left;">
First_bloom
</td>
<td style="text-align:right;">
19580502
</td>
<td style="text-align:right;">
1958
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
122
</td>
</tr>
<tr>
<td style="text-align:right;">
1958
</td>
<td style="text-align:left;">
Full_bloom
</td>
<td style="text-align:right;">
19580503
</td>
<td style="text-align:right;">
1958
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
123
</td>
</tr>
<tr>
<td style="text-align:right;">
1958
</td>
<td style="text-align:left;">
Last_bloom
</td>
<td style="text-align:right;">
19580507
</td>
<td style="text-align:right;">
1958
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
127
</td>
</tr>
<tr>
<td style="text-align:right;">
1959
</td>
<td style="text-align:left;">
First_bloom
</td>
<td style="text-align:right;">
19590408
</td>
<td style="text-align:right;">
1959
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
98
</td>
</tr>
<tr>
<td style="text-align:right;">
1959
</td>
<td style="text-align:left;">
Full_bloom
</td>
<td style="text-align:right;">
19590413
</td>
<td style="text-align:right;">
1959
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
103
</td>
</tr>
</tbody>
</table>
<p>We can now plot bloom dates for the historic record:</p>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="frost-risk-analysis.html#cb449-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Alexander_Lucas,</span>
<span id="cb449-2"><a href="frost-risk-analysis.html#cb449-2" tabindex="-1"></a>       <span class="fu">aes</span>(Pheno_year,</span>
<span id="cb449-3"><a href="frost-risk-analysis.html#cb449-3" tabindex="-1"></a>           JDay,</span>
<span id="cb449-4"><a href="frost-risk-analysis.html#cb449-4" tabindex="-1"></a>           <span class="at">col =</span> variable)) <span class="sc">+</span></span>
<span id="cb449-5"><a href="frost-risk-analysis.html#cb449-5" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb449-6"><a href="frost-risk-analysis.html#cb449-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb449-7"><a href="frost-risk-analysis.html#cb449-7" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(</span>
<span id="cb449-8"><a href="frost-risk-analysis.html#cb449-8" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;Phenological event&quot;</span>,</span>
<span id="cb449-9"><a href="frost-risk-analysis.html#cb449-9" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;First bloom&quot;</span>,</span>
<span id="cb449-10"><a href="frost-risk-analysis.html#cb449-10" tabindex="-1"></a>               <span class="st">&quot;Full bloom&quot;</span>,</span>
<span id="cb449-11"><a href="frost-risk-analysis.html#cb449-11" tabindex="-1"></a>               <span class="st">&quot;Last bloom&quot;</span>)) <span class="sc">+</span></span>
<span id="cb449-12"><a href="frost-risk-analysis.html#cb449-12" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Phenological year&quot;</span>) <span class="sc">+</span></span>
<span id="cb449-13"><a href="frost-risk-analysis.html#cb449-13" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Julian date (day of the year)&quot;</span>)</span></code></pre></div>
<p><img src="Book_files/figure-html/plot_bloom_Alexander_Lucas-1.png" width="672" /></p>
<p>It’s a bit hard to see what’s going on here, so let’s add a regression line. <code>ggplot</code> has a convenient function for this. We can even add a standard error to the line:</p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="frost-risk-analysis.html#cb450-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Alexander_Lucas,</span>
<span id="cb450-2"><a href="frost-risk-analysis.html#cb450-2" tabindex="-1"></a>       <span class="fu">aes</span>(Pheno_year,</span>
<span id="cb450-3"><a href="frost-risk-analysis.html#cb450-3" tabindex="-1"></a>           JDay,</span>
<span id="cb450-4"><a href="frost-risk-analysis.html#cb450-4" tabindex="-1"></a>           <span class="at">col =</span> variable)) <span class="sc">+</span></span>
<span id="cb450-5"><a href="frost-risk-analysis.html#cb450-5" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb450-6"><a href="frost-risk-analysis.html#cb450-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb450-7"><a href="frost-risk-analysis.html#cb450-7" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">&quot;Phenological event&quot;</span>,</span>
<span id="cb450-8"><a href="frost-risk-analysis.html#cb450-8" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;First bloom&quot;</span>,</span>
<span id="cb450-9"><a href="frost-risk-analysis.html#cb450-9" tabindex="-1"></a>                                  <span class="st">&quot;Full bloom&quot;</span>, </span>
<span id="cb450-10"><a href="frost-risk-analysis.html#cb450-10" tabindex="-1"></a>                                  <span class="st">&quot;Last bloom&quot;</span>)) <span class="sc">+</span></span>
<span id="cb450-11"><a href="frost-risk-analysis.html#cb450-11" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Phenological year&quot;</span>) <span class="sc">+</span></span>
<span id="cb450-12"><a href="frost-risk-analysis.html#cb450-12" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Julian date (day of the year)&quot;</span>) <span class="sc">+</span></span>
<span id="cb450-13"><a href="frost-risk-analysis.html#cb450-13" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>)</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-306-1.png" width="672" /></p>
<p>We could also use the <code>geom_smooth</code> method to display the data.</p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="frost-risk-analysis.html#cb451-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>Alexander_Lucas,<span class="fu">aes</span>(Pheno_year,JDay,<span class="at">col=</span>variable)) <span class="sc">+</span></span>
<span id="cb451-2"><a href="frost-risk-analysis.html#cb451-2" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb451-3"><a href="frost-risk-analysis.html#cb451-3" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size=</span><span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb451-4"><a href="frost-risk-analysis.html#cb451-4" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(</span>
<span id="cb451-5"><a href="frost-risk-analysis.html#cb451-5" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;Phenological event&quot;</span>,</span>
<span id="cb451-6"><a href="frost-risk-analysis.html#cb451-6" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;First bloom&quot;</span>, <span class="st">&quot;Full bloom&quot;</span>, <span class="st">&quot;Last bloom&quot;</span>)) <span class="sc">+</span></span>
<span id="cb451-7"><a href="frost-risk-analysis.html#cb451-7" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Phenological year&quot;</span>) <span class="sc">+</span></span>
<span id="cb451-8"><a href="frost-risk-analysis.html#cb451-8" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Julian date (day of the year)&quot;</span>) </span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-307-1.png" width="672" /></p>
<p>Looks like we have a trend here, but how can we be sure? The <a href="https://en.wikipedia.org/wiki/Kendall_rank_correlation_coefficient">Kendall test</a> is a pretty good tool for testing time series for trends:</p>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="frost-risk-analysis.html#cb452-1" tabindex="-1"></a><span class="fu">require</span>(Kendall)</span>
<span id="cb452-2"><a href="frost-risk-analysis.html#cb452-2" tabindex="-1"></a>Kendall_first <span class="ot">&lt;-</span></span>
<span id="cb452-3"><a href="frost-risk-analysis.html#cb452-3" tabindex="-1"></a>  <span class="fu">Kendall</span>(<span class="at">x =</span> Alexander_Lucas<span class="sc">$</span>Pheno_year[</span>
<span id="cb452-4"><a href="frost-risk-analysis.html#cb452-4" tabindex="-1"></a>            <span class="fu">which</span>(Alexander_Lucas<span class="sc">$</span>variable <span class="sc">==</span> <span class="st">&quot;First_bloom&quot;</span>)],</span>
<span id="cb452-5"><a href="frost-risk-analysis.html#cb452-5" tabindex="-1"></a>          <span class="at">y =</span> Alexander_Lucas<span class="sc">$</span>JDay[</span>
<span id="cb452-6"><a href="frost-risk-analysis.html#cb452-6" tabindex="-1"></a>            <span class="fu">which</span>(Alexander_Lucas<span class="sc">$</span>variable <span class="sc">==</span> <span class="st">&quot;First_bloom&quot;</span>)])</span>
<span id="cb452-7"><a href="frost-risk-analysis.html#cb452-7" tabindex="-1"></a></span>
<span id="cb452-8"><a href="frost-risk-analysis.html#cb452-8" tabindex="-1"></a>Kendall_full <span class="ot">&lt;-</span> </span>
<span id="cb452-9"><a href="frost-risk-analysis.html#cb452-9" tabindex="-1"></a>  <span class="fu">Kendall</span>(<span class="at">x =</span> Alexander_Lucas<span class="sc">$</span>Pheno_year[</span>
<span id="cb452-10"><a href="frost-risk-analysis.html#cb452-10" tabindex="-1"></a>            <span class="fu">which</span>(Alexander_Lucas<span class="sc">$</span>variable <span class="sc">==</span> <span class="st">&quot;Full_bloom&quot;</span>)],</span>
<span id="cb452-11"><a href="frost-risk-analysis.html#cb452-11" tabindex="-1"></a>          <span class="at">y =</span> Alexander_Lucas<span class="sc">$</span>JDay[</span>
<span id="cb452-12"><a href="frost-risk-analysis.html#cb452-12" tabindex="-1"></a>            <span class="fu">which</span>(Alexander_Lucas<span class="sc">$</span>variable <span class="sc">==</span> <span class="st">&quot;Full_bloom&quot;</span>)])</span>
<span id="cb452-13"><a href="frost-risk-analysis.html#cb452-13" tabindex="-1"></a></span>
<span id="cb452-14"><a href="frost-risk-analysis.html#cb452-14" tabindex="-1"></a>Kendall_last <span class="ot">&lt;-</span> </span>
<span id="cb452-15"><a href="frost-risk-analysis.html#cb452-15" tabindex="-1"></a>  <span class="fu">Kendall</span>(<span class="at">x =</span> Alexander_Lucas<span class="sc">$</span>Pheno_year[</span>
<span id="cb452-16"><a href="frost-risk-analysis.html#cb452-16" tabindex="-1"></a>            <span class="fu">which</span>(Alexander_Lucas<span class="sc">$</span>variable <span class="sc">==</span> <span class="st">&quot;Last_bloom&quot;</span>)],</span>
<span id="cb452-17"><a href="frost-risk-analysis.html#cb452-17" tabindex="-1"></a>          <span class="at">y =</span> Alexander_Lucas<span class="sc">$</span>JDay[</span>
<span id="cb452-18"><a href="frost-risk-analysis.html#cb452-18" tabindex="-1"></a>            <span class="fu">which</span>(Alexander_Lucas<span class="sc">$</span>variable <span class="sc">==</span> <span class="st">&quot;Last_bloom&quot;</span>)])</span>
<span id="cb452-19"><a href="frost-risk-analysis.html#cb452-19" tabindex="-1"></a></span>
<span id="cb452-20"><a href="frost-risk-analysis.html#cb452-20" tabindex="-1"></a>Kendall_first</span></code></pre></div>
<pre><code>## tau = -0.186, 2-sided pvalue =0.03533</code></pre>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="frost-risk-analysis.html#cb454-1" tabindex="-1"></a>Kendall_full</span></code></pre></div>
<pre><code>## tau = -0.27, 2-sided pvalue =0.0021401</code></pre>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="frost-risk-analysis.html#cb456-1" tabindex="-1"></a>Kendall_last</span></code></pre></div>
<pre><code>## tau = -0.233, 2-sided pvalue =0.0083237</code></pre>
<p>This test is a rank correlation test, which focuses on how often a value increases or decreases from one year to the next. If we overwhelmingly have movement in one direction, as is the case here, we have a significant trend. The 2-sided p-value given here can be interpreted like the usual p values we’re used to. In all cases, these values are &lt;0.05, so we can be pretty sure that we have a trend here. The <code>tau</code> value is negative, meaning that we have a decreasing (bloom-advancing) trend.</p>
<p>Maybe we’re also interested in the strength of the trend. The Kendall test doesn’t give us that information, and we may need to assume that our data can be described by some sort of mathematical function. Let’s do what most people do and assume a linear model.</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="frost-risk-analysis.html#cb458-1" tabindex="-1"></a>linear_trend_first <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb458-2"><a href="frost-risk-analysis.html#cb458-2" tabindex="-1"></a>  Alexander_Lucas<span class="sc">$</span>JDay[</span>
<span id="cb458-3"><a href="frost-risk-analysis.html#cb458-3" tabindex="-1"></a>    <span class="fu">which</span>(Alexander_Lucas<span class="sc">$</span>variable <span class="sc">==</span> <span class="st">&quot;First_bloom&quot;</span>)]<span class="sc">~</span></span>
<span id="cb458-4"><a href="frost-risk-analysis.html#cb458-4" tabindex="-1"></a>    Alexander_Lucas<span class="sc">$</span>Pheno_year[</span>
<span id="cb458-5"><a href="frost-risk-analysis.html#cb458-5" tabindex="-1"></a>      <span class="fu">which</span>(Alexander_Lucas<span class="sc">$</span>variable <span class="sc">==</span> <span class="st">&quot;First_bloom&quot;</span>)])</span>
<span id="cb458-6"><a href="frost-risk-analysis.html#cb458-6" tabindex="-1"></a></span>
<span id="cb458-7"><a href="frost-risk-analysis.html#cb458-7" tabindex="-1"></a>linear_trend_full <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb458-8"><a href="frost-risk-analysis.html#cb458-8" tabindex="-1"></a>  Alexander_Lucas<span class="sc">$</span>JDay[</span>
<span id="cb458-9"><a href="frost-risk-analysis.html#cb458-9" tabindex="-1"></a>    <span class="fu">which</span>(Alexander_Lucas<span class="sc">$</span>variable <span class="sc">==</span> <span class="st">&quot;Full_bloom&quot;</span>)]<span class="sc">~</span></span>
<span id="cb458-10"><a href="frost-risk-analysis.html#cb458-10" tabindex="-1"></a>    Alexander_Lucas<span class="sc">$</span>Pheno_year[</span>
<span id="cb458-11"><a href="frost-risk-analysis.html#cb458-11" tabindex="-1"></a>      <span class="fu">which</span>(Alexander_Lucas<span class="sc">$</span>variable <span class="sc">==</span> <span class="st">&quot;First_bloom&quot;</span>)])</span>
<span id="cb458-12"><a href="frost-risk-analysis.html#cb458-12" tabindex="-1"></a></span>
<span id="cb458-13"><a href="frost-risk-analysis.html#cb458-13" tabindex="-1"></a>linear_trend_last <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb458-14"><a href="frost-risk-analysis.html#cb458-14" tabindex="-1"></a>  Alexander_Lucas<span class="sc">$</span>JDay[</span>
<span id="cb458-15"><a href="frost-risk-analysis.html#cb458-15" tabindex="-1"></a>    <span class="fu">which</span>(Alexander_Lucas<span class="sc">$</span>variable <span class="sc">==</span> <span class="st">&quot;Last_bloom&quot;</span>)]<span class="sc">~</span></span>
<span id="cb458-16"><a href="frost-risk-analysis.html#cb458-16" tabindex="-1"></a>    Alexander_Lucas<span class="sc">$</span>Pheno_year[</span>
<span id="cb458-17"><a href="frost-risk-analysis.html#cb458-17" tabindex="-1"></a>      <span class="fu">which</span>(Alexander_Lucas<span class="sc">$</span>variable <span class="sc">==</span> <span class="st">&quot;First_bloom&quot;</span>)])</span>
<span id="cb458-18"><a href="frost-risk-analysis.html#cb458-18" tabindex="-1"></a></span>
<span id="cb458-19"><a href="frost-risk-analysis.html#cb458-19" tabindex="-1"></a>linear_trend_first</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Alexander_Lucas$JDay[which(Alexander_Lucas$variable == 
##     &quot;First_bloom&quot;)] ~ Alexander_Lucas$Pheno_year[which(Alexander_Lucas$variable == 
##     &quot;First_bloom&quot;)])
## 
## Coefficients:
##                                                                  (Intercept)  
##                                                                     429.1662  
## Alexander_Lucas$Pheno_year[which(Alexander_Lucas$variable == &quot;First_bloom&quot;)]  
##                                                                      -0.1618</code></pre>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="frost-risk-analysis.html#cb460-1" tabindex="-1"></a>linear_trend_full</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Alexander_Lucas$JDay[which(Alexander_Lucas$variable == 
##     &quot;Full_bloom&quot;)] ~ Alexander_Lucas$Pheno_year[which(Alexander_Lucas$variable == 
##     &quot;First_bloom&quot;)])
## 
## Coefficients:
##                                                                  (Intercept)  
##                                                                     569.6720  
## Alexander_Lucas$Pheno_year[which(Alexander_Lucas$variable == &quot;First_bloom&quot;)]  
##                                                                      -0.2305</code></pre>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="frost-risk-analysis.html#cb462-1" tabindex="-1"></a>linear_trend_last</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Alexander_Lucas$JDay[which(Alexander_Lucas$variable == 
##     &quot;Last_bloom&quot;)] ~ Alexander_Lucas$Pheno_year[which(Alexander_Lucas$variable == 
##     &quot;First_bloom&quot;)])
## 
## Coefficients:
##                                                                  (Intercept)  
##                                                                     485.9785  
## Alexander_Lucas$Pheno_year[which(Alexander_Lucas$variable == &quot;First_bloom&quot;)]  
##                                                                      -0.1841</code></pre>
<p>What we have to look at is the second model coefficient, which is -0.16 for first bloom, -0.23 for full bloom and -0.18 for last bloom. Such shifts are often specified per decade, so we’ll have to multiply by a factor of 10. Let’s collect all our trend results:</p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="frost-risk-analysis.html#cb464-1" tabindex="-1"></a>phenology_trends <span class="ot">&lt;-</span></span>
<span id="cb464-2"><a href="frost-risk-analysis.html#cb464-2" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Stage =</span> <span class="fu">c</span>(<span class="st">&quot;First bloom&quot;</span>,</span>
<span id="cb464-3"><a href="frost-risk-analysis.html#cb464-3" tabindex="-1"></a>                       <span class="st">&quot;Full bloom&quot;</span>, </span>
<span id="cb464-4"><a href="frost-risk-analysis.html#cb464-4" tabindex="-1"></a>                       <span class="st">&quot;Last bloom&quot;</span>),</span>
<span id="cb464-5"><a href="frost-risk-analysis.html#cb464-5" tabindex="-1"></a>             <span class="at">Kendall_tau =</span> <span class="fu">c</span>(<span class="fu">round</span>(Kendall_first[[<span class="dv">1</span>]][<span class="dv">1</span>],<span class="dv">3</span>),</span>
<span id="cb464-6"><a href="frost-risk-analysis.html#cb464-6" tabindex="-1"></a>                             <span class="fu">round</span>(Kendall_full[[<span class="dv">1</span>]][<span class="dv">1</span>],<span class="dv">3</span>),</span>
<span id="cb464-7"><a href="frost-risk-analysis.html#cb464-7" tabindex="-1"></a>                             <span class="fu">round</span>(Kendall_last[[<span class="dv">1</span>]][<span class="dv">1</span>],<span class="dv">3</span>)),</span>
<span id="cb464-8"><a href="frost-risk-analysis.html#cb464-8" tabindex="-1"></a>             <span class="at">Kendall_p =</span> <span class="fu">c</span>(<span class="fu">round</span>(Kendall_first[[<span class="dv">2</span>]][<span class="dv">1</span>],<span class="dv">3</span>),</span>
<span id="cb464-9"><a href="frost-risk-analysis.html#cb464-9" tabindex="-1"></a>                           <span class="fu">round</span>(Kendall_full[[<span class="dv">2</span>]][<span class="dv">1</span>],<span class="dv">3</span>),</span>
<span id="cb464-10"><a href="frost-risk-analysis.html#cb464-10" tabindex="-1"></a>                           <span class="fu">round</span>(Kendall_last[[<span class="dv">2</span>]][<span class="dv">1</span>],<span class="dv">3</span>)),</span>
<span id="cb464-11"><a href="frost-risk-analysis.html#cb464-11" tabindex="-1"></a>             <span class="at">Linear_trend_per_decade =</span></span>
<span id="cb464-12"><a href="frost-risk-analysis.html#cb464-12" tabindex="-1"></a>               <span class="fu">c</span>(<span class="fu">round</span>(linear_trend_first[[<span class="dv">1</span>]][<span class="dv">2</span>],<span class="dv">2</span>) <span class="sc">*</span> <span class="dv">10</span>,</span>
<span id="cb464-13"><a href="frost-risk-analysis.html#cb464-13" tabindex="-1"></a>                 <span class="fu">round</span>(linear_trend_full[[<span class="dv">1</span>]][<span class="dv">2</span>],<span class="dv">2</span>) <span class="sc">*</span> <span class="dv">10</span>,</span>
<span id="cb464-14"><a href="frost-risk-analysis.html#cb464-14" tabindex="-1"></a>                 <span class="fu">round</span>(linear_trend_last[[<span class="dv">1</span>]][<span class="dv">2</span>],<span class="dv">2</span>) <span class="sc">*</span> <span class="dv">10</span>)</span>
<span id="cb464-15"><a href="frost-risk-analysis.html#cb464-15" tabindex="-1"></a>             )</span></code></pre></div>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="frost-risk-analysis.html#cb465-1" tabindex="-1"></a>phenology_trends</span></code></pre></div>
<table class="table table-striped" style="font-size: 10px; ">
<thead>
<tr>
<th style="text-align:left;">
Stage
</th>
<th style="text-align:right;">
Kendall_tau
</th>
<th style="text-align:right;">
Kendall_p
</th>
<th style="text-align:right;">
Linear_trend_per_decade
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
First bloom
</td>
<td style="text-align:right;">
-0.186
</td>
<td style="text-align:right;">
0.035
</td>
<td style="text-align:right;">
-1.6
</td>
</tr>
<tr>
<td style="text-align:left;">
Full bloom
</td>
<td style="text-align:right;">
-0.270
</td>
<td style="text-align:right;">
0.002
</td>
<td style="text-align:right;">
-2.3
</td>
</tr>
<tr>
<td style="text-align:left;">
Last bloom
</td>
<td style="text-align:right;">
-0.233
</td>
<td style="text-align:right;">
0.008
</td>
<td style="text-align:right;">
-1.8
</td>
</tr>
</tbody>
</table>
</div>
<div id="frost-risk" class="section level2 hasAnchor" number="33.3">
<h2><span class="header-section-number">33.3</span> Frost risk<a href="frost-risk-analysis.html#frost-risk" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To analyze the frost risk, we first need a frost model. We’re going to keep this relatively simple and just count any hour with temperatures &lt;0°C as a frost hour. In reality, the story is a bit more complicated, because as buds break out of dormancy, they gradually become more sensitive to frost. Fully dormant buds can withstand rather deep freezes (in many species), and this hardiness gradually diminishes as phenological development resumes in spring. We’ll stick to a simple model for now.</p>
<p>We’ve built simple temperature models before, so this shouldn’t be a big problem for us. As a reminder, we can call up the help file of <code>step_model</code> for guidance.</p>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="frost-risk-analysis.html#cb466-1" tabindex="-1"></a>frost_df <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb466-2"><a href="frost-risk-analysis.html#cb466-2" tabindex="-1"></a>  <span class="at">lower =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1000</span>, <span class="dv">0</span>),</span>
<span id="cb466-3"><a href="frost-risk-analysis.html#cb466-3" tabindex="-1"></a>  <span class="at">upper =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1000</span>),</span>
<span id="cb466-4"><a href="frost-risk-analysis.html#cb466-4" tabindex="-1"></a>  <span class="at">weight =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb466-5"><a href="frost-risk-analysis.html#cb466-5" tabindex="-1"></a></span>
<span id="cb466-6"><a href="frost-risk-analysis.html#cb466-6" tabindex="-1"></a>frost_model <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">step_model</span>(x,</span>
<span id="cb466-7"><a href="frost-risk-analysis.html#cb466-7" tabindex="-1"></a>                                      frost_df)</span></code></pre></div>
<p>Now we can apply this model to the historic record, after converting the temperature record to hourly values:</p>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="frost-risk-analysis.html#cb467-1" tabindex="-1"></a>hourly <span class="ot">&lt;-</span> <span class="fu">stack_hourly_temps</span>(CKA_weather,</span>
<span id="cb467-2"><a href="frost-risk-analysis.html#cb467-2" tabindex="-1"></a>                             <span class="at">latitude =</span> <span class="fl">50.625</span>)</span>
<span id="cb467-3"><a href="frost-risk-analysis.html#cb467-3" tabindex="-1"></a></span>
<span id="cb467-4"><a href="frost-risk-analysis.html#cb467-4" tabindex="-1"></a>frost <span class="ot">&lt;-</span> <span class="fu">tempResponse</span>(hourly,</span>
<span id="cb467-5"><a href="frost-risk-analysis.html#cb467-5" tabindex="-1"></a>                      <span class="at">models =</span> <span class="fu">c</span>(<span class="at">frost =</span> frost_model))</span>
<span id="cb467-6"><a href="frost-risk-analysis.html#cb467-6" tabindex="-1"></a></span>
<span id="cb467-7"><a href="frost-risk-analysis.html#cb467-7" tabindex="-1"></a><span class="fu">ggplot</span>(frost,</span>
<span id="cb467-8"><a href="frost-risk-analysis.html#cb467-8" tabindex="-1"></a>       <span class="fu">aes</span>(End_year,</span>
<span id="cb467-9"><a href="frost-risk-analysis.html#cb467-9" tabindex="-1"></a>           frost)) <span class="sc">+</span></span>
<span id="cb467-10"><a href="frost-risk-analysis.html#cb467-10" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb467-11"><a href="frost-risk-analysis.html#cb467-11" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb467-12"><a href="frost-risk-analysis.html#cb467-12" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb467-13"><a href="frost-risk-analysis.html#cb467-13" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Frost hours per year&quot;</span>) <span class="sc">+</span></span>
<span id="cb467-14"><a href="frost-risk-analysis.html#cb467-14" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Year&quot;</span>)</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-314-1.png" width="672" /></p>
<p>What we see clearly here is that the number of frost hours has decreased quite strongly at Klein-Altendorf. Let’s calculate the same statistics as before:</p>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="frost-risk-analysis.html#cb468-1" tabindex="-1"></a><span class="fu">Kendall</span>(<span class="at">x =</span> frost<span class="sc">$</span>End_year,</span>
<span id="cb468-2"><a href="frost-risk-analysis.html#cb468-2" tabindex="-1"></a>        <span class="at">y =</span> frost<span class="sc">$</span>frost)</span></code></pre></div>
<pre><code>## tau = -0.179, 2-sided pvalue =0.041862</code></pre>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="frost-risk-analysis.html#cb470-1" tabindex="-1"></a><span class="fu">lm</span>(frost<span class="sc">$</span>frost <span class="sc">~</span> frost<span class="sc">$</span>End_year)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = frost$frost ~ frost$End_year)
## 
## Coefficients:
##    (Intercept)  frost$End_year  
##       11172.57           -5.19</code></pre>
<p>So on average, assuming a linear decline, we’ve lost about -5.2 frost hours per year! You can probably see how we could easily make historic scenarios of frost hour numbers using the functions we learned about in previous lessons.</p>
<p>But here we’re not really interested in how many frost hours we’ve had - we want to know if our pear trees have been affected by spring frost. For this we don’t need this aggregation for the whole year - we need daily data of frost occurrence that we can then compare with bloom dates. For this, we need a slightly different version of our frost model:</p>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="frost-risk-analysis.html#cb472-1" tabindex="-1"></a>frost_model_no_summ <span class="ot">&lt;-</span> </span>
<span id="cb472-2"><a href="frost-risk-analysis.html#cb472-2" tabindex="-1"></a>  <span class="cf">function</span>(x) <span class="fu">step_model</span>(x, </span>
<span id="cb472-3"><a href="frost-risk-analysis.html#cb472-3" tabindex="-1"></a>                         frost_df,</span>
<span id="cb472-4"><a href="frost-risk-analysis.html#cb472-4" tabindex="-1"></a>                         <span class="at">summ=</span><span class="cn">FALSE</span>)</span>
<span id="cb472-5"><a href="frost-risk-analysis.html#cb472-5" tabindex="-1"></a></span>
<span id="cb472-6"><a href="frost-risk-analysis.html#cb472-6" tabindex="-1"></a>hourly<span class="sc">$</span>hourtemps[, <span class="st">&quot;frost&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">frost_model_no_summ</span>(hourly<span class="sc">$</span>hourtemps<span class="sc">$</span>Temp)</span>
<span id="cb472-7"><a href="frost-risk-analysis.html#cb472-7" tabindex="-1"></a></span>
<span id="cb472-8"><a href="frost-risk-analysis.html#cb472-8" tabindex="-1"></a>Daily_frost_hours <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(hourly<span class="sc">$</span>hourtemps<span class="sc">$</span>frost,</span>
<span id="cb472-9"><a href="frost-risk-analysis.html#cb472-9" tabindex="-1"></a>                               <span class="at">by =</span> <span class="fu">list</span>(hourly<span class="sc">$</span>hourtemps<span class="sc">$</span>YEARMODA),</span>
<span id="cb472-10"><a href="frost-risk-analysis.html#cb472-10" tabindex="-1"></a>                               <span class="at">FUN =</span> sum)</span>
<span id="cb472-11"><a href="frost-risk-analysis.html#cb472-11" tabindex="-1"></a></span>
<span id="cb472-12"><a href="frost-risk-analysis.html#cb472-12" tabindex="-1"></a>Daily_frost <span class="ot">&lt;-</span> <span class="fu">make_JDay</span>(CKA_weather)</span>
<span id="cb472-13"><a href="frost-risk-analysis.html#cb472-13" tabindex="-1"></a></span>
<span id="cb472-14"><a href="frost-risk-analysis.html#cb472-14" tabindex="-1"></a>Daily_frost[, <span class="st">&quot;Frost_hours&quot;</span>] <span class="ot">&lt;-</span> Daily_frost_hours<span class="sc">$</span>x</span></code></pre></div>
<p>Here is what just happened: To actually find out whether an individual hour has frost or not, we need a frost model that doesn’t automatically add up all frost hours that accumulate. To achieve this, we have to get back into the <code>step_model</code> function and set the parameter <code>summ</code> to <code>FALSE</code>. We can apply the resulting model directly to the hourly temperatures.</p>
<p>We probably shouldn’t plot the data by hour, but rather by day, so we need to summarize the hourly data. This can be achieved with the <code>aggregate</code> function, which can sum up values for all rows in a particular <code>data.frame</code> column that meet certain criteria (the function is actually more general than that, but this is all we need here).</p>
<p>We then take our <code>CKA_weather</code> <code>data.frame</code>, add Julian dates to it (<code>make_JDay</code>), and place our daily frost hour data into a new column.</p>
<p>Now we’re ready to plot the results. We should find a way to put this into the same plot as our bloom data, so let’s try to use the same axes: <code>Year</code> and <code>JDay</code>. We also wanted to show the number of frost hours of course, so let’s indicate this by using dots of variable size. Since I couldn’t quite figure out how to not show days with 0 frost hours, we should first set the <code>Frost_hours</code> for the respective days to <code>NA</code>. Here’s how this can be achieved with <code>ggplot</code>:</p>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="frost-risk-analysis.html#cb473-1" tabindex="-1"></a>Daily_frost<span class="sc">$</span>Frost_hours[<span class="fu">which</span>(Daily_frost<span class="sc">$</span>Frost_hours <span class="sc">==</span> <span class="dv">0</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb473-2"><a href="frost-risk-analysis.html#cb473-2" tabindex="-1"></a></span>
<span id="cb473-3"><a href="frost-risk-analysis.html#cb473-3" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Daily_frost,</span>
<span id="cb473-4"><a href="frost-risk-analysis.html#cb473-4" tabindex="-1"></a>       <span class="fu">aes</span>(Year,</span>
<span id="cb473-5"><a href="frost-risk-analysis.html#cb473-5" tabindex="-1"></a>           JDay,</span>
<span id="cb473-6"><a href="frost-risk-analysis.html#cb473-6" tabindex="-1"></a>           <span class="at">size =</span> Frost_hours)) <span class="sc">+</span></span>
<span id="cb473-7"><a href="frost-risk-analysis.html#cb473-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">col =</span> <span class="st">&quot;light blue&quot;</span>,</span>
<span id="cb473-8"><a href="frost-risk-analysis.html#cb473-8" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb473-9"><a href="frost-risk-analysis.html#cb473-9" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>),</span>
<span id="cb473-10"><a href="frost-risk-analysis.html#cb473-10" tabindex="-1"></a>             <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>),</span>
<span id="cb473-11"><a href="frost-risk-analysis.html#cb473-11" tabindex="-1"></a>             <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;5&quot;</span>, <span class="st">&quot;10&quot;</span>, <span class="st">&quot;15&quot;</span>, <span class="st">&quot;20&quot;</span>),</span>
<span id="cb473-12"><a href="frost-risk-analysis.html#cb473-12" tabindex="-1"></a>             <span class="at">name =</span> <span class="st">&quot;Frost hours&quot;</span>) <span class="sc">+</span></span>
<span id="cb473-13"><a href="frost-risk-analysis.html#cb473-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>)</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-317-1.png" width="672" /></p>
<p>And now let’s try to plot this in the same figure as the bloom dates:</p>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="frost-risk-analysis.html#cb474-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Alexander_Lucas,</span>
<span id="cb474-2"><a href="frost-risk-analysis.html#cb474-2" tabindex="-1"></a>       <span class="fu">aes</span>(Pheno_year,</span>
<span id="cb474-3"><a href="frost-risk-analysis.html#cb474-3" tabindex="-1"></a>           JDay,</span>
<span id="cb474-4"><a href="frost-risk-analysis.html#cb474-4" tabindex="-1"></a>           <span class="at">col =</span> variable)) <span class="sc">+</span></span>
<span id="cb474-5"><a href="frost-risk-analysis.html#cb474-5" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb474-6"><a href="frost-risk-analysis.html#cb474-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb474-7"><a href="frost-risk-analysis.html#cb474-7" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(</span>
<span id="cb474-8"><a href="frost-risk-analysis.html#cb474-8" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;Phenological event&quot;</span>,</span>
<span id="cb474-9"><a href="frost-risk-analysis.html#cb474-9" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;First bloom&quot;</span>,</span>
<span id="cb474-10"><a href="frost-risk-analysis.html#cb474-10" tabindex="-1"></a>               <span class="st">&quot;Full bloom&quot;</span>,</span>
<span id="cb474-11"><a href="frost-risk-analysis.html#cb474-11" tabindex="-1"></a>               <span class="st">&quot;Last bloom&quot;</span>)) <span class="sc">+</span></span>
<span id="cb474-12"><a href="frost-risk-analysis.html#cb474-12" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Phenological year&quot;</span>) <span class="sc">+</span></span>
<span id="cb474-13"><a href="frost-risk-analysis.html#cb474-13" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Julian date (day of the year)&quot;</span>) <span class="sc">+</span></span>
<span id="cb474-14"><a href="frost-risk-analysis.html#cb474-14" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> Daily_frost,</span>
<span id="cb474-15"><a href="frost-risk-analysis.html#cb474-15" tabindex="-1"></a>             <span class="fu">aes</span>(Year,</span>
<span id="cb474-16"><a href="frost-risk-analysis.html#cb474-16" tabindex="-1"></a>                 JDay,</span>
<span id="cb474-17"><a href="frost-risk-analysis.html#cb474-17" tabindex="-1"></a>                 <span class="at">size =</span> Frost_hours),</span>
<span id="cb474-18"><a href="frost-risk-analysis.html#cb474-18" tabindex="-1"></a>             <span class="at">col =</span> <span class="st">&quot;light blue&quot;</span>,</span>
<span id="cb474-19"><a href="frost-risk-analysis.html#cb474-19" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb474-20"><a href="frost-risk-analysis.html#cb474-20" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>),</span>
<span id="cb474-21"><a href="frost-risk-analysis.html#cb474-21" tabindex="-1"></a>             <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>),</span>
<span id="cb474-22"><a href="frost-risk-analysis.html#cb474-22" tabindex="-1"></a>             <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;5&quot;</span>, <span class="st">&quot;10&quot;</span>, <span class="st">&quot;15&quot;</span>, <span class="st">&quot;20&quot;</span>),</span>
<span id="cb474-23"><a href="frost-risk-analysis.html#cb474-23" tabindex="-1"></a>             <span class="at">name =</span> <span class="st">&quot;Frost hours&quot;</span>) <span class="sc">+</span></span>
<span id="cb474-24"><a href="frost-risk-analysis.html#cb474-24" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>)</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-318-1.png" width="672" /></p>
<p>Hard to see anything here. We’re really only interested in spring, so let’s only show data for that period:</p>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="frost-risk-analysis.html#cb475-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Alexander_Lucas,</span>
<span id="cb475-2"><a href="frost-risk-analysis.html#cb475-2" tabindex="-1"></a>       <span class="fu">aes</span>(Pheno_year,</span>
<span id="cb475-3"><a href="frost-risk-analysis.html#cb475-3" tabindex="-1"></a>           JDay,</span>
<span id="cb475-4"><a href="frost-risk-analysis.html#cb475-4" tabindex="-1"></a>           <span class="at">col =</span> variable)) <span class="sc">+</span></span>
<span id="cb475-5"><a href="frost-risk-analysis.html#cb475-5" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb475-6"><a href="frost-risk-analysis.html#cb475-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb475-7"><a href="frost-risk-analysis.html#cb475-7" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(</span>
<span id="cb475-8"><a href="frost-risk-analysis.html#cb475-8" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;Phenological event&quot;</span>,</span>
<span id="cb475-9"><a href="frost-risk-analysis.html#cb475-9" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;First bloom&quot;</span>,</span>
<span id="cb475-10"><a href="frost-risk-analysis.html#cb475-10" tabindex="-1"></a>               <span class="st">&quot;Full bloom&quot;</span>,</span>
<span id="cb475-11"><a href="frost-risk-analysis.html#cb475-11" tabindex="-1"></a>               <span class="st">&quot;Last bloom&quot;</span>)) <span class="sc">+</span></span>
<span id="cb475-12"><a href="frost-risk-analysis.html#cb475-12" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Phenological year&quot;</span>) <span class="sc">+</span></span>
<span id="cb475-13"><a href="frost-risk-analysis.html#cb475-13" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Julian date (day of the year)&quot;</span>) <span class="sc">+</span></span>
<span id="cb475-14"><a href="frost-risk-analysis.html#cb475-14" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> Daily_frost,</span>
<span id="cb475-15"><a href="frost-risk-analysis.html#cb475-15" tabindex="-1"></a>             <span class="fu">aes</span>(Year,</span>
<span id="cb475-16"><a href="frost-risk-analysis.html#cb475-16" tabindex="-1"></a>                 JDay,</span>
<span id="cb475-17"><a href="frost-risk-analysis.html#cb475-17" tabindex="-1"></a>                 <span class="at">size =</span> Frost_hours),</span>
<span id="cb475-18"><a href="frost-risk-analysis.html#cb475-18" tabindex="-1"></a>             <span class="at">col =</span> <span class="st">&quot;light blue&quot;</span>,</span>
<span id="cb475-19"><a href="frost-risk-analysis.html#cb475-19" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb475-20"><a href="frost-risk-analysis.html#cb475-20" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>),</span>
<span id="cb475-21"><a href="frost-risk-analysis.html#cb475-21" tabindex="-1"></a>             <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>),</span>
<span id="cb475-22"><a href="frost-risk-analysis.html#cb475-22" tabindex="-1"></a>             <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;5&quot;</span>, <span class="st">&quot;10&quot;</span>, <span class="st">&quot;15&quot;</span>, <span class="st">&quot;20&quot;</span>),</span>
<span id="cb475-23"><a href="frost-risk-analysis.html#cb475-23" tabindex="-1"></a>             <span class="at">name =</span> <span class="st">&quot;Frost hours&quot;</span>) <span class="sc">+</span></span>
<span id="cb475-24"><a href="frost-risk-analysis.html#cb475-24" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb475-25"><a href="frost-risk-analysis.html#cb475-25" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">75</span>, <span class="dv">140</span>))</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-319-1.png" width="672" /></p>
<p>Still hard to see. We need a better way to show the bloom dates. Let’s try a ribbon for the total bloom duration and a line for full bloom. That requires a bit of restructuring.</p>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="frost-risk-analysis.html#cb476-1" tabindex="-1"></a>Ribbon_Lucas <span class="ot">&lt;-</span></span>
<span id="cb476-2"><a href="frost-risk-analysis.html#cb476-2" tabindex="-1"></a>  Alexander_Lucas <span class="sc">%&gt;%</span></span>
<span id="cb476-3"><a href="frost-risk-analysis.html#cb476-3" tabindex="-1"></a>  <span class="fu">select</span>(Pheno_year, variable, JDay) <span class="sc">%&gt;%</span></span>
<span id="cb476-4"><a href="frost-risk-analysis.html#cb476-4" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;variable&quot;</span>, <span class="at">values_from =</span> <span class="st">&quot;JDay&quot;</span>)</span>
<span id="cb476-5"><a href="frost-risk-analysis.html#cb476-5" tabindex="-1"></a></span>
<span id="cb476-6"><a href="frost-risk-analysis.html#cb476-6" tabindex="-1"></a></span>
<span id="cb476-7"><a href="frost-risk-analysis.html#cb476-7" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Ribbon_Lucas,</span>
<span id="cb476-8"><a href="frost-risk-analysis.html#cb476-8" tabindex="-1"></a>       <span class="fu">aes</span>(Pheno_year)) <span class="sc">+</span></span>
<span id="cb476-9"><a href="frost-risk-analysis.html#cb476-9" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> First_bloom,</span>
<span id="cb476-10"><a href="frost-risk-analysis.html#cb476-10" tabindex="-1"></a>                  <span class="at">ymax =</span> Last_bloom),</span>
<span id="cb476-11"><a href="frost-risk-analysis.html#cb476-11" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">&quot;light gray&quot;</span>) <span class="sc">+</span></span>
<span id="cb476-12"><a href="frost-risk-analysis.html#cb476-12" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Full_bloom)) <span class="sc">+</span></span>
<span id="cb476-13"><a href="frost-risk-analysis.html#cb476-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb476-14"><a href="frost-risk-analysis.html#cb476-14" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Phenological year&quot;</span>) <span class="sc">+</span></span>
<span id="cb476-15"><a href="frost-risk-analysis.html#cb476-15" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Julian date (day of the year)&quot;</span>) <span class="sc">+</span></span>
<span id="cb476-16"><a href="frost-risk-analysis.html#cb476-16" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> Daily_frost,</span>
<span id="cb476-17"><a href="frost-risk-analysis.html#cb476-17" tabindex="-1"></a>             <span class="fu">aes</span>(Year,</span>
<span id="cb476-18"><a href="frost-risk-analysis.html#cb476-18" tabindex="-1"></a>                 JDay,</span>
<span id="cb476-19"><a href="frost-risk-analysis.html#cb476-19" tabindex="-1"></a>                 <span class="at">size =</span> Frost_hours),</span>
<span id="cb476-20"><a href="frost-risk-analysis.html#cb476-20" tabindex="-1"></a>             <span class="at">col =</span> <span class="st">&quot;light blue&quot;</span>,</span>
<span id="cb476-21"><a href="frost-risk-analysis.html#cb476-21" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb476-22"><a href="frost-risk-analysis.html#cb476-22" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>),</span>
<span id="cb476-23"><a href="frost-risk-analysis.html#cb476-23" tabindex="-1"></a>             <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>),</span>
<span id="cb476-24"><a href="frost-risk-analysis.html#cb476-24" tabindex="-1"></a>             <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;5&quot;</span>, <span class="st">&quot;10&quot;</span>, <span class="st">&quot;15&quot;</span>, <span class="st">&quot;20&quot;</span>),</span>
<span id="cb476-25"><a href="frost-risk-analysis.html#cb476-25" tabindex="-1"></a>             <span class="at">name =</span> <span class="st">&quot;Frost hours&quot;</span>) <span class="sc">+</span></span>
<span id="cb476-26"><a href="frost-risk-analysis.html#cb476-26" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb476-27"><a href="frost-risk-analysis.html#cb476-27" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">75</span>, <span class="dv">140</span>))</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-320-1.png" width="672" /></p>
<p>It’s still a bit hard to see when frost events coincided with bloom. Let’s try to point this out more clearly by adding color.</p>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="frost-risk-analysis.html#cb477-1" tabindex="-1"></a><span class="co"># identify frost events that overlap with bloom</span></span>
<span id="cb477-2"><a href="frost-risk-analysis.html#cb477-2" tabindex="-1"></a>lookup_dates <span class="ot">&lt;-</span> Ribbon_Lucas</span>
<span id="cb477-3"><a href="frost-risk-analysis.html#cb477-3" tabindex="-1"></a></span>
<span id="cb477-4"><a href="frost-risk-analysis.html#cb477-4" tabindex="-1"></a><span class="fu">row.names</span>(lookup_dates) <span class="ot">&lt;-</span> lookup_dates<span class="sc">$</span>Pheno_year</span>
<span id="cb477-5"><a href="frost-risk-analysis.html#cb477-5" tabindex="-1"></a></span>
<span id="cb477-6"><a href="frost-risk-analysis.html#cb477-6" tabindex="-1"></a>Daily_frost[, <span class="st">&quot;First_bloom&quot;</span>]<span class="ot">&lt;-</span></span>
<span id="cb477-7"><a href="frost-risk-analysis.html#cb477-7" tabindex="-1"></a>  lookup_dates[<span class="fu">as.character</span>(Daily_frost<span class="sc">$</span>Year),</span>
<span id="cb477-8"><a href="frost-risk-analysis.html#cb477-8" tabindex="-1"></a>               <span class="st">&quot;First_bloom&quot;</span>]</span>
<span id="cb477-9"><a href="frost-risk-analysis.html#cb477-9" tabindex="-1"></a></span>
<span id="cb477-10"><a href="frost-risk-analysis.html#cb477-10" tabindex="-1"></a>Daily_frost[, <span class="st">&quot;Last_bloom&quot;</span>]<span class="ot">&lt;-</span></span>
<span id="cb477-11"><a href="frost-risk-analysis.html#cb477-11" tabindex="-1"></a>  lookup_dates[<span class="fu">as.character</span>(Daily_frost<span class="sc">$</span>Year),</span>
<span id="cb477-12"><a href="frost-risk-analysis.html#cb477-12" tabindex="-1"></a>               <span class="st">&quot;Last_bloom&quot;</span>]</span>
<span id="cb477-13"><a href="frost-risk-analysis.html#cb477-13" tabindex="-1"></a></span>
<span id="cb477-14"><a href="frost-risk-analysis.html#cb477-14" tabindex="-1"></a>Daily_frost[<span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.na</span>(Daily_frost<span class="sc">$</span>Frost_hours)),</span>
<span id="cb477-15"><a href="frost-risk-analysis.html#cb477-15" tabindex="-1"></a>            <span class="st">&quot;Bloom_frost&quot;</span>] <span class="ot">&lt;-</span></span>
<span id="cb477-16"><a href="frost-risk-analysis.html#cb477-16" tabindex="-1"></a>  <span class="st">&quot;Before bloom&quot;</span></span>
<span id="cb477-17"><a href="frost-risk-analysis.html#cb477-17" tabindex="-1"></a></span>
<span id="cb477-18"><a href="frost-risk-analysis.html#cb477-18" tabindex="-1"></a>Daily_frost[<span class="fu">which</span>(Daily_frost<span class="sc">$</span>JDay <span class="sc">&gt;=</span> Daily_frost<span class="sc">$</span>First_bloom),</span>
<span id="cb477-19"><a href="frost-risk-analysis.html#cb477-19" tabindex="-1"></a>            <span class="st">&quot;Bloom_frost&quot;</span>]<span class="ot">&lt;-</span></span>
<span id="cb477-20"><a href="frost-risk-analysis.html#cb477-20" tabindex="-1"></a>  <span class="st">&quot;During bloom&quot;</span></span>
<span id="cb477-21"><a href="frost-risk-analysis.html#cb477-21" tabindex="-1"></a></span>
<span id="cb477-22"><a href="frost-risk-analysis.html#cb477-22" tabindex="-1"></a>Daily_frost[<span class="fu">which</span>(Daily_frost<span class="sc">$</span>JDay <span class="sc">&gt;</span> Daily_frost<span class="sc">$</span>Last_bloom),</span>
<span id="cb477-23"><a href="frost-risk-analysis.html#cb477-23" tabindex="-1"></a>            <span class="st">&quot;Bloom_frost&quot;</span>]<span class="ot">&lt;-</span></span>
<span id="cb477-24"><a href="frost-risk-analysis.html#cb477-24" tabindex="-1"></a>  <span class="st">&quot;After bloom&quot;</span></span>
<span id="cb477-25"><a href="frost-risk-analysis.html#cb477-25" tabindex="-1"></a></span>
<span id="cb477-26"><a href="frost-risk-analysis.html#cb477-26" tabindex="-1"></a>Daily_frost[<span class="fu">which</span>(Daily_frost<span class="sc">$</span>JDay <span class="sc">&gt;</span> <span class="dv">180</span>),</span>
<span id="cb477-27"><a href="frost-risk-analysis.html#cb477-27" tabindex="-1"></a>            <span class="st">&quot;Bloom_frost&quot;</span>]<span class="ot">&lt;-</span></span>
<span id="cb477-28"><a href="frost-risk-analysis.html#cb477-28" tabindex="-1"></a>  <span class="st">&quot;Before bloom&quot;</span></span>
<span id="cb477-29"><a href="frost-risk-analysis.html#cb477-29" tabindex="-1"></a></span>
<span id="cb477-30"><a href="frost-risk-analysis.html#cb477-30" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Ribbon_Lucas,</span>
<span id="cb477-31"><a href="frost-risk-analysis.html#cb477-31" tabindex="-1"></a>       <span class="fu">aes</span>(Pheno_year)) <span class="sc">+</span></span>
<span id="cb477-32"><a href="frost-risk-analysis.html#cb477-32" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> First_bloom, </span>
<span id="cb477-33"><a href="frost-risk-analysis.html#cb477-33" tabindex="-1"></a>                  <span class="at">ymax =</span> Last_bloom),</span>
<span id="cb477-34"><a href="frost-risk-analysis.html#cb477-34" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">&quot;light gray&quot;</span>) <span class="sc">+</span></span>
<span id="cb477-35"><a href="frost-risk-analysis.html#cb477-35" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Full_bloom)) <span class="sc">+</span></span>
<span id="cb477-36"><a href="frost-risk-analysis.html#cb477-36" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb477-37"><a href="frost-risk-analysis.html#cb477-37" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Phenological year&quot;</span>) <span class="sc">+</span></span>
<span id="cb477-38"><a href="frost-risk-analysis.html#cb477-38" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Julian date (day of the year)&quot;</span>) <span class="sc">+</span></span>
<span id="cb477-39"><a href="frost-risk-analysis.html#cb477-39" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> Daily_frost,</span>
<span id="cb477-40"><a href="frost-risk-analysis.html#cb477-40" tabindex="-1"></a>             <span class="fu">aes</span>(Year,</span>
<span id="cb477-41"><a href="frost-risk-analysis.html#cb477-41" tabindex="-1"></a>                 JDay,</span>
<span id="cb477-42"><a href="frost-risk-analysis.html#cb477-42" tabindex="-1"></a>                 <span class="at">size =</span> Frost_hours,</span>
<span id="cb477-43"><a href="frost-risk-analysis.html#cb477-43" tabindex="-1"></a>                 <span class="at">col =</span> Bloom_frost),</span>
<span id="cb477-44"><a href="frost-risk-analysis.html#cb477-44" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb477-45"><a href="frost-risk-analysis.html#cb477-45" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>),</span>
<span id="cb477-46"><a href="frost-risk-analysis.html#cb477-46" tabindex="-1"></a>             <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>),</span>
<span id="cb477-47"><a href="frost-risk-analysis.html#cb477-47" tabindex="-1"></a>             <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;5&quot;</span>, <span class="st">&quot;10&quot;</span>, <span class="st">&quot;15&quot;</span>, <span class="st">&quot;20&quot;</span>),</span>
<span id="cb477-48"><a href="frost-risk-analysis.html#cb477-48" tabindex="-1"></a>             <span class="at">name =</span> <span class="st">&quot;Frost hours&quot;</span>) <span class="sc">+</span></span>
<span id="cb477-49"><a href="frost-risk-analysis.html#cb477-49" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb477-50"><a href="frost-risk-analysis.html#cb477-50" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;Before bloom&quot;</span>,</span>
<span id="cb477-51"><a href="frost-risk-analysis.html#cb477-51" tabindex="-1"></a>               <span class="st">&quot;During bloom&quot;</span>,</span>
<span id="cb477-52"><a href="frost-risk-analysis.html#cb477-52" tabindex="-1"></a>               <span class="st">&quot;After bloom&quot;</span>),</span>
<span id="cb477-53"><a href="frost-risk-analysis.html#cb477-53" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;light green&quot;</span>,</span>
<span id="cb477-54"><a href="frost-risk-analysis.html#cb477-54" tabindex="-1"></a>               <span class="st">&quot;red&quot;</span>,</span>
<span id="cb477-55"><a href="frost-risk-analysis.html#cb477-55" tabindex="-1"></a>               <span class="st">&quot;light blue&quot;</span>),</span>
<span id="cb477-56"><a href="frost-risk-analysis.html#cb477-56" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;Frost timing&quot;</span>) <span class="sc">+</span></span>
<span id="cb477-57"><a href="frost-risk-analysis.html#cb477-57" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb477-58"><a href="frost-risk-analysis.html#cb477-58" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">75</span>, <span class="dv">140</span>))</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-321-1.png" width="672" /></p>
<p>Now let’s see if there’s been a long-term trend in the number of frost hours during bloom:</p>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="frost-risk-analysis.html#cb478-1" tabindex="-1"></a>Bloom_frost_trend <span class="ot">&lt;-</span> </span>
<span id="cb478-2"><a href="frost-risk-analysis.html#cb478-2" tabindex="-1"></a>  <span class="fu">aggregate</span>(</span>
<span id="cb478-3"><a href="frost-risk-analysis.html#cb478-3" tabindex="-1"></a>    Daily_frost<span class="sc">$</span>Frost_hours,</span>
<span id="cb478-4"><a href="frost-risk-analysis.html#cb478-4" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">list</span>(Daily_frost<span class="sc">$</span>Year,</span>
<span id="cb478-5"><a href="frost-risk-analysis.html#cb478-5" tabindex="-1"></a>              Daily_frost<span class="sc">$</span>Bloom_frost),</span>
<span id="cb478-6"><a href="frost-risk-analysis.html#cb478-6" tabindex="-1"></a>    <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">sum</span>(x,</span>
<span id="cb478-7"><a href="frost-risk-analysis.html#cb478-7" tabindex="-1"></a>                          <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb478-8"><a href="frost-risk-analysis.html#cb478-8" tabindex="-1"></a></span>
<span id="cb478-9"><a href="frost-risk-analysis.html#cb478-9" tabindex="-1"></a><span class="fu">colnames</span>(Bloom_frost_trend) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Year&quot;</span>,</span>
<span id="cb478-10"><a href="frost-risk-analysis.html#cb478-10" tabindex="-1"></a>                                 <span class="st">&quot;Frost_timing&quot;</span>,</span>
<span id="cb478-11"><a href="frost-risk-analysis.html#cb478-11" tabindex="-1"></a>                                 <span class="st">&quot;Frost_hours&quot;</span>)</span>
<span id="cb478-12"><a href="frost-risk-analysis.html#cb478-12" tabindex="-1"></a></span>
<span id="cb478-13"><a href="frost-risk-analysis.html#cb478-13" tabindex="-1"></a>DuringBloom<span class="ot">&lt;-</span></span>
<span id="cb478-14"><a href="frost-risk-analysis.html#cb478-14" tabindex="-1"></a>  Bloom_frost_trend[</span>
<span id="cb478-15"><a href="frost-risk-analysis.html#cb478-15" tabindex="-1"></a>    <span class="fu">which</span>(Bloom_frost_trend<span class="sc">$</span>Frost_timing <span class="sc">==</span> <span class="st">&quot;During bloom&quot;</span>),]</span>
<span id="cb478-16"><a href="frost-risk-analysis.html#cb478-16" tabindex="-1"></a></span>
<span id="cb478-17"><a href="frost-risk-analysis.html#cb478-17" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> DuringBloom,</span>
<span id="cb478-18"><a href="frost-risk-analysis.html#cb478-18" tabindex="-1"></a>       <span class="fu">aes</span>(Year,</span>
<span id="cb478-19"><a href="frost-risk-analysis.html#cb478-19" tabindex="-1"></a>           Frost_hours)) <span class="sc">+</span></span>
<span id="cb478-20"><a href="frost-risk-analysis.html#cb478-20" tabindex="-1"></a>  <span class="fu">geom_col</span>() </span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-322-1.png" width="672" /></p>
<p>It’s a bit hard to see whether there’s a trend here. Let’s do some statistics again:</p>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="frost-risk-analysis.html#cb479-1" tabindex="-1"></a><span class="fu">Kendall</span>(<span class="at">x =</span> DuringBloom<span class="sc">$</span>Year,</span>
<span id="cb479-2"><a href="frost-risk-analysis.html#cb479-2" tabindex="-1"></a>        <span class="at">y =</span> DuringBloom<span class="sc">$</span>Frost_hours)</span></code></pre></div>
<pre><code>## tau = 0.0834, 2-sided pvalue =0.3797</code></pre>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="frost-risk-analysis.html#cb481-1" tabindex="-1"></a><span class="fu">lm</span>(DuringBloom<span class="sc">$</span>Frost_hours <span class="sc">~</span> DuringBloom<span class="sc">$</span>Year)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = DuringBloom$Frost_hours ~ DuringBloom$Year)
## 
## Coefficients:
##      (Intercept)  DuringBloom$Year  
##       -159.07879           0.08302</code></pre>
<p>So the slope of this regression indicates an average increase by 0.08 frost hours during bloom each year. However, the Kendall test did not consider this a significant trend.</p>
</div>
<div id="exercises_frost_risk" class="section level2 unnumbered hasAnchor">
<h2><code>Exercises</code> on frost risk analysis<a href="frost-risk-analysis.html#exercises_frost_risk" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Please document all results of the following assignments in your <code>learning logbook</code>.</p>
<ol style="list-style-type: decimal">
<li>Download the phenology dataset for the apple cultivar <em>Roter Boskoop</em> from Klein-Altendorf.</li>
</ol>
<button class="btn btn-warning" onclick="&#10;    async function downloadFile(event) {&#10;      event.preventDefault();&#10;      try {&#10;        const response = await fetch(&#39;data:text/csv;base64,UGhlbm9feWVhcjtGaXJzdF9ibG9vbTtGdWxsX2Jsb29tO0xhc3RfYmxvb20KMTk1ODsxOTU4MDUwOTsxOTU4MDUxMTsxOTU4MDUxNAoxOTU5OzE5NTkwNDE0OzE5NTkwNDIxOzE5NTkwNTA0CjE5NjA7MTk2MDA0MjQ7MTk2MDA1MDU7MTk2MDA1MTAKMTk2MTsxOTYxMDQwOTsxOTYxMDQxOTsxOTYxMDUwMQoxOTYyOzE5NjIwNTE0OzE5NjIwNTIyOzE5NjIwNTMwCjE5NjM7MTk2MzA1MDc7MTk2MzA1MTU7MTk2MzA1MjQKMTk2NDsxOTY0MDUwNTsxOTY0MDUxMTsxOTY0MDUxOAoxOTY1OzE5NjUwNTExOzE5NjUwNTE2OzE5NjUwNTI0CjE5NjY7MTk2NjA0MjY7MTk2NjA0MzA7MTk2NjA1MDcKMTk2NzsxOTY3MDQzMDsxOTY3MDUwOTsxOTY3MDUxNQoxOTY4OzE5NjgwNTAxOzE5NjgwNTA0OzE5NjgwNTExCjE5Njk7MTk2OTA1MDU7MTk2OTA1MTA7MTk2OTA1MTgKMTk3MDsxOTcwMDUxNDsxOTcwMDUyMDsxOTcwMDUyNgoxOTcxOzE5NzEwNTAzOzE5NzEwNTEwOzE5NzEwNTE0CjE5NzI7MTk3MjA0MzA7MTk3MjA1MDU7MTk3MjA1MTkKMTk3MzsxOTczMDUxMzsxOTczMDUxNjsxOTczMDUyMAoxOTc0OzE5NzQwNDEyOzE5NzQwNDE2OzE5NzQwNDI0CjE5NzU7MTk3NTA0Mjk7MTk3NTA1MDY7MTk3NTA1MTgKMTk3NjsxOTc2MDUwNTsxOTc2MDUwODsxOTc2MDUxNAoxOTc3OzE5NzcwNTA0OzE5NzcwNTE1OzE5NzcwNTI1CjE5Nzg7MTk3ODA1MDQ7MTk3ODA1MDc7MTk3ODA1MjgKMTk3OTsxOTc5MDUxNDsxOTc5MDUxNjsxOTc5MDUyNwoxOTgwOzE5ODAwNTA2OzE5ODAwNTEzOzE5ODAwNTE5CjE5ODE7MTk4MTA0MTU7MTk4MTA0MzA7MTk4MTA1MTQKMTk4MjsxOTgyMDUxMDsxOTgyMDUxMzsxOTgyMDUyMwoxOTgzOzE5ODMwNTAzOzE5ODMwNTA4OzE5ODMwNTE0CjE5ODQ7MTk4NDA1MDg7MTk4NDA1MTg7MTk4NDA1MjgKMTk4NTsxOTg1MDUxMzsxOTg1MDUxODsxOTg1MDUyMQoxOTg2OzE5ODYwNTExOzE5ODYwNTE1OzE5ODYwNTIxCjE5ODc7MTk4NzA1MDE7MTk4NzA1MDU7MTk4NzA1MTYKMTk4ODsxOTg4MDQzMDsxOTg4MDUwMzsxOTg4MDUxNQoxOTg5OzE5ODkwNDIwOzE5ODkwNDI5OzE5ODkwNTExCjE5OTA7MTk5MDA0MDU7MTk5MDA0MTI7MTk5MDA0MjgKMTk5MTsxOTkxMDQxNjsxOTkxMDQzMDsxOTkxMDUyMAoxOTkyOzE5OTIwNDI2OzE5OTIwNTAyOzE5OTIwNTEyCjE5OTM7MTk5MzA0MjY7MTk5MzA0Mjk7MTk5MzA1MDQKMTk5NDsxOTk0MDQyNjsxOTk0MDQzMDsxOTk0MDUxMwoxOTk1OzE5OTUwNDI3OzE5OTUwNTAyOzE5OTUwNTEzCjE5OTY7MTk5NjA0MzA7MTk5NjA1MDQ7MTk5NjA1MjEKMTk5NzsxOTk3MDQxNzsxOTk3MDQyMjsxOTk3MDUwMwoxOTk4OzE5OTgwNDE5OzE5OTgwNDIyOzE5OTgwNDI5CjE5OTk7MTk5OTA0MjM7MTk5OTA0MjY7MTk5OTA1MDEKMjAwMDsyMDAwMDQyMjsyMDAwMDQyNDsyMDAwMDQzMAoyMDAxOzIwMDEwNTAyOzIwMDEwNTAzOzIwMDEwNTEwCjIwMDI7MjAwMjA0MTA7MjAwMjA0MTM7MjAwMjA1MDMKMjAwMzsyMDAzMDQyMzsyMDAzMDQyNTsyMDAzMDUwMQoyMDA0OzIwMDQwNDIyOzIwMDQwNDI1OzIwMDQwNTA0CjIwMDU7MjAwNTA0MjM7MjAwNTA0MjU7MjAwNTA1MDEKMjAwNjsyMDA2MDUwNDsyMDA2MDUwNjsyMDA2MDUxMgoyMDA3OzIwMDcwNDE0OzIwMDcwNDE1OzIwMDcwNDIwCjIwMDg7MjAwODA0MjQ7MjAwODA0Mjc7MjAwODA1MDgKMjAwOTsyMDA5MDQxOTsyMDA5MDQyMTsyMDA5MDQyOQoyMDEwOzIwMTAwNDI1OzIwMTAwNDI3OzIwMTAwNTA4CjIwMTE7MjAxMTA0MTE7MjAxMTA0MTI7MjAxMTA0MjIKMjAxMjsyMDEyMDQyMDsyMDEyMDQyMzsyMDEyMDUwMQoyMDEzOzIwMTMwNTAzOzIwMTMwNTA1OzIwMTMwNTE0CjIwMTQ7MjAxNDA0MDQ7MjAxNDA0MDY7MjAxNDA0MTYKMjAxNTsyMDE1MDQyMTsyMDE1MDQyNDsyMDE1MDUwMgoyMDE2OzIwMTYwNDIzOzIwMTYwNDMwOzIwMTYwNTA5CjIwMTc7MjAxNzA0MTA7MjAxNzA0MTI7MjAxNzA1MDEKMjAxODsyMDE4MDQxOTsyMDE4MDQyMDsyMDE4MDUwNQo=&#39;);&#10;        if (!response.ok) throw new Error(&#39;Network response failed&#39;);&#10;        const blob = await response.blob();&#10;        const blobUrl = window.URL.createObjectURL(blob);&#10;        const a = document.createElement(&#39;a&#39;);&#10;        a.href = blobUrl;&#10;        a.download = &#39;Roter_Boskoop_bloom_1958_2019.csv&#39;;&#10;        a.style.display = &#39;none&#39;;&#10;        document.body.appendChild(a);&#10;        a.dispatchEvent(new MouseEvent(&#39;click&#39;));&#10;        document.body.removeChild(a);&#10;        setTimeout(() =&gt; {&#10;          window.URL.revokeObjectURL(blobUrl);&#10;        }, 100);&#10;        return false;&#10;      } catch (error) {&#10;        console.error(&#39;Download failed:&#39;, error);&#10;        alert(&#39;Download failed. Please try again.&#39;);&#10;      }&#10;    }&#10;    downloadFile(event);&#10;  " has_icon="TRUE"><i class="fa fa-save"></i> Download Roter Boskoop dataset</button>
<ol start="2" style="list-style-type: decimal">
<li>Illustrate the development of the bloom period over the duration of the weather record. Use multiple ways to show this - feel free to be creative.</li>
<li>Evaluate the occurrence of frost events at Klein-Altendorf since 1958. Illustrate this in a plot.</li>
<li>Produce an illustration of the relationship between spring frost events and the bloom period of ‘Roter Boskoop’.</li>
<li>Evaluate how the risk of spring frost for this cultivar has changed over time. Has there been a significant trend?</li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="phenoflex3.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="a-robust-method-to-estimate-future-frost-risks.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Book.pdf", "Book.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
