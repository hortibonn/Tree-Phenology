<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 21 Delineating temperature response phases with PLS regression | Tree phenology analysis with R</title>
  <meta name="description" content="This lecture introduces the chillR package for R." />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 21 Delineating temperature response phases with PLS regression | Tree phenology analysis with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This lecture introduces the chillR package for R." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 21 Delineating temperature response phases with PLS regression | Tree phenology analysis with R" />
  
  <meta name="twitter:description" content="This lecture introduces the chillR package for R." />
  

<meta name="author" content="Eike Luedeling" />


<meta name="date" content="2024-11-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="simple_phenology.html"/>
<link rel="next" href="pls_reflection.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.2/leaflet.js"></script>
<script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/font-awesome-6.5.2/js/script.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 1em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Tree phenology analysis with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#objectives"><i class="fa fa-check"></i><b>1.1</b> Objectives</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#performance-assessment"><i class="fa fa-check"></i><b>1.2</b> Performance assessment</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#house-rules"><i class="fa fa-check"></i><b>1.3</b> House rules</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="the-tools-we-use.html"><a href="the-tools-we-use.html"><i class="fa fa-check"></i><b>2</b> The tools we use</a>
<ul>
<li class="chapter" data-level="2.1" data-path="the-tools-we-use.html"><a href="the-tools-we-use.html#r-and-rstudio"><i class="fa fa-check"></i><b>2.1</b> R and RStudio</a></li>
<li class="chapter" data-level="2.2" data-path="the-tools-we-use.html"><a href="the-tools-we-use.html#git-and-github"><i class="fa fa-check"></i><b>2.2</b> git and github</a></li>
<li class="chapter" data-level="2.3" data-path="the-tools-we-use.html"><a href="the-tools-we-use.html#rmarkdown"><i class="fa fa-check"></i><b>2.3</b> Rmarkdown</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tree-dormancy.html"><a href="tree-dormancy.html"><i class="fa fa-check"></i><b>3</b> Tree dormancy</a>
<ul>
<li class="chapter" data-level="3.1" data-path="tree-dormancy.html"><a href="tree-dormancy.html#learning-goals-for-this-lesson"><i class="fa fa-check"></i><b>3.1</b> Learning goals for this lesson:</a></li>
<li class="chapter" data-level="3.2" data-path="tree-dormancy.html"><a href="tree-dormancy.html#introduction-to-dormancy"><i class="fa fa-check"></i><b>3.2</b> Introduction to dormancy</a></li>
<li class="chapter" data-level="3.3" data-path="tree-dormancy.html"><a href="tree-dormancy.html#dormancy-physiology"><i class="fa fa-check"></i><b>3.3</b> Dormancy physiology</a></li>
<li class="chapter" data-level="3.4" data-path="tree-dormancy.html"><a href="tree-dormancy.html#experimental-and-statistical-determination-of-the-chilling-and-forcing-periods"><i class="fa fa-check"></i><b>3.4</b> Experimental and statistical determination of the chilling and forcing periods</a></li>
<li class="chapter" data-level="3.5" data-path="tree-dormancy.html"><a href="tree-dormancy.html#phenology-record-and-bbch-scale"><i class="fa fa-check"></i><b>3.5</b> Phenology record and BBCH scale</a></li>
<li class="chapter" data-level="" data-path="tree-dormancy.html"><a href="tree-dormancy.html#exercises_dormancy"><i class="fa fa-check"></i><code>Exercises</code> on tree dormancy</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html"><i class="fa fa-check"></i><b>4</b> Climate change and impact projection</a>
<ul>
<li class="chapter" data-level="4.1" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#the-drivers-of-climate-change"><i class="fa fa-check"></i><b>4.1</b> The drivers of climate change</a></li>
<li class="chapter" data-level="4.2" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#what-weve-already-seen"><i class="fa fa-check"></i><b>4.2</b> What we’ve already seen</a></li>
<li class="chapter" data-level="4.3" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#future-scenarios"><i class="fa fa-check"></i><b>4.3</b> Future scenarios</a></li>
<li class="chapter" data-level="4.4" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#impact-projection-approaches"><i class="fa fa-check"></i><b>4.4</b> Impact projection approaches</a></li>
<li class="chapter" data-level="" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#exercises_climate_change"><i class="fa fa-check"></i><code>Exercises</code> on climate change</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html"><i class="fa fa-check"></i><b>5</b> Winter chill projections</a>
<ul>
<li class="chapter" data-level="" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#goals_analysis_examples"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="5.1" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-projections-1"><i class="fa fa-check"></i><b>5.1</b> Winter chill projections</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-oman"><i class="fa fa-check"></i><b>5.1.1</b> Winter chill in Oman</a></li>
<li class="chapter" data-level="5.1.2" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-model-sensitivity"><i class="fa fa-check"></i><b>5.1.2</b> Chill model sensitivity</a></li>
<li class="chapter" data-level="5.1.3" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-california"><i class="fa fa-check"></i><b>5.1.3</b> Winter chill in California</a></li>
<li class="chapter" data-level="5.1.4" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-ratios"><i class="fa fa-check"></i><b>5.1.4</b> Winter chill ratios</a></li>
<li class="chapter" data-level="5.1.5" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#a-global-projection-of-future-winter-chill"><i class="fa fa-check"></i><b>5.1.5</b> A global projection of future winter chill</a></li>
<li class="chapter" data-level="5.1.6" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-germany"><i class="fa fa-check"></i><b>5.1.6</b> Winter chill in Germany</a></li>
<li class="chapter" data-level="5.1.7" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-tunisia"><i class="fa fa-check"></i><b>5.1.7</b> Winter chill in Tunisia</a></li>
<li class="chapter" data-level="5.1.8" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-chile"><i class="fa fa-check"></i><b>5.1.8</b> Winter chill in Chile</a></li>
<li class="chapter" data-level="5.1.9" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-projection-for-patagonia"><i class="fa fa-check"></i><b>5.1.9</b> Chill projection for Patagonia</a></li>
<li class="chapter" data-level="5.1.10" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-model-comparison"><i class="fa fa-check"></i><b>5.1.10</b> Chill model comparison</a></li>
<li class="chapter" data-level="5.1.11" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-projection-for-all-of-tunisia"><i class="fa fa-check"></i><b>5.1.11</b> Chill projection for all of Tunisia</a></li>
<li class="chapter" data-level="5.1.12" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#revisiting-chill-accumulation-in-oman"><i class="fa fa-check"></i><b>5.1.12</b> Revisiting chill accumulation in Oman</a></li>
<li class="chapter" data-level="5.1.13" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#future-studies"><i class="fa fa-check"></i><b>5.1.13</b> Future studies?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#exercises_past_studies"><i class="fa fa-check"></i><code>Exercises</code> on past chill projections</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="manual-chill-analysis.html"><a href="manual-chill-analysis.html"><i class="fa fa-check"></i><b>6</b> Manual chill analysis</a>
<ul>
<li class="chapter" data-level="" data-path="manual-chill-analysis.html"><a href="manual-chill-analysis.html#goals_manual_chill_analysis"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="6.1" data-path="manual-chill-analysis.html"><a href="manual-chill-analysis.html#computing-chilling-hours-from-hourly-temperature-data"><i class="fa fa-check"></i><b>6.1</b> Computing Chilling Hours from hourly temperature data</a></li>
<li class="chapter" data-level="6.2" data-path="manual-chill-analysis.html"><a href="manual-chill-analysis.html#our-first-chill-function"><i class="fa fa-check"></i><b>6.2</b> Our first chill function</a></li>
<li class="chapter" data-level="" data-path="manual-chill-analysis.html"><a href="manual-chill-analysis.html#exercises_manual_chill_analysis"><i class="fa fa-check"></i><code>Exercises</code> on basic chill modeling</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chill-models.html"><a href="chill-models.html"><i class="fa fa-check"></i><b>7</b> Chill models</a>
<ul>
<li class="chapter" data-level="" data-path="chill-models.html"><a href="chill-models.html#goals_chill_models"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="7.1" data-path="chill-models.html"><a href="chill-models.html#chill-models-in-chillr"><i class="fa fa-check"></i><b>7.1</b> Chill models in <code>chillR</code></a></li>
<li class="chapter" data-level="" data-path="chill-models.html"><a href="chill-models.html#exercises_chill_models"><i class="fa fa-check"></i><code>Exercises</code> on chill models</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html"><i class="fa fa-check"></i><b>8</b> Making hourly temperatures</a>
<ul>
<li class="chapter" data-level="" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#goals_hourly"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="8.1" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#generating-hourly-temperatures"><i class="fa fa-check"></i><b>8.1</b> Generating hourly temperatures</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#idealized-daily-temperature-curves"><i class="fa fa-check"></i><b>8.1.1</b> Idealized daily temperature curves</a></li>
<li class="chapter" data-level="8.1.2" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#empirical-daily-temperature-curves"><i class="fa fa-check"></i><b>8.1.2</b> Empirical daily temperature curves</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#exercises_hourly"><i class="fa fa-check"></i><code>Exercises</code> on hourly temperatures</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html"><i class="fa fa-check"></i><b>9</b> Some useful tools in R</a>
<ul>
<li class="chapter" data-level="" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#goals_R_tools"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="9.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#an-evolving-language---and-a-lifelong-learning-process"><i class="fa fa-check"></i><b>9.1</b> An evolving language - and a lifelong learning process</a></li>
<li class="chapter" data-level="9.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-tidyverse"><i class="fa fa-check"></i><b>9.2</b> The <code>tidyverse</code></a></li>
<li class="chapter" data-level="9.3" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-ggplot2-package"><i class="fa fa-check"></i><b>9.3</b> The <code>ggplot2</code> package</a></li>
<li class="chapter" data-level="9.4" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-tibble-package"><i class="fa fa-check"></i><b>9.4</b> The <code>tibble</code> package</a></li>
<li class="chapter" data-level="9.5" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-magrittr-package---pipes"><i class="fa fa-check"></i><b>9.5</b> The <code>magrittr</code> package - pipes</a></li>
<li class="chapter" data-level="9.6" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-tidyr-package"><i class="fa fa-check"></i><b>9.6</b> The <code>tidyr</code> package</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#pivot_longer"><i class="fa fa-check"></i><b>9.6.1</b> <code>pivot_longer</code></a></li>
<li class="chapter" data-level="9.6.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#pivot_wider"><i class="fa fa-check"></i><b>9.6.2</b> <code>pivot_wider</code></a></li>
<li class="chapter" data-level="9.6.3" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#select"><i class="fa fa-check"></i><b>9.6.3</b> <code>select</code></a></li>
<li class="chapter" data-level="9.6.4" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#filter"><i class="fa fa-check"></i><b>9.6.4</b> <code>filter</code></a></li>
<li class="chapter" data-level="9.6.5" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#mutate"><i class="fa fa-check"></i><b>9.6.5</b> <code>mutate</code></a></li>
<li class="chapter" data-level="9.6.6" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#arrange"><i class="fa fa-check"></i><b>9.6.6</b> <code>arrange</code></a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#loops"><i class="fa fa-check"></i><b>9.7</b> Loops</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#for-loops"><i class="fa fa-check"></i><b>9.7.1</b> <em>For</em> loops</a></li>
<li class="chapter" data-level="9.7.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#while-loops"><i class="fa fa-check"></i><b>9.7.2</b> <em>While</em> loops</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#apply-functions"><i class="fa fa-check"></i><b>9.8</b> <code>apply</code> functions</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#sapply"><i class="fa fa-check"></i><b>9.8.1</b> <code>sapply</code></a></li>
<li class="chapter" data-level="9.8.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#lapply"><i class="fa fa-check"></i><b>9.8.2</b> <code>lapply</code></a></li>
<li class="chapter" data-level="9.8.3" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#apply"><i class="fa fa-check"></i><b>9.8.3</b> <code>apply</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#exercises_R_tools"><i class="fa fa-check"></i><code>Exercises</code> on useful R tools</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="get_temp_data.html"><a href="get_temp_data.html"><i class="fa fa-check"></i><b>10</b> Getting temperature data</a>
<ul>
<li class="chapter" data-level="" data-path="get_temp_data.html"><a href="get_temp_data.html#goals_get_temps"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="10.1" data-path="get_temp_data.html"><a href="get_temp_data.html#temperature-data-needs"><i class="fa fa-check"></i><b>10.1</b> Temperature data needs</a></li>
<li class="chapter" data-level="10.2" data-path="get_temp_data.html"><a href="get_temp_data.html#the-global-summary-of-the-day-database"><i class="fa fa-check"></i><b>10.2</b> The Global Summary of the Day database</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="get_temp_data.html"><a href="get_temp_data.html#actionlist_stations"><i class="fa fa-check"></i><b>10.2.1</b> <code>action=list_stations</code></a></li>
<li class="chapter" data-level="10.2.2" data-path="get_temp_data.html"><a href="get_temp_data.html#actiondownload_weather"><i class="fa fa-check"></i><b>10.2.2</b> <code>action="download_weather"</code></a></li>
<li class="chapter" data-level="10.2.3" data-path="get_temp_data.html"><a href="get_temp_data.html#downloaded-weather-as-action-argument"><i class="fa fa-check"></i><b>10.2.3</b> downloaded weather as <code>action</code> argument</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="get_temp_data.html"><a href="get_temp_data.html#exercises_getting"><i class="fa fa-check"></i><code>Exercises</code> on getting temperature data</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html"><i class="fa fa-check"></i><b>11</b> Filling gaps in temperature records</a>
<ul>
<li class="chapter" data-level="" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#goals_gaps"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="11.1" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#gaps"><i class="fa fa-check"></i><b>11.1</b> Gaps</a></li>
<li class="chapter" data-level="11.2" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#filling-short-gaps-in-daily-records"><i class="fa fa-check"></i><b>11.2</b> Filling short gaps in daily records</a></li>
<li class="chapter" data-level="11.3" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#filling-long-gaps-in-daily-records"><i class="fa fa-check"></i><b>11.3</b> Filling long gaps in daily records</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#bias-correction-for-shorter-intervals"><i class="fa fa-check"></i><b>11.3.1</b> Bias-correction for shorter intervals</a></li>
<li class="chapter" data-level="11.3.2" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#saving-the-data-for-later"><i class="fa fa-check"></i><b>11.3.2</b> Saving the data for later</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#filling-gaps-in-hourly-records"><i class="fa fa-check"></i><b>11.4</b> Filling gaps in hourly records</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#accuracy-assessment"><i class="fa fa-check"></i><b>11.4.1</b> Accuracy assessment</a></li>
<li class="chapter" data-level="11.4.2" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#computing-agroclimatic-metrics"><i class="fa fa-check"></i><b>11.4.2</b> Computing agroclimatic metrics</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#exercises_patching"><i class="fa fa-check"></i><code>Exercises</code> on filling gaps</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html"><i class="fa fa-check"></i><b>12</b> Generating temperature scenarios</a>
<ul>
<li class="chapter" data-level="" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html#goals_temperature_scenarios"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="12.1" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html#chill-scenarios"><i class="fa fa-check"></i><b>12.1</b> Chill scenarios</a></li>
<li class="chapter" data-level="12.2" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html#risk-assessment-in-orchard-planning"><i class="fa fa-check"></i><b>12.2</b> Risk assessment in orchard planning</a></li>
<li class="chapter" data-level="12.3" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html#weather-generators"><i class="fa fa-check"></i><b>12.3</b> Weather generators</a></li>
<li class="chapter" data-level="12.4" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html#weather-generation-in-chillr"><i class="fa fa-check"></i><b>12.4</b> Weather generation in <code>chillR</code></a></li>
<li class="chapter" data-level="" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html#weather_generation_exercises"><i class="fa fa-check"></i><code>Exercises</code> on temperature generation</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="saving-and-loading-data-and-hiding-this-in-markdown.html"><a href="saving-and-loading-data-and-hiding-this-in-markdown.html"><i class="fa fa-check"></i><b>13</b> Saving and loading data (and hiding this in markdown)</a>
<ul>
<li class="chapter" data-level="13.1" data-path="saving-and-loading-data-and-hiding-this-in-markdown.html"><a href="saving-and-loading-data-and-hiding-this-in-markdown.html#learning-goals-for-this-lesson-1"><i class="fa fa-check"></i><b>13.1</b> Learning Goals for this lesson:</a></li>
<li class="chapter" data-level="13.2" data-path="saving-and-loading-data-and-hiding-this-in-markdown.html"><a href="saving-and-loading-data-and-hiding-this-in-markdown.html#saving-and-loading-data"><i class="fa fa-check"></i><b>13.2</b> Saving and loading data</a></li>
<li class="chapter" data-level="13.3" data-path="saving-and-loading-data-and-hiding-this-in-markdown.html"><a href="saving-and-loading-data-and-hiding-this-in-markdown.html#hiding-all-this-from-the-readers-of-our-markdown-file"><i class="fa fa-check"></i><b>13.3</b> Hiding all this from the readers of our markdown file</a></li>
<li class="chapter" data-level="" data-path="saving-and-loading-data-and-hiding-this-in-markdown.html"><a href="saving-and-loading-data-and-hiding-this-in-markdown.html#exercises_saveLoad"><i class="fa fa-check"></i><code>Exercises</code> on saving and loading data</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="historic-temperature-scenarios.html"><a href="historic-temperature-scenarios.html"><i class="fa fa-check"></i><b>14</b> Historic temperature scenarios</a>
<ul>
<li class="chapter" data-level="" data-path="historic-temperature-scenarios.html"><a href="historic-temperature-scenarios.html#goals_hist_temp_scen"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="14.1" data-path="historic-temperature-scenarios.html"><a href="historic-temperature-scenarios.html#climate-change-scenarios"><i class="fa fa-check"></i><b>14.1</b> Climate change scenarios</a></li>
<li class="chapter" data-level="14.2" data-path="historic-temperature-scenarios.html"><a href="historic-temperature-scenarios.html#making-historic-temperature-scenarios"><i class="fa fa-check"></i><b>14.2</b> Making historic temperature scenarios</a></li>
<li class="chapter" data-level="" data-path="historic-temperature-scenarios.html"><a href="historic-temperature-scenarios.html#exercises_historic_scenarios"><i class="fa fa-check"></i><code>Exercises</code> on generating historic temperature scenarios</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="future-temperature-scenarios.html"><a href="future-temperature-scenarios.html"><i class="fa fa-check"></i><b>15</b> Future temperature scenarios</a>
<ul>
<li class="chapter" data-level="" data-path="future-temperature-scenarios.html"><a href="future-temperature-scenarios.html#goals_future_temp_scen"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="15.1" data-path="future-temperature-scenarios.html"><a href="future-temperature-scenarios.html#impacts-of-future-climate-change"><i class="fa fa-check"></i><b>15.1</b> Impacts of future climate change</a></li>
<li class="chapter" data-level="15.2" data-path="future-temperature-scenarios.html"><a href="future-temperature-scenarios.html#future-climate-scenarios"><i class="fa fa-check"></i><b>15.2</b> Future climate scenarios</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="future-temperature-scenarios.html"><a href="future-temperature-scenarios.html#some-background-on-climate-models-and-warming-pathways"><i class="fa fa-check"></i><b>15.2.1</b> Some background on climate models and warming pathways</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="future-temperature-scenarios.html"><a href="future-temperature-scenarios.html#exercises_future_scenarios"><i class="fa fa-check"></i><code>Exercises</code> on future temperature scenarios</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html"><i class="fa fa-check"></i><b>16</b> Making CMIP6 scenarios</a>
<ul>
<li class="chapter" data-level="" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html#goals_CMIP6"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="16.1" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html#accessing-gridded-climate-data-from-the-copernicus-climate-data-store"><i class="fa fa-check"></i><b>16.1</b> Accessing gridded climate data from the Copernicus climate data store</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html#downloading-future-climate-data"><i class="fa fa-check"></i><b>16.1.1</b> Downloading future climate data</a></li>
<li class="chapter" data-level="16.1.2" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html#generating-change-scenarios"><i class="fa fa-check"></i><b>16.1.2</b> Generating change scenarios</a></li>
<li class="chapter" data-level="16.1.3" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html#extracting-data-from-the-grids"><i class="fa fa-check"></i><b>16.1.3</b> Extracting data from the grids</a></li>
<li class="chapter" data-level="16.1.4" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html#baseline-adjustment"><i class="fa fa-check"></i><b>16.1.4</b> Baseline adjustment</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html#exercises_CMIP6"><i class="fa fa-check"></i><code>Exercises</code> on generating CMIP6 temperature scenarios</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="making-cmip5-scenarios-with-the-climatewizard.html"><a href="making-cmip5-scenarios-with-the-climatewizard.html"><i class="fa fa-check"></i><b>17</b> Making CMIP5 scenarios with the <code>ClimateWizard</code></a>
<ul>
<li class="chapter" data-level="" data-path="making-cmip5-scenarios-with-the-climatewizard.html"><a href="making-cmip5-scenarios-with-the-climatewizard.html#goals_ClimateWizard"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="17.1" data-path="making-cmip5-scenarios-with-the-climatewizard.html"><a href="making-cmip5-scenarios-with-the-climatewizard.html#using-the-climatewizard"><i class="fa fa-check"></i><b>17.1</b> Using the <code>ClimateWizard</code></a></li>
<li class="chapter" data-level="" data-path="making-cmip5-scenarios-with-the-climatewizard.html"><a href="making-cmip5-scenarios-with-the-climatewizard.html#exercises_ClimateWizard"><i class="fa fa-check"></i><code>Exercises</code> on generating CMIP5 temperature scenarios</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="plot_future.html"><a href="plot_future.html"><i class="fa fa-check"></i><b>18</b> Plotting future scenarios</a>
<ul>
<li class="chapter" data-level="" data-path="plot_future.html"><a href="plot_future.html#goals_future_plots"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="18.1" data-path="plot_future.html"><a href="plot_future.html#making-attractive-plots"><i class="fa fa-check"></i><b>18.1</b> Making attractive plots</a></li>
<li class="chapter" data-level="18.2" data-path="plot_future.html"><a href="plot_future.html#the-results"><i class="fa fa-check"></i><b>18.2</b> The results</a></li>
<li class="chapter" data-level="" data-path="plot_future.html"><a href="plot_future.html#exercises_future_plots"><i class="fa fa-check"></i><code>Exercises</code> on plotting future projections</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="chill_model_comparison.html"><a href="chill_model_comparison.html"><i class="fa fa-check"></i><b>19</b> Chill model comparison</a>
<ul>
<li class="chapter" data-level="" data-path="chill_model_comparison.html"><a href="chill_model_comparison.html#goals_chill_model"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="19.1" data-path="chill_model_comparison.html"><a href="chill_model_comparison.html#safe-winter-chill"><i class="fa fa-check"></i><b>19.1</b> Safe Winter Chill</a></li>
<li class="chapter" data-level="19.2" data-path="chill_model_comparison.html"><a href="chill_model_comparison.html#chill-metrics"><i class="fa fa-check"></i><b>19.2</b> Chill metrics</a></li>
<li class="chapter" data-level="19.3" data-path="chill_model_comparison.html"><a href="chill_model_comparison.html#an-animated-plot-of-relative-changes-in-safe-winter-chill"><i class="fa fa-check"></i><b>19.3</b> An animated plot of relative changes in Safe Winter Chill</a></li>
<li class="chapter" data-level="" data-path="chill_model_comparison.html"><a href="chill_model_comparison.html#exercises_chill_model_comparison"><i class="fa fa-check"></i><code>Exercises</code> on chill model comparison</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="simple_phenology.html"><a href="simple_phenology.html"><i class="fa fa-check"></i><b>20</b> Simple phenology analysis</a>
<ul>
<li class="chapter" data-level="" data-path="simple_phenology.html"><a href="simple_phenology.html#goals_simple_phenology"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="20.1" data-path="simple_phenology.html"><a href="simple_phenology.html#phenology-analysis"><i class="fa fa-check"></i><b>20.1</b> Phenology analysis</a></li>
<li class="chapter" data-level="20.2" data-path="simple_phenology.html"><a href="simple_phenology.html#time-series-analysis"><i class="fa fa-check"></i><b>20.2</b> Time series analysis</a></li>
<li class="chapter" data-level="20.3" data-path="simple_phenology.html"><a href="simple_phenology.html#p-hacking"><i class="fa fa-check"></i><b>20.3</b> p-hacking</a></li>
<li class="chapter" data-level="20.4" data-path="simple_phenology.html"><a href="simple_phenology.html#the-process-that-generates-the-data"><i class="fa fa-check"></i><b>20.4</b> The process that generates the data</a></li>
<li class="chapter" data-level="20.5" data-path="simple_phenology.html"><a href="simple_phenology.html#an-ecological-theory-to-guide-our-analysis"><i class="fa fa-check"></i><b>20.5</b> An ecological theory to guide our analysis</a></li>
<li class="chapter" data-level="20.6" data-path="simple_phenology.html"><a href="simple_phenology.html#temperature-correlations"><i class="fa fa-check"></i><b>20.6</b> Temperature correlations</a></li>
<li class="chapter" data-level="" data-path="simple_phenology.html"><a href="simple_phenology.html#exercises_simple_analysis"><i class="fa fa-check"></i><code>Exercises</code> on simple phenology analysis</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="pls_intro.html"><a href="pls_intro.html"><i class="fa fa-check"></i><b>21</b> Delineating temperature response phases with PLS regression</a>
<ul>
<li class="chapter" data-level="" data-path="pls_intro.html"><a href="pls_intro.html#goals_PLS_intro"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="21.1" data-path="pls_intro.html"><a href="pls_intro.html#detecting-temperature-response-phases"><i class="fa fa-check"></i><b>21.1</b> Detecting temperature response phases</a></li>
<li class="chapter" data-level="21.2" data-path="pls_intro.html"><a href="pls_intro.html#finding-signals-in-hyperspectral-remote-sensing-data"><i class="fa fa-check"></i><b>21.2</b> Finding signals in hyperspectral remote sensing data</a></li>
<li class="chapter" data-level="21.3" data-path="pls_intro.html"><a href="pls_intro.html#pls-regression-for-phenology-analysis"><i class="fa fa-check"></i><b>21.3</b> PLS regression for phenology analysis</a></li>
<li class="chapter" data-level="21.4" data-path="pls_intro.html"><a href="pls_intro.html#a-note-of-caution-about-pls-results"><i class="fa fa-check"></i><b>21.4</b> A note of caution about PLS results</a></li>
<li class="chapter" data-level="21.5" data-path="pls_intro.html"><a href="pls_intro.html#pls-analysis-of-alexander-lucas-pears-in-klein-altendorf"><i class="fa fa-check"></i><b>21.5</b> PLS analysis of ‘Alexander Lucas’ pears in Klein-Altendorf</a></li>
<li class="chapter" data-level="" data-path="pls_intro.html"><a href="pls_intro.html#exercises_first_PLS"><i class="fa fa-check"></i><code>Exercises</code> on chill model comparison</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="pls_reflection.html"><a href="pls_reflection.html"><i class="fa fa-check"></i><b>22</b> Successes and limitations of PLS regression analysis</a>
<ul>
<li class="chapter" data-level="" data-path="pls_reflection.html"><a href="pls_reflection.html#goals_PLS_reflection"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="22.1" data-path="pls_reflection.html"><a href="pls_reflection.html#pls-regression"><i class="fa fa-check"></i><b>22.1</b> PLS regression</a></li>
<li class="chapter" data-level="22.2" data-path="pls_reflection.html"><a href="pls_reflection.html#pls-examples"><i class="fa fa-check"></i><b>22.2</b> PLS examples</a>
<ul>
<li class="chapter" data-level="22.2.1" data-path="pls_reflection.html"><a href="pls_reflection.html#grasslands-on-the-tibetan-plateau"><i class="fa fa-check"></i><b>22.2.1</b> Grasslands on the Tibetan Plateau</a></li>
<li class="chapter" data-level="22.2.2" data-path="pls_reflection.html"><a href="pls_reflection.html#deciduous-trees"><i class="fa fa-check"></i><b>22.2.2</b> Deciduous trees</a></li>
<li class="chapter" data-level="22.2.3" data-path="pls_reflection.html"><a href="pls_reflection.html#why-were-not-seeing-the-chilling-phase"><i class="fa fa-check"></i><b>22.2.3</b> Why we’re not seeing the chilling phase</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="pls_reflection.html"><a href="pls_reflection.html#exercises_PLS_reflection"><i class="fa fa-check"></i><code>Exercises</code> on chill model comparison</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="pls_chillforce.html"><a href="pls_chillforce.html"><i class="fa fa-check"></i><b>23</b> PLS regression with agroclimatic metrics</a>
<ul>
<li class="chapter" data-level="" data-path="pls_chillforce.html"><a href="pls_chillforce.html#goals_PLS_chillforce"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="23.1" data-path="pls_chillforce.html"><a href="pls_chillforce.html#adjusting-pls-for-use-with-non-monotonic-relationships"><i class="fa fa-check"></i><b>23.1</b> Adjusting PLS for use with non-monotonic relationships</a></li>
<li class="chapter" data-level="23.2" data-path="pls_chillforce.html"><a href="pls_chillforce.html#pls-analysis-with-chilling-and-forcing-data"><i class="fa fa-check"></i><b>23.2</b> PLS analysis with chilling and forcing data</a></li>
<li class="chapter" data-level="23.3" data-path="pls_chillforce.html"><a href="pls_chillforce.html#delineating-chilling-and-forcing-periods"><i class="fa fa-check"></i><b>23.3</b> Delineating chilling and forcing periods</a></li>
<li class="chapter" data-level="23.4" data-path="pls_chillforce.html"><a href="pls_chillforce.html#ggplotting-the-results"><i class="fa fa-check"></i><b>23.4</b> <code>ggplot</code>ting the results</a></li>
<li class="chapter" data-level="" data-path="pls_chillforce.html"><a href="pls_chillforce.html#exercises_PLS_chill_force"><i class="fa fa-check"></i><code>Exercises</code> on chill model comparison</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html"><i class="fa fa-check"></i><b>24</b> Examples of PLS regression with agroclimatic metrics</a>
<ul>
<li class="chapter" data-level="" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#goals_PLS_chillforce_ex"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="24.1" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#pls-regression-across-species-and-agroclimatic-contexts"><i class="fa fa-check"></i><b>24.1</b> PLS regression across species and agroclimatic contexts</a>
<ul>
<li class="chapter" data-level="24.1.1" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#chestnut-jujube-and-apricot-in-beijing"><i class="fa fa-check"></i><b>24.1.1</b> Chestnut, jujube and apricot in Beijing</a></li>
<li class="chapter" data-level="24.1.2" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#apples-in-shaanxi-province-china"><i class="fa fa-check"></i><b>24.1.2</b> Apples in Shaanxi Province, China</a></li>
<li class="chapter" data-level="24.1.3" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#cherries-in-klein-altendorf"><i class="fa fa-check"></i><b>24.1.3</b> Cherries in Klein-Altendorf</a></li>
<li class="chapter" data-level="24.1.4" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#apricots-in-the-uk"><i class="fa fa-check"></i><b>24.1.4</b> Apricots in the UK</a></li>
<li class="chapter" data-level="24.1.5" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#grapevine-in-croatia"><i class="fa fa-check"></i><b>24.1.5</b> Grapevine in Croatia</a></li>
<li class="chapter" data-level="24.1.6" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#walnuts-in-california"><i class="fa fa-check"></i><b>24.1.6</b> Walnuts in California</a></li>
<li class="chapter" data-level="24.1.7" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#almonds-in-tunisia"><i class="fa fa-check"></i><b>24.1.7</b> Almonds in Tunisia</a></li>
<li class="chapter" data-level="24.1.8" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#pistachios-in-tunisia"><i class="fa fa-check"></i><b>24.1.8</b> Pistachios in Tunisia</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#exercises_PLS_chill_force_ex"><i class="fa fa-check"></i><code>Exercises</code> on examples of PLS regression with agroclimatic metrics</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html"><i class="fa fa-check"></i><b>25</b> Why PLS doesn’t always work</a>
<ul>
<li class="chapter" data-level="" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#goals_PLS_chillforce_reflection"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="25.1" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#disappointing-pls-performance"><i class="fa fa-check"></i><b>25.1</b> Disappointing PLS performance</a></li>
<li class="chapter" data-level="25.2" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#what-pls-regression-can-find"><i class="fa fa-check"></i><b>25.2</b> What PLS regression can find</a></li>
<li class="chapter" data-level="25.3" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#chill-model-sensitivity-vs.-observed-temperature"><i class="fa fa-check"></i><b>25.3</b> Chill model sensitivity vs. observed temperature</a>
<ul>
<li class="chapter" data-level="25.3.1" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#beijing-china"><i class="fa fa-check"></i><b>25.3.1</b> Beijing, China</a></li>
<li class="chapter" data-level="25.3.2" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#klein-altendorf-germany"><i class="fa fa-check"></i><b>25.3.2</b> Klein-Altendorf, Germany</a></li>
<li class="chapter" data-level="25.3.3" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#davis-california"><i class="fa fa-check"></i><b>25.3.3</b> Davis, California</a></li>
<li class="chapter" data-level="25.3.4" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#sfax-tunisia"><i class="fa fa-check"></i><b>25.3.4</b> Sfax, Tunisia</a></li>
</ul></li>
<li class="chapter" data-level="25.4" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#heat-model-sensitivity-vs.-observed-temperature"><i class="fa fa-check"></i><b>25.4</b> Heat model sensitivity vs. observed temperature</a></li>
<li class="chapter" data-level="" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#exercises_PLS_chillforce_reflection"><i class="fa fa-check"></i><code>Exercises</code> on expected PLS responsiveness</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="pls_eval_PLS.html"><a href="pls_eval_PLS.html"><i class="fa fa-check"></i><b>26</b> Evaluating PLS outputs</a>
<ul>
<li class="chapter" data-level="" data-path="pls_eval_PLS.html"><a href="pls_eval_PLS.html#goals_PLS_eval"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="26.1" data-path="pls_eval_PLS.html"><a href="pls_eval_PLS.html#chilling-and-forcing-requirements"><i class="fa fa-check"></i><b>26.1</b> Chilling and forcing requirements</a></li>
<li class="chapter" data-level="26.2" data-path="pls_eval_PLS.html"><a href="pls_eval_PLS.html#response-to-seasonal-temperature"><i class="fa fa-check"></i><b>26.2</b> Response to seasonal temperature</a></li>
<li class="chapter" data-level="26.3" data-path="pls_eval_PLS.html"><a href="pls_eval_PLS.html#applying-our-functions-to-california-walnuts"><i class="fa fa-check"></i><b>26.3</b> Applying our functions to California walnuts</a></li>
<li class="chapter" data-level="" data-path="pls_eval_PLS.html"><a href="pls_eval_PLS.html#exercises_PLS_eval"><i class="fa fa-check"></i><code>Exercises</code> on evaluating PLS regression results</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="pls_chillforce_relimp.html"><a href="pls_chillforce_relimp.html"><i class="fa fa-check"></i><b>27</b> The relative importance of chill and heat</a>
<ul>
<li class="chapter" data-level="" data-path="pls_chillforce_relimp.html"><a href="pls_chillforce_relimp.html#goals_PLS_chillforce_relimp"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="27.1" data-path="pls_chillforce_relimp.html"><a href="pls_chillforce_relimp.html#chilling-vs.-forcing-temperatures"><i class="fa fa-check"></i><b>27.1</b> Chilling vs. forcing temperatures</a></li>
<li class="chapter" data-level="27.2" data-path="pls_chillforce_relimp.html"><a href="pls_chillforce_relimp.html#patterns-in-temperature-responses"><i class="fa fa-check"></i><b>27.2</b> Patterns in temperature responses</a></li>
<li class="chapter" data-level="27.3" data-path="pls_chillforce_relimp.html"><a href="pls_chillforce_relimp.html#the-warm-end-of-the-spectrum"><i class="fa fa-check"></i><b>27.3</b> The warm end of the spectrum</a></li>
<li class="chapter" data-level="27.4" data-path="pls_chillforce_relimp.html"><a href="pls_chillforce_relimp.html#implications-of-our-hypothesis"><i class="fa fa-check"></i><b>27.4</b> Implications of our hypothesis</a></li>
<li class="chapter" data-level="" data-path="pls_chillforce_relimp.html"><a href="pls_chillforce_relimp.html#exercises_PLS_chillforce_relimp"><i class="fa fa-check"></i><code>Exercises</code> on the relative importance of chill and heat</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="exp_PLS.html"><a href="exp_PLS.html"><i class="fa fa-check"></i><b>28</b> Experimentally enhanced PLS</a>
<ul>
<li class="chapter" data-level="" data-path="exp_PLS.html"><a href="exp_PLS.html#goals_exp_PLS"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="28.1" data-path="exp_PLS.html"><a href="exp_PLS.html#enhanced-phenology-data"><i class="fa fa-check"></i><b>28.1</b> Enhanced phenology data</a></li>
<li class="chapter" data-level="" data-path="exp_PLS.html"><a href="exp_PLS.html#exc_exp_PLS"><i class="fa fa-check"></i><code>Exercises</code> on experimental PLS</a></li>
</ul></li>
<li class="chapter" data-level="29" data-path="model_validity.html"><a href="model_validity.html"><i class="fa fa-check"></i><b>29</b> Making valid tree phenology models</a>
<ul>
<li class="chapter" data-level="" data-path="model_validity.html"><a href="model_validity.html#goals_model_validity"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="29.1" data-path="model_validity.html"><a href="model_validity.html#the-modeling-challenge"><i class="fa fa-check"></i><b>29.1</b> The modeling challenge</a></li>
<li class="chapter" data-level="29.2" data-path="model_validity.html"><a href="model_validity.html#validating-models"><i class="fa fa-check"></i><b>29.2</b> Validating models</a></li>
<li class="chapter" data-level="29.3" data-path="model_validity.html"><a href="model_validity.html#mapping-validity-domains"><i class="fa fa-check"></i><b>29.3</b> Mapping validity domains</a></li>
<li class="chapter" data-level="29.4" data-path="model_validity.html"><a href="model_validity.html#one-last-thought-on-model-validity"><i class="fa fa-check"></i><b>29.4</b> One last thought on model validity</a></li>
<li class="chapter" data-level="" data-path="model_validity.html"><a href="model_validity.html#ex_model_validity"><i class="fa fa-check"></i><code>Exercises</code> on making valid tree phenology models</a></li>
</ul></li>
<li class="chapter" data-level="30" data-path="phenoflex.html"><a href="phenoflex.html"><i class="fa fa-check"></i><b>30</b> The <code>PhenoFlex</code> model</a>
<ul>
<li class="chapter" data-level="" data-path="phenoflex.html"><a href="phenoflex.html#goals_phenoflex"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="30.1" data-path="phenoflex.html"><a href="phenoflex.html#ingredients-of-this-lesson"><i class="fa fa-check"></i><b>30.1</b> Ingredients of this lesson</a></li>
<li class="chapter" data-level="30.2" data-path="phenoflex.html"><a href="phenoflex.html#towards-credible-phenology-models"><i class="fa fa-check"></i><b>30.2</b> Towards credible phenology models</a></li>
<li class="chapter" data-level="30.3" data-path="phenoflex.html"><a href="phenoflex.html#the-phenoflex-framework"><i class="fa fa-check"></i><b>30.3</b> The PhenoFlex framework</a></li>
<li class="chapter" data-level="30.4" data-path="phenoflex.html"><a href="phenoflex.html#running-phenoflex"><i class="fa fa-check"></i><b>30.4</b> Running <code>PhenoFlex</code></a></li>
<li class="chapter" data-level="30.5" data-path="phenoflex.html"><a href="phenoflex.html#parameterizing-phenoflex"><i class="fa fa-check"></i><b>30.5</b> Parameterizing <code>PhenoFlex</code></a></li>
<li class="chapter" data-level="30.6" data-path="phenoflex.html"><a href="phenoflex.html#conclusions-on-phenoflex"><i class="fa fa-check"></i><b>30.6</b> Conclusions on <code>PhenoFlex</code></a></li>
<li class="chapter" data-level="" data-path="phenoflex.html"><a href="phenoflex.html#ex_model_phenoflex"><i class="fa fa-check"></i><code>Exercises</code> on making valid tree phenology models</a></li>
</ul></li>
<li class="chapter" data-level="31" data-path="phenoflex2.html"><a href="phenoflex2.html"><i class="fa fa-check"></i><b>31</b> The <code>PhenoFlex</code> model - a second look</a>
<ul>
<li class="chapter" data-level="" data-path="phenoflex2.html"><a href="phenoflex2.html#goals_phenoflex2"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="31.1" data-path="phenoflex2.html"><a href="phenoflex2.html#some-basic-diagnostics-for-our-phenoflex-fit"><i class="fa fa-check"></i><b>31.1</b> Some basic diagnostics for our <code>PhenoFlex</code> fit</a></li>
<li class="chapter" data-level="31.2" data-path="phenoflex2.html"><a href="phenoflex2.html#temperature-response-of-the-phenoflex-components"><i class="fa fa-check"></i><b>31.2</b> Temperature response of the <code>PhenoFlex</code> components</a></li>
<li class="chapter" data-level="31.3" data-path="phenoflex2.html"><a href="phenoflex2.html#overall-impression"><i class="fa fa-check"></i><b>31.3</b> Overall impression</a></li>
<li class="chapter" data-level="31.4" data-path="phenoflex2.html"><a href="phenoflex2.html#caveats-and-assumptions"><i class="fa fa-check"></i><b>31.4</b> Caveats and assumptions</a></li>
<li class="chapter" data-level="31.5" data-path="phenoflex2.html"><a href="phenoflex2.html#outlook"><i class="fa fa-check"></i><b>31.5</b> Outlook</a></li>
<li class="chapter" data-level="" data-path="phenoflex2.html"><a href="phenoflex2.html#ex_phenoflex2"><i class="fa fa-check"></i><code>Exercises</code> on basic <code>PhenoFlex</code> diagnostics</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="phenoflex3.html"><a href="phenoflex3.html"><i class="fa fa-check"></i><b>32</b> Can we improve the performance of <code>PhenoFlex</code>?</a>
<ul>
<li class="chapter" data-level="" data-path="phenoflex3.html"><a href="phenoflex3.html#goals_phenoflex3"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="32.1" data-path="phenoflex3.html"><a href="phenoflex3.html#the-motivation"><i class="fa fa-check"></i><b>32.1</b> The motivation</a></li>
<li class="chapter" data-level="32.2" data-path="phenoflex3.html"><a href="phenoflex3.html#using-experimental-phenology-data-for-assessing-the-performance-of-phenoflex"><i class="fa fa-check"></i><b>32.2</b> Using experimental phenology data for assessing the performance of <code>PhenoFlex</code></a></li>
<li class="chapter" data-level="32.3" data-path="phenoflex3.html"><a href="phenoflex3.html#validation"><i class="fa fa-check"></i><b>32.3</b> Validation</a></li>
<li class="chapter" data-level="32.4" data-path="phenoflex3.html"><a href="phenoflex3.html#conclusions"><i class="fa fa-check"></i><b>32.4</b> Conclusions</a></li>
<li class="chapter" data-level="" data-path="phenoflex3.html"><a href="phenoflex3.html#ex_phenoflex3"><i class="fa fa-check"></i><code>Exercises</code> on improving the performance of <code>PhenoFlex</code></a></li>
</ul></li>
<li class="chapter" data-level="33" data-path="frost-risk-analysis.html"><a href="frost-risk-analysis.html"><i class="fa fa-check"></i><b>33</b> Frost risk analysis</a>
<ul>
<li class="chapter" data-level="" data-path="frost-risk-analysis.html"><a href="frost-risk-analysis.html#goals_frost_risk"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="33.1" data-path="frost-risk-analysis.html"><a href="frost-risk-analysis.html#spring-frost"><i class="fa fa-check"></i><b>33.1</b> Spring frost</a></li>
<li class="chapter" data-level="33.2" data-path="frost-risk-analysis.html"><a href="frost-risk-analysis.html#phenology-trend-analysis"><i class="fa fa-check"></i><b>33.2</b> Phenology trend analysis</a></li>
<li class="chapter" data-level="33.3" data-path="frost-risk-analysis.html"><a href="frost-risk-analysis.html#frost-risk"><i class="fa fa-check"></i><b>33.3</b> Frost risk</a></li>
<li class="chapter" data-level="" data-path="frost-risk-analysis.html"><a href="frost-risk-analysis.html#exercises_frost_risk"><i class="fa fa-check"></i><code>Exercises</code> on frost risk analysis</a></li>
</ul></li>
<li class="chapter" data-level="34" data-path="a-robust-method-to-estimate-future-frost-risks.html"><a href="a-robust-method-to-estimate-future-frost-risks.html"><i class="fa fa-check"></i><b>34</b> A robust method to estimate future frost risks (?)</a>
<ul>
<li class="chapter" data-level="" data-path="a-robust-method-to-estimate-future-frost-risks.html"><a href="a-robust-method-to-estimate-future-frost-risks.html#goals_future_frost_risk"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="34.1" data-path="a-robust-method-to-estimate-future-frost-risks.html"><a href="a-robust-method-to-estimate-future-frost-risks.html#frost-risk-for-future-scenarios"><i class="fa fa-check"></i><b>34.1</b> Frost risk for future scenarios</a></li>
<li class="chapter" data-level="34.2" data-path="a-robust-method-to-estimate-future-frost-risks.html"><a href="a-robust-method-to-estimate-future-frost-risks.html#validation-1"><i class="fa fa-check"></i><b>34.2</b> Validation</a></li>
<li class="chapter" data-level="34.3" data-path="a-robust-method-to-estimate-future-frost-risks.html"><a href="a-robust-method-to-estimate-future-frost-risks.html#exercises-for-this-chapter"><i class="fa fa-check"></i><b>34.3</b> <code>Exercises</code> for this chapter</a></li>
</ul></li>
<li class="chapter" data-level="35" data-path="major_concepts.html"><a href="major_concepts.html"><i class="fa fa-check"></i><b>35</b> Major concepts</a>
<ul>
<li class="chapter" data-level="" data-path="major_concepts.html"><a href="major_concepts.html#goals_major_concepts"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="35.1" data-path="major_concepts.html"><a href="major_concepts.html#key-insights"><i class="fa fa-check"></i><b>35.1</b> Key insights</a>
<ul>
<li class="chapter" data-level="35.1.1" data-path="major_concepts.html"><a href="major_concepts.html#tree-dormancy-1"><i class="fa fa-check"></i><b>35.1.1</b> Tree dormancy</a></li>
<li class="chapter" data-level="35.1.2" data-path="major_concepts.html"><a href="major_concepts.html#climate-change"><i class="fa fa-check"></i><b>35.1.2</b> Climate change</a></li>
<li class="chapter" data-level="35.1.3" data-path="major_concepts.html"><a href="major_concepts.html#phenology-modeling"><i class="fa fa-check"></i><b>35.1.3</b> Phenology modeling</a></li>
<li class="chapter" data-level="35.1.4" data-path="major_concepts.html"><a href="major_concepts.html#phenology-responses-to-global-warming"><i class="fa fa-check"></i><b>35.1.4</b> Phenology responses to global warming</a></li>
<li class="chapter" data-level="35.1.5" data-path="major_concepts.html"><a href="major_concepts.html#the-phenoflex-modeling-framework"><i class="fa fa-check"></i><b>35.1.5</b> The <code>PhenoFlex</code> modeling framework</a></li>
</ul></li>
<li class="chapter" data-level="35.2" data-path="major_concepts.html"><a href="major_concepts.html#major-concepts-weve-encountered"><i class="fa fa-check"></i><b>35.2</b> Major concepts we’ve encountered</a>
<ul>
<li class="chapter" data-level="35.2.1" data-path="major_concepts.html"><a href="major_concepts.html#reproducibility-and-transparency"><i class="fa fa-check"></i><b>35.2.1</b> Reproducibility and transparency</a></li>
<li class="chapter" data-level="35.2.2" data-path="major_concepts.html"><a href="major_concepts.html#tools"><i class="fa fa-check"></i><b>35.2.2</b> Tools</a></li>
<li class="chapter" data-level="35.2.3" data-path="major_concepts.html"><a href="major_concepts.html#automate-and-move-on"><i class="fa fa-check"></i><b>35.2.3</b> Automate and move on</a></li>
<li class="chapter" data-level="35.2.4" data-path="major_concepts.html"><a href="major_concepts.html#the-power-of-r"><i class="fa fa-check"></i><b>35.2.4</b> The power of R</a></li>
<li class="chapter" data-level="35.2.5" data-path="major_concepts.html"><a href="major_concepts.html#curiosity-and-interdisciplinarity"><i class="fa fa-check"></i><b>35.2.5</b> Curiosity and interdisciplinarity</a></li>
<li class="chapter" data-level="35.2.6" data-path="major_concepts.html"><a href="major_concepts.html#uncertainty"><i class="fa fa-check"></i><b>35.2.6</b> Uncertainty</a></li>
<li class="chapter" data-level="35.2.7" data-path="major_concepts.html"><a href="major_concepts.html#p-hacking-1"><i class="fa fa-check"></i><b>35.2.7</b> p-hacking</a></li>
<li class="chapter" data-level="35.2.8" data-path="major_concepts.html"><a href="major_concepts.html#the-dangers-of-machine-learning"><i class="fa fa-check"></i><b>35.2.8</b> The dangers of machine learning</a></li>
<li class="chapter" data-level="35.2.9" data-path="major_concepts.html"><a href="major_concepts.html#rationalizing"><i class="fa fa-check"></i><b>35.2.9</b> Rationalizing</a></li>
<li class="chapter" data-level="35.2.10" data-path="major_concepts.html"><a href="major_concepts.html#overfitting"><i class="fa fa-check"></i><b>35.2.10</b> Overfitting</a></li>
<li class="chapter" data-level="35.2.11" data-path="major_concepts.html"><a href="major_concepts.html#the-process-that-generated-the-data"><i class="fa fa-check"></i><b>35.2.11</b> The process that generated the data</a></li>
<li class="chapter" data-level="35.2.12" data-path="major_concepts.html"><a href="major_concepts.html#the-importance-of-theory"><i class="fa fa-check"></i><b>35.2.12</b> The importance of theory</a></li>
<li class="chapter" data-level="35.2.13" data-path="major_concepts.html"><a href="major_concepts.html#conceptual-modeling"><i class="fa fa-check"></i><b>35.2.13</b> Conceptual modeling</a></li>
<li class="chapter" data-level="35.2.14" data-path="major_concepts.html"><a href="major_concepts.html#consistency-with-existing-theory-and-prior-knowledge"><i class="fa fa-check"></i><b>35.2.14</b> Consistency with existing theory and prior knowledge</a></li>
<li class="chapter" data-level="35.2.15" data-path="major_concepts.html"><a href="major_concepts.html#model-validity-and-model-validation"><i class="fa fa-check"></i><b>35.2.15</b> Model validity and model validation</a></li>
<li class="chapter" data-level="35.2.16" data-path="major_concepts.html"><a href="major_concepts.html#our-role-in-research"><i class="fa fa-check"></i><b>35.2.16</b> Our role in research</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="major_concepts.html"><a href="major_concepts.html#ex_majorconcepts"><i class="fa fa-check"></i><code>Exercises</code> on major concepts</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="refs.html"><a href="refs.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tree phenology analysis with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="pls_intro" class="section level1 hasAnchor" number="21">
<h1><span class="header-section-number">Chapter 21</span> Delineating temperature response phases with PLS regression<a href="pls_intro.html#pls_intro" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="goals_PLS_intro" class="section level2 unnumbered hasAnchor">
<h2>Learning goals for this lesson<a href="pls_intro.html#goals_PLS_intro" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Understand the difference between simple regression approaches and the challenge to detect signals in noisy datasets</li>
<li>Fully understand why relating high-resolution temperature records to phenology data is challenging</li>
<li>Understand roughly what PLS regression does</li>
<li>Be able to use the <code>PLS_pheno</code> function in <code>chillR</code></li>
<li>Be able to use <code>ggplot</code> to produce a nice figure of PLS results</li>
</ul>
</div>
<div id="detecting-temperature-response-phases" class="section level2 hasAnchor" number="21.1">
<h2><span class="header-section-number">21.1</span> Detecting temperature response phases<a href="pls_intro.html#detecting-temperature-response-phases" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the last lesson, we tried - somewhat unsuccessfully - to find simple relationships between temperature during particular periods and phenology. Based on what we already know about phenology, we shouldn’t be particularly surprised by this. Spring phenology responds to exposure to chilling temperatures over a considerable period, during which the precise timing of this exposure is probably not important. The same applies to heat. We thus shouldn’t expect temperature during a single well-defined period to explain much of the observed variation in bloom or leafing dates. It seems more likely that temperatures during longer periods have an effect, possibly with varying levels of effectiveness. Methods that either fully consider temperatures during particular intervals or completely discard them are then not very promising.</p>
<p>Another major problem is that we may have high-resolution temperature data, e.g. at daily or even hourly resolution, but we may not have a good way of correlating this to observed phenology. Statistically, this is because we are relating a small number of dependent variables - e.g. bloom dates, for which we usually just have one value per year - with a large number of independent variables - temperatures on each day, or during each hour, of the dormant season. Ordinary regression procedures don’t do well in such settings.</p>
<p>The statistical challenge we are encountering here is not unique, however. Wanting to explain relatively few observations with lots of independent variables is actually a pretty common challenge, for example in remote sensing, and researchers in several disciplines have found ways of dealing with it. Let’s take a quick trip to the context where I first encountered promising analysis techniques.</p>
</div>
<div id="finding-signals-in-hyperspectral-remote-sensing-data" class="section level2 hasAnchor" number="21.2">
<h2><span class="header-section-number">21.2</span> Finding signals in hyperspectral remote sensing data<a href="pls_intro.html#finding-signals-in-hyperspectral-remote-sensing-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>I first worked with hyperspectral data in the context of a project in California, where we tried to detect <a href="https://en.wikipedia.org/wiki/Spider_mite">spider mite</a> damage in peaches <a href="https://www.sciencedirect.com/science/article/abs/pii/S0303243409000221"><span class="citation">(<span>Luedeling et al., 2009c</span>)</span></a>. Hyperspectral data often contain spectral reflectance (or absorption) data for radiation at hundreds (even thousands) of spectral wavelengths. Such spectra are then related to properties of particular materials. In our case, we had scored mite damage on 1132 peach leaves, for which we also collected reflectance spectra at wavelengths between 350 and 2500 nm.</p>
<p>The following image shows two distinct reflectance profiles that represent healthy (0% damage) and heavily affected (90% damage) leaves. As you can see, the healthy leaves reflected less light at wavelengths around 500 nm and more light in a wide region around 1000 nm. We can easily see that here, but there are also mathematical procedures for detecting the signals caused by a particular property of the material (in this case mite damage).</p>
<div class="float">
<img src="pictures/Mites_spectra.png" alt="Hyperspectral reflectance spectra of healthy (0% damage) and highly mite-affected (90% damage) peach leaves in California. The lines show the averages, the shading illustrates the standard error of the mean (Luedeling et al., 2009c)" />
<div class="figcaption">Hyperspectral reflectance spectra of healthy (0% damage) and highly mite-affected (90% damage) peach leaves in California. The lines show the averages, the shading illustrates the standard error of the mean <a href="https://www.sciencedirect.com/science/article/abs/pii/S0303243409000221"><span class="citation">(<span>Luedeling et al., 2009c</span>)</span></a></div>
</div>
<p>To identify significant wavelengths, we should not look at this as a regression exercise, but rather address the situation as a signal detection problem. There is a lot of noise in such datasets, and we’re looking for the signal that is produced by the property we’re trying to measure.</p>
<p>There are a number of methods to detect signals, and the blossoming machine learning literature keeps producing new ones. The method I adopted back then, and which we’re also going to learn about in this lesson, is Projection-to-Latent-Structures (PLS) regression, also known as Partial Least Squares regression. I prefer the complicated name, because it is more informative about what is going on. In principle, the method identifies latent structures, a sort of principal components, that best describe the variation in the dataset. These latent structures are then used in a regression procedure. I won’t talk about the mathematical details here, because that would be boring (and I also never fully understood them…) - what matters is that this is quite effective in identifying signals in noisy datasets, and it works in situations where we have lots of independent variables and just one dependent variable, for which we don’t necessarily need a lot of observations.</p>
<p>Here are the PLS results for the peach leaf dataset, relating reflectance to mite damage:</p>
<div class="float">
<img src="pictures/mites_PLS.png" alt="Coefficients of a PLS model relating mite damage to hyperspectral reflectance data. Particularly prominent wavelengths are marked (Luedeling et al., 2009c)" />
<div class="figcaption">Coefficients of a PLS model relating mite damage to hyperspectral reflectance data. Particularly prominent wavelengths are marked <a href="https://www.sciencedirect.com/science/article/abs/pii/S0303243409000221"><span class="citation">(<span>Luedeling et al., 2009c</span>)</span></a></div>
</div>
<p>We can see here that certain wavelengths are particularly strongly correlated with spider mite damage, so it might be possible to construct some sort of mite detection index by concentrating on wavelengths around 365 nm, 497 nm, 687 nm and so forth. Well, in this case that didn’t work so well. Except for cases of extreme damage, we didn’t really manage to detect mites. Or as one of my colleagues in the project put it: “Yes, at some point you can detect mite damage, but at that point, you could also detect mites by driving past the orchard at 60 miles an hour and just looking out of the window”…</p>
<p>Well, fortunately, mite detection is not what we’re after here. What I want to point out is that the general statistical situation here is quite similar to the situation we’re facing when trying to relate high-resolution temperature to tree phenology. We have one dependent variable, just a few observations and lots of independent variables. So let’s see if PLS regression can help us with our temperature responses.</p>
</div>
<div id="pls-regression-for-phenology-analysis" class="section level2 hasAnchor" number="21.3">
<h2><span class="header-section-number">21.3</span> PLS regression for phenology analysis<a href="pls_intro.html#pls-regression-for-phenology-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>I first tried this kind of analysis with leaf emergence data of the walnut cultivar ‘Payne’ in California <a href="https://www.sciencedirect.com/science/article/abs/pii/S0168192312000561"><span class="citation">(<span>Luedeling &amp; Gassner, 2012</span>)</span></a>. We used PLS regression on a 54-year dataset, from 1953-2007 (with data for 1996 missing), recorded at the University of California at Davis.</p>
<p>We related these leaf emergence dates with mean daily temperature, obtaining the following results:</p>
<div class="float">
<img src="pictures/PLS_Payne.png" alt="Results of a PLS regression analysis of the relationship between leaf emergence of ‘Payne’ walnuts in Davis, California, and daily mean temperature during the dormant season (Luedeling et al., 2012)" />
<div class="figcaption">Results of a PLS regression analysis of the relationship between leaf emergence of ‘Payne’ walnuts in Davis, California, and daily mean temperature during the dormant season <a href="https://www.sciencedirect.com/science/article/abs/pii/S0168192312000561"><span class="citation">(<span>Luedeling et al., 2012</span>)</span></a></div>
</div>
<p>This figure shows three versions of the analysis. In the analysis that produced the topmost set of figures, unprocessed daily mean temperatures were related to phenology dates. The results looked a little fuzzy, so I also ran the analysis with an 11-day running mean of temperatures (middle) and also with monthly data (bottom). Each set of plots contains illustrations of two results: the model coefficients, which are comparable to the coefficients of a normal regression model, and the ‘variable importance in the projection’ score (VIP), which indicates how important the contribution of each daily temperature is for the overall regression model. This is often interpreted as a sort of ‘significance’, which is decided on by using a cut-off threshold (often 0.8).</p>
<p>So what do we see here? Basically, the model coefficients illustrate how leaf emergence dates are affected by particularly warm or cool conditions on a certain day. Positive model coefficients indicate a positive relationship between (Julian) leaf emergence dates and temperature, i.e. warmer than usual temperatures are correlated with later than usual leaf emergence dates. Conversely, negative model coefficients indicate a negative correlation, i.e. warm temperatures are related to early spring phenology.</p>
<p>When we relate the emerging pattern of model coefficients to our understanding of the dormancy process, we can detect two distinct phases here. Between early November and mid-January, we see a period with positive model coefficients (and high VIP scores), i.e. warm conditions during this period are related to delayed leaf emergence in spring. This is consistent with what we might expect to be happening during the chilling period, when warm conditions might delay the fulfillment of chilling requirements, which would in turn delay all subsequent development.</p>
<p>Following this period of positive model coefficients, we see a phase with negative coefficients between mid-January and (about) the end of March. Such coefficients are consistent with our expectation for the forcing phase, when warm temperatures would accelerate heat accumulation and thus advance leaf emergence.</p>
<p>After early to mid-April, we see an inconsistent pattern. Given that leaf emergence happens in March to very early April, this is not surprising. Temperatures after this time cannot possibly affect budbreak dates. We also see that temperature response patterns before November are inconsistent. This may indicate that no chill accumulates before the end of October.</p>
<p>We found quite similar patterns for the cultivars ‘Chandler’ and ‘Franquette’:</p>
<div class="float">
<img src="pictures/PLS_walnuts.png" alt="VIP scores and model coefficients of PLS models relating leaf emergence dates of the walnut cultivars ‘Payne’, ‘Chandler’ and ‘Franquette’ in Davis, California, with mean daily temperatures (Luedeling et al., 2012)" />
<div class="figcaption">VIP scores and model coefficients of PLS models relating leaf emergence dates of the walnut cultivars ‘Payne’, ‘Chandler’ and ‘Franquette’ in Davis, California, with mean daily temperatures <a href="https://www.sciencedirect.com/science/article/abs/pii/S0168192312000561"><span class="citation">(<span>Luedeling et al., 2012</span>)</span></a></div>
</div>
<p>As you can see, the model coefficient patterns are a bit less clear here, including brief interruptions of the chilling period for the two other cultivars and lots of variation in heat and chilling responses. What does this mean?</p>
</div>
<div id="a-note-of-caution-about-pls-results" class="section level2 hasAnchor" number="21.4">
<h2><span class="header-section-number">21.4</span> A note of caution about PLS results<a href="pls_intro.html#a-note-of-caution-about-pls-results" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We always have to keep in mind what PLS is and what it can do. This is a data mining technique that is usually used with a lot larger datasets than what we have here. Remember that in the spider mite example, we had over 1000 leaf samples. The method also works with less data, but we should not expect results to be crystal-clear then. It is thus very important that we don’t overinterpret every little feature of the plots that emerges.</p>
<p>In fact, when we’re dealing with datasets as small as the ones we usually encounter in phenology analysis, I would strongly advise against using PLS as a data-mining tool, i.e. to detect patterns in the data. This tool should only be used in conjunction with a theory about how the system works. With this, we can use the PLS results to support or possibly refute certain ideas. In our case, we may start with a strong expectation of finding a chilling period (with positive model coefficients), followed by a forcing period (with negative coefficients). Our results are consistent with our theory, so - together with this theory - the picture that emerges is quite consistent.</p>
<p><strong><em>Important: always keep in mind that we’re using PLS with a very small dataset and we should not place too much emphasis on individual characteristics of the emerging model coefficient patterns</em></strong> (unless of course, we have other reasons to believe they are meaningful, or we find them across many similar analyses).</p>
<p>In this context, it is important that we clarify our expectations <em>before</em> we run our analysis. It’s always possible to interpret random patterns that emerge in some reasonable-sounding way after the fact, but this practice - which is also known as <em>rationalizing</em> - isn’t particularly sound. It’s pretty common, however, in the discussions of machine-learning papers…</p>
</div>
<div id="pls-analysis-of-alexander-lucas-pears-in-klein-altendorf" class="section level2 hasAnchor" number="21.5">
<h2><span class="header-section-number">21.5</span> PLS analysis of ‘Alexander Lucas’ pears in Klein-Altendorf<a href="pls_intro.html#pls-analysis-of-alexander-lucas-pears-in-klein-altendorf" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now let’s try this analysis for ourselves. We’ll work with the dataset of pears (cultivar ‘Alexander Lucas’) we already looked at before (you can download it in the <a href="simple_phenology.html#simple_phenology">Simple phenology analysis</a> chapter). We’ll start with first bloom, which we first have to convert to Julian dates:</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="pls_intro.html#cb320-1" tabindex="-1"></a><span class="fu">library</span>(chillR)</span>
<span id="cb320-2"><a href="pls_intro.html#cb320-2" tabindex="-1"></a></span>
<span id="cb320-3"><a href="pls_intro.html#cb320-3" tabindex="-1"></a></span>
<span id="cb320-4"><a href="pls_intro.html#cb320-4" tabindex="-1"></a>Alex_first <span class="ot">&lt;-</span> <span class="fu">read_tab</span>(<span class="st">&quot;data/Alexander_Lucas_bloom_1958_2019.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb320-5"><a href="pls_intro.html#cb320-5" tabindex="-1"></a>  <span class="fu">select</span>(Pheno_year, First_bloom) <span class="sc">%&gt;%</span></span>
<span id="cb320-6"><a href="pls_intro.html#cb320-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(First_bloom, <span class="dv">1</span>, <span class="dv">4</span>)),</span>
<span id="cb320-7"><a href="pls_intro.html#cb320-7" tabindex="-1"></a>         <span class="at">Month =</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(First_bloom, <span class="dv">5</span>, <span class="dv">6</span>)),</span>
<span id="cb320-8"><a href="pls_intro.html#cb320-8" tabindex="-1"></a>         <span class="at">Day =</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(First_bloom, <span class="dv">7</span>, <span class="dv">8</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb320-9"><a href="pls_intro.html#cb320-9" tabindex="-1"></a>  <span class="fu">make_JDay</span>() <span class="sc">%&gt;%</span></span>
<span id="cb320-10"><a href="pls_intro.html#cb320-10" tabindex="-1"></a>  <span class="fu">select</span>(Pheno_year, JDay) <span class="sc">%&gt;%</span></span>
<span id="cb320-11"><a href="pls_intro.html#cb320-11" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Year =</span> Pheno_year,</span>
<span id="cb320-12"><a href="pls_intro.html#cb320-12" tabindex="-1"></a>         <span class="at">pheno =</span> JDay)</span></code></pre></div>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="pls_intro.html#cb321-1" tabindex="-1"></a><span class="fu">head</span>(Alex_first)</span></code></pre></div>
<table class="table table-striped" style="font-size: 8px; ">
<thead>
<tr>
<th style="text-align:right;">
Year
</th>
<th style="text-align:right;">
pheno
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1958
</td>
<td style="text-align:right;">
122
</td>
</tr>
<tr>
<td style="text-align:right;">
1959
</td>
<td style="text-align:right;">
98
</td>
</tr>
<tr>
<td style="text-align:right;">
1960
</td>
<td style="text-align:right;">
101
</td>
</tr>
<tr>
<td style="text-align:right;">
1961
</td>
<td style="text-align:right;">
89
</td>
</tr>
<tr>
<td style="text-align:right;">
1962
</td>
<td style="text-align:right;">
117
</td>
</tr>
<tr>
<td style="text-align:right;">
1963
</td>
<td style="text-align:right;">
118
</td>
</tr>
</tbody>
</table>
<p>The PLS function we’ll use is a bit particular about the format of this <code>data.frame</code>, so I had to adjust the <code>data.frame</code> structure a bit and change the column names. Now we need temperature data, which we have also worked with before:</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="pls_intro.html#cb322-1" tabindex="-1"></a>KA_temps <span class="ot">&lt;-</span> <span class="fu">read_tab</span>(<span class="st">&quot;data/TMaxTMin1958-2019_patched.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb322-2"><a href="pls_intro.html#cb322-2" tabindex="-1"></a>  <span class="fu">make_JDay</span>()</span></code></pre></div>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="pls_intro.html#cb323-1" tabindex="-1"></a><span class="fu">head</span>(KA_temps)</span></code></pre></div>
<table class="table table-striped" style="font-size: 8px; ">
<thead>
<tr>
<th style="text-align:left;">
DATE
</th>
<th style="text-align:right;">
YEARMODA
</th>
<th style="text-align:right;">
Year
</th>
<th style="text-align:right;">
Month
</th>
<th style="text-align:right;">
Day
</th>
<th style="text-align:right;">
Tmin
</th>
<th style="text-align:right;">
Tmax
</th>
<th style="text-align:left;">
Tmin_source
</th>
<th style="text-align:left;">
Tmax_source
</th>
<th style="text-align:left;">
no_Tmin
</th>
<th style="text-align:left;">
no_Tmax
</th>
<th style="text-align:right;">
JDay
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
01-01-58
</td>
<td style="text-align:right;">
19580101
</td>
<td style="text-align:right;">
1958
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5.0
</td>
<td style="text-align:right;">
7.50
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
02-01-58
</td>
<td style="text-align:right;">
19580102
</td>
<td style="text-align:right;">
1958
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1.5
</td>
<td style="text-align:right;">
9.00
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
03-01-58
</td>
<td style="text-align:right;">
19580103
</td>
<td style="text-align:right;">
1958
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
-5.5
</td>
<td style="text-align:right;">
1.10
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
04-01-58
</td>
<td style="text-align:right;">
19580104
</td>
<td style="text-align:right;">
1958
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
-5.5
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
05-01-58
</td>
<td style="text-align:right;">
19580105
</td>
<td style="text-align:right;">
1958
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
3.5
</td>
<td style="text-align:right;">
2.75
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
06-01-58
</td>
<td style="text-align:right;">
19580106
</td>
<td style="text-align:right;">
1958
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
3.0
</td>
<td style="text-align:right;">
5.00
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
6
</td>
</tr>
</tbody>
</table>
<p>This <code>data.frame</code> can be more complex, but it needs to conform to the typical structure of <code>chillR</code> temperature datasets, i.e. it must have columns <code>Year</code>, <code>Month</code>, <code>Day</code>, <code>Tmin</code>, <code>Tmax</code> and in this case also <code>JDay</code>.</p>
<p>With these two inputs, we can now use the <code>PLS_pheno</code> function from the <code>chillR</code> package. I note here that this function makes use of the <a href="https://cran.r-project.org/web/packages/pls/vignettes/pls-manual.pdf"><code>plsr</code></a> package.</p>
<p>The <code>PLS_pheno</code> function requires as a minimum just a temperature dataset (<code>weather_data</code>) and a phenology dataset (<code>bio_data</code>). The result is a list of three objects: <code>$object_type</code> - just the string ‘PLS_Temp_pheno’, <code>$pheno</code> - the phenology input data, and <code>$PLS_summary</code> - the results we’re interested in.</p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="pls_intro.html#cb324-1" tabindex="-1"></a>PLS_results <span class="ot">&lt;-</span> <span class="fu">PLS_pheno</span>(KA_temps,</span>
<span id="cb324-2"><a href="pls_intro.html#cb324-2" tabindex="-1"></a>                         Alex_first)</span></code></pre></div>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="pls_intro.html#cb325-1" tabindex="-1"></a><span class="fu">head</span>(PLS_results<span class="sc">$</span>PLS_summary)</span></code></pre></div>
<table class="table table-striped" style="font-size: 8px; ">
<thead>
<tr>
<th style="text-align:right;">
Date
</th>
<th style="text-align:right;">
JDay
</th>
<th style="text-align:right;">
Coef
</th>
<th style="text-align:right;">
VIP
</th>
<th style="text-align:right;">
Tmean
</th>
<th style="text-align:right;">
Tstdev
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
801
</td>
<td style="text-align:right;">
-152
</td>
<td style="text-align:right;">
0.0826036
</td>
<td style="text-align:right;">
0.3676590
</td>
<td style="text-align:right;">
18.32970
</td>
<td style="text-align:right;">
1.914004
</td>
</tr>
<tr>
<td style="text-align:right;">
802
</td>
<td style="text-align:right;">
-151
</td>
<td style="text-align:right;">
0.0932920
</td>
<td style="text-align:right;">
0.4159775
</td>
<td style="text-align:right;">
18.30846
</td>
<td style="text-align:right;">
1.884389
</td>
</tr>
<tr>
<td style="text-align:right;">
803
</td>
<td style="text-align:right;">
-150
</td>
<td style="text-align:right;">
0.0940262
</td>
<td style="text-align:right;">
0.4530441
</td>
<td style="text-align:right;">
18.27148
</td>
<td style="text-align:right;">
1.844368
</td>
</tr>
<tr>
<td style="text-align:right;">
804
</td>
<td style="text-align:right;">
-149
</td>
<td style="text-align:right;">
0.0899057
</td>
<td style="text-align:right;">
0.4609463
</td>
<td style="text-align:right;">
18.23742
</td>
<td style="text-align:right;">
1.886276
</td>
</tr>
<tr>
<td style="text-align:right;">
805
</td>
<td style="text-align:right;">
-148
</td>
<td style="text-align:right;">
0.0643769
</td>
<td style="text-align:right;">
0.4140336
</td>
<td style="text-align:right;">
18.19609
</td>
<td style="text-align:right;">
1.884567
</td>
</tr>
<tr>
<td style="text-align:right;">
806
</td>
<td style="text-align:right;">
-147
</td>
<td style="text-align:right;">
0.0103315
</td>
<td style="text-align:right;">
0.4476572
</td>
<td style="text-align:right;">
18.17148
</td>
<td style="text-align:right;">
1.855337
</td>
</tr>
</tbody>
</table>
<p>This summary object contains 6 columns: <code>Date</code>- the calendar day coded as <code>MMDD</code>, <code>JDay</code>- the Julian date, <code>Coef</code>- the PLS model coefficient, <code>VIP</code>- the variable importance in the projection score, <code>Tmean</code> - the mean temperature on the respective day, and <code>Tstdev</code> the standard deviation of temperatures on this day across the whole temperature dataset.</p>
<p>This <code>PLS_results</code> element can now be plotted with the dedicated plotting function <code>plot_PLS</code>. Here’s what the results of this would look like:</p>
<div class="float">
<img src="pictures/PLS_out.png" alt="Temperature response pattern of ‘Alexander Lucas’ pears in Klein-Altendorf, as determined by PLS regression and plotted with the standard function in chillR" />
<div class="figcaption">Temperature response pattern of ‘Alexander Lucas’ pears in Klein-Altendorf, as determined by PLS regression and plotted with the standard function in <code>chillR</code></div>
</div>
<p>What you see here now is a bit prettier than the figures from the original PLS publication. We have the VIP plot on top, with ‘important’ days highlighted in blue. In the second row, we have the model coefficients, with data for all the days identified as ‘important’ shown in red (when negative) or green (when positive). In the bottom row, we see the temperature dynamics during this time, with the mean temperature across all years shown by the black line, and the standard deviation indicated by the shading, which uses the same color scheme as the model coefficient plot. The gray shading at the left end of the plot shows the full range of observed bloom dates, with the dashed line indicating the mean bloom date.</p>
<p>I hope you like how this figure looks - because you can’t really change much in it… It was also a lot of work to make this look ok. This is mainly because I put all of this together using the standard plotting functions in R, which (with my programming skills at the time) make it pretty difficult to produce complex figures. Since the sizes of all text elements and many other things had to be specifically modified, the only way to ensure acceptable outputs was to directly write the plot to an image file.</p>
<p>Before we reproduce this using <code>ggplot</code>, let’s look at the parameters of the <code>PLS_pheno</code> function.</p>
<ul>
<li><code>split_month</code> - the <code>PLS_pheno</code> function uses temperature data for an entire year, but we can decide when to start this year. The default is 7, which means that the phenological year ends at the end of July.</li>
<li><code>runn_mean</code> - the running mean to be applied to the temperature data before the analysis. We can set this to 1, but then we get a fairly messy temperature response pattern. The default is 11, which has usually worked pretty well.</li>
<li><code>end_at_pheno_end</code> - if this is set to <code>TRUE</code> (the default), then temperatures after the latest <code>JDay</code> of the phenology dataset aren’t considered in the analysis.</li>
<li><code>use_Tmean</code> - this can be set to <code>TRUE</code>, if your temperature dataset has a <code>Tmean</code> column and you want to use that rather than calculating means from <code>Tmin</code> and <code>TMax</code>.</li>
<li><code>expl.var</code>, <code>ncomp.fix</code> and <code>crossvalidate</code> refer to specifics of the PLS analysis, <code>return.all</code> indicates that you also want all the PLS outputs to be returned. Refer to the help function of <code>PLS_pheno</code> and possibly to the <code>plsr</code> package for more details.</li>
</ul>
<p>So now let’s make the same plot in <code>ggplot</code>:</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="pls_intro.html#cb326-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb326-2"><a href="pls_intro.html#cb326-2" tabindex="-1"></a></span>
<span id="cb326-3"><a href="pls_intro.html#cb326-3" tabindex="-1"></a>PLS_gg <span class="ot">&lt;-</span> PLS_results<span class="sc">$</span>PLS_summary <span class="sc">%&gt;%</span></span>
<span id="cb326-4"><a href="pls_intro.html#cb326-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">trunc</span>(Date <span class="sc">/</span> <span class="dv">100</span>),</span>
<span id="cb326-5"><a href="pls_intro.html#cb326-5" tabindex="-1"></a>         <span class="at">Day =</span> Date <span class="sc">-</span> Month <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb326-6"><a href="pls_intro.html#cb326-6" tabindex="-1"></a>         <span class="at">Date =</span> <span class="cn">NULL</span>) </span>
<span id="cb326-7"><a href="pls_intro.html#cb326-7" tabindex="-1"></a></span>
<span id="cb326-8"><a href="pls_intro.html#cb326-8" tabindex="-1"></a>PLS_gg<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">ISOdate</span>(<span class="dv">2002</span>, </span>
<span id="cb326-9"><a href="pls_intro.html#cb326-9" tabindex="-1"></a>                       PLS_gg<span class="sc">$</span>Month, </span>
<span id="cb326-10"><a href="pls_intro.html#cb326-10" tabindex="-1"></a>                       PLS_gg<span class="sc">$</span>Day)</span>
<span id="cb326-11"><a href="pls_intro.html#cb326-11" tabindex="-1"></a>PLS_gg<span class="sc">$</span>Date[PLS_gg<span class="sc">$</span>JDay <span class="sc">&lt;=</span> <span class="dv">0</span>] <span class="ot">&lt;-</span></span>
<span id="cb326-12"><a href="pls_intro.html#cb326-12" tabindex="-1"></a>  <span class="fu">ISOdate</span>(<span class="dv">2001</span>, </span>
<span id="cb326-13"><a href="pls_intro.html#cb326-13" tabindex="-1"></a>          PLS_gg<span class="sc">$</span>Month[PLS_gg<span class="sc">$</span>JDay <span class="sc">&lt;=</span> <span class="dv">0</span>], </span>
<span id="cb326-14"><a href="pls_intro.html#cb326-14" tabindex="-1"></a>          PLS_gg<span class="sc">$</span>Day[PLS_gg<span class="sc">$</span>JDay <span class="sc">&lt;=</span> <span class="dv">0</span>])</span>
<span id="cb326-15"><a href="pls_intro.html#cb326-15" tabindex="-1"></a></span>
<span id="cb326-16"><a href="pls_intro.html#cb326-16" tabindex="-1"></a>PLS_gg <span class="ot">&lt;-</span> PLS_gg <span class="sc">%&gt;%</span></span>
<span id="cb326-17"><a href="pls_intro.html#cb326-17" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">VIP_importance =</span> VIP <span class="sc">&gt;=</span> <span class="fl">0.8</span>,</span>
<span id="cb326-18"><a href="pls_intro.html#cb326-18" tabindex="-1"></a>         <span class="at">VIP_Coeff =</span> <span class="fu">factor</span>(<span class="fu">sign</span>(Coef) <span class="sc">*</span> VIP_importance))</span>
<span id="cb326-19"><a href="pls_intro.html#cb326-19" tabindex="-1"></a></span>
<span id="cb326-20"><a href="pls_intro.html#cb326-20" tabindex="-1"></a></span>
<span id="cb326-21"><a href="pls_intro.html#cb326-21" tabindex="-1"></a>VIP_plot<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(PLS_gg,</span>
<span id="cb326-22"><a href="pls_intro.html#cb326-22" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">x =</span> Date,<span class="at">y =</span> VIP)) <span class="sc">+</span></span>
<span id="cb326-23"><a href="pls_intro.html#cb326-23" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>,</span>
<span id="cb326-24"><a href="pls_intro.html#cb326-24" tabindex="-1"></a>           <span class="fu">aes</span>(<span class="at">fill =</span> VIP <span class="sc">&gt;</span> <span class="fl">0.8</span>))</span>
<span id="cb326-25"><a href="pls_intro.html#cb326-25" tabindex="-1"></a></span>
<span id="cb326-26"><a href="pls_intro.html#cb326-26" tabindex="-1"></a>VIP_plot <span class="ot">&lt;-</span> VIP_plot <span class="sc">+</span></span>
<span id="cb326-27"><a href="pls_intro.html#cb326-27" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name=</span><span class="st">&quot;VIP&quot;</span>, </span>
<span id="cb326-28"><a href="pls_intro.html#cb326-28" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;&lt;0.8&quot;</span>, <span class="st">&quot;&gt;0.8&quot;</span>), </span>
<span id="cb326-29"><a href="pls_intro.html#cb326-29" tabindex="-1"></a>                    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;FALSE&quot;</span> <span class="ot">=</span> <span class="st">&quot;grey&quot;</span>, <span class="st">&quot;TRUE&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>)) <span class="sc">+</span></span>
<span id="cb326-30"><a href="pls_intro.html#cb326-30" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb326-31"><a href="pls_intro.html#cb326-31" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb326-32"><a href="pls_intro.html#cb326-32" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb326-33"><a href="pls_intro.html#cb326-33" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb326-34"><a href="pls_intro.html#cb326-34" tabindex="-1"></a></span>
<span id="cb326-35"><a href="pls_intro.html#cb326-35" tabindex="-1"></a>VIP_plot</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-193-1.png" width="672" /></p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="pls_intro.html#cb327-1" tabindex="-1"></a>coeff_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(PLS_gg,</span>
<span id="cb327-2"><a href="pls_intro.html#cb327-2" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> Date,</span>
<span id="cb327-3"><a href="pls_intro.html#cb327-3" tabindex="-1"></a>                         <span class="at">y =</span> Coef)) <span class="sc">+</span></span>
<span id="cb327-4"><a href="pls_intro.html#cb327-4" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span><span class="st">&#39;identity&#39;</span>,</span>
<span id="cb327-5"><a href="pls_intro.html#cb327-5" tabindex="-1"></a>           <span class="fu">aes</span>(<span class="at">fill =</span> VIP_Coeff)) <span class="sc">+</span></span>
<span id="cb327-6"><a href="pls_intro.html#cb327-6" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">&quot;Effect direction&quot;</span>, </span>
<span id="cb327-7"><a href="pls_intro.html#cb327-7" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Advancing&quot;</span>,</span>
<span id="cb327-8"><a href="pls_intro.html#cb327-8" tabindex="-1"></a>                               <span class="st">&quot;Unimportant&quot;</span>,</span>
<span id="cb327-9"><a href="pls_intro.html#cb327-9" tabindex="-1"></a>                               <span class="st">&quot;Delaying&quot;</span>), </span>
<span id="cb327-10"><a href="pls_intro.html#cb327-10" tabindex="-1"></a>                    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;-1&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb327-11"><a href="pls_intro.html#cb327-11" tabindex="-1"></a>                               <span class="st">&quot;0&quot;</span> <span class="ot">=</span> <span class="st">&quot;grey&quot;</span>,</span>
<span id="cb327-12"><a href="pls_intro.html#cb327-12" tabindex="-1"></a>                               <span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;dark green&quot;</span>)) <span class="sc">+</span></span>
<span id="cb327-13"><a href="pls_intro.html#cb327-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb327-14"><a href="pls_intro.html#cb327-14" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;PLS coefficient&quot;</span>) <span class="sc">+</span></span>
<span id="cb327-15"><a href="pls_intro.html#cb327-15" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb327-16"><a href="pls_intro.html#cb327-16" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb327-17"><a href="pls_intro.html#cb327-17" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>() )</span>
<span id="cb327-18"><a href="pls_intro.html#cb327-18" tabindex="-1"></a></span>
<span id="cb327-19"><a href="pls_intro.html#cb327-19" tabindex="-1"></a>coeff_plot</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-193-2.png" width="672" /></p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="pls_intro.html#cb328-1" tabindex="-1"></a>temp_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(PLS_gg) <span class="sc">+</span></span>
<span id="cb328-2"><a href="pls_intro.html#cb328-2" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> Date,</span>
<span id="cb328-3"><a href="pls_intro.html#cb328-3" tabindex="-1"></a>                  <span class="at">ymin =</span> Tmean <span class="sc">-</span> Tstdev,</span>
<span id="cb328-4"><a href="pls_intro.html#cb328-4" tabindex="-1"></a>                  <span class="at">ymax =</span> Tmean <span class="sc">+</span> Tstdev),</span>
<span id="cb328-5"><a href="pls_intro.html#cb328-5" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb328-6"><a href="pls_intro.html#cb328-6" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> Date,</span>
<span id="cb328-7"><a href="pls_intro.html#cb328-7" tabindex="-1"></a>                  <span class="at">ymin =</span> Tmean <span class="sc">-</span> Tstdev <span class="sc">*</span> (VIP_Coeff <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb328-8"><a href="pls_intro.html#cb328-8" tabindex="-1"></a>                  <span class="at">ymax =</span> Tmean <span class="sc">+</span> Tstdev <span class="sc">*</span> (VIP_Coeff <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>)),</span>
<span id="cb328-9"><a href="pls_intro.html#cb328-9" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb328-10"><a href="pls_intro.html#cb328-10" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> Date,</span>
<span id="cb328-11"><a href="pls_intro.html#cb328-11" tabindex="-1"></a>                  <span class="at">ymin =</span> Tmean <span class="sc">-</span> Tstdev <span class="sc">*</span> (VIP_Coeff <span class="sc">==</span> <span class="dv">1</span>),</span>
<span id="cb328-12"><a href="pls_intro.html#cb328-12" tabindex="-1"></a>                  <span class="at">ymax =</span> Tmean <span class="sc">+</span> Tstdev <span class="sc">*</span> (VIP_Coeff <span class="sc">==</span> <span class="dv">1</span>)),</span>
<span id="cb328-13"><a href="pls_intro.html#cb328-13" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">&quot;dark green&quot;</span>) <span class="sc">+</span></span>
<span id="cb328-14"><a href="pls_intro.html#cb328-14" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> Date,</span>
<span id="cb328-15"><a href="pls_intro.html#cb328-15" tabindex="-1"></a>                <span class="at">y =</span> Tmean)) <span class="sc">+</span></span>
<span id="cb328-16"><a href="pls_intro.html#cb328-16" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb328-17"><a href="pls_intro.html#cb328-17" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(T[mean],<span class="st">&quot; (°C)&quot;</span>)))</span>
<span id="cb328-18"><a href="pls_intro.html#cb328-18" tabindex="-1"></a></span>
<span id="cb328-19"><a href="pls_intro.html#cb328-19" tabindex="-1"></a>temp_plot</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-193-3.png" width="672" /></p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="pls_intro.html#cb329-1" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb329-2"><a href="pls_intro.html#cb329-2" tabindex="-1"></a></span>
<span id="cb329-3"><a href="pls_intro.html#cb329-3" tabindex="-1"></a>plot<span class="ot">&lt;-</span> (VIP_plot <span class="sc">+</span></span>
<span id="cb329-4"><a href="pls_intro.html#cb329-4" tabindex="-1"></a>          coeff_plot <span class="sc">+</span></span>
<span id="cb329-5"><a href="pls_intro.html#cb329-5" tabindex="-1"></a>          temp_plot <span class="sc">+</span></span>
<span id="cb329-6"><a href="pls_intro.html#cb329-6" tabindex="-1"></a>          <span class="fu">plot_layout</span>(<span class="at">ncol=</span><span class="dv">1</span>,</span>
<span id="cb329-7"><a href="pls_intro.html#cb329-7" tabindex="-1"></a>            <span class="at">guides =</span> <span class="st">&quot;collect&quot;</span>)</span>
<span id="cb329-8"><a href="pls_intro.html#cb329-8" tabindex="-1"></a>        ) <span class="sc">&amp;</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb329-9"><a href="pls_intro.html#cb329-9" tabindex="-1"></a>                  <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb329-10"><a href="pls_intro.html#cb329-10" tabindex="-1"></a>                  <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb329-11"><a href="pls_intro.html#cb329-11" tabindex="-1"></a>                  <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb329-12"><a href="pls_intro.html#cb329-12" tabindex="-1"></a></span>
<span id="cb329-13"><a href="pls_intro.html#cb329-13" tabindex="-1"></a>plot</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-193-4.png" width="672" /></p>
<p>That was a bit of work, but now we have code that produces a nice compound figure that shows everything we expect of the outputs of a PLS analysis. So why not make a function from this?</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="pls_intro.html#cb330-1" tabindex="-1"></a>ggplot_PLS <span class="ot">&lt;-</span> <span class="cf">function</span>(PLS_results)</span>
<span id="cb330-2"><a href="pls_intro.html#cb330-2" tabindex="-1"></a>{</span>
<span id="cb330-3"><a href="pls_intro.html#cb330-3" tabindex="-1"></a>  <span class="fu">library</span>(ggplot2)</span>
<span id="cb330-4"><a href="pls_intro.html#cb330-4" tabindex="-1"></a>  PLS_gg <span class="ot">&lt;-</span> PLS_results<span class="sc">$</span>PLS_summary <span class="sc">%&gt;%</span></span>
<span id="cb330-5"><a href="pls_intro.html#cb330-5" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">trunc</span>(Date <span class="sc">/</span> <span class="dv">100</span>),</span>
<span id="cb330-6"><a href="pls_intro.html#cb330-6" tabindex="-1"></a>           <span class="at">Day =</span> Date <span class="sc">-</span> Month <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb330-7"><a href="pls_intro.html#cb330-7" tabindex="-1"></a>           <span class="at">Date =</span> <span class="cn">NULL</span>) </span>
<span id="cb330-8"><a href="pls_intro.html#cb330-8" tabindex="-1"></a>  </span>
<span id="cb330-9"><a href="pls_intro.html#cb330-9" tabindex="-1"></a>  PLS_gg<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">ISOdate</span>(<span class="dv">2002</span>, </span>
<span id="cb330-10"><a href="pls_intro.html#cb330-10" tabindex="-1"></a>                         PLS_gg<span class="sc">$</span>Month, </span>
<span id="cb330-11"><a href="pls_intro.html#cb330-11" tabindex="-1"></a>                         PLS_gg<span class="sc">$</span>Day)</span>
<span id="cb330-12"><a href="pls_intro.html#cb330-12" tabindex="-1"></a>  </span>
<span id="cb330-13"><a href="pls_intro.html#cb330-13" tabindex="-1"></a>  PLS_gg<span class="sc">$</span>Date[PLS_gg<span class="sc">$</span>JDay <span class="sc">&lt;=</span> <span class="dv">0</span>] <span class="ot">&lt;-</span></span>
<span id="cb330-14"><a href="pls_intro.html#cb330-14" tabindex="-1"></a>    <span class="fu">ISOdate</span>(<span class="dv">2001</span>, </span>
<span id="cb330-15"><a href="pls_intro.html#cb330-15" tabindex="-1"></a>            PLS_gg<span class="sc">$</span>Month[PLS_gg<span class="sc">$</span>JDay <span class="sc">&lt;=</span> <span class="dv">0</span>], </span>
<span id="cb330-16"><a href="pls_intro.html#cb330-16" tabindex="-1"></a>            PLS_gg<span class="sc">$</span>Day[PLS_gg<span class="sc">$</span>JDay <span class="sc">&lt;=</span> <span class="dv">0</span>])</span>
<span id="cb330-17"><a href="pls_intro.html#cb330-17" tabindex="-1"></a>  </span>
<span id="cb330-18"><a href="pls_intro.html#cb330-18" tabindex="-1"></a>  PLS_gg <span class="ot">&lt;-</span> PLS_gg <span class="sc">%&gt;%</span></span>
<span id="cb330-19"><a href="pls_intro.html#cb330-19" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">VIP_importance =</span> VIP <span class="sc">&gt;=</span> <span class="fl">0.8</span>,</span>
<span id="cb330-20"><a href="pls_intro.html#cb330-20" tabindex="-1"></a>           <span class="at">VIP_Coeff =</span> <span class="fu">factor</span>(<span class="fu">sign</span>(Coef) <span class="sc">*</span> VIP_importance))</span>
<span id="cb330-21"><a href="pls_intro.html#cb330-21" tabindex="-1"></a>  </span>
<span id="cb330-22"><a href="pls_intro.html#cb330-22" tabindex="-1"></a>  VIP_plot<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(PLS_gg,<span class="fu">aes</span>(<span class="at">x=</span>Date,<span class="at">y=</span>VIP)) <span class="sc">+</span></span>
<span id="cb330-23"><a href="pls_intro.html#cb330-23" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&#39;identity&#39;</span>,<span class="fu">aes</span>(<span class="at">fill=</span>VIP<span class="sc">&gt;</span><span class="fl">0.8</span>))</span>
<span id="cb330-24"><a href="pls_intro.html#cb330-24" tabindex="-1"></a>  </span>
<span id="cb330-25"><a href="pls_intro.html#cb330-25" tabindex="-1"></a>  VIP_plot <span class="ot">&lt;-</span> VIP_plot <span class="sc">+</span></span>
<span id="cb330-26"><a href="pls_intro.html#cb330-26" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">name=</span><span class="st">&quot;VIP&quot;</span>, </span>
<span id="cb330-27"><a href="pls_intro.html#cb330-27" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;&lt;0.8&quot;</span>, <span class="st">&quot;&gt;0.8&quot;</span>), </span>
<span id="cb330-28"><a href="pls_intro.html#cb330-28" tabindex="-1"></a>                      <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;FALSE&quot;</span> <span class="ot">=</span> <span class="st">&quot;grey&quot;</span>, </span>
<span id="cb330-29"><a href="pls_intro.html#cb330-29" tabindex="-1"></a>                                 <span class="st">&quot;TRUE&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>)) <span class="sc">+</span></span>
<span id="cb330-30"><a href="pls_intro.html#cb330-30" tabindex="-1"></a>    <span class="fu">theme_bw</span>(<span class="at">base_size=</span><span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb330-31"><a href="pls_intro.html#cb330-31" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb330-32"><a href="pls_intro.html#cb330-32" tabindex="-1"></a>          <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb330-33"><a href="pls_intro.html#cb330-33" tabindex="-1"></a>          <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb330-34"><a href="pls_intro.html#cb330-34" tabindex="-1"></a>  </span>
<span id="cb330-35"><a href="pls_intro.html#cb330-35" tabindex="-1"></a>  coeff_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(PLS_gg,</span>
<span id="cb330-36"><a href="pls_intro.html#cb330-36" tabindex="-1"></a>                       <span class="fu">aes</span>(<span class="at">x =</span> Date,</span>
<span id="cb330-37"><a href="pls_intro.html#cb330-37" tabindex="-1"></a>                           <span class="at">y =</span> Coef)) <span class="sc">+</span></span>
<span id="cb330-38"><a href="pls_intro.html#cb330-38" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span><span class="st">&#39;identity&#39;</span>,</span>
<span id="cb330-39"><a href="pls_intro.html#cb330-39" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">fill =</span> VIP_Coeff)) <span class="sc">+</span></span>
<span id="cb330-40"><a href="pls_intro.html#cb330-40" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">&quot;Effect direction&quot;</span>, </span>
<span id="cb330-41"><a href="pls_intro.html#cb330-41" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Advancing&quot;</span>,</span>
<span id="cb330-42"><a href="pls_intro.html#cb330-42" tabindex="-1"></a>                                 <span class="st">&quot;Unimportant&quot;</span>,</span>
<span id="cb330-43"><a href="pls_intro.html#cb330-43" tabindex="-1"></a>                                 <span class="st">&quot;Delaying&quot;</span>), </span>
<span id="cb330-44"><a href="pls_intro.html#cb330-44" tabindex="-1"></a>                      <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;-1&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb330-45"><a href="pls_intro.html#cb330-45" tabindex="-1"></a>                                 <span class="st">&quot;0&quot;</span> <span class="ot">=</span> <span class="st">&quot;grey&quot;</span>,</span>
<span id="cb330-46"><a href="pls_intro.html#cb330-46" tabindex="-1"></a>                                 <span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;dark green&quot;</span>)) <span class="sc">+</span></span>
<span id="cb330-47"><a href="pls_intro.html#cb330-47" tabindex="-1"></a>    <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb330-48"><a href="pls_intro.html#cb330-48" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;PLS coefficient&quot;</span>) <span class="sc">+</span></span>
<span id="cb330-49"><a href="pls_intro.html#cb330-49" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb330-50"><a href="pls_intro.html#cb330-50" tabindex="-1"></a>          <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb330-51"><a href="pls_intro.html#cb330-51" tabindex="-1"></a>          <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb330-52"><a href="pls_intro.html#cb330-52" tabindex="-1"></a>  </span>
<span id="cb330-53"><a href="pls_intro.html#cb330-53" tabindex="-1"></a>  temp_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(PLS_gg) <span class="sc">+</span></span>
<span id="cb330-54"><a href="pls_intro.html#cb330-54" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> Date,</span>
<span id="cb330-55"><a href="pls_intro.html#cb330-55" tabindex="-1"></a>                    <span class="at">ymin =</span> Tmean <span class="sc">-</span> Tstdev,</span>
<span id="cb330-56"><a href="pls_intro.html#cb330-56" tabindex="-1"></a>                    <span class="at">ymax =</span> Tmean <span class="sc">+</span> Tstdev),</span>
<span id="cb330-57"><a href="pls_intro.html#cb330-57" tabindex="-1"></a>                <span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb330-58"><a href="pls_intro.html#cb330-58" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> Date,</span>
<span id="cb330-59"><a href="pls_intro.html#cb330-59" tabindex="-1"></a>                    <span class="at">ymin =</span> Tmean <span class="sc">-</span> Tstdev <span class="sc">*</span> (VIP_Coeff <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb330-60"><a href="pls_intro.html#cb330-60" tabindex="-1"></a>                    <span class="at">ymax =</span> Tmean <span class="sc">+</span> Tstdev <span class="sc">*</span> (VIP_Coeff <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>)),</span>
<span id="cb330-61"><a href="pls_intro.html#cb330-61" tabindex="-1"></a>                <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb330-62"><a href="pls_intro.html#cb330-62" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> Date,</span>
<span id="cb330-63"><a href="pls_intro.html#cb330-63" tabindex="-1"></a>                    <span class="at">ymin =</span> Tmean <span class="sc">-</span> Tstdev <span class="sc">*</span> (VIP_Coeff <span class="sc">==</span> <span class="dv">1</span>),</span>
<span id="cb330-64"><a href="pls_intro.html#cb330-64" tabindex="-1"></a>                    <span class="at">ymax =</span> Tmean <span class="sc">+</span> Tstdev <span class="sc">*</span> (VIP_Coeff <span class="sc">==</span> <span class="dv">1</span>)),</span>
<span id="cb330-65"><a href="pls_intro.html#cb330-65" tabindex="-1"></a>                <span class="at">fill =</span> <span class="st">&quot;dark green&quot;</span>) <span class="sc">+</span></span>
<span id="cb330-66"><a href="pls_intro.html#cb330-66" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> Date,</span>
<span id="cb330-67"><a href="pls_intro.html#cb330-67" tabindex="-1"></a>                  <span class="at">y =</span> Tmean)) <span class="sc">+</span></span>
<span id="cb330-68"><a href="pls_intro.html#cb330-68" tabindex="-1"></a>    <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb330-69"><a href="pls_intro.html#cb330-69" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(T[mean],<span class="st">&quot; (°C)&quot;</span>)))</span>
<span id="cb330-70"><a href="pls_intro.html#cb330-70" tabindex="-1"></a>  </span>
<span id="cb330-71"><a href="pls_intro.html#cb330-71" tabindex="-1"></a>  <span class="fu">library</span>(patchwork)</span>
<span id="cb330-72"><a href="pls_intro.html#cb330-72" tabindex="-1"></a>  </span>
<span id="cb330-73"><a href="pls_intro.html#cb330-73" tabindex="-1"></a>  plot<span class="ot">&lt;-</span> (VIP_plot <span class="sc">+</span></span>
<span id="cb330-74"><a href="pls_intro.html#cb330-74" tabindex="-1"></a>            coeff_plot <span class="sc">+</span></span>
<span id="cb330-75"><a href="pls_intro.html#cb330-75" tabindex="-1"></a>            temp_plot <span class="sc">+</span></span>
<span id="cb330-76"><a href="pls_intro.html#cb330-76" tabindex="-1"></a>            <span class="fu">plot_layout</span>(<span class="at">ncol=</span><span class="dv">1</span>,</span>
<span id="cb330-77"><a href="pls_intro.html#cb330-77" tabindex="-1"></a>                        <span class="at">guides =</span> <span class="st">&quot;collect&quot;</span>)</span>
<span id="cb330-78"><a href="pls_intro.html#cb330-78" tabindex="-1"></a>          ) <span class="sc">&amp;</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb330-79"><a href="pls_intro.html#cb330-79" tabindex="-1"></a>                    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb330-80"><a href="pls_intro.html#cb330-80" tabindex="-1"></a>                    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb330-81"><a href="pls_intro.html#cb330-81" tabindex="-1"></a>                    <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb330-82"><a href="pls_intro.html#cb330-82" tabindex="-1"></a>  </span>
<span id="cb330-83"><a href="pls_intro.html#cb330-83" tabindex="-1"></a>  plot}</span>
<span id="cb330-84"><a href="pls_intro.html#cb330-84" tabindex="-1"></a></span>
<span id="cb330-85"><a href="pls_intro.html#cb330-85" tabindex="-1"></a><span class="fu">ggplot_PLS</span>(PLS_results)</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-194-1.png" width="672" /></p>
<p>Now we have a function that can automatically plot the outputs of a PLS analysis. After solving this technical challenge, we can finally take a look at the results of our analysis… which do not look as expected. We see a strong bloom-advancing response to high temperatures in spring, but where is the chilling period? We’ll get to this in the next lesson, but maybe you already have some ideas?</p>
</div>
<div id="exercises_first_PLS" class="section level2 unnumbered hasAnchor">
<h2><code>Exercises</code> on chill model comparison<a href="pls_intro.html#exercises_first_PLS" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Please document all results of the following assignments in your <code>learning logbook</code>.</p>
<ol style="list-style-type: decimal">
<li>Briefly explain why you shouldn’t take the results of a PLS regression analysis between temperature and phenology at face value. What do you need in addition in order to make sense of such outputs?</li>
<li>Replicate the PLS analysis for the <em>Roter Boskoop</em> dataset that you used in a previous lesson.</li>
</ol>
<button class="btn btn-warning" onclick="&#10;    async function downloadFile(event) {&#10;      event.preventDefault();&#10;      try {&#10;        const response = await fetch(&#39;data:text/csv;base64,UGhlbm9feWVhcjtGaXJzdF9ibG9vbTtGdWxsX2Jsb29tO0xhc3RfYmxvb20KMTk1ODsxOTU4MDUwOTsxOTU4MDUxMTsxOTU4MDUxNAoxOTU5OzE5NTkwNDE0OzE5NTkwNDIxOzE5NTkwNTA0CjE5NjA7MTk2MDA0MjQ7MTk2MDA1MDU7MTk2MDA1MTAKMTk2MTsxOTYxMDQwOTsxOTYxMDQxOTsxOTYxMDUwMQoxOTYyOzE5NjIwNTE0OzE5NjIwNTIyOzE5NjIwNTMwCjE5NjM7MTk2MzA1MDc7MTk2MzA1MTU7MTk2MzA1MjQKMTk2NDsxOTY0MDUwNTsxOTY0MDUxMTsxOTY0MDUxOAoxOTY1OzE5NjUwNTExOzE5NjUwNTE2OzE5NjUwNTI0CjE5NjY7MTk2NjA0MjY7MTk2NjA0MzA7MTk2NjA1MDcKMTk2NzsxOTY3MDQzMDsxOTY3MDUwOTsxOTY3MDUxNQoxOTY4OzE5NjgwNTAxOzE5NjgwNTA0OzE5NjgwNTExCjE5Njk7MTk2OTA1MDU7MTk2OTA1MTA7MTk2OTA1MTgKMTk3MDsxOTcwMDUxNDsxOTcwMDUyMDsxOTcwMDUyNgoxOTcxOzE5NzEwNTAzOzE5NzEwNTEwOzE5NzEwNTE0CjE5NzI7MTk3MjA0MzA7MTk3MjA1MDU7MTk3MjA1MTkKMTk3MzsxOTczMDUxMzsxOTczMDUxNjsxOTczMDUyMAoxOTc0OzE5NzQwNDEyOzE5NzQwNDE2OzE5NzQwNDI0CjE5NzU7MTk3NTA0Mjk7MTk3NTA1MDY7MTk3NTA1MTgKMTk3NjsxOTc2MDUwNTsxOTc2MDUwODsxOTc2MDUxNAoxOTc3OzE5NzcwNTA0OzE5NzcwNTE1OzE5NzcwNTI1CjE5Nzg7MTk3ODA1MDQ7MTk3ODA1MDc7MTk3ODA1MjgKMTk3OTsxOTc5MDUxNDsxOTc5MDUxNjsxOTc5MDUyNwoxOTgwOzE5ODAwNTA2OzE5ODAwNTEzOzE5ODAwNTE5CjE5ODE7MTk4MTA0MTU7MTk4MTA0MzA7MTk4MTA1MTQKMTk4MjsxOTgyMDUxMDsxOTgyMDUxMzsxOTgyMDUyMwoxOTgzOzE5ODMwNTAzOzE5ODMwNTA4OzE5ODMwNTE0CjE5ODQ7MTk4NDA1MDg7MTk4NDA1MTg7MTk4NDA1MjgKMTk4NTsxOTg1MDUxMzsxOTg1MDUxODsxOTg1MDUyMQoxOTg2OzE5ODYwNTExOzE5ODYwNTE1OzE5ODYwNTIxCjE5ODc7MTk4NzA1MDE7MTk4NzA1MDU7MTk4NzA1MTYKMTk4ODsxOTg4MDQzMDsxOTg4MDUwMzsxOTg4MDUxNQoxOTg5OzE5ODkwNDIwOzE5ODkwNDI5OzE5ODkwNTExCjE5OTA7MTk5MDA0MDU7MTk5MDA0MTI7MTk5MDA0MjgKMTk5MTsxOTkxMDQxNjsxOTkxMDQzMDsxOTkxMDUyMAoxOTkyOzE5OTIwNDI2OzE5OTIwNTAyOzE5OTIwNTEyCjE5OTM7MTk5MzA0MjY7MTk5MzA0Mjk7MTk5MzA1MDQKMTk5NDsxOTk0MDQyNjsxOTk0MDQzMDsxOTk0MDUxMwoxOTk1OzE5OTUwNDI3OzE5OTUwNTAyOzE5OTUwNTEzCjE5OTY7MTk5NjA0MzA7MTk5NjA1MDQ7MTk5NjA1MjEKMTk5NzsxOTk3MDQxNzsxOTk3MDQyMjsxOTk3MDUwMwoxOTk4OzE5OTgwNDE5OzE5OTgwNDIyOzE5OTgwNDI5CjE5OTk7MTk5OTA0MjM7MTk5OTA0MjY7MTk5OTA1MDEKMjAwMDsyMDAwMDQyMjsyMDAwMDQyNDsyMDAwMDQzMAoyMDAxOzIwMDEwNTAyOzIwMDEwNTAzOzIwMDEwNTEwCjIwMDI7MjAwMjA0MTA7MjAwMjA0MTM7MjAwMjA1MDMKMjAwMzsyMDAzMDQyMzsyMDAzMDQyNTsyMDAzMDUwMQoyMDA0OzIwMDQwNDIyOzIwMDQwNDI1OzIwMDQwNTA0CjIwMDU7MjAwNTA0MjM7MjAwNTA0MjU7MjAwNTA1MDEKMjAwNjsyMDA2MDUwNDsyMDA2MDUwNjsyMDA2MDUxMgoyMDA3OzIwMDcwNDE0OzIwMDcwNDE1OzIwMDcwNDIwCjIwMDg7MjAwODA0MjQ7MjAwODA0Mjc7MjAwODA1MDgKMjAwOTsyMDA5MDQxOTsyMDA5MDQyMTsyMDA5MDQyOQoyMDEwOzIwMTAwNDI1OzIwMTAwNDI3OzIwMTAwNTA4CjIwMTE7MjAxMTA0MTE7MjAxMTA0MTI7MjAxMTA0MjIKMjAxMjsyMDEyMDQyMDsyMDEyMDQyMzsyMDEyMDUwMQoyMDEzOzIwMTMwNTAzOzIwMTMwNTA1OzIwMTMwNTE0CjIwMTQ7MjAxNDA0MDQ7MjAxNDA0MDY7MjAxNDA0MTYKMjAxNTsyMDE1MDQyMTsyMDE1MDQyNDsyMDE1MDUwMgoyMDE2OzIwMTYwNDIzOzIwMTYwNDMwOzIwMTYwNTA5CjIwMTc7MjAxNzA0MTA7MjAxNzA0MTI7MjAxNzA1MDEKMjAxODsyMDE4MDQxOTsyMDE4MDQyMDsyMDE4MDUwNQo=&#39;);&#10;        if (!response.ok) throw new Error(&#39;Network response failed&#39;);&#10;        const blob = await response.blob();&#10;        const blobUrl = window.URL.createObjectURL(blob);&#10;        const a = document.createElement(&#39;a&#39;);&#10;        a.href = blobUrl;&#10;        a.download = &#39;Roter_Boskoop_bloom_1958_2019.csv.csv&#39;;&#10;        a.style.display = &#39;none&#39;;&#10;        document.body.appendChild(a);&#10;        a.dispatchEvent(new MouseEvent(&#39;click&#39;));&#10;        document.body.removeChild(a);&#10;        setTimeout(() =&gt; {&#10;          window.URL.revokeObjectURL(blobUrl);&#10;        }, 100);&#10;        return false;&#10;      } catch (error) {&#10;        console.error(&#39;Download failed:&#39;, error);&#10;        alert(&#39;Download failed. Please try again.&#39;);&#10;      }&#10;    }&#10;    downloadFile(event);&#10;  " has_icon="TRUE"><i class="fa fa-save"></i> Download Roter Boskoop dataset</button>
<ol start="3" style="list-style-type: decimal">
<li>Write down your thoughts on why we’re not seeing the temperature response pattern we may have expected. What happened to the chill response?</li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="simple_phenology.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="pls_reflection.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Book.pdf", "Book.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
