<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 32 Can we improve the performance of PhenoFlex? | Tree phenology analysis with R</title>
  <meta name="description" content="This lecture introduces the chillR package for R." />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 32 Can we improve the performance of PhenoFlex? | Tree phenology analysis with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This lecture introduces the chillR package for R." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 32 Can we improve the performance of PhenoFlex? | Tree phenology analysis with R" />
  
  <meta name="twitter:description" content="This lecture introduces the chillR package for R." />
  

<meta name="author" content="Eike Luedeling" />


<meta name="date" content="2025-01-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="phenoflex2.html"/>
<link rel="next" href="frost-risk-analysis.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.2/leaflet.js"></script>
<script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/font-awesome-6.5.2/js/script.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 1em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Tree phenology analysis with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#objectives"><i class="fa fa-check"></i><b>1.1</b> Objectives</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#performance-assessment"><i class="fa fa-check"></i><b>1.2</b> Performance assessment</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#house-rules"><i class="fa fa-check"></i><b>1.3</b> House rules</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="the-tools-we-use.html"><a href="the-tools-we-use.html"><i class="fa fa-check"></i><b>2</b> The tools we use</a>
<ul>
<li class="chapter" data-level="2.1" data-path="the-tools-we-use.html"><a href="the-tools-we-use.html#r-and-rstudio"><i class="fa fa-check"></i><b>2.1</b> R and RStudio</a></li>
<li class="chapter" data-level="2.2" data-path="the-tools-we-use.html"><a href="the-tools-we-use.html#git-and-github"><i class="fa fa-check"></i><b>2.2</b> git and github</a></li>
<li class="chapter" data-level="2.3" data-path="the-tools-we-use.html"><a href="the-tools-we-use.html#rmarkdown"><i class="fa fa-check"></i><b>2.3</b> Rmarkdown</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tree-dormancy.html"><a href="tree-dormancy.html"><i class="fa fa-check"></i><b>3</b> Tree dormancy</a>
<ul>
<li class="chapter" data-level="3.1" data-path="tree-dormancy.html"><a href="tree-dormancy.html#learning-goals-for-this-lesson"><i class="fa fa-check"></i><b>3.1</b> Learning goals for this lesson:</a></li>
<li class="chapter" data-level="3.2" data-path="tree-dormancy.html"><a href="tree-dormancy.html#introduction-to-dormancy"><i class="fa fa-check"></i><b>3.2</b> Introduction to dormancy</a></li>
<li class="chapter" data-level="3.3" data-path="tree-dormancy.html"><a href="tree-dormancy.html#dormancy-physiology"><i class="fa fa-check"></i><b>3.3</b> Dormancy physiology</a></li>
<li class="chapter" data-level="3.4" data-path="tree-dormancy.html"><a href="tree-dormancy.html#experimental-and-statistical-determination-of-the-chilling-and-forcing-periods"><i class="fa fa-check"></i><b>3.4</b> Experimental and statistical determination of the chilling and forcing periods</a></li>
<li class="chapter" data-level="3.5" data-path="tree-dormancy.html"><a href="tree-dormancy.html#phenology-record-and-bbch-scale"><i class="fa fa-check"></i><b>3.5</b> Phenology record and BBCH scale</a></li>
<li class="chapter" data-level="" data-path="tree-dormancy.html"><a href="tree-dormancy.html#exercises_dormancy"><i class="fa fa-check"></i><code>Exercises</code> on tree dormancy</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html"><i class="fa fa-check"></i><b>4</b> Climate change and impact projection</a>
<ul>
<li class="chapter" data-level="4.1" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#the-drivers-of-climate-change"><i class="fa fa-check"></i><b>4.1</b> The drivers of climate change</a></li>
<li class="chapter" data-level="4.2" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#what-weve-already-seen"><i class="fa fa-check"></i><b>4.2</b> What we’ve already seen</a></li>
<li class="chapter" data-level="4.3" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#future-scenarios"><i class="fa fa-check"></i><b>4.3</b> Future scenarios</a></li>
<li class="chapter" data-level="4.4" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#impact-projection-approaches"><i class="fa fa-check"></i><b>4.4</b> Impact projection approaches</a></li>
<li class="chapter" data-level="" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#exercises_climate_change"><i class="fa fa-check"></i><code>Exercises</code> on climate change</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html"><i class="fa fa-check"></i><b>5</b> Winter chill projections</a>
<ul>
<li class="chapter" data-level="" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#goals_analysis_examples"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="5.1" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-projections-1"><i class="fa fa-check"></i><b>5.1</b> Winter chill projections</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-oman"><i class="fa fa-check"></i><b>5.1.1</b> Winter chill in Oman</a></li>
<li class="chapter" data-level="5.1.2" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-model-sensitivity"><i class="fa fa-check"></i><b>5.1.2</b> Chill model sensitivity</a></li>
<li class="chapter" data-level="5.1.3" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-california"><i class="fa fa-check"></i><b>5.1.3</b> Winter chill in California</a></li>
<li class="chapter" data-level="5.1.4" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-ratios"><i class="fa fa-check"></i><b>5.1.4</b> Winter chill ratios</a></li>
<li class="chapter" data-level="5.1.5" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#a-global-projection-of-future-winter-chill"><i class="fa fa-check"></i><b>5.1.5</b> A global projection of future winter chill</a></li>
<li class="chapter" data-level="5.1.6" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-germany"><i class="fa fa-check"></i><b>5.1.6</b> Winter chill in Germany</a></li>
<li class="chapter" data-level="5.1.7" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-tunisia"><i class="fa fa-check"></i><b>5.1.7</b> Winter chill in Tunisia</a></li>
<li class="chapter" data-level="5.1.8" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-chile"><i class="fa fa-check"></i><b>5.1.8</b> Winter chill in Chile</a></li>
<li class="chapter" data-level="5.1.9" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-projection-for-patagonia"><i class="fa fa-check"></i><b>5.1.9</b> Chill projection for Patagonia</a></li>
<li class="chapter" data-level="5.1.10" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-model-comparison"><i class="fa fa-check"></i><b>5.1.10</b> Chill model comparison</a></li>
<li class="chapter" data-level="5.1.11" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-projection-for-all-of-tunisia"><i class="fa fa-check"></i><b>5.1.11</b> Chill projection for all of Tunisia</a></li>
<li class="chapter" data-level="5.1.12" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#revisiting-chill-accumulation-in-oman"><i class="fa fa-check"></i><b>5.1.12</b> Revisiting chill accumulation in Oman</a></li>
<li class="chapter" data-level="5.1.13" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#future-studies"><i class="fa fa-check"></i><b>5.1.13</b> Future studies?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#exercises_past_studies"><i class="fa fa-check"></i><code>Exercises</code> on past chill projections</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="manual-chill-analysis.html"><a href="manual-chill-analysis.html"><i class="fa fa-check"></i><b>6</b> Manual chill analysis</a>
<ul>
<li class="chapter" data-level="" data-path="manual-chill-analysis.html"><a href="manual-chill-analysis.html#goals_manual_chill_analysis"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="6.1" data-path="manual-chill-analysis.html"><a href="manual-chill-analysis.html#computing-chilling-hours-from-hourly-temperature-data"><i class="fa fa-check"></i><b>6.1</b> Computing Chilling Hours from hourly temperature data</a></li>
<li class="chapter" data-level="6.2" data-path="manual-chill-analysis.html"><a href="manual-chill-analysis.html#our-first-chill-function"><i class="fa fa-check"></i><b>6.2</b> Our first chill function</a></li>
<li class="chapter" data-level="" data-path="manual-chill-analysis.html"><a href="manual-chill-analysis.html#exercises_manual_chill_analysis"><i class="fa fa-check"></i><code>Exercises</code> on basic chill modeling</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chill-models.html"><a href="chill-models.html"><i class="fa fa-check"></i><b>7</b> Chill models</a>
<ul>
<li class="chapter" data-level="" data-path="chill-models.html"><a href="chill-models.html#goals_chill_models"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="7.1" data-path="chill-models.html"><a href="chill-models.html#chill-models-in-chillr"><i class="fa fa-check"></i><b>7.1</b> Chill models in <code>chillR</code></a></li>
<li class="chapter" data-level="" data-path="chill-models.html"><a href="chill-models.html#exercises_chill_models"><i class="fa fa-check"></i><code>Exercises</code> on chill models</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html"><i class="fa fa-check"></i><b>8</b> Making hourly temperatures</a>
<ul>
<li class="chapter" data-level="" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#goals_hourly"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="8.1" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#generating-hourly-temperatures"><i class="fa fa-check"></i><b>8.1</b> Generating hourly temperatures</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#idealized-daily-temperature-curves"><i class="fa fa-check"></i><b>8.1.1</b> Idealized daily temperature curves</a></li>
<li class="chapter" data-level="8.1.2" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#empirical-daily-temperature-curves"><i class="fa fa-check"></i><b>8.1.2</b> Empirical daily temperature curves</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#exercises_hourly"><i class="fa fa-check"></i><code>Exercises</code> on hourly temperatures</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html"><i class="fa fa-check"></i><b>9</b> Some useful tools in R</a>
<ul>
<li class="chapter" data-level="" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#goals_R_tools"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="9.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#an-evolving-language---and-a-lifelong-learning-process"><i class="fa fa-check"></i><b>9.1</b> An evolving language - and a lifelong learning process</a></li>
<li class="chapter" data-level="9.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-tidyverse"><i class="fa fa-check"></i><b>9.2</b> The <code>tidyverse</code></a></li>
<li class="chapter" data-level="9.3" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-ggplot2-package"><i class="fa fa-check"></i><b>9.3</b> The <code>ggplot2</code> package</a></li>
<li class="chapter" data-level="9.4" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-tibble-package"><i class="fa fa-check"></i><b>9.4</b> The <code>tibble</code> package</a></li>
<li class="chapter" data-level="9.5" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-magrittr-package---pipes"><i class="fa fa-check"></i><b>9.5</b> The <code>magrittr</code> package - pipes</a></li>
<li class="chapter" data-level="9.6" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-tidyr-package"><i class="fa fa-check"></i><b>9.6</b> The <code>tidyr</code> package</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#pivot_longer"><i class="fa fa-check"></i><b>9.6.1</b> <code>pivot_longer</code></a></li>
<li class="chapter" data-level="9.6.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#pivot_wider"><i class="fa fa-check"></i><b>9.6.2</b> <code>pivot_wider</code></a></li>
<li class="chapter" data-level="9.6.3" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#select"><i class="fa fa-check"></i><b>9.6.3</b> <code>select</code></a></li>
<li class="chapter" data-level="9.6.4" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#filter"><i class="fa fa-check"></i><b>9.6.4</b> <code>filter</code></a></li>
<li class="chapter" data-level="9.6.5" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#mutate"><i class="fa fa-check"></i><b>9.6.5</b> <code>mutate</code></a></li>
<li class="chapter" data-level="9.6.6" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#arrange"><i class="fa fa-check"></i><b>9.6.6</b> <code>arrange</code></a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#loops"><i class="fa fa-check"></i><b>9.7</b> Loops</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#for-loops"><i class="fa fa-check"></i><b>9.7.1</b> <em>For</em> loops</a></li>
<li class="chapter" data-level="9.7.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#while-loops"><i class="fa fa-check"></i><b>9.7.2</b> <em>While</em> loops</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#apply-functions"><i class="fa fa-check"></i><b>9.8</b> <code>apply</code> functions</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#sapply"><i class="fa fa-check"></i><b>9.8.1</b> <code>sapply</code></a></li>
<li class="chapter" data-level="9.8.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#lapply"><i class="fa fa-check"></i><b>9.8.2</b> <code>lapply</code></a></li>
<li class="chapter" data-level="9.8.3" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#apply"><i class="fa fa-check"></i><b>9.8.3</b> <code>apply</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#exercises_R_tools"><i class="fa fa-check"></i><code>Exercises</code> on useful R tools</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="get_temp_data.html"><a href="get_temp_data.html"><i class="fa fa-check"></i><b>10</b> Getting temperature data</a>
<ul>
<li class="chapter" data-level="" data-path="get_temp_data.html"><a href="get_temp_data.html#goals_get_temps"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="10.1" data-path="get_temp_data.html"><a href="get_temp_data.html#temperature-data-needs"><i class="fa fa-check"></i><b>10.1</b> Temperature data needs</a></li>
<li class="chapter" data-level="10.2" data-path="get_temp_data.html"><a href="get_temp_data.html#the-global-summary-of-the-day-database"><i class="fa fa-check"></i><b>10.2</b> The Global Summary of the Day database</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="get_temp_data.html"><a href="get_temp_data.html#actionlist_stations"><i class="fa fa-check"></i><b>10.2.1</b> <code>action=list_stations</code></a></li>
<li class="chapter" data-level="10.2.2" data-path="get_temp_data.html"><a href="get_temp_data.html#actiondownload_weather"><i class="fa fa-check"></i><b>10.2.2</b> <code>action="download_weather"</code></a></li>
<li class="chapter" data-level="10.2.3" data-path="get_temp_data.html"><a href="get_temp_data.html#downloaded-weather-as-action-argument"><i class="fa fa-check"></i><b>10.2.3</b> downloaded weather as <code>action</code> argument</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="get_temp_data.html"><a href="get_temp_data.html#exercises_getting"><i class="fa fa-check"></i><code>Exercises</code> on getting temperature data</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html"><i class="fa fa-check"></i><b>11</b> Filling gaps in temperature records</a>
<ul>
<li class="chapter" data-level="" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#goals_gaps"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="11.1" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#gaps"><i class="fa fa-check"></i><b>11.1</b> Gaps</a></li>
<li class="chapter" data-level="11.2" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#filling-short-gaps-in-daily-records"><i class="fa fa-check"></i><b>11.2</b> Filling short gaps in daily records</a></li>
<li class="chapter" data-level="11.3" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#filling-long-gaps-in-daily-records"><i class="fa fa-check"></i><b>11.3</b> Filling long gaps in daily records</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#bias-correction-for-shorter-intervals"><i class="fa fa-check"></i><b>11.3.1</b> Bias-correction for shorter intervals</a></li>
<li class="chapter" data-level="11.3.2" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#saving-the-data-for-later"><i class="fa fa-check"></i><b>11.3.2</b> Saving the data for later</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#filling-gaps-in-hourly-records"><i class="fa fa-check"></i><b>11.4</b> Filling gaps in hourly records</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#accuracy-assessment"><i class="fa fa-check"></i><b>11.4.1</b> Accuracy assessment</a></li>
<li class="chapter" data-level="11.4.2" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#computing-agroclimatic-metrics"><i class="fa fa-check"></i><b>11.4.2</b> Computing agroclimatic metrics</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#exercises_patching"><i class="fa fa-check"></i><code>Exercises</code> on filling gaps</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html"><i class="fa fa-check"></i><b>12</b> Generating temperature scenarios</a>
<ul>
<li class="chapter" data-level="" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html#goals_temperature_scenarios"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="12.1" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html#chill-scenarios"><i class="fa fa-check"></i><b>12.1</b> Chill scenarios</a></li>
<li class="chapter" data-level="12.2" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html#risk-assessment-in-orchard-planning"><i class="fa fa-check"></i><b>12.2</b> Risk assessment in orchard planning</a></li>
<li class="chapter" data-level="12.3" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html#weather-generators"><i class="fa fa-check"></i><b>12.3</b> Weather generators</a></li>
<li class="chapter" data-level="12.4" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html#weather-generation-in-chillr"><i class="fa fa-check"></i><b>12.4</b> Weather generation in <code>chillR</code></a></li>
<li class="chapter" data-level="" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html#weather_generation_exercises"><i class="fa fa-check"></i><code>Exercises</code> on temperature generation</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="saving-and-loading-data-and-hiding-this-in-markdown.html"><a href="saving-and-loading-data-and-hiding-this-in-markdown.html"><i class="fa fa-check"></i><b>13</b> Saving and loading data (and hiding this in markdown)</a>
<ul>
<li class="chapter" data-level="13.1" data-path="saving-and-loading-data-and-hiding-this-in-markdown.html"><a href="saving-and-loading-data-and-hiding-this-in-markdown.html#learning-goals-for-this-lesson-1"><i class="fa fa-check"></i><b>13.1</b> Learning Goals for this lesson:</a></li>
<li class="chapter" data-level="13.2" data-path="saving-and-loading-data-and-hiding-this-in-markdown.html"><a href="saving-and-loading-data-and-hiding-this-in-markdown.html#saving-and-loading-data"><i class="fa fa-check"></i><b>13.2</b> Saving and loading data</a></li>
<li class="chapter" data-level="13.3" data-path="saving-and-loading-data-and-hiding-this-in-markdown.html"><a href="saving-and-loading-data-and-hiding-this-in-markdown.html#hiding-all-this-from-the-readers-of-our-markdown-file"><i class="fa fa-check"></i><b>13.3</b> Hiding all this from the readers of our markdown file</a></li>
<li class="chapter" data-level="" data-path="saving-and-loading-data-and-hiding-this-in-markdown.html"><a href="saving-and-loading-data-and-hiding-this-in-markdown.html#exercises_saveLoad"><i class="fa fa-check"></i><code>Exercises</code> on saving and loading data</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="historic-temperature-scenarios.html"><a href="historic-temperature-scenarios.html"><i class="fa fa-check"></i><b>14</b> Historic temperature scenarios</a>
<ul>
<li class="chapter" data-level="" data-path="historic-temperature-scenarios.html"><a href="historic-temperature-scenarios.html#goals_hist_temp_scen"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="14.1" data-path="historic-temperature-scenarios.html"><a href="historic-temperature-scenarios.html#climate-change-scenarios"><i class="fa fa-check"></i><b>14.1</b> Climate change scenarios</a></li>
<li class="chapter" data-level="14.2" data-path="historic-temperature-scenarios.html"><a href="historic-temperature-scenarios.html#making-historic-temperature-scenarios"><i class="fa fa-check"></i><b>14.2</b> Making historic temperature scenarios</a></li>
<li class="chapter" data-level="" data-path="historic-temperature-scenarios.html"><a href="historic-temperature-scenarios.html#exercises_historic_scenarios"><i class="fa fa-check"></i><code>Exercises</code> on generating historic temperature scenarios</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="future-temperature-scenarios.html"><a href="future-temperature-scenarios.html"><i class="fa fa-check"></i><b>15</b> Future temperature scenarios</a>
<ul>
<li class="chapter" data-level="" data-path="future-temperature-scenarios.html"><a href="future-temperature-scenarios.html#goals_future_temp_scen"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="15.1" data-path="future-temperature-scenarios.html"><a href="future-temperature-scenarios.html#impacts-of-future-climate-change"><i class="fa fa-check"></i><b>15.1</b> Impacts of future climate change</a></li>
<li class="chapter" data-level="15.2" data-path="future-temperature-scenarios.html"><a href="future-temperature-scenarios.html#future-climate-scenarios"><i class="fa fa-check"></i><b>15.2</b> Future climate scenarios</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="future-temperature-scenarios.html"><a href="future-temperature-scenarios.html#some-background-on-climate-models-and-warming-pathways"><i class="fa fa-check"></i><b>15.2.1</b> Some background on climate models and warming pathways</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="future-temperature-scenarios.html"><a href="future-temperature-scenarios.html#exercises_future_scenarios"><i class="fa fa-check"></i><code>Exercises</code> on future temperature scenarios</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html"><i class="fa fa-check"></i><b>16</b> Making CMIP6 scenarios</a>
<ul>
<li class="chapter" data-level="" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html#goals_CMIP6"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="16.1" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html#accessing-gridded-climate-data-from-the-copernicus-climate-data-store"><i class="fa fa-check"></i><b>16.1</b> Accessing gridded climate data from the Copernicus climate data store</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html#downloading-future-climate-data"><i class="fa fa-check"></i><b>16.1.1</b> Downloading future climate data</a></li>
<li class="chapter" data-level="16.1.2" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html#generating-change-scenarios"><i class="fa fa-check"></i><b>16.1.2</b> Generating change scenarios</a></li>
<li class="chapter" data-level="16.1.3" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html#extracting-data-from-the-grids"><i class="fa fa-check"></i><b>16.1.3</b> Extracting data from the grids</a></li>
<li class="chapter" data-level="16.1.4" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html#baseline-adjustment"><i class="fa fa-check"></i><b>16.1.4</b> Baseline adjustment</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html#exercises_CMIP6"><i class="fa fa-check"></i><code>Exercises</code> on generating CMIP6 temperature scenarios</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="making-cmip5-scenarios-with-the-climatewizard.html"><a href="making-cmip5-scenarios-with-the-climatewizard.html"><i class="fa fa-check"></i><b>17</b> Making CMIP5 scenarios with the <code>ClimateWizard</code></a>
<ul>
<li class="chapter" data-level="" data-path="making-cmip5-scenarios-with-the-climatewizard.html"><a href="making-cmip5-scenarios-with-the-climatewizard.html#goals_ClimateWizard"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="17.1" data-path="making-cmip5-scenarios-with-the-climatewizard.html"><a href="making-cmip5-scenarios-with-the-climatewizard.html#using-the-climatewizard"><i class="fa fa-check"></i><b>17.1</b> Using the <code>ClimateWizard</code></a></li>
<li class="chapter" data-level="" data-path="making-cmip5-scenarios-with-the-climatewizard.html"><a href="making-cmip5-scenarios-with-the-climatewizard.html#exercises_ClimateWizard"><i class="fa fa-check"></i><code>Exercises</code> on generating CMIP5 temperature scenarios</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="plot_future.html"><a href="plot_future.html"><i class="fa fa-check"></i><b>18</b> Plotting future scenarios</a>
<ul>
<li class="chapter" data-level="" data-path="plot_future.html"><a href="plot_future.html#goals_future_plots"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="18.1" data-path="plot_future.html"><a href="plot_future.html#making-attractive-plots"><i class="fa fa-check"></i><b>18.1</b> Making attractive plots</a></li>
<li class="chapter" data-level="18.2" data-path="plot_future.html"><a href="plot_future.html#the-results"><i class="fa fa-check"></i><b>18.2</b> The results</a></li>
<li class="chapter" data-level="" data-path="plot_future.html"><a href="plot_future.html#exercises_future_plots"><i class="fa fa-check"></i><code>Exercises</code> on plotting future projections</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="chill_model_comparison.html"><a href="chill_model_comparison.html"><i class="fa fa-check"></i><b>19</b> Chill model comparison</a>
<ul>
<li class="chapter" data-level="" data-path="chill_model_comparison.html"><a href="chill_model_comparison.html#goals_chill_model"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="19.1" data-path="chill_model_comparison.html"><a href="chill_model_comparison.html#safe-winter-chill"><i class="fa fa-check"></i><b>19.1</b> Safe Winter Chill</a></li>
<li class="chapter" data-level="19.2" data-path="chill_model_comparison.html"><a href="chill_model_comparison.html#chill-metrics"><i class="fa fa-check"></i><b>19.2</b> Chill metrics</a></li>
<li class="chapter" data-level="19.3" data-path="chill_model_comparison.html"><a href="chill_model_comparison.html#an-animated-plot-of-relative-changes-in-safe-winter-chill"><i class="fa fa-check"></i><b>19.3</b> An animated plot of relative changes in Safe Winter Chill</a></li>
<li class="chapter" data-level="" data-path="chill_model_comparison.html"><a href="chill_model_comparison.html#exercises_chill_model_comparison"><i class="fa fa-check"></i><code>Exercises</code> on chill model comparison</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="simple_phenology.html"><a href="simple_phenology.html"><i class="fa fa-check"></i><b>20</b> Simple phenology analysis</a>
<ul>
<li class="chapter" data-level="" data-path="simple_phenology.html"><a href="simple_phenology.html#goals_simple_phenology"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="20.1" data-path="simple_phenology.html"><a href="simple_phenology.html#phenology-analysis"><i class="fa fa-check"></i><b>20.1</b> Phenology analysis</a></li>
<li class="chapter" data-level="20.2" data-path="simple_phenology.html"><a href="simple_phenology.html#time-series-analysis"><i class="fa fa-check"></i><b>20.2</b> Time series analysis</a></li>
<li class="chapter" data-level="20.3" data-path="simple_phenology.html"><a href="simple_phenology.html#p-hacking"><i class="fa fa-check"></i><b>20.3</b> p-hacking</a></li>
<li class="chapter" data-level="20.4" data-path="simple_phenology.html"><a href="simple_phenology.html#the-process-that-generates-the-data"><i class="fa fa-check"></i><b>20.4</b> The process that generates the data</a></li>
<li class="chapter" data-level="20.5" data-path="simple_phenology.html"><a href="simple_phenology.html#an-ecological-theory-to-guide-our-analysis"><i class="fa fa-check"></i><b>20.5</b> An ecological theory to guide our analysis</a></li>
<li class="chapter" data-level="20.6" data-path="simple_phenology.html"><a href="simple_phenology.html#temperature-correlations"><i class="fa fa-check"></i><b>20.6</b> Temperature correlations</a></li>
<li class="chapter" data-level="" data-path="simple_phenology.html"><a href="simple_phenology.html#exercises_simple_analysis"><i class="fa fa-check"></i><code>Exercises</code> on simple phenology analysis</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="pls_intro.html"><a href="pls_intro.html"><i class="fa fa-check"></i><b>21</b> Delineating temperature response phases with PLS regression</a>
<ul>
<li class="chapter" data-level="" data-path="pls_intro.html"><a href="pls_intro.html#goals_PLS_intro"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="21.1" data-path="pls_intro.html"><a href="pls_intro.html#detecting-temperature-response-phases"><i class="fa fa-check"></i><b>21.1</b> Detecting temperature response phases</a></li>
<li class="chapter" data-level="21.2" data-path="pls_intro.html"><a href="pls_intro.html#finding-signals-in-hyperspectral-remote-sensing-data"><i class="fa fa-check"></i><b>21.2</b> Finding signals in hyperspectral remote sensing data</a></li>
<li class="chapter" data-level="21.3" data-path="pls_intro.html"><a href="pls_intro.html#pls-regression-for-phenology-analysis"><i class="fa fa-check"></i><b>21.3</b> PLS regression for phenology analysis</a></li>
<li class="chapter" data-level="21.4" data-path="pls_intro.html"><a href="pls_intro.html#a-note-of-caution-about-pls-results"><i class="fa fa-check"></i><b>21.4</b> A note of caution about PLS results</a></li>
<li class="chapter" data-level="21.5" data-path="pls_intro.html"><a href="pls_intro.html#pls-analysis-of-alexander-lucas-pears-in-klein-altendorf"><i class="fa fa-check"></i><b>21.5</b> PLS analysis of ‘Alexander Lucas’ pears in Klein-Altendorf</a></li>
<li class="chapter" data-level="" data-path="pls_intro.html"><a href="pls_intro.html#exercises_first_PLS"><i class="fa fa-check"></i><code>Exercises</code> on chill model comparison</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="pls_reflection.html"><a href="pls_reflection.html"><i class="fa fa-check"></i><b>22</b> Successes and limitations of PLS regression analysis</a>
<ul>
<li class="chapter" data-level="" data-path="pls_reflection.html"><a href="pls_reflection.html#goals_PLS_reflection"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="22.1" data-path="pls_reflection.html"><a href="pls_reflection.html#pls-regression"><i class="fa fa-check"></i><b>22.1</b> PLS regression</a></li>
<li class="chapter" data-level="22.2" data-path="pls_reflection.html"><a href="pls_reflection.html#pls-examples"><i class="fa fa-check"></i><b>22.2</b> PLS examples</a>
<ul>
<li class="chapter" data-level="22.2.1" data-path="pls_reflection.html"><a href="pls_reflection.html#grasslands-on-the-tibetan-plateau"><i class="fa fa-check"></i><b>22.2.1</b> Grasslands on the Tibetan Plateau</a></li>
<li class="chapter" data-level="22.2.2" data-path="pls_reflection.html"><a href="pls_reflection.html#deciduous-trees"><i class="fa fa-check"></i><b>22.2.2</b> Deciduous trees</a></li>
<li class="chapter" data-level="22.2.3" data-path="pls_reflection.html"><a href="pls_reflection.html#why-were-not-seeing-the-chilling-phase"><i class="fa fa-check"></i><b>22.2.3</b> Why we’re not seeing the chilling phase</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="pls_reflection.html"><a href="pls_reflection.html#exercises_PLS_reflection"><i class="fa fa-check"></i><code>Exercises</code> on chill model comparison</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="pls_chillforce.html"><a href="pls_chillforce.html"><i class="fa fa-check"></i><b>23</b> PLS regression with agroclimatic metrics</a>
<ul>
<li class="chapter" data-level="" data-path="pls_chillforce.html"><a href="pls_chillforce.html#goals_PLS_chillforce"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="23.1" data-path="pls_chillforce.html"><a href="pls_chillforce.html#adjusting-pls-for-use-with-non-monotonic-relationships"><i class="fa fa-check"></i><b>23.1</b> Adjusting PLS for use with non-monotonic relationships</a></li>
<li class="chapter" data-level="23.2" data-path="pls_chillforce.html"><a href="pls_chillforce.html#pls-analysis-with-chilling-and-forcing-data"><i class="fa fa-check"></i><b>23.2</b> PLS analysis with chilling and forcing data</a></li>
<li class="chapter" data-level="23.3" data-path="pls_chillforce.html"><a href="pls_chillforce.html#delineating-chilling-and-forcing-periods"><i class="fa fa-check"></i><b>23.3</b> Delineating chilling and forcing periods</a></li>
<li class="chapter" data-level="23.4" data-path="pls_chillforce.html"><a href="pls_chillforce.html#ggplotting-the-results"><i class="fa fa-check"></i><b>23.4</b> <code>ggplot</code>ting the results</a></li>
<li class="chapter" data-level="" data-path="pls_chillforce.html"><a href="pls_chillforce.html#exercises_PLS_chill_force"><i class="fa fa-check"></i><code>Exercises</code> on chill model comparison</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html"><i class="fa fa-check"></i><b>24</b> Examples of PLS regression with agroclimatic metrics</a>
<ul>
<li class="chapter" data-level="" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#goals_PLS_chillforce_ex"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="24.1" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#pls-regression-across-species-and-agroclimatic-contexts"><i class="fa fa-check"></i><b>24.1</b> PLS regression across species and agroclimatic contexts</a>
<ul>
<li class="chapter" data-level="24.1.1" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#chestnut-jujube-and-apricot-in-beijing"><i class="fa fa-check"></i><b>24.1.1</b> Chestnut, jujube and apricot in Beijing</a></li>
<li class="chapter" data-level="24.1.2" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#apples-in-shaanxi-province-china"><i class="fa fa-check"></i><b>24.1.2</b> Apples in Shaanxi Province, China</a></li>
<li class="chapter" data-level="24.1.3" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#cherries-in-klein-altendorf"><i class="fa fa-check"></i><b>24.1.3</b> Cherries in Klein-Altendorf</a></li>
<li class="chapter" data-level="24.1.4" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#apricots-in-the-uk"><i class="fa fa-check"></i><b>24.1.4</b> Apricots in the UK</a></li>
<li class="chapter" data-level="24.1.5" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#grapevine-in-croatia"><i class="fa fa-check"></i><b>24.1.5</b> Grapevine in Croatia</a></li>
<li class="chapter" data-level="24.1.6" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#walnuts-in-california"><i class="fa fa-check"></i><b>24.1.6</b> Walnuts in California</a></li>
<li class="chapter" data-level="24.1.7" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#almonds-in-tunisia"><i class="fa fa-check"></i><b>24.1.7</b> Almonds in Tunisia</a></li>
<li class="chapter" data-level="24.1.8" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#pistachios-in-tunisia"><i class="fa fa-check"></i><b>24.1.8</b> Pistachios in Tunisia</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#exercises_PLS_chill_force_ex"><i class="fa fa-check"></i><code>Exercises</code> on examples of PLS regression with agroclimatic metrics</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html"><i class="fa fa-check"></i><b>25</b> Why PLS doesn’t always work</a>
<ul>
<li class="chapter" data-level="" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#goals_PLS_chillforce_reflection"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="25.1" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#disappointing-pls-performance"><i class="fa fa-check"></i><b>25.1</b> Disappointing PLS performance</a></li>
<li class="chapter" data-level="25.2" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#what-pls-regression-can-find"><i class="fa fa-check"></i><b>25.2</b> What PLS regression can find</a></li>
<li class="chapter" data-level="25.3" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#chill-model-sensitivity-vs.-observed-temperature"><i class="fa fa-check"></i><b>25.3</b> Chill model sensitivity vs. observed temperature</a>
<ul>
<li class="chapter" data-level="25.3.1" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#beijing-china"><i class="fa fa-check"></i><b>25.3.1</b> Beijing, China</a></li>
<li class="chapter" data-level="25.3.2" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#klein-altendorf-germany"><i class="fa fa-check"></i><b>25.3.2</b> Klein-Altendorf, Germany</a></li>
<li class="chapter" data-level="25.3.3" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#davis-california"><i class="fa fa-check"></i><b>25.3.3</b> Davis, California</a></li>
<li class="chapter" data-level="25.3.4" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#sfax-tunisia"><i class="fa fa-check"></i><b>25.3.4</b> Sfax, Tunisia</a></li>
</ul></li>
<li class="chapter" data-level="25.4" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#heat-model-sensitivity-vs.-observed-temperature"><i class="fa fa-check"></i><b>25.4</b> Heat model sensitivity vs. observed temperature</a></li>
<li class="chapter" data-level="" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#exercises_PLS_chillforce_reflection"><i class="fa fa-check"></i><code>Exercises</code> on expected PLS responsiveness</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="pls_eval_PLS.html"><a href="pls_eval_PLS.html"><i class="fa fa-check"></i><b>26</b> Evaluating PLS outputs</a>
<ul>
<li class="chapter" data-level="" data-path="pls_eval_PLS.html"><a href="pls_eval_PLS.html#goals_PLS_eval"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="26.1" data-path="pls_eval_PLS.html"><a href="pls_eval_PLS.html#chilling-and-forcing-requirements"><i class="fa fa-check"></i><b>26.1</b> Chilling and forcing requirements</a></li>
<li class="chapter" data-level="26.2" data-path="pls_eval_PLS.html"><a href="pls_eval_PLS.html#response-to-seasonal-temperature"><i class="fa fa-check"></i><b>26.2</b> Response to seasonal temperature</a></li>
<li class="chapter" data-level="26.3" data-path="pls_eval_PLS.html"><a href="pls_eval_PLS.html#applying-our-functions-to-california-walnuts"><i class="fa fa-check"></i><b>26.3</b> Applying our functions to California walnuts</a></li>
<li class="chapter" data-level="" data-path="pls_eval_PLS.html"><a href="pls_eval_PLS.html#exercises_PLS_eval"><i class="fa fa-check"></i><code>Exercises</code> on evaluating PLS regression results</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="pls_chillforce_relimp.html"><a href="pls_chillforce_relimp.html"><i class="fa fa-check"></i><b>27</b> The relative importance of chill and heat</a>
<ul>
<li class="chapter" data-level="" data-path="pls_chillforce_relimp.html"><a href="pls_chillforce_relimp.html#goals_PLS_chillforce_relimp"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="27.1" data-path="pls_chillforce_relimp.html"><a href="pls_chillforce_relimp.html#chilling-vs.-forcing-temperatures"><i class="fa fa-check"></i><b>27.1</b> Chilling vs. forcing temperatures</a></li>
<li class="chapter" data-level="27.2" data-path="pls_chillforce_relimp.html"><a href="pls_chillforce_relimp.html#patterns-in-temperature-responses"><i class="fa fa-check"></i><b>27.2</b> Patterns in temperature responses</a></li>
<li class="chapter" data-level="27.3" data-path="pls_chillforce_relimp.html"><a href="pls_chillforce_relimp.html#the-warm-end-of-the-spectrum"><i class="fa fa-check"></i><b>27.3</b> The warm end of the spectrum</a></li>
<li class="chapter" data-level="27.4" data-path="pls_chillforce_relimp.html"><a href="pls_chillforce_relimp.html#implications-of-our-hypothesis"><i class="fa fa-check"></i><b>27.4</b> Implications of our hypothesis</a></li>
<li class="chapter" data-level="" data-path="pls_chillforce_relimp.html"><a href="pls_chillforce_relimp.html#exercises_PLS_chillforce_relimp"><i class="fa fa-check"></i><code>Exercises</code> on the relative importance of chill and heat</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="exp_PLS.html"><a href="exp_PLS.html"><i class="fa fa-check"></i><b>28</b> Experimentally enhanced PLS</a>
<ul>
<li class="chapter" data-level="" data-path="exp_PLS.html"><a href="exp_PLS.html#goals_exp_PLS"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="28.1" data-path="exp_PLS.html"><a href="exp_PLS.html#enhanced-phenology-data"><i class="fa fa-check"></i><b>28.1</b> Enhanced phenology data</a></li>
<li class="chapter" data-level="" data-path="exp_PLS.html"><a href="exp_PLS.html#exc_exp_PLS"><i class="fa fa-check"></i><code>Exercises</code> on experimental PLS</a></li>
</ul></li>
<li class="chapter" data-level="29" data-path="model_validity.html"><a href="model_validity.html"><i class="fa fa-check"></i><b>29</b> Making valid tree phenology models</a>
<ul>
<li class="chapter" data-level="" data-path="model_validity.html"><a href="model_validity.html#goals_model_validity"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="29.1" data-path="model_validity.html"><a href="model_validity.html#the-modeling-challenge"><i class="fa fa-check"></i><b>29.1</b> The modeling challenge</a></li>
<li class="chapter" data-level="29.2" data-path="model_validity.html"><a href="model_validity.html#validating-models"><i class="fa fa-check"></i><b>29.2</b> Validating models</a></li>
<li class="chapter" data-level="29.3" data-path="model_validity.html"><a href="model_validity.html#mapping-validity-domains"><i class="fa fa-check"></i><b>29.3</b> Mapping validity domains</a></li>
<li class="chapter" data-level="29.4" data-path="model_validity.html"><a href="model_validity.html#one-last-thought-on-model-validity"><i class="fa fa-check"></i><b>29.4</b> One last thought on model validity</a></li>
<li class="chapter" data-level="" data-path="model_validity.html"><a href="model_validity.html#ex_model_validity"><i class="fa fa-check"></i><code>Exercises</code> on making valid tree phenology models</a></li>
</ul></li>
<li class="chapter" data-level="30" data-path="phenoflex.html"><a href="phenoflex.html"><i class="fa fa-check"></i><b>30</b> The <code>PhenoFlex</code> model</a>
<ul>
<li class="chapter" data-level="" data-path="phenoflex.html"><a href="phenoflex.html#goals_phenoflex"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="30.1" data-path="phenoflex.html"><a href="phenoflex.html#ingredients-of-this-lesson"><i class="fa fa-check"></i><b>30.1</b> Ingredients of this lesson</a></li>
<li class="chapter" data-level="30.2" data-path="phenoflex.html"><a href="phenoflex.html#towards-credible-phenology-models"><i class="fa fa-check"></i><b>30.2</b> Towards credible phenology models</a></li>
<li class="chapter" data-level="30.3" data-path="phenoflex.html"><a href="phenoflex.html#the-phenoflex-framework"><i class="fa fa-check"></i><b>30.3</b> The PhenoFlex framework</a></li>
<li class="chapter" data-level="30.4" data-path="phenoflex.html"><a href="phenoflex.html#running-phenoflex"><i class="fa fa-check"></i><b>30.4</b> Running <code>PhenoFlex</code></a></li>
<li class="chapter" data-level="30.5" data-path="phenoflex.html"><a href="phenoflex.html#parameterizing-phenoflex"><i class="fa fa-check"></i><b>30.5</b> Parameterizing <code>PhenoFlex</code></a></li>
<li class="chapter" data-level="30.6" data-path="phenoflex.html"><a href="phenoflex.html#conclusions-on-phenoflex"><i class="fa fa-check"></i><b>30.6</b> Conclusions on <code>PhenoFlex</code></a></li>
<li class="chapter" data-level="" data-path="phenoflex.html"><a href="phenoflex.html#ex_model_phenoflex"><i class="fa fa-check"></i><code>Exercises</code> on making valid tree phenology models</a></li>
</ul></li>
<li class="chapter" data-level="31" data-path="phenoflex2.html"><a href="phenoflex2.html"><i class="fa fa-check"></i><b>31</b> The <code>PhenoFlex</code> model - a second look</a>
<ul>
<li class="chapter" data-level="" data-path="phenoflex2.html"><a href="phenoflex2.html#goals_phenoflex2"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="31.1" data-path="phenoflex2.html"><a href="phenoflex2.html#some-basic-diagnostics-for-our-phenoflex-fit"><i class="fa fa-check"></i><b>31.1</b> Some basic diagnostics for our <code>PhenoFlex</code> fit</a></li>
<li class="chapter" data-level="31.2" data-path="phenoflex2.html"><a href="phenoflex2.html#temperature-response-of-the-phenoflex-components"><i class="fa fa-check"></i><b>31.2</b> Temperature response of the <code>PhenoFlex</code> components</a></li>
<li class="chapter" data-level="31.3" data-path="phenoflex2.html"><a href="phenoflex2.html#overall-impression"><i class="fa fa-check"></i><b>31.3</b> Overall impression</a></li>
<li class="chapter" data-level="31.4" data-path="phenoflex2.html"><a href="phenoflex2.html#caveats-and-assumptions"><i class="fa fa-check"></i><b>31.4</b> Caveats and assumptions</a></li>
<li class="chapter" data-level="31.5" data-path="phenoflex2.html"><a href="phenoflex2.html#outlook"><i class="fa fa-check"></i><b>31.5</b> Outlook</a></li>
<li class="chapter" data-level="" data-path="phenoflex2.html"><a href="phenoflex2.html#ex_phenoflex2"><i class="fa fa-check"></i><code>Exercises</code> on basic <code>PhenoFlex</code> diagnostics</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="phenoflex3.html"><a href="phenoflex3.html"><i class="fa fa-check"></i><b>32</b> Can we improve the performance of <code>PhenoFlex</code>?</a>
<ul>
<li class="chapter" data-level="" data-path="phenoflex3.html"><a href="phenoflex3.html#goals_phenoflex3"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="32.1" data-path="phenoflex3.html"><a href="phenoflex3.html#the-motivation"><i class="fa fa-check"></i><b>32.1</b> The motivation</a></li>
<li class="chapter" data-level="32.2" data-path="phenoflex3.html"><a href="phenoflex3.html#using-experimental-phenology-data-for-assessing-the-performance-of-phenoflex"><i class="fa fa-check"></i><b>32.2</b> Using experimental phenology data for assessing the performance of <code>PhenoFlex</code></a></li>
<li class="chapter" data-level="32.3" data-path="phenoflex3.html"><a href="phenoflex3.html#validation"><i class="fa fa-check"></i><b>32.3</b> Validation</a></li>
<li class="chapter" data-level="32.4" data-path="phenoflex3.html"><a href="phenoflex3.html#conclusions"><i class="fa fa-check"></i><b>32.4</b> Conclusions</a></li>
<li class="chapter" data-level="" data-path="phenoflex3.html"><a href="phenoflex3.html#ex_phenoflex3"><i class="fa fa-check"></i><code>Exercises</code> on improving the performance of <code>PhenoFlex</code></a></li>
</ul></li>
<li class="chapter" data-level="33" data-path="frost-risk-analysis.html"><a href="frost-risk-analysis.html"><i class="fa fa-check"></i><b>33</b> Frost risk analysis</a>
<ul>
<li class="chapter" data-level="" data-path="frost-risk-analysis.html"><a href="frost-risk-analysis.html#goals_frost_risk"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="33.1" data-path="frost-risk-analysis.html"><a href="frost-risk-analysis.html#spring-frost"><i class="fa fa-check"></i><b>33.1</b> Spring frost</a></li>
<li class="chapter" data-level="33.2" data-path="frost-risk-analysis.html"><a href="frost-risk-analysis.html#phenology-trend-analysis"><i class="fa fa-check"></i><b>33.2</b> Phenology trend analysis</a></li>
<li class="chapter" data-level="33.3" data-path="frost-risk-analysis.html"><a href="frost-risk-analysis.html#frost-risk"><i class="fa fa-check"></i><b>33.3</b> Frost risk</a></li>
<li class="chapter" data-level="" data-path="frost-risk-analysis.html"><a href="frost-risk-analysis.html#exercises_frost_risk"><i class="fa fa-check"></i><code>Exercises</code> on frost risk analysis</a></li>
</ul></li>
<li class="chapter" data-level="34" data-path="a-robust-method-to-estimate-future-frost-risks.html"><a href="a-robust-method-to-estimate-future-frost-risks.html"><i class="fa fa-check"></i><b>34</b> A robust method to estimate future frost risks (?)</a>
<ul>
<li class="chapter" data-level="" data-path="a-robust-method-to-estimate-future-frost-risks.html"><a href="a-robust-method-to-estimate-future-frost-risks.html#goals_future_frost_risk"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="34.1" data-path="a-robust-method-to-estimate-future-frost-risks.html"><a href="a-robust-method-to-estimate-future-frost-risks.html#frost-risk-for-future-scenarios"><i class="fa fa-check"></i><b>34.1</b> Frost risk for future scenarios</a></li>
<li class="chapter" data-level="34.2" data-path="a-robust-method-to-estimate-future-frost-risks.html"><a href="a-robust-method-to-estimate-future-frost-risks.html#validation-1"><i class="fa fa-check"></i><b>34.2</b> Validation</a></li>
<li class="chapter" data-level="34.3" data-path="a-robust-method-to-estimate-future-frost-risks.html"><a href="a-robust-method-to-estimate-future-frost-risks.html#exercises-for-this-chapter"><i class="fa fa-check"></i><b>34.3</b> <code>Exercises</code> for this chapter</a></li>
</ul></li>
<li class="chapter" data-level="35" data-path="major_concepts.html"><a href="major_concepts.html"><i class="fa fa-check"></i><b>35</b> Major concepts</a>
<ul>
<li class="chapter" data-level="" data-path="major_concepts.html"><a href="major_concepts.html#goals_major_concepts"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="35.1" data-path="major_concepts.html"><a href="major_concepts.html#key-insights"><i class="fa fa-check"></i><b>35.1</b> Key insights</a>
<ul>
<li class="chapter" data-level="35.1.1" data-path="major_concepts.html"><a href="major_concepts.html#tree-dormancy-1"><i class="fa fa-check"></i><b>35.1.1</b> Tree dormancy</a></li>
<li class="chapter" data-level="35.1.2" data-path="major_concepts.html"><a href="major_concepts.html#climate-change"><i class="fa fa-check"></i><b>35.1.2</b> Climate change</a></li>
<li class="chapter" data-level="35.1.3" data-path="major_concepts.html"><a href="major_concepts.html#phenology-modeling"><i class="fa fa-check"></i><b>35.1.3</b> Phenology modeling</a></li>
<li class="chapter" data-level="35.1.4" data-path="major_concepts.html"><a href="major_concepts.html#phenology-responses-to-global-warming"><i class="fa fa-check"></i><b>35.1.4</b> Phenology responses to global warming</a></li>
<li class="chapter" data-level="35.1.5" data-path="major_concepts.html"><a href="major_concepts.html#the-phenoflex-modeling-framework"><i class="fa fa-check"></i><b>35.1.5</b> The <code>PhenoFlex</code> modeling framework</a></li>
</ul></li>
<li class="chapter" data-level="35.2" data-path="major_concepts.html"><a href="major_concepts.html#major-concepts-weve-encountered"><i class="fa fa-check"></i><b>35.2</b> Major concepts we’ve encountered</a>
<ul>
<li class="chapter" data-level="35.2.1" data-path="major_concepts.html"><a href="major_concepts.html#reproducibility-and-transparency"><i class="fa fa-check"></i><b>35.2.1</b> Reproducibility and transparency</a></li>
<li class="chapter" data-level="35.2.2" data-path="major_concepts.html"><a href="major_concepts.html#tools"><i class="fa fa-check"></i><b>35.2.2</b> Tools</a></li>
<li class="chapter" data-level="35.2.3" data-path="major_concepts.html"><a href="major_concepts.html#automate-and-move-on"><i class="fa fa-check"></i><b>35.2.3</b> Automate and move on</a></li>
<li class="chapter" data-level="35.2.4" data-path="major_concepts.html"><a href="major_concepts.html#the-power-of-r"><i class="fa fa-check"></i><b>35.2.4</b> The power of R</a></li>
<li class="chapter" data-level="35.2.5" data-path="major_concepts.html"><a href="major_concepts.html#curiosity-and-interdisciplinarity"><i class="fa fa-check"></i><b>35.2.5</b> Curiosity and interdisciplinarity</a></li>
<li class="chapter" data-level="35.2.6" data-path="major_concepts.html"><a href="major_concepts.html#uncertainty"><i class="fa fa-check"></i><b>35.2.6</b> Uncertainty</a></li>
<li class="chapter" data-level="35.2.7" data-path="major_concepts.html"><a href="major_concepts.html#p-hacking-1"><i class="fa fa-check"></i><b>35.2.7</b> p-hacking</a></li>
<li class="chapter" data-level="35.2.8" data-path="major_concepts.html"><a href="major_concepts.html#the-dangers-of-machine-learning"><i class="fa fa-check"></i><b>35.2.8</b> The dangers of machine learning</a></li>
<li class="chapter" data-level="35.2.9" data-path="major_concepts.html"><a href="major_concepts.html#rationalizing"><i class="fa fa-check"></i><b>35.2.9</b> Rationalizing</a></li>
<li class="chapter" data-level="35.2.10" data-path="major_concepts.html"><a href="major_concepts.html#overfitting"><i class="fa fa-check"></i><b>35.2.10</b> Overfitting</a></li>
<li class="chapter" data-level="35.2.11" data-path="major_concepts.html"><a href="major_concepts.html#the-process-that-generated-the-data"><i class="fa fa-check"></i><b>35.2.11</b> The process that generated the data</a></li>
<li class="chapter" data-level="35.2.12" data-path="major_concepts.html"><a href="major_concepts.html#the-importance-of-theory"><i class="fa fa-check"></i><b>35.2.12</b> The importance of theory</a></li>
<li class="chapter" data-level="35.2.13" data-path="major_concepts.html"><a href="major_concepts.html#conceptual-modeling"><i class="fa fa-check"></i><b>35.2.13</b> Conceptual modeling</a></li>
<li class="chapter" data-level="35.2.14" data-path="major_concepts.html"><a href="major_concepts.html#consistency-with-existing-theory-and-prior-knowledge"><i class="fa fa-check"></i><b>35.2.14</b> Consistency with existing theory and prior knowledge</a></li>
<li class="chapter" data-level="35.2.15" data-path="major_concepts.html"><a href="major_concepts.html#model-validity-and-model-validation"><i class="fa fa-check"></i><b>35.2.15</b> Model validity and model validation</a></li>
<li class="chapter" data-level="35.2.16" data-path="major_concepts.html"><a href="major_concepts.html#our-role-in-research"><i class="fa fa-check"></i><b>35.2.16</b> Our role in research</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="major_concepts.html"><a href="major_concepts.html#ex_majorconcepts"><i class="fa fa-check"></i><code>Exercises</code> on major concepts</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="refs.html"><a href="refs.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tree phenology analysis with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="phenoflex3" class="section level1 hasAnchor" number="32">
<h1><span class="header-section-number">Chapter 32</span> Can we improve the performance of <code>PhenoFlex</code>?<a href="phenoflex3.html#phenoflex3" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="goals_phenoflex3" class="section level2 unnumbered hasAnchor">
<h2>Learning goals for this lesson<a href="phenoflex3.html#goals_phenoflex3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Parameterize the <code>PhenoFlex</code> model with experimental data</li>
<li>Assess the impact of marginal seasons on the predictive performance of <code>PhenoFlex</code></li>
</ul>
</div>
<div id="the-motivation" class="section level2 hasAnchor" number="32.1">
<h2><span class="header-section-number">32.1</span> The motivation<a href="phenoflex3.html#the-motivation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As we have seen during the chapters <a href="phenoflex.html#phenoflex">The <code>PhenoFlex</code> model</a> and <a href="phenoflex2.html#phenoflex2">The <code>PhenoFlex</code> model - a second look</a>, the <code>PhenoFlex</code> model is rather recent and needs to be validated under different conditions. In addition, some results obtained in the original publication <span class="citation">(<a href="#ref-luedelingPhenoFlex">Luedeling et al., 2021</a>)</span> suggest temperature responses during chill accumulation that seem implausible (see below, in particular the chill response for PhenoFlex<sub>fitted</sub> for Apple ‘Boskoop’).</p>
<div class="float">
<img src="pictures/PhenoFlex_paper_responses.png" alt="Chill and heat response plots for two versions of the PhenoFlex model." />
<div class="figcaption">Chill and heat response plots for two versions of the PhenoFlex model.</div>
</div>
<p>Note in the figure above the chill response for apple cv. “Boskoop” for temperatures above 25 °C. As we have learned in previous chapters, such high temperature may even be counterproductive for chill accumulation. This response estimated by <code>PhenoFlex</code> may suggest that conditions used for calibrating the modelling framework didn’t vary widely enough during the endo-dormancy period and point out the need for more relevant temperature conditions in the calibration data set to obtain an appropriate set of parameters.</p>
</div>
<div id="using-experimental-phenology-data-for-assessing-the-performance-of-phenoflex" class="section level2 hasAnchor" number="32.2">
<h2><span class="header-section-number">32.2</span> Using experimental phenology data for assessing the performance of <code>PhenoFlex</code><a href="phenoflex3.html#using-experimental-phenology-data-for-assessing-the-performance-of-phenoflex" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In our lab, we had the idea of using the data generated in the tree-moving experiment and analyzed in the chapter on <a href="exp_PLS.html#exp_PLS">Experimentally enhanced PLS</a> to calibrate the <code>PhenoFlex</code> model. This chapter presents an overview of the process and the main results. For more details, refer to the published version of the analysis <span class="citation">(<a href="#ref-fernandezUnusual">Fernandez et al., 2022</a>)</span> <a href="https://www.sciencedirect.com/science/article/pii/S016819232200209X"><em>(Link)</em></a>.</p>
<p>We will first load the weather and phenology data from the <code>data</code> folder and apply some cleaning procedures to comply with <code>PhenoFlex</code> format. If you don’t have the files yet, please first download them and save them in the <code>data</code> folder.</p>
<a href="data/final_weather_data_S1_S2_apple_hourly.csv">
<button class="btn btn-warning"><i class="fa fa-save"></i> Download weather data from the experiment</button>
</a>
<a href="data/final_bio_data_S1_S2_apple.csv">
<button class="btn btn-warning"><i class="fa fa-save"></i> Download phenology data from the experiment</button>
</a>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="phenoflex3.html#cb428-1" tabindex="-1"></a><span class="fu">library</span>(chillR)</span>
<span id="cb428-2"><a href="phenoflex3.html#cb428-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb428-3"><a href="phenoflex3.html#cb428-3" tabindex="-1"></a></span>
<span id="cb428-4"><a href="phenoflex3.html#cb428-4" tabindex="-1"></a><span class="co"># Load the data from the folder</span></span>
<span id="cb428-5"><a href="phenoflex3.html#cb428-5" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_tab</span>(<span class="st">&quot;data/final_weather_data_S1_S2_apple_hourly.csv&quot;</span>)</span>
<span id="cb428-6"><a href="phenoflex3.html#cb428-6" tabindex="-1"></a></span>
<span id="cb428-7"><a href="phenoflex3.html#cb428-7" tabindex="-1"></a><span class="co"># Generate a new column (Year_2) to simulate the year and comply with the format of PhenoFlex functions</span></span>
<span id="cb428-8"><a href="phenoflex3.html#cb428-8" tabindex="-1"></a>data[<span class="st">&quot;Year_2&quot;</span>] <span class="ot">&lt;-</span> data<span class="sc">$</span>Treatment <span class="sc">+</span> data<span class="sc">$</span>Year </span>
<span id="cb428-9"><a href="phenoflex3.html#cb428-9" tabindex="-1"></a></span>
<span id="cb428-10"><a href="phenoflex3.html#cb428-10" tabindex="-1"></a><span class="co"># Since this experiment was conducted during two consecutive seasons, the next step will fix a small continuity issue</span></span>
<span id="cb428-11"><a href="phenoflex3.html#cb428-11" tabindex="-1"></a><span class="co"># generated during the season 2</span></span>
<span id="cb428-12"><a href="phenoflex3.html#cb428-12" tabindex="-1"></a>data[data<span class="sc">$</span>Treatment <span class="sc">&gt;=</span> <span class="dv">34</span>, <span class="st">&quot;Year_2&quot;</span>] <span class="ot">&lt;-</span></span>
<span id="cb428-13"><a href="phenoflex3.html#cb428-13" tabindex="-1"></a>  data[data<span class="sc">$</span>Treatment <span class="sc">&gt;=</span> <span class="dv">34</span>, <span class="st">&quot;Year_2&quot;</span>] <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb428-14"><a href="phenoflex3.html#cb428-14" tabindex="-1"></a></span>
<span id="cb428-15"><a href="phenoflex3.html#cb428-15" tabindex="-1"></a><span class="co"># For further compatibility, I will now select the columns needed and will drop &quot;Year&quot; (the original one)</span></span>
<span id="cb428-16"><a href="phenoflex3.html#cb428-16" tabindex="-1"></a>data <span class="ot">&lt;-</span> data[<span class="fu">c</span>(<span class="st">&quot;YEARMODA&quot;</span>, <span class="st">&quot;Year_2&quot;</span>, <span class="st">&quot;Month&quot;</span>,</span>
<span id="cb428-17"><a href="phenoflex3.html#cb428-17" tabindex="-1"></a>               <span class="st">&quot;Day&quot;</span>, <span class="st">&quot;Hour&quot;</span>, <span class="st">&quot;JDay&quot;</span>, <span class="st">&quot;Temp&quot;</span>)]</span>
<span id="cb428-18"><a href="phenoflex3.html#cb428-18" tabindex="-1"></a></span>
<span id="cb428-19"><a href="phenoflex3.html#cb428-19" tabindex="-1"></a><span class="co"># To replace the missing &quot;Year&quot; column, I will now change the name of the column</span></span>
<span id="cb428-20"><a href="phenoflex3.html#cb428-20" tabindex="-1"></a><span class="fu">colnames</span>(data)[<span class="fu">which</span>(<span class="fu">colnames</span>(data) <span class="sc">==</span> <span class="st">&quot;Year_2&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;Year&quot;</span></span>
<span id="cb428-21"><a href="phenoflex3.html#cb428-21" tabindex="-1"></a></span>
<span id="cb428-22"><a href="phenoflex3.html#cb428-22" tabindex="-1"></a></span>
<span id="cb428-23"><a href="phenoflex3.html#cb428-23" tabindex="-1"></a><span class="co"># Import the phenology data from the repository</span></span>
<span id="cb428-24"><a href="phenoflex3.html#cb428-24" tabindex="-1"></a>pheno <span class="ot">&lt;-</span> <span class="fu">read_tab</span>(<span class="st">&quot;data/final_bio_data_S1_S2_apple.csv&quot;</span>)</span>
<span id="cb428-25"><a href="phenoflex3.html#cb428-25" tabindex="-1"></a></span>
<span id="cb428-26"><a href="phenoflex3.html#cb428-26" tabindex="-1"></a><span class="co"># Remove troubling treatments</span></span>
<span id="cb428-27"><a href="phenoflex3.html#cb428-27" tabindex="-1"></a>pheno <span class="ot">&lt;-</span> pheno[<span class="sc">!</span>(pheno<span class="sc">$</span>Treatment <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">36</span>, <span class="dv">3</span>, <span class="dv">23</span>, <span class="dv">24</span>, <span class="dv">17</span>, <span class="dv">18</span>, <span class="dv">61</span>)), </span>
<span id="cb428-28"><a href="phenoflex3.html#cb428-28" tabindex="-1"></a>               <span class="fu">c</span>(<span class="st">&quot;Treatment&quot;</span>, <span class="st">&quot;pheno&quot;</span>)]</span>
<span id="cb428-29"><a href="phenoflex3.html#cb428-29" tabindex="-1"></a></span>
<span id="cb428-30"><a href="phenoflex3.html#cb428-30" tabindex="-1"></a>pheno[<span class="st">&quot;Treatment&quot;</span>] <span class="ot">&lt;-</span> pheno<span class="sc">$</span>Treatment <span class="sc">+</span> <span class="dv">2019</span></span>
<span id="cb428-31"><a href="phenoflex3.html#cb428-31" tabindex="-1"></a></span>
<span id="cb428-32"><a href="phenoflex3.html#cb428-32" tabindex="-1"></a><span class="fu">colnames</span>(pheno) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Year&quot;</span>, <span class="st">&quot;pheno&quot;</span>)</span></code></pre></div>
<p>We can now take a look at the format of both datasets with the help of the <code>head()</code> function to see how they look:</p>
<ul>
<li>Weather records show the hourly temperature trees were exposed to during the experiment.</li>
</ul>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="phenoflex3.html#cb429-1" tabindex="-1"></a><span class="fu">head</span>(data)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">YEARMODA</th>
<th align="right">Year</th>
<th align="right">Month</th>
<th align="right">Day</th>
<th align="right">Hour</th>
<th align="right">JDay</th>
<th align="right">Temp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">20180606</td>
<td align="right">2019</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">157</td>
<td align="right">13.60700</td>
</tr>
<tr class="even">
<td align="right">20180606</td>
<td align="right">2019</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">1</td>
<td align="right">157</td>
<td align="right">12.49315</td>
</tr>
<tr class="odd">
<td align="right">20180606</td>
<td align="right">2019</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">2</td>
<td align="right">157</td>
<td align="right">11.76103</td>
</tr>
<tr class="even">
<td align="right">20180606</td>
<td align="right">2019</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">3</td>
<td align="right">157</td>
<td align="right">11.11030</td>
</tr>
<tr class="odd">
<td align="right">20180606</td>
<td align="right">2019</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">4</td>
<td align="right">157</td>
<td align="right">10.45488</td>
</tr>
<tr class="even">
<td align="right">20180606</td>
<td align="right">2019</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">5</td>
<td align="right">157</td>
<td align="right">11.95780</td>
</tr>
</tbody>
</table>
<ul>
<li>Phenology data show the date of full bloom (in day of the year), which was recorded as the moment we observed 50% of flowers open with first petals falling according to the BBCH scale.</li>
</ul>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="phenoflex3.html#cb430-1" tabindex="-1"></a><span class="fu">head</span>(pheno)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Year</th>
<th align="right">pheno</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">2020</td>
<td align="right">115</td>
</tr>
<tr class="even">
<td align="right">2021</td>
<td align="right">98</td>
</tr>
<tr class="odd">
<td align="right">2023</td>
<td align="right">64</td>
</tr>
<tr class="even">
<td align="right">2024</td>
<td align="right">49</td>
</tr>
<tr class="odd">
<td align="right">2025</td>
<td align="right">64</td>
</tr>
<tr class="even">
<td align="right">2026</td>
<td align="right">50</td>
</tr>
</tbody>
</table>
<p>In both datesets, you can see the column <code>treatment</code> representing a “fake” year or season that corresponds to the actual treatment used in the experiment.</p>
<p>For comparison, we developed two versions of the analysis for calibrating the <code>PhenoFlex</code> model. In version 1 (hereafter <code>PhenoFlex_marginal</code>), we included all available experimental seasons, including five seasons that may have been marginal in terms of temperature to overcome the dormancy of apple trees. In version 2 (hereafter <code>PhenoFlex_normal</code>), we removed these seasons from the calibration data set.</p>
<div class="float">
<img src="pictures/Figure_1_PhenoFlex_exp_data.png" alt="Experimental seasons used in the different versions of the calibration procedure. The histogram on the left shows the distribution of mean temperature among experimental seasons" />
<div class="figcaption">Experimental seasons used in the different versions of the calibration procedure. The histogram on the left shows the distribution of mean temperature among experimental seasons</div>
</div>
<p>As you can see in the figure above, we identified these five marginal seasons as a small cluster at the upper limit of the distribution after sorting the seasons according to the mean temperature experienced by the trees between the beginning of the experiment and the moment we recorded full bloom.</p>
<p>In the following chunk we are just creating different datasets for the two versions of the analysis. The treatments represented by the years <code>c(2032, 2061, 2065, 2077, 2081)</code> were identified as marginal seasons and removed from the calibration data set in <code>PhenoFlex_normal</code>.</p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="phenoflex3.html#cb431-1" tabindex="-1"></a>pheno_marginal <span class="ot">&lt;-</span> pheno</span>
<span id="cb431-2"><a href="phenoflex3.html#cb431-2" tabindex="-1"></a></span>
<span id="cb431-3"><a href="phenoflex3.html#cb431-3" tabindex="-1"></a>pheno_normal <span class="ot">&lt;-</span> pheno[<span class="sc">!</span>(pheno<span class="sc">$</span>Year <span class="sc">%in%</span> </span>
<span id="cb431-4"><a href="phenoflex3.html#cb431-4" tabindex="-1"></a>                          <span class="fu">c</span>(<span class="dv">2032</span>, <span class="dv">2061</span>, <span class="dv">2065</span>, <span class="dv">2077</span>, <span class="dv">2081</span>)), ]</span></code></pre></div>
<p>We can now do the same for the weather data by defining two vectors containing the seasons we want to use for model calibration. We will randomly select 40 seasons for calibration in both versions of the analysis, leaving the remaining 14 experimental seasons for validation.</p>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="phenoflex3.html#cb432-1" tabindex="-1"></a><span class="co"># Define a vector of calibration and validation seasons. Marginal includes</span></span>
<span id="cb432-2"><a href="phenoflex3.html#cb432-2" tabindex="-1"></a><span class="co"># the marginal seasons</span></span>
<span id="cb432-3"><a href="phenoflex3.html#cb432-3" tabindex="-1"></a>calibration_seasons <span class="ot">&lt;-</span></span>
<span id="cb432-4"><a href="phenoflex3.html#cb432-4" tabindex="-1"></a>  <span class="fu">sort</span>(<span class="fu">sample</span>(pheno_normal<span class="sc">$</span>Year, </span>
<span id="cb432-5"><a href="phenoflex3.html#cb432-5" tabindex="-1"></a>              <span class="dv">40</span>, </span>
<span id="cb432-6"><a href="phenoflex3.html#cb432-6" tabindex="-1"></a>              <span class="at">replace =</span> <span class="cn">FALSE</span>))</span>
<span id="cb432-7"><a href="phenoflex3.html#cb432-7" tabindex="-1"></a></span>
<span id="cb432-8"><a href="phenoflex3.html#cb432-8" tabindex="-1"></a>calibration_seasons_marginal <span class="ot">&lt;-</span></span>
<span id="cb432-9"><a href="phenoflex3.html#cb432-9" tabindex="-1"></a>  <span class="fu">sort</span>(<span class="fu">c</span>(<span class="fu">sample</span>(calibration_seasons, </span>
<span id="cb432-10"><a href="phenoflex3.html#cb432-10" tabindex="-1"></a>                <span class="dv">35</span>,</span>
<span id="cb432-11"><a href="phenoflex3.html#cb432-11" tabindex="-1"></a>                <span class="at">replace =</span> <span class="cn">FALSE</span>),</span>
<span id="cb432-12"><a href="phenoflex3.html#cb432-12" tabindex="-1"></a>         pheno_marginal<span class="sc">$</span>Year[<span class="fu">which</span>(<span class="sc">!</span>(pheno_marginal<span class="sc">$</span>Year <span class="sc">%in%</span></span>
<span id="cb432-13"><a href="phenoflex3.html#cb432-13" tabindex="-1"></a>                                       pheno_normal<span class="sc">$</span>Year))]))</span>
<span id="cb432-14"><a href="phenoflex3.html#cb432-14" tabindex="-1"></a></span>
<span id="cb432-15"><a href="phenoflex3.html#cb432-15" tabindex="-1"></a>calibration_seasons_normal <span class="ot">&lt;-</span> calibration_seasons</span>
<span id="cb432-16"><a href="phenoflex3.html#cb432-16" tabindex="-1"></a></span>
<span id="cb432-17"><a href="phenoflex3.html#cb432-17" tabindex="-1"></a><span class="co"># Common validation seasons</span></span>
<span id="cb432-18"><a href="phenoflex3.html#cb432-18" tabindex="-1"></a>validation_seasons <span class="ot">&lt;-</span> </span>
<span id="cb432-19"><a href="phenoflex3.html#cb432-19" tabindex="-1"></a>  <span class="fu">sort</span>(pheno_normal[<span class="sc">!</span>(pheno_normal<span class="sc">$</span>Year <span class="sc">%in%</span> </span>
<span id="cb432-20"><a href="phenoflex3.html#cb432-20" tabindex="-1"></a>                        calibration_seasons), <span class="st">&quot;Year&quot;</span>])</span>
<span id="cb432-21"><a href="phenoflex3.html#cb432-21" tabindex="-1"></a></span>
<span id="cb432-22"><a href="phenoflex3.html#cb432-22" tabindex="-1"></a><span class="co"># Define the list of seasons (weather data)</span></span>
<span id="cb432-23"><a href="phenoflex3.html#cb432-23" tabindex="-1"></a>season_list_marginal <span class="ot">&lt;-</span> </span>
<span id="cb432-24"><a href="phenoflex3.html#cb432-24" tabindex="-1"></a>  <span class="fu">genSeasonList</span>(data,</span>
<span id="cb432-25"><a href="phenoflex3.html#cb432-25" tabindex="-1"></a>                <span class="at">mrange =</span> <span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">7</span>),</span>
<span id="cb432-26"><a href="phenoflex3.html#cb432-26" tabindex="-1"></a>                <span class="at">years =</span> calibration_seasons_marginal)</span>
<span id="cb432-27"><a href="phenoflex3.html#cb432-27" tabindex="-1"></a></span>
<span id="cb432-28"><a href="phenoflex3.html#cb432-28" tabindex="-1"></a>season_list_normal <span class="ot">&lt;-</span></span>
<span id="cb432-29"><a href="phenoflex3.html#cb432-29" tabindex="-1"></a>  <span class="fu">genSeasonList</span>(data,</span>
<span id="cb432-30"><a href="phenoflex3.html#cb432-30" tabindex="-1"></a>                <span class="at">mrange =</span> <span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">7</span>),</span>
<span id="cb432-31"><a href="phenoflex3.html#cb432-31" tabindex="-1"></a>                <span class="at">years =</span> calibration_seasons_normal)</span></code></pre></div>
<p>Now we can apply what we learned in the chapter <a href="phenoflex.html#phenoflex">The <code>PhenoFlex</code> model</a> and fit the model parameters to data. Note that we start the fitting procedure with wide ranges (particularly for <code>yc</code> and <code>zc</code>) in order to let the model find the best estimates.</p>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="phenoflex3.html#cb433-1" tabindex="-1"></a><span class="co"># Set the initial parameters (wide ranges)</span></span>
<span id="cb433-2"><a href="phenoflex3.html#cb433-2" tabindex="-1"></a><span class="co">#   yc,  zc,  s1, Tu,     E0,      E1,     A0,          A1,   Tf, Tc, Tb, slope</span></span>
<span id="cb433-3"><a href="phenoflex3.html#cb433-3" tabindex="-1"></a>lower <span class="ot">&lt;-</span> </span>
<span id="cb433-4"><a href="phenoflex3.html#cb433-4" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">100</span>, <span class="fl">0.1</span>,  <span class="dv">0</span>, <span class="fl">3000.0</span>,  <span class="fl">9000.0</span>, <span class="fl">6000.0</span>,       <span class="dv">5</span>.e13,    <span class="dv">0</span>,  <span class="dv">0</span>,  <span class="dv">0</span>,  <span class="fl">0.05</span>)</span>
<span id="cb433-5"><a href="phenoflex3.html#cb433-5" tabindex="-1"></a>par   <span class="ot">&lt;-</span> </span>
<span id="cb433-6"><a href="phenoflex3.html#cb433-6" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">190</span>, <span class="fl">0.5</span>, <span class="dv">25</span>, <span class="fl">3372.8</span>,  <span class="fl">9900.3</span>, <span class="fl">6319.5</span>, <span class="fl">5.939917e13</span>,    <span class="dv">4</span>, <span class="dv">36</span>,  <span class="dv">4</span>,  <span class="fl">1.60</span>)</span>
<span id="cb433-7"><a href="phenoflex3.html#cb433-7" tabindex="-1"></a>upper <span class="ot">&lt;-</span></span>
<span id="cb433-8"><a href="phenoflex3.html#cb433-8" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">500</span>, <span class="fl">1.0</span>, <span class="dv">30</span>, <span class="fl">4000.0</span>, <span class="fl">10000.0</span>, <span class="fl">7000.0</span>,       <span class="dv">6</span>.e13,   <span class="dv">10</span>, <span class="dv">40</span>, <span class="dv">10</span>, <span class="fl">50.00</span>)</span>
<span id="cb433-9"><a href="phenoflex3.html#cb433-9" tabindex="-1"></a></span>
<span id="cb433-10"><a href="phenoflex3.html#cb433-10" tabindex="-1"></a><span class="co"># Run the fitter</span></span>
<span id="cb433-11"><a href="phenoflex3.html#cb433-11" tabindex="-1"></a>pheno_fit_marginal <span class="ot">&lt;-</span> </span>
<span id="cb433-12"><a href="phenoflex3.html#cb433-12" tabindex="-1"></a>  <span class="fu">phenologyFitter</span>(<span class="at">par.guess =</span> par,</span>
<span id="cb433-13"><a href="phenoflex3.html#cb433-13" tabindex="-1"></a>                  <span class="at">modelfn =</span> PhenoFlex_GDHwrapper,</span>
<span id="cb433-14"><a href="phenoflex3.html#cb433-14" tabindex="-1"></a>                  <span class="at">bloomJDays =</span> pheno_marginal[pheno_marginal<span class="sc">$</span>Year <span class="sc">%in%</span></span>
<span id="cb433-15"><a href="phenoflex3.html#cb433-15" tabindex="-1"></a>                                                calibration_seasons_marginal,</span>
<span id="cb433-16"><a href="phenoflex3.html#cb433-16" tabindex="-1"></a>                                              <span class="st">&quot;pheno&quot;</span>],</span>
<span id="cb433-17"><a href="phenoflex3.html#cb433-17" tabindex="-1"></a>                  <span class="at">SeasonList =</span> season_list_marginal,</span>
<span id="cb433-18"><a href="phenoflex3.html#cb433-18" tabindex="-1"></a>                  <span class="at">lower =</span> lower,</span>
<span id="cb433-19"><a href="phenoflex3.html#cb433-19" tabindex="-1"></a>                  <span class="at">upper =</span> upper,</span>
<span id="cb433-20"><a href="phenoflex3.html#cb433-20" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">smooth =</span> <span class="cn">FALSE</span>,</span>
<span id="cb433-21"><a href="phenoflex3.html#cb433-21" tabindex="-1"></a>                                 <span class="at">verbose =</span> <span class="cn">FALSE</span>,</span>
<span id="cb433-22"><a href="phenoflex3.html#cb433-22" tabindex="-1"></a>                                 <span class="at">maxit =</span> <span class="dv">100</span>,</span>
<span id="cb433-23"><a href="phenoflex3.html#cb433-23" tabindex="-1"></a>                                 <span class="at">nb.stop.improvement =</span> <span class="dv">10</span>))</span>
<span id="cb433-24"><a href="phenoflex3.html#cb433-24" tabindex="-1"></a></span>
<span id="cb433-25"><a href="phenoflex3.html#cb433-25" tabindex="-1"></a><span class="co"># Same for version 2</span></span>
<span id="cb433-26"><a href="phenoflex3.html#cb433-26" tabindex="-1"></a>pheno_fit_normal <span class="ot">&lt;-</span> </span>
<span id="cb433-27"><a href="phenoflex3.html#cb433-27" tabindex="-1"></a>  <span class="fu">phenologyFitter</span>(<span class="at">par.guess =</span> par,</span>
<span id="cb433-28"><a href="phenoflex3.html#cb433-28" tabindex="-1"></a>                  <span class="at">modelfn =</span> PhenoFlex_GDHwrapper,</span>
<span id="cb433-29"><a href="phenoflex3.html#cb433-29" tabindex="-1"></a>                  <span class="at">bloomJDays =</span> pheno_normal[pheno_normal<span class="sc">$</span>Year <span class="sc">%in%</span></span>
<span id="cb433-30"><a href="phenoflex3.html#cb433-30" tabindex="-1"></a>                                              calibration_seasons_normal,</span>
<span id="cb433-31"><a href="phenoflex3.html#cb433-31" tabindex="-1"></a>                                            <span class="st">&quot;pheno&quot;</span>],</span>
<span id="cb433-32"><a href="phenoflex3.html#cb433-32" tabindex="-1"></a>                  <span class="at">SeasonList =</span> season_list_normal,</span>
<span id="cb433-33"><a href="phenoflex3.html#cb433-33" tabindex="-1"></a>                  <span class="at">lower =</span> lower,</span>
<span id="cb433-34"><a href="phenoflex3.html#cb433-34" tabindex="-1"></a>                  <span class="at">upper =</span> upper,</span>
<span id="cb433-35"><a href="phenoflex3.html#cb433-35" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">smooth =</span> <span class="cn">FALSE</span>,</span>
<span id="cb433-36"><a href="phenoflex3.html#cb433-36" tabindex="-1"></a>                                 <span class="at">verbose =</span> <span class="cn">FALSE</span>,</span>
<span id="cb433-37"><a href="phenoflex3.html#cb433-37" tabindex="-1"></a>                                 <span class="at">maxit =</span> <span class="dv">100</span>,</span>
<span id="cb433-38"><a href="phenoflex3.html#cb433-38" tabindex="-1"></a>                                 <span class="at">nb.stop.improvement =</span> <span class="dv">10</span>))</span></code></pre></div>
<p><em>Note that we set the argument <code>maxit</code> in the <code>control</code> list to 100 to make the code run fast. For a real assessment, we should probably use greater values (e.g. 1,000).</em></p>
<p>We are saving the results of the fitting (model parameters and predicted bloom dates) and reading them from the folder to save time in future analyses.</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="phenoflex3.html#cb434-1" tabindex="-1"></a><span class="fu">write.csv</span>(pheno_fit_marginal<span class="sc">$</span>par,</span>
<span id="cb434-2"><a href="phenoflex3.html#cb434-2" tabindex="-1"></a>          <span class="st">&quot;data/PhenoFlex_marginal_params.csv&quot;</span>,</span>
<span id="cb434-3"><a href="phenoflex3.html#cb434-3" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb434-4"><a href="phenoflex3.html#cb434-4" tabindex="-1"></a></span>
<span id="cb434-5"><a href="phenoflex3.html#cb434-5" tabindex="-1"></a><span class="fu">write.csv</span>(pheno_fit_normal<span class="sc">$</span>par,</span>
<span id="cb434-6"><a href="phenoflex3.html#cb434-6" tabindex="-1"></a>          <span class="st">&quot;data/PhenoFlex_normal_params.csv&quot;</span>,</span>
<span id="cb434-7"><a href="phenoflex3.html#cb434-7" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb434-8"><a href="phenoflex3.html#cb434-8" tabindex="-1"></a></span>
<span id="cb434-9"><a href="phenoflex3.html#cb434-9" tabindex="-1"></a><span class="fu">write.csv</span>(<span class="fu">data.frame</span>(pheno_marginal[pheno_marginal<span class="sc">$</span>Year <span class="sc">%in%</span></span>
<span id="cb434-10"><a href="phenoflex3.html#cb434-10" tabindex="-1"></a>                                      calibration_seasons_marginal, ],</span>
<span id="cb434-11"><a href="phenoflex3.html#cb434-11" tabindex="-1"></a>                     <span class="st">&quot;Predicted&quot;</span> <span class="ot">=</span> pheno_fit_marginal<span class="sc">$</span>pbloomJDays),</span>
<span id="cb434-12"><a href="phenoflex3.html#cb434-12" tabindex="-1"></a>          <span class="st">&quot;data/PhenoFlex_marginal_predicted_bloom.csv&quot;</span>,</span>
<span id="cb434-13"><a href="phenoflex3.html#cb434-13" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb434-14"><a href="phenoflex3.html#cb434-14" tabindex="-1"></a></span>
<span id="cb434-15"><a href="phenoflex3.html#cb434-15" tabindex="-1"></a><span class="fu">write.csv</span>(<span class="fu">data.frame</span>(pheno_normal[pheno_normal<span class="sc">$</span>Year <span class="sc">%in%</span></span>
<span id="cb434-16"><a href="phenoflex3.html#cb434-16" tabindex="-1"></a>                                    calibration_seasons_normal, ],</span>
<span id="cb434-17"><a href="phenoflex3.html#cb434-17" tabindex="-1"></a>                     <span class="st">&quot;Predicted&quot;</span> <span class="ot">=</span> pheno_fit_normal<span class="sc">$</span>pbloomJDays),</span>
<span id="cb434-18"><a href="phenoflex3.html#cb434-18" tabindex="-1"></a>          <span class="st">&quot;data/PhenoFlex_normal_predicted_bloom.csv&quot;</span>,</span>
<span id="cb434-19"><a href="phenoflex3.html#cb434-19" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>Let’s take a look at some results from the fitting procedure. We can obtain the predictions by the model using the fitted parameters and then estimate the prediction error.</p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="phenoflex3.html#cb435-1" tabindex="-1"></a><span class="co"># Read the parameters</span></span>
<span id="cb435-2"><a href="phenoflex3.html#cb435-2" tabindex="-1"></a>params_marginal <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/PhenoFlex_marginal_params.csv&quot;</span>)[[<span class="dv">1</span>]]</span>
<span id="cb435-3"><a href="phenoflex3.html#cb435-3" tabindex="-1"></a>params_normal <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/PhenoFlex_normal_params.csv&quot;</span>)[[<span class="dv">1</span>]]</span>
<span id="cb435-4"><a href="phenoflex3.html#cb435-4" tabindex="-1"></a></span>
<span id="cb435-5"><a href="phenoflex3.html#cb435-5" tabindex="-1"></a><span class="co"># Generate a data set to collect the outputs of the fitting for the calibration data </span></span>
<span id="cb435-6"><a href="phenoflex3.html#cb435-6" tabindex="-1"></a>out_df_marginal <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/PhenoFlex_marginal_predicted_bloom.csv&quot;</span>)</span>
<span id="cb435-7"><a href="phenoflex3.html#cb435-7" tabindex="-1"></a>out_df_normal <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/PhenoFlex_normal_predicted_bloom.csv&quot;</span>)</span>
<span id="cb435-8"><a href="phenoflex3.html#cb435-8" tabindex="-1"></a></span>
<span id="cb435-9"><a href="phenoflex3.html#cb435-9" tabindex="-1"></a><span class="co"># Compute the error (observed - predicted)</span></span>
<span id="cb435-10"><a href="phenoflex3.html#cb435-10" tabindex="-1"></a>out_df_marginal[[<span class="st">&quot;Error&quot;</span>]] <span class="ot">&lt;-</span></span>
<span id="cb435-11"><a href="phenoflex3.html#cb435-11" tabindex="-1"></a>  out_df_marginal<span class="sc">$</span>pheno <span class="sc">-</span> out_df_marginal<span class="sc">$</span>Predicted</span>
<span id="cb435-12"><a href="phenoflex3.html#cb435-12" tabindex="-1"></a></span>
<span id="cb435-13"><a href="phenoflex3.html#cb435-13" tabindex="-1"></a>out_df_normal[[<span class="st">&quot;Error&quot;</span>]] <span class="ot">&lt;-</span></span>
<span id="cb435-14"><a href="phenoflex3.html#cb435-14" tabindex="-1"></a>  out_df_normal<span class="sc">$</span>pheno <span class="sc">-</span> out_df_normal<span class="sc">$</span>Predicted</span></code></pre></div>
<p>We can now compute some model performance metrics based on the prediction error estimated above. This is not very relevant during the calibration procedure, but it can give us an idea on how the two <code>PhenoFlex</code> versions compare.</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="phenoflex3.html#cb436-1" tabindex="-1"></a>calibration_metrics</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Metric</th>
<th align="right">PhenoFlex_marginal</th>
<th align="right">PhenoFlex_normal</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">RMSEP</td>
<td align="right">10.61386</td>
<td align="right">3.837238</td>
</tr>
<tr class="even">
<td align="left">RPIQ</td>
<td align="right">3.39179</td>
<td align="right">10.163561</td>
</tr>
</tbody>
</table>
<p>There is certainly room for improvement (especially considering that we only used 10 iterations), but the results give us a clear indication that calibrating the model with the marginal seasons reduced the performance of <code>PhenoFlex</code>.</p>
<p>Let’s plot some results.</p>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="phenoflex3.html#cb437-1" tabindex="-1"></a>out_df_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(<span class="st">&quot;PhenoFlex marginal&quot;</span> <span class="ot">=</span> out_df_marginal,</span>
<span id="cb437-2"><a href="phenoflex3.html#cb437-2" tabindex="-1"></a>                        <span class="st">&quot;PhenoFlex normal&quot;</span> <span class="ot">=</span> out_df_normal,</span>
<span id="cb437-3"><a href="phenoflex3.html#cb437-3" tabindex="-1"></a>                        <span class="at">.id =</span> <span class="st">&quot;PhenoFlex version&quot;</span>)</span>
<span id="cb437-4"><a href="phenoflex3.html#cb437-4" tabindex="-1"></a></span>
<span id="cb437-5"><a href="phenoflex3.html#cb437-5" tabindex="-1"></a><span class="co"># Plot the observed versus predicted values</span></span>
<span id="cb437-6"><a href="phenoflex3.html#cb437-6" tabindex="-1"></a><span class="fu">ggplot</span>(out_df_all,</span>
<span id="cb437-7"><a href="phenoflex3.html#cb437-7" tabindex="-1"></a>       <span class="fu">aes</span>(pheno, </span>
<span id="cb437-8"><a href="phenoflex3.html#cb437-8" tabindex="-1"></a>           Predicted)) <span class="sc">+</span></span>
<span id="cb437-9"><a href="phenoflex3.html#cb437-9" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb437-10"><a href="phenoflex3.html#cb437-10" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb437-11"><a href="phenoflex3.html#cb437-11" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Observed&quot;</span>) <span class="sc">+</span></span>
<span id="cb437-12"><a href="phenoflex3.html#cb437-12" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> <span class="st">`</span><span class="at">PhenoFlex version</span><span class="st">`</span>) <span class="sc">+</span></span>
<span id="cb437-13"><a href="phenoflex3.html#cb437-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="Book_files/figure-html/plotting-1.png" width="672" /></p>
<p>We can see in the plot that the version including the marginal seasons shows a greater dispersion compared to the version excluding the marginal seasons in the calibration of the framework.</p>
</div>
<div id="validation" class="section level2 hasAnchor" number="32.3">
<h2><span class="header-section-number">32.3</span> Validation<a href="phenoflex3.html#validation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We should probably now take a look at how well both versions can predict bloom dates for seasons that were not contained in the calibration data set. We need to extract the model parameters and use the function <code>PhenoFlex_GDHwrapper()</code> to complete this task. Remember, we are using a common set of seasons for validation of both the <code>PhenoFlex_marginal</code> and <code>PhenoFlex_normal</code> versions.</p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="phenoflex3.html#cb438-1" tabindex="-1"></a><span class="co"># Generate a validation data set with phenology data</span></span>
<span id="cb438-2"><a href="phenoflex3.html#cb438-2" tabindex="-1"></a>valid_df_marginal <span class="ot">&lt;-</span> pheno_marginal[pheno_marginal<span class="sc">$</span>Year <span class="sc">%in%</span> </span>
<span id="cb438-3"><a href="phenoflex3.html#cb438-3" tabindex="-1"></a>                                      validation_seasons, ]</span>
<span id="cb438-4"><a href="phenoflex3.html#cb438-4" tabindex="-1"></a></span>
<span id="cb438-5"><a href="phenoflex3.html#cb438-5" tabindex="-1"></a>valid_df_normal <span class="ot">&lt;-</span> pheno_normal[pheno_normal<span class="sc">$</span>Year <span class="sc">%in%</span></span>
<span id="cb438-6"><a href="phenoflex3.html#cb438-6" tabindex="-1"></a>                                  validation_seasons, ]</span>
<span id="cb438-7"><a href="phenoflex3.html#cb438-7" tabindex="-1"></a></span>
<span id="cb438-8"><a href="phenoflex3.html#cb438-8" tabindex="-1"></a><span class="co"># Generate a list of seasons with weather data for the validation procedure</span></span>
<span id="cb438-9"><a href="phenoflex3.html#cb438-9" tabindex="-1"></a>valid_season_list <span class="ot">&lt;-</span> <span class="fu">genSeasonList</span>(data,</span>
<span id="cb438-10"><a href="phenoflex3.html#cb438-10" tabindex="-1"></a>                                   <span class="at">mrange =</span> <span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">7</span>), </span>
<span id="cb438-11"><a href="phenoflex3.html#cb438-11" tabindex="-1"></a>                                   <span class="at">years =</span> validation_seasons)</span>
<span id="cb438-12"><a href="phenoflex3.html#cb438-12" tabindex="-1"></a></span>
<span id="cb438-13"><a href="phenoflex3.html#cb438-13" tabindex="-1"></a><span class="co"># Estimate the bloom dates with PhenoFlexGDHwrapper</span></span>
<span id="cb438-14"><a href="phenoflex3.html#cb438-14" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span> <span class="sc">:</span> <span class="fu">nrow</span>(valid_df_marginal)) {</span>
<span id="cb438-15"><a href="phenoflex3.html#cb438-15" tabindex="-1"></a>  valid_df_marginal[i, <span class="st">&quot;Predicted&quot;</span>] <span class="ot">&lt;-</span></span>
<span id="cb438-16"><a href="phenoflex3.html#cb438-16" tabindex="-1"></a>    <span class="fu">PhenoFlex_GDHwrapper</span>(valid_season_list[[i]],</span>
<span id="cb438-17"><a href="phenoflex3.html#cb438-17" tabindex="-1"></a>                         params_marginal)</span>
<span id="cb438-18"><a href="phenoflex3.html#cb438-18" tabindex="-1"></a>  }</span>
<span id="cb438-19"><a href="phenoflex3.html#cb438-19" tabindex="-1"></a></span>
<span id="cb438-20"><a href="phenoflex3.html#cb438-20" tabindex="-1"></a><span class="co"># The same for the second version</span></span>
<span id="cb438-21"><a href="phenoflex3.html#cb438-21" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span> <span class="sc">:</span> <span class="fu">nrow</span>(valid_df_normal)) {</span>
<span id="cb438-22"><a href="phenoflex3.html#cb438-22" tabindex="-1"></a>  valid_df_normal[i, <span class="st">&quot;Predicted&quot;</span>] <span class="ot">&lt;-</span></span>
<span id="cb438-23"><a href="phenoflex3.html#cb438-23" tabindex="-1"></a>    <span class="fu">PhenoFlex_GDHwrapper</span>(valid_season_list[[i]],</span>
<span id="cb438-24"><a href="phenoflex3.html#cb438-24" tabindex="-1"></a>                         params_normal)</span>
<span id="cb438-25"><a href="phenoflex3.html#cb438-25" tabindex="-1"></a>  }</span>
<span id="cb438-26"><a href="phenoflex3.html#cb438-26" tabindex="-1"></a></span>
<span id="cb438-27"><a href="phenoflex3.html#cb438-27" tabindex="-1"></a><span class="co"># Compute the error (observed - predicted)</span></span>
<span id="cb438-28"><a href="phenoflex3.html#cb438-28" tabindex="-1"></a>valid_df_marginal[[<span class="st">&quot;Error&quot;</span>]] <span class="ot">&lt;-</span></span>
<span id="cb438-29"><a href="phenoflex3.html#cb438-29" tabindex="-1"></a>  valid_df_marginal<span class="sc">$</span>pheno <span class="sc">-</span> valid_df_marginal<span class="sc">$</span>Predicted</span>
<span id="cb438-30"><a href="phenoflex3.html#cb438-30" tabindex="-1"></a></span>
<span id="cb438-31"><a href="phenoflex3.html#cb438-31" tabindex="-1"></a>valid_df_normal[[<span class="st">&quot;Error&quot;</span>]] <span class="ot">&lt;-</span> </span>
<span id="cb438-32"><a href="phenoflex3.html#cb438-32" tabindex="-1"></a>  valid_df_normal<span class="sc">$</span>pheno <span class="sc">-</span> valid_df_normal<span class="sc">$</span>Predicted</span></code></pre></div>
<p>Since we already know the difference between the observed values and the values predicted by the model (i.e. the prediction error) in the validation data set, we can estimate some model performance metrics such as the RMSEP and the RPIQ. To this end, we can use the functions <code>RMSEP()</code> and <code>RPIQ()</code> from <code>chillR</code>.</p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="phenoflex3.html#cb439-1" tabindex="-1"></a>validation_metrics</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Metric</th>
<th align="right">PhenoFlex_marginal</th>
<th align="right">PhenoFlex_normal</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">RMSEP</td>
<td align="right">6.643169</td>
<td align="right">4.246336</td>
</tr>
<tr class="even">
<td align="left">RPIQ</td>
<td align="right">6.171753</td>
<td align="right">9.655382</td>
</tr>
</tbody>
</table>
<p>The results shown in the table above confirm the pattern we observed in the calibration procedure. <strong>The inclusion of the marginal seasons lowered the performance of <code>PhenoFlex</code>.</strong> But it is always nice to see the results in a more graphically way, right? So, let’s plot them!</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="phenoflex3.html#cb440-1" tabindex="-1"></a><span class="co"># Create a unique data set</span></span>
<span id="cb440-2"><a href="phenoflex3.html#cb440-2" tabindex="-1"></a>valid_df_all <span class="ot">&lt;-</span> </span>
<span id="cb440-3"><a href="phenoflex3.html#cb440-3" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="st">&quot;PhenoFlex marginal&quot;</span> <span class="ot">=</span> valid_df_marginal,</span>
<span id="cb440-4"><a href="phenoflex3.html#cb440-4" tabindex="-1"></a>            <span class="st">&quot;PhenoFlex normal&quot;</span> <span class="ot">=</span> valid_df_normal,</span>
<span id="cb440-5"><a href="phenoflex3.html#cb440-5" tabindex="-1"></a>            <span class="at">.id =</span> <span class="st">&quot;PhenoFlex version&quot;</span>)</span>
<span id="cb440-6"><a href="phenoflex3.html#cb440-6" tabindex="-1"></a></span>
<span id="cb440-7"><a href="phenoflex3.html#cb440-7" tabindex="-1"></a><span class="co"># Plot the calibrated and validated </span></span>
<span id="cb440-8"><a href="phenoflex3.html#cb440-8" tabindex="-1"></a><span class="fu">ggplot</span>(out_df_all,</span>
<span id="cb440-9"><a href="phenoflex3.html#cb440-9" tabindex="-1"></a>       <span class="fu">aes</span>(pheno,</span>
<span id="cb440-10"><a href="phenoflex3.html#cb440-10" tabindex="-1"></a>           Predicted,</span>
<span id="cb440-11"><a href="phenoflex3.html#cb440-11" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">&quot;Calibration&quot;</span>)) <span class="sc">+</span></span>
<span id="cb440-12"><a href="phenoflex3.html#cb440-12" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb440-13"><a href="phenoflex3.html#cb440-13" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> valid_df_all,</span>
<span id="cb440-14"><a href="phenoflex3.html#cb440-14" tabindex="-1"></a>             <span class="fu">aes</span>(pheno, </span>
<span id="cb440-15"><a href="phenoflex3.html#cb440-15" tabindex="-1"></a>                 Predicted,</span>
<span id="cb440-16"><a href="phenoflex3.html#cb440-16" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;Validation&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb440-17"><a href="phenoflex3.html#cb440-17" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;cadetblue&quot;</span>,</span>
<span id="cb440-18"><a href="phenoflex3.html#cb440-18" tabindex="-1"></a>                                <span class="st">&quot;firebrick&quot;</span>)) <span class="sc">+</span></span>
<span id="cb440-19"><a href="phenoflex3.html#cb440-19" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, </span>
<span id="cb440-20"><a href="phenoflex3.html#cb440-20" tabindex="-1"></a>              <span class="at">slope =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb440-21"><a href="phenoflex3.html#cb440-21" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Observed&quot;</span>,</span>
<span id="cb440-22"><a href="phenoflex3.html#cb440-22" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Dataset&quot;</span>) <span class="sc">+</span></span>
<span id="cb440-23"><a href="phenoflex3.html#cb440-23" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> <span class="st">`</span><span class="at">PhenoFlex version</span><span class="st">`</span>) <span class="sc">+</span></span>
<span id="cb440-24"><a href="phenoflex3.html#cb440-24" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="Book_files/figure-html/validation_plot-1.png" width="672" /></p>
<p>Again, here we see that the red dots (representing the validation seasons) in <code>PhenoFlex_marginal</code> are more dispersed and placed at a greater distance from the line <code>x = y</code> compared to the red dots from the <code>PhenoFlex_normal</code> version.</p>
<p>We will now take a look at the chill and heat response curves for both versions of the analysis. To this end, we will make use of the functions <code>apply_const_temp()</code>, <code>gen_bell()</code>, and <code>GDH_response()</code> that we created in the chapter <a href="phenoflex2.html#phenoflex2">The <code>PhenoFlex</code> model - a second look</a>. We will load the functions again and will hide this process with the chunk options.</p>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="phenoflex3.html#cb441-1" tabindex="-1"></a><span class="co"># Create a data set with theoretical temperatures and heat and chill responses</span></span>
<span id="cb441-2"><a href="phenoflex3.html#cb441-2" tabindex="-1"></a>temp_response_marginal <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Temp =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">60</span>, <span class="fl">0.1</span>),</span>
<span id="cb441-3"><a href="phenoflex3.html#cb441-3" tabindex="-1"></a>                                     <span class="at">Chill_res =</span> <span class="fu">gen_bell</span>(params_marginal,</span>
<span id="cb441-4"><a href="phenoflex3.html#cb441-4" tabindex="-1"></a>                                                          <span class="at">temp_values =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">60</span>, <span class="fl">0.1</span>)),</span>
<span id="cb441-5"><a href="phenoflex3.html#cb441-5" tabindex="-1"></a>                                     <span class="at">Heat_res =</span> <span class="fu">GDH_response</span>(params_marginal,</span>
<span id="cb441-6"><a href="phenoflex3.html#cb441-6" tabindex="-1"></a>                                                             <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">60</span>, <span class="fl">0.1</span>)),</span>
<span id="cb441-7"><a href="phenoflex3.html#cb441-7" tabindex="-1"></a>                                     <span class="at">Version =</span> <span class="st">&quot;PhenoFlex marginal&quot;</span>)</span>
<span id="cb441-8"><a href="phenoflex3.html#cb441-8" tabindex="-1"></a></span>
<span id="cb441-9"><a href="phenoflex3.html#cb441-9" tabindex="-1"></a>temp_response_normal <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Temp =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">60</span>, <span class="fl">0.1</span>),</span>
<span id="cb441-10"><a href="phenoflex3.html#cb441-10" tabindex="-1"></a>                                   <span class="at">Chill_res =</span> <span class="fu">gen_bell</span>(params_normal,</span>
<span id="cb441-11"><a href="phenoflex3.html#cb441-11" tabindex="-1"></a>                                                        <span class="at">temp_values =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">60</span>, <span class="fl">0.1</span>)),</span>
<span id="cb441-12"><a href="phenoflex3.html#cb441-12" tabindex="-1"></a>                                   <span class="at">Heat_res =</span> <span class="fu">GDH_response</span>(params_normal,</span>
<span id="cb441-13"><a href="phenoflex3.html#cb441-13" tabindex="-1"></a>                                                           <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">60</span>, <span class="fl">0.1</span>)),</span>
<span id="cb441-14"><a href="phenoflex3.html#cb441-14" tabindex="-1"></a>                                   <span class="at">Version =</span> <span class="st">&quot;PhenoFlex normal&quot;</span>)</span>
<span id="cb441-15"><a href="phenoflex3.html#cb441-15" tabindex="-1"></a></span>
<span id="cb441-16"><a href="phenoflex3.html#cb441-16" tabindex="-1"></a></span>
<span id="cb441-17"><a href="phenoflex3.html#cb441-17" tabindex="-1"></a><span class="co"># Generate a single data set</span></span>
<span id="cb441-18"><a href="phenoflex3.html#cb441-18" tabindex="-1"></a>temp_response <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(temp_response_marginal, </span>
<span id="cb441-19"><a href="phenoflex3.html#cb441-19" tabindex="-1"></a>                           temp_response_normal)</span>
<span id="cb441-20"><a href="phenoflex3.html#cb441-20" tabindex="-1"></a></span>
<span id="cb441-21"><a href="phenoflex3.html#cb441-21" tabindex="-1"></a><span class="co"># Plotting</span></span>
<span id="cb441-22"><a href="phenoflex3.html#cb441-22" tabindex="-1"></a><span class="fu">ggplot</span>(temp_response, </span>
<span id="cb441-23"><a href="phenoflex3.html#cb441-23" tabindex="-1"></a>       <span class="fu">aes</span>(Temp)) <span class="sc">+</span></span>
<span id="cb441-24"><a href="phenoflex3.html#cb441-24" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Chill_res,</span>
<span id="cb441-25"><a href="phenoflex3.html#cb441-25" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">&quot;Chill&quot;</span>)) <span class="sc">+</span></span>
<span id="cb441-26"><a href="phenoflex3.html#cb441-26" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Heat_res <span class="sc">*</span> <span class="dv">25</span>, </span>
<span id="cb441-27"><a href="phenoflex3.html#cb441-27" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">&quot;Heat&quot;</span>)) <span class="sc">+</span></span>
<span id="cb441-28"><a href="phenoflex3.html#cb441-28" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.001</span>, <span class="fl">0.01</span>)),</span>
<span id="cb441-29"><a href="phenoflex3.html#cb441-29" tabindex="-1"></a>                     <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span> . <span class="sc">/</span> <span class="dv">25</span>, </span>
<span id="cb441-30"><a href="phenoflex3.html#cb441-30" tabindex="-1"></a>                                         <span class="at">name =</span> <span class="st">&quot;Arbitrary heat units&quot;</span>)) <span class="sc">+</span></span>
<span id="cb441-31"><a href="phenoflex3.html#cb441-31" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb441-32"><a href="phenoflex3.html#cb441-32" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;blue4&quot;</span>, </span>
<span id="cb441-33"><a href="phenoflex3.html#cb441-33" tabindex="-1"></a>                                <span class="st">&quot;firebrick&quot;</span>)) <span class="sc">+</span></span>
<span id="cb441-34"><a href="phenoflex3.html#cb441-34" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Temperature (°C)&quot;</span>,</span>
<span id="cb441-35"><a href="phenoflex3.html#cb441-35" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Arbitrary chill units&quot;</span>,</span>
<span id="cb441-36"><a href="phenoflex3.html#cb441-36" tabindex="-1"></a>       <span class="at">color =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb441-37"><a href="phenoflex3.html#cb441-37" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Version <span class="sc">~</span> .) <span class="sc">+</span></span>
<span id="cb441-38"><a href="phenoflex3.html#cb441-38" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb441-39"><a href="phenoflex3.html#cb441-39" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.85</span>, <span class="fl">0.85</span>))</span></code></pre></div>
<p><img src="Book_files/figure-html/response_curves-1.png" width="672" /></p>
<p>We see some differences in the chill response among versions, but similar heat curves. To some extent, <code>PhenoFlex_normal</code> emulates the chill response observed in the original chill model (i.e. the Dynamic model). Note that in <code>PhenoFlex_marginal</code> the accumulation of chill only starts at temperatures above 5 °C. Regarding the heat response, <code>PhenoFlex_normal</code> shows accumulation of heat with slightly higher temperatures than the curve shown for <code>PhenoFlex_marginal</code>. Since we used very few model iterations, however, these results are difficult to interpret.</p>
</div>
<div id="conclusions" class="section level2 hasAnchor" number="32.4">
<h2><span class="header-section-number">32.4</span> Conclusions<a href="phenoflex3.html#conclusions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This was just an abbreviated version of the analysis we conducted, but it gives us some interesting insights on the potential limitations of the modelling framework. It seems possible that under extreme conditions, the process of dormancy breaking is modulated by mechanisms that are not considered in the <code>PhenoFlex</code> framework (or in any other frameworks that are currently available). To test this hypothesis, however, additional systematic studies would have to be conducted.</p>
</div>
<div id="ex_phenoflex3" class="section level2 unnumbered hasAnchor">
<h2><code>Exercises</code> on improving the performance of <code>PhenoFlex</code><a href="phenoflex3.html#ex_phenoflex3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Describe (briefly) in your own words:</p>
<ol style="list-style-type: decimal">
<li>What was the objective of this work?</li>
<li>What was the main conclusion?</li>
<li>What experiments could we conduct to test the hypothesis that emerged at the end of the conclusion?</li>
</ol>

</div>
</div>
<h3>References<a href="refs.html#refs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="1" line-spacing="2">
<div id="ref-fernandezUnusual" class="csl-entry">
Fernandez E, Schiffers K, Urbach C &amp; Luedeling E. (2022). Unusually warm winter seasons may compromise the performance of current phenology models – predicting bloom dates in young apple trees with PhenoFlex. <em>Agricultural and Forest Meteorology</em>, <em>322, 109020</em>. doi: <a href="https://doi.org/10.1016/j.agrformet.2022.109020">10.1016/j.agrformet.2022.109020</a>
</div>
<div id="ref-luedelingPhenoFlex" class="csl-entry">
Luedeling E, Schiffers K, Fohrmann T &amp; Urbach C. (2021). Pheno-flex - an integrated model to predict spring phenology in temperate fruit trees. <em>Agricultural and Forest Meteorology</em>, <em>307, 108491</em>. doi: <a href="https://doi.org/10.1016/j.agrformet.2021.108491">10.1016/j.agrformet.2021.108491</a>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="phenoflex2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="frost-risk-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Book.pdf", "Book.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
