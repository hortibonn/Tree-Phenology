<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 34 A robust method to estimate future frost risks (?) | Tree phenology analysis with R</title>
  <meta name="description" content="This lecture introduces the chillR package for R." />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 34 A robust method to estimate future frost risks (?) | Tree phenology analysis with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This lecture introduces the chillR package for R." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 34 A robust method to estimate future frost risks (?) | Tree phenology analysis with R" />
  
  <meta name="twitter:description" content="This lecture introduces the chillR package for R." />
  

<meta name="author" content="Eike Luedeling" />


<meta name="date" content="2025-01-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="frost-risk-analysis.html"/>
<link rel="next" href="major_concepts.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.2/leaflet.js"></script>
<script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/font-awesome-6.5.2/js/script.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 1em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Tree phenology analysis with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#objectives"><i class="fa fa-check"></i><b>1.1</b> Objectives</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#performance-assessment"><i class="fa fa-check"></i><b>1.2</b> Performance assessment</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#house-rules"><i class="fa fa-check"></i><b>1.3</b> House rules</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="the-tools-we-use.html"><a href="the-tools-we-use.html"><i class="fa fa-check"></i><b>2</b> The tools we use</a>
<ul>
<li class="chapter" data-level="2.1" data-path="the-tools-we-use.html"><a href="the-tools-we-use.html#r-and-rstudio"><i class="fa fa-check"></i><b>2.1</b> R and RStudio</a></li>
<li class="chapter" data-level="2.2" data-path="the-tools-we-use.html"><a href="the-tools-we-use.html#git-and-github"><i class="fa fa-check"></i><b>2.2</b> git and github</a></li>
<li class="chapter" data-level="2.3" data-path="the-tools-we-use.html"><a href="the-tools-we-use.html#rmarkdown"><i class="fa fa-check"></i><b>2.3</b> Rmarkdown</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tree-dormancy.html"><a href="tree-dormancy.html"><i class="fa fa-check"></i><b>3</b> Tree dormancy</a>
<ul>
<li class="chapter" data-level="3.1" data-path="tree-dormancy.html"><a href="tree-dormancy.html#learning-goals-for-this-lesson"><i class="fa fa-check"></i><b>3.1</b> Learning goals for this lesson:</a></li>
<li class="chapter" data-level="3.2" data-path="tree-dormancy.html"><a href="tree-dormancy.html#introduction-to-dormancy"><i class="fa fa-check"></i><b>3.2</b> Introduction to dormancy</a></li>
<li class="chapter" data-level="3.3" data-path="tree-dormancy.html"><a href="tree-dormancy.html#dormancy-physiology"><i class="fa fa-check"></i><b>3.3</b> Dormancy physiology</a></li>
<li class="chapter" data-level="3.4" data-path="tree-dormancy.html"><a href="tree-dormancy.html#experimental-and-statistical-determination-of-the-chilling-and-forcing-periods"><i class="fa fa-check"></i><b>3.4</b> Experimental and statistical determination of the chilling and forcing periods</a></li>
<li class="chapter" data-level="3.5" data-path="tree-dormancy.html"><a href="tree-dormancy.html#phenology-record-and-bbch-scale"><i class="fa fa-check"></i><b>3.5</b> Phenology record and BBCH scale</a></li>
<li class="chapter" data-level="" data-path="tree-dormancy.html"><a href="tree-dormancy.html#exercises_dormancy"><i class="fa fa-check"></i><code>Exercises</code> on tree dormancy</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html"><i class="fa fa-check"></i><b>4</b> Climate change and impact projection</a>
<ul>
<li class="chapter" data-level="4.1" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#the-drivers-of-climate-change"><i class="fa fa-check"></i><b>4.1</b> The drivers of climate change</a></li>
<li class="chapter" data-level="4.2" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#what-weve-already-seen"><i class="fa fa-check"></i><b>4.2</b> What we’ve already seen</a></li>
<li class="chapter" data-level="4.3" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#future-scenarios"><i class="fa fa-check"></i><b>4.3</b> Future scenarios</a></li>
<li class="chapter" data-level="4.4" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#impact-projection-approaches"><i class="fa fa-check"></i><b>4.4</b> Impact projection approaches</a></li>
<li class="chapter" data-level="" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#exercises_climate_change"><i class="fa fa-check"></i><code>Exercises</code> on climate change</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html"><i class="fa fa-check"></i><b>5</b> Winter chill projections</a>
<ul>
<li class="chapter" data-level="" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#goals_analysis_examples"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="5.1" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-projections-1"><i class="fa fa-check"></i><b>5.1</b> Winter chill projections</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-oman"><i class="fa fa-check"></i><b>5.1.1</b> Winter chill in Oman</a></li>
<li class="chapter" data-level="5.1.2" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-model-sensitivity"><i class="fa fa-check"></i><b>5.1.2</b> Chill model sensitivity</a></li>
<li class="chapter" data-level="5.1.3" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-california"><i class="fa fa-check"></i><b>5.1.3</b> Winter chill in California</a></li>
<li class="chapter" data-level="5.1.4" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-ratios"><i class="fa fa-check"></i><b>5.1.4</b> Winter chill ratios</a></li>
<li class="chapter" data-level="5.1.5" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#a-global-projection-of-future-winter-chill"><i class="fa fa-check"></i><b>5.1.5</b> A global projection of future winter chill</a></li>
<li class="chapter" data-level="5.1.6" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-germany"><i class="fa fa-check"></i><b>5.1.6</b> Winter chill in Germany</a></li>
<li class="chapter" data-level="5.1.7" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-tunisia"><i class="fa fa-check"></i><b>5.1.7</b> Winter chill in Tunisia</a></li>
<li class="chapter" data-level="5.1.8" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-chile"><i class="fa fa-check"></i><b>5.1.8</b> Winter chill in Chile</a></li>
<li class="chapter" data-level="5.1.9" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-projection-for-patagonia"><i class="fa fa-check"></i><b>5.1.9</b> Chill projection for Patagonia</a></li>
<li class="chapter" data-level="5.1.10" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-model-comparison"><i class="fa fa-check"></i><b>5.1.10</b> Chill model comparison</a></li>
<li class="chapter" data-level="5.1.11" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-projection-for-all-of-tunisia"><i class="fa fa-check"></i><b>5.1.11</b> Chill projection for all of Tunisia</a></li>
<li class="chapter" data-level="5.1.12" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#revisiting-chill-accumulation-in-oman"><i class="fa fa-check"></i><b>5.1.12</b> Revisiting chill accumulation in Oman</a></li>
<li class="chapter" data-level="5.1.13" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#future-studies"><i class="fa fa-check"></i><b>5.1.13</b> Future studies?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#exercises_past_studies"><i class="fa fa-check"></i><code>Exercises</code> on past chill projections</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="manual-chill-analysis.html"><a href="manual-chill-analysis.html"><i class="fa fa-check"></i><b>6</b> Manual chill analysis</a>
<ul>
<li class="chapter" data-level="" data-path="manual-chill-analysis.html"><a href="manual-chill-analysis.html#goals_manual_chill_analysis"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="6.1" data-path="manual-chill-analysis.html"><a href="manual-chill-analysis.html#computing-chilling-hours-from-hourly-temperature-data"><i class="fa fa-check"></i><b>6.1</b> Computing Chilling Hours from hourly temperature data</a></li>
<li class="chapter" data-level="6.2" data-path="manual-chill-analysis.html"><a href="manual-chill-analysis.html#our-first-chill-function"><i class="fa fa-check"></i><b>6.2</b> Our first chill function</a></li>
<li class="chapter" data-level="" data-path="manual-chill-analysis.html"><a href="manual-chill-analysis.html#exercises_manual_chill_analysis"><i class="fa fa-check"></i><code>Exercises</code> on basic chill modeling</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chill-models.html"><a href="chill-models.html"><i class="fa fa-check"></i><b>7</b> Chill models</a>
<ul>
<li class="chapter" data-level="" data-path="chill-models.html"><a href="chill-models.html#goals_chill_models"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="7.1" data-path="chill-models.html"><a href="chill-models.html#chill-models-in-chillr"><i class="fa fa-check"></i><b>7.1</b> Chill models in <code>chillR</code></a></li>
<li class="chapter" data-level="" data-path="chill-models.html"><a href="chill-models.html#exercises_chill_models"><i class="fa fa-check"></i><code>Exercises</code> on chill models</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html"><i class="fa fa-check"></i><b>8</b> Making hourly temperatures</a>
<ul>
<li class="chapter" data-level="" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#goals_hourly"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="8.1" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#generating-hourly-temperatures"><i class="fa fa-check"></i><b>8.1</b> Generating hourly temperatures</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#idealized-daily-temperature-curves"><i class="fa fa-check"></i><b>8.1.1</b> Idealized daily temperature curves</a></li>
<li class="chapter" data-level="8.1.2" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#empirical-daily-temperature-curves"><i class="fa fa-check"></i><b>8.1.2</b> Empirical daily temperature curves</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#exercises_hourly"><i class="fa fa-check"></i><code>Exercises</code> on hourly temperatures</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html"><i class="fa fa-check"></i><b>9</b> Some useful tools in R</a>
<ul>
<li class="chapter" data-level="" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#goals_R_tools"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="9.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#an-evolving-language---and-a-lifelong-learning-process"><i class="fa fa-check"></i><b>9.1</b> An evolving language - and a lifelong learning process</a></li>
<li class="chapter" data-level="9.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-tidyverse"><i class="fa fa-check"></i><b>9.2</b> The <code>tidyverse</code></a></li>
<li class="chapter" data-level="9.3" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-ggplot2-package"><i class="fa fa-check"></i><b>9.3</b> The <code>ggplot2</code> package</a></li>
<li class="chapter" data-level="9.4" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-tibble-package"><i class="fa fa-check"></i><b>9.4</b> The <code>tibble</code> package</a></li>
<li class="chapter" data-level="9.5" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-magrittr-package---pipes"><i class="fa fa-check"></i><b>9.5</b> The <code>magrittr</code> package - pipes</a></li>
<li class="chapter" data-level="9.6" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-tidyr-package"><i class="fa fa-check"></i><b>9.6</b> The <code>tidyr</code> package</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#pivot_longer"><i class="fa fa-check"></i><b>9.6.1</b> <code>pivot_longer</code></a></li>
<li class="chapter" data-level="9.6.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#pivot_wider"><i class="fa fa-check"></i><b>9.6.2</b> <code>pivot_wider</code></a></li>
<li class="chapter" data-level="9.6.3" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#select"><i class="fa fa-check"></i><b>9.6.3</b> <code>select</code></a></li>
<li class="chapter" data-level="9.6.4" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#filter"><i class="fa fa-check"></i><b>9.6.4</b> <code>filter</code></a></li>
<li class="chapter" data-level="9.6.5" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#mutate"><i class="fa fa-check"></i><b>9.6.5</b> <code>mutate</code></a></li>
<li class="chapter" data-level="9.6.6" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#arrange"><i class="fa fa-check"></i><b>9.6.6</b> <code>arrange</code></a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#loops"><i class="fa fa-check"></i><b>9.7</b> Loops</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#for-loops"><i class="fa fa-check"></i><b>9.7.1</b> <em>For</em> loops</a></li>
<li class="chapter" data-level="9.7.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#while-loops"><i class="fa fa-check"></i><b>9.7.2</b> <em>While</em> loops</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#apply-functions"><i class="fa fa-check"></i><b>9.8</b> <code>apply</code> functions</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#sapply"><i class="fa fa-check"></i><b>9.8.1</b> <code>sapply</code></a></li>
<li class="chapter" data-level="9.8.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#lapply"><i class="fa fa-check"></i><b>9.8.2</b> <code>lapply</code></a></li>
<li class="chapter" data-level="9.8.3" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#apply"><i class="fa fa-check"></i><b>9.8.3</b> <code>apply</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#exercises_R_tools"><i class="fa fa-check"></i><code>Exercises</code> on useful R tools</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="get_temp_data.html"><a href="get_temp_data.html"><i class="fa fa-check"></i><b>10</b> Getting temperature data</a>
<ul>
<li class="chapter" data-level="" data-path="get_temp_data.html"><a href="get_temp_data.html#goals_get_temps"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="10.1" data-path="get_temp_data.html"><a href="get_temp_data.html#temperature-data-needs"><i class="fa fa-check"></i><b>10.1</b> Temperature data needs</a></li>
<li class="chapter" data-level="10.2" data-path="get_temp_data.html"><a href="get_temp_data.html#the-global-summary-of-the-day-database"><i class="fa fa-check"></i><b>10.2</b> The Global Summary of the Day database</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="get_temp_data.html"><a href="get_temp_data.html#actionlist_stations"><i class="fa fa-check"></i><b>10.2.1</b> <code>action=list_stations</code></a></li>
<li class="chapter" data-level="10.2.2" data-path="get_temp_data.html"><a href="get_temp_data.html#actiondownload_weather"><i class="fa fa-check"></i><b>10.2.2</b> <code>action="download_weather"</code></a></li>
<li class="chapter" data-level="10.2.3" data-path="get_temp_data.html"><a href="get_temp_data.html#downloaded-weather-as-action-argument"><i class="fa fa-check"></i><b>10.2.3</b> downloaded weather as <code>action</code> argument</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="get_temp_data.html"><a href="get_temp_data.html#exercises_getting"><i class="fa fa-check"></i><code>Exercises</code> on getting temperature data</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html"><i class="fa fa-check"></i><b>11</b> Filling gaps in temperature records</a>
<ul>
<li class="chapter" data-level="" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#goals_gaps"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="11.1" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#gaps"><i class="fa fa-check"></i><b>11.1</b> Gaps</a></li>
<li class="chapter" data-level="11.2" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#filling-short-gaps-in-daily-records"><i class="fa fa-check"></i><b>11.2</b> Filling short gaps in daily records</a></li>
<li class="chapter" data-level="11.3" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#filling-long-gaps-in-daily-records"><i class="fa fa-check"></i><b>11.3</b> Filling long gaps in daily records</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#bias-correction-for-shorter-intervals"><i class="fa fa-check"></i><b>11.3.1</b> Bias-correction for shorter intervals</a></li>
<li class="chapter" data-level="11.3.2" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#saving-the-data-for-later"><i class="fa fa-check"></i><b>11.3.2</b> Saving the data for later</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#filling-gaps-in-hourly-records"><i class="fa fa-check"></i><b>11.4</b> Filling gaps in hourly records</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#accuracy-assessment"><i class="fa fa-check"></i><b>11.4.1</b> Accuracy assessment</a></li>
<li class="chapter" data-level="11.4.2" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#computing-agroclimatic-metrics"><i class="fa fa-check"></i><b>11.4.2</b> Computing agroclimatic metrics</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#exercises_patching"><i class="fa fa-check"></i><code>Exercises</code> on filling gaps</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html"><i class="fa fa-check"></i><b>12</b> Generating temperature scenarios</a>
<ul>
<li class="chapter" data-level="" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html#goals_temperature_scenarios"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="12.1" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html#chill-scenarios"><i class="fa fa-check"></i><b>12.1</b> Chill scenarios</a></li>
<li class="chapter" data-level="12.2" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html#risk-assessment-in-orchard-planning"><i class="fa fa-check"></i><b>12.2</b> Risk assessment in orchard planning</a></li>
<li class="chapter" data-level="12.3" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html#weather-generators"><i class="fa fa-check"></i><b>12.3</b> Weather generators</a></li>
<li class="chapter" data-level="12.4" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html#weather-generation-in-chillr"><i class="fa fa-check"></i><b>12.4</b> Weather generation in <code>chillR</code></a></li>
<li class="chapter" data-level="" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html#weather_generation_exercises"><i class="fa fa-check"></i><code>Exercises</code> on temperature generation</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="saving-and-loading-data-and-hiding-this-in-markdown.html"><a href="saving-and-loading-data-and-hiding-this-in-markdown.html"><i class="fa fa-check"></i><b>13</b> Saving and loading data (and hiding this in markdown)</a>
<ul>
<li class="chapter" data-level="13.1" data-path="saving-and-loading-data-and-hiding-this-in-markdown.html"><a href="saving-and-loading-data-and-hiding-this-in-markdown.html#learning-goals-for-this-lesson-1"><i class="fa fa-check"></i><b>13.1</b> Learning Goals for this lesson:</a></li>
<li class="chapter" data-level="13.2" data-path="saving-and-loading-data-and-hiding-this-in-markdown.html"><a href="saving-and-loading-data-and-hiding-this-in-markdown.html#saving-and-loading-data"><i class="fa fa-check"></i><b>13.2</b> Saving and loading data</a></li>
<li class="chapter" data-level="13.3" data-path="saving-and-loading-data-and-hiding-this-in-markdown.html"><a href="saving-and-loading-data-and-hiding-this-in-markdown.html#hiding-all-this-from-the-readers-of-our-markdown-file"><i class="fa fa-check"></i><b>13.3</b> Hiding all this from the readers of our markdown file</a></li>
<li class="chapter" data-level="" data-path="saving-and-loading-data-and-hiding-this-in-markdown.html"><a href="saving-and-loading-data-and-hiding-this-in-markdown.html#exercises_saveLoad"><i class="fa fa-check"></i><code>Exercises</code> on saving and loading data</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="historic-temperature-scenarios.html"><a href="historic-temperature-scenarios.html"><i class="fa fa-check"></i><b>14</b> Historic temperature scenarios</a>
<ul>
<li class="chapter" data-level="" data-path="historic-temperature-scenarios.html"><a href="historic-temperature-scenarios.html#goals_hist_temp_scen"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="14.1" data-path="historic-temperature-scenarios.html"><a href="historic-temperature-scenarios.html#climate-change-scenarios"><i class="fa fa-check"></i><b>14.1</b> Climate change scenarios</a></li>
<li class="chapter" data-level="14.2" data-path="historic-temperature-scenarios.html"><a href="historic-temperature-scenarios.html#making-historic-temperature-scenarios"><i class="fa fa-check"></i><b>14.2</b> Making historic temperature scenarios</a></li>
<li class="chapter" data-level="" data-path="historic-temperature-scenarios.html"><a href="historic-temperature-scenarios.html#exercises_historic_scenarios"><i class="fa fa-check"></i><code>Exercises</code> on generating historic temperature scenarios</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="future-temperature-scenarios.html"><a href="future-temperature-scenarios.html"><i class="fa fa-check"></i><b>15</b> Future temperature scenarios</a>
<ul>
<li class="chapter" data-level="" data-path="future-temperature-scenarios.html"><a href="future-temperature-scenarios.html#goals_future_temp_scen"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="15.1" data-path="future-temperature-scenarios.html"><a href="future-temperature-scenarios.html#impacts-of-future-climate-change"><i class="fa fa-check"></i><b>15.1</b> Impacts of future climate change</a></li>
<li class="chapter" data-level="15.2" data-path="future-temperature-scenarios.html"><a href="future-temperature-scenarios.html#future-climate-scenarios"><i class="fa fa-check"></i><b>15.2</b> Future climate scenarios</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="future-temperature-scenarios.html"><a href="future-temperature-scenarios.html#some-background-on-climate-models-and-warming-pathways"><i class="fa fa-check"></i><b>15.2.1</b> Some background on climate models and warming pathways</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="future-temperature-scenarios.html"><a href="future-temperature-scenarios.html#exercises_future_scenarios"><i class="fa fa-check"></i><code>Exercises</code> on future temperature scenarios</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html"><i class="fa fa-check"></i><b>16</b> Making CMIP6 scenarios</a>
<ul>
<li class="chapter" data-level="" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html#goals_CMIP6"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="16.1" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html#accessing-gridded-climate-data-from-the-copernicus-climate-data-store"><i class="fa fa-check"></i><b>16.1</b> Accessing gridded climate data from the Copernicus climate data store</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html#downloading-future-climate-data"><i class="fa fa-check"></i><b>16.1.1</b> Downloading future climate data</a></li>
<li class="chapter" data-level="16.1.2" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html#generating-change-scenarios"><i class="fa fa-check"></i><b>16.1.2</b> Generating change scenarios</a></li>
<li class="chapter" data-level="16.1.3" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html#extracting-data-from-the-grids"><i class="fa fa-check"></i><b>16.1.3</b> Extracting data from the grids</a></li>
<li class="chapter" data-level="16.1.4" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html#baseline-adjustment"><i class="fa fa-check"></i><b>16.1.4</b> Baseline adjustment</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="making-cmip6-scenarios.html"><a href="making-cmip6-scenarios.html#exercises_CMIP6"><i class="fa fa-check"></i><code>Exercises</code> on generating CMIP6 temperature scenarios</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="making-cmip5-scenarios-with-the-climatewizard.html"><a href="making-cmip5-scenarios-with-the-climatewizard.html"><i class="fa fa-check"></i><b>17</b> Making CMIP5 scenarios with the <code>ClimateWizard</code></a>
<ul>
<li class="chapter" data-level="" data-path="making-cmip5-scenarios-with-the-climatewizard.html"><a href="making-cmip5-scenarios-with-the-climatewizard.html#goals_ClimateWizard"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="17.1" data-path="making-cmip5-scenarios-with-the-climatewizard.html"><a href="making-cmip5-scenarios-with-the-climatewizard.html#using-the-climatewizard"><i class="fa fa-check"></i><b>17.1</b> Using the <code>ClimateWizard</code></a></li>
<li class="chapter" data-level="" data-path="making-cmip5-scenarios-with-the-climatewizard.html"><a href="making-cmip5-scenarios-with-the-climatewizard.html#exercises_ClimateWizard"><i class="fa fa-check"></i><code>Exercises</code> on generating CMIP5 temperature scenarios</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="plot_future.html"><a href="plot_future.html"><i class="fa fa-check"></i><b>18</b> Plotting future scenarios</a>
<ul>
<li class="chapter" data-level="" data-path="plot_future.html"><a href="plot_future.html#goals_future_plots"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="18.1" data-path="plot_future.html"><a href="plot_future.html#making-attractive-plots"><i class="fa fa-check"></i><b>18.1</b> Making attractive plots</a></li>
<li class="chapter" data-level="18.2" data-path="plot_future.html"><a href="plot_future.html#the-results"><i class="fa fa-check"></i><b>18.2</b> The results</a></li>
<li class="chapter" data-level="" data-path="plot_future.html"><a href="plot_future.html#exercises_future_plots"><i class="fa fa-check"></i><code>Exercises</code> on plotting future projections</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="chill_model_comparison.html"><a href="chill_model_comparison.html"><i class="fa fa-check"></i><b>19</b> Chill model comparison</a>
<ul>
<li class="chapter" data-level="" data-path="chill_model_comparison.html"><a href="chill_model_comparison.html#goals_chill_model"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="19.1" data-path="chill_model_comparison.html"><a href="chill_model_comparison.html#safe-winter-chill"><i class="fa fa-check"></i><b>19.1</b> Safe Winter Chill</a></li>
<li class="chapter" data-level="19.2" data-path="chill_model_comparison.html"><a href="chill_model_comparison.html#chill-metrics"><i class="fa fa-check"></i><b>19.2</b> Chill metrics</a></li>
<li class="chapter" data-level="19.3" data-path="chill_model_comparison.html"><a href="chill_model_comparison.html#an-animated-plot-of-relative-changes-in-safe-winter-chill"><i class="fa fa-check"></i><b>19.3</b> An animated plot of relative changes in Safe Winter Chill</a></li>
<li class="chapter" data-level="" data-path="chill_model_comparison.html"><a href="chill_model_comparison.html#exercises_chill_model_comparison"><i class="fa fa-check"></i><code>Exercises</code> on chill model comparison</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="simple_phenology.html"><a href="simple_phenology.html"><i class="fa fa-check"></i><b>20</b> Simple phenology analysis</a>
<ul>
<li class="chapter" data-level="" data-path="simple_phenology.html"><a href="simple_phenology.html#goals_simple_phenology"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="20.1" data-path="simple_phenology.html"><a href="simple_phenology.html#phenology-analysis"><i class="fa fa-check"></i><b>20.1</b> Phenology analysis</a></li>
<li class="chapter" data-level="20.2" data-path="simple_phenology.html"><a href="simple_phenology.html#time-series-analysis"><i class="fa fa-check"></i><b>20.2</b> Time series analysis</a></li>
<li class="chapter" data-level="20.3" data-path="simple_phenology.html"><a href="simple_phenology.html#p-hacking"><i class="fa fa-check"></i><b>20.3</b> p-hacking</a></li>
<li class="chapter" data-level="20.4" data-path="simple_phenology.html"><a href="simple_phenology.html#the-process-that-generates-the-data"><i class="fa fa-check"></i><b>20.4</b> The process that generates the data</a></li>
<li class="chapter" data-level="20.5" data-path="simple_phenology.html"><a href="simple_phenology.html#an-ecological-theory-to-guide-our-analysis"><i class="fa fa-check"></i><b>20.5</b> An ecological theory to guide our analysis</a></li>
<li class="chapter" data-level="20.6" data-path="simple_phenology.html"><a href="simple_phenology.html#temperature-correlations"><i class="fa fa-check"></i><b>20.6</b> Temperature correlations</a></li>
<li class="chapter" data-level="" data-path="simple_phenology.html"><a href="simple_phenology.html#exercises_simple_analysis"><i class="fa fa-check"></i><code>Exercises</code> on simple phenology analysis</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="pls_intro.html"><a href="pls_intro.html"><i class="fa fa-check"></i><b>21</b> Delineating temperature response phases with PLS regression</a>
<ul>
<li class="chapter" data-level="" data-path="pls_intro.html"><a href="pls_intro.html#goals_PLS_intro"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="21.1" data-path="pls_intro.html"><a href="pls_intro.html#detecting-temperature-response-phases"><i class="fa fa-check"></i><b>21.1</b> Detecting temperature response phases</a></li>
<li class="chapter" data-level="21.2" data-path="pls_intro.html"><a href="pls_intro.html#finding-signals-in-hyperspectral-remote-sensing-data"><i class="fa fa-check"></i><b>21.2</b> Finding signals in hyperspectral remote sensing data</a></li>
<li class="chapter" data-level="21.3" data-path="pls_intro.html"><a href="pls_intro.html#pls-regression-for-phenology-analysis"><i class="fa fa-check"></i><b>21.3</b> PLS regression for phenology analysis</a></li>
<li class="chapter" data-level="21.4" data-path="pls_intro.html"><a href="pls_intro.html#a-note-of-caution-about-pls-results"><i class="fa fa-check"></i><b>21.4</b> A note of caution about PLS results</a></li>
<li class="chapter" data-level="21.5" data-path="pls_intro.html"><a href="pls_intro.html#pls-analysis-of-alexander-lucas-pears-in-klein-altendorf"><i class="fa fa-check"></i><b>21.5</b> PLS analysis of ‘Alexander Lucas’ pears in Klein-Altendorf</a></li>
<li class="chapter" data-level="" data-path="pls_intro.html"><a href="pls_intro.html#exercises_first_PLS"><i class="fa fa-check"></i><code>Exercises</code> on chill model comparison</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="pls_reflection.html"><a href="pls_reflection.html"><i class="fa fa-check"></i><b>22</b> Successes and limitations of PLS regression analysis</a>
<ul>
<li class="chapter" data-level="" data-path="pls_reflection.html"><a href="pls_reflection.html#goals_PLS_reflection"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="22.1" data-path="pls_reflection.html"><a href="pls_reflection.html#pls-regression"><i class="fa fa-check"></i><b>22.1</b> PLS regression</a></li>
<li class="chapter" data-level="22.2" data-path="pls_reflection.html"><a href="pls_reflection.html#pls-examples"><i class="fa fa-check"></i><b>22.2</b> PLS examples</a>
<ul>
<li class="chapter" data-level="22.2.1" data-path="pls_reflection.html"><a href="pls_reflection.html#grasslands-on-the-tibetan-plateau"><i class="fa fa-check"></i><b>22.2.1</b> Grasslands on the Tibetan Plateau</a></li>
<li class="chapter" data-level="22.2.2" data-path="pls_reflection.html"><a href="pls_reflection.html#deciduous-trees"><i class="fa fa-check"></i><b>22.2.2</b> Deciduous trees</a></li>
<li class="chapter" data-level="22.2.3" data-path="pls_reflection.html"><a href="pls_reflection.html#why-were-not-seeing-the-chilling-phase"><i class="fa fa-check"></i><b>22.2.3</b> Why we’re not seeing the chilling phase</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="pls_reflection.html"><a href="pls_reflection.html#exercises_PLS_reflection"><i class="fa fa-check"></i><code>Exercises</code> on chill model comparison</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="pls_chillforce.html"><a href="pls_chillforce.html"><i class="fa fa-check"></i><b>23</b> PLS regression with agroclimatic metrics</a>
<ul>
<li class="chapter" data-level="" data-path="pls_chillforce.html"><a href="pls_chillforce.html#goals_PLS_chillforce"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="23.1" data-path="pls_chillforce.html"><a href="pls_chillforce.html#adjusting-pls-for-use-with-non-monotonic-relationships"><i class="fa fa-check"></i><b>23.1</b> Adjusting PLS for use with non-monotonic relationships</a></li>
<li class="chapter" data-level="23.2" data-path="pls_chillforce.html"><a href="pls_chillforce.html#pls-analysis-with-chilling-and-forcing-data"><i class="fa fa-check"></i><b>23.2</b> PLS analysis with chilling and forcing data</a></li>
<li class="chapter" data-level="23.3" data-path="pls_chillforce.html"><a href="pls_chillforce.html#delineating-chilling-and-forcing-periods"><i class="fa fa-check"></i><b>23.3</b> Delineating chilling and forcing periods</a></li>
<li class="chapter" data-level="23.4" data-path="pls_chillforce.html"><a href="pls_chillforce.html#ggplotting-the-results"><i class="fa fa-check"></i><b>23.4</b> <code>ggplot</code>ting the results</a></li>
<li class="chapter" data-level="" data-path="pls_chillforce.html"><a href="pls_chillforce.html#exercises_PLS_chill_force"><i class="fa fa-check"></i><code>Exercises</code> on chill model comparison</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html"><i class="fa fa-check"></i><b>24</b> Examples of PLS regression with agroclimatic metrics</a>
<ul>
<li class="chapter" data-level="" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#goals_PLS_chillforce_ex"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="24.1" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#pls-regression-across-species-and-agroclimatic-contexts"><i class="fa fa-check"></i><b>24.1</b> PLS regression across species and agroclimatic contexts</a>
<ul>
<li class="chapter" data-level="24.1.1" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#chestnut-jujube-and-apricot-in-beijing"><i class="fa fa-check"></i><b>24.1.1</b> Chestnut, jujube and apricot in Beijing</a></li>
<li class="chapter" data-level="24.1.2" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#apples-in-shaanxi-province-china"><i class="fa fa-check"></i><b>24.1.2</b> Apples in Shaanxi Province, China</a></li>
<li class="chapter" data-level="24.1.3" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#cherries-in-klein-altendorf"><i class="fa fa-check"></i><b>24.1.3</b> Cherries in Klein-Altendorf</a></li>
<li class="chapter" data-level="24.1.4" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#apricots-in-the-uk"><i class="fa fa-check"></i><b>24.1.4</b> Apricots in the UK</a></li>
<li class="chapter" data-level="24.1.5" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#grapevine-in-croatia"><i class="fa fa-check"></i><b>24.1.5</b> Grapevine in Croatia</a></li>
<li class="chapter" data-level="24.1.6" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#walnuts-in-california"><i class="fa fa-check"></i><b>24.1.6</b> Walnuts in California</a></li>
<li class="chapter" data-level="24.1.7" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#almonds-in-tunisia"><i class="fa fa-check"></i><b>24.1.7</b> Almonds in Tunisia</a></li>
<li class="chapter" data-level="24.1.8" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#pistachios-in-tunisia"><i class="fa fa-check"></i><b>24.1.8</b> Pistachios in Tunisia</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="pls_chillforce_ex.html"><a href="pls_chillforce_ex.html#exercises_PLS_chill_force_ex"><i class="fa fa-check"></i><code>Exercises</code> on examples of PLS regression with agroclimatic metrics</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html"><i class="fa fa-check"></i><b>25</b> Why PLS doesn’t always work</a>
<ul>
<li class="chapter" data-level="" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#goals_PLS_chillforce_reflection"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="25.1" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#disappointing-pls-performance"><i class="fa fa-check"></i><b>25.1</b> Disappointing PLS performance</a></li>
<li class="chapter" data-level="25.2" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#what-pls-regression-can-find"><i class="fa fa-check"></i><b>25.2</b> What PLS regression can find</a></li>
<li class="chapter" data-level="25.3" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#chill-model-sensitivity-vs.-observed-temperature"><i class="fa fa-check"></i><b>25.3</b> Chill model sensitivity vs. observed temperature</a>
<ul>
<li class="chapter" data-level="25.3.1" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#beijing-china"><i class="fa fa-check"></i><b>25.3.1</b> Beijing, China</a></li>
<li class="chapter" data-level="25.3.2" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#klein-altendorf-germany"><i class="fa fa-check"></i><b>25.3.2</b> Klein-Altendorf, Germany</a></li>
<li class="chapter" data-level="25.3.3" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#davis-california"><i class="fa fa-check"></i><b>25.3.3</b> Davis, California</a></li>
<li class="chapter" data-level="25.3.4" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#sfax-tunisia"><i class="fa fa-check"></i><b>25.3.4</b> Sfax, Tunisia</a></li>
</ul></li>
<li class="chapter" data-level="25.4" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#heat-model-sensitivity-vs.-observed-temperature"><i class="fa fa-check"></i><b>25.4</b> Heat model sensitivity vs. observed temperature</a></li>
<li class="chapter" data-level="" data-path="pls_chillforce_reflection.html"><a href="pls_chillforce_reflection.html#exercises_PLS_chillforce_reflection"><i class="fa fa-check"></i><code>Exercises</code> on expected PLS responsiveness</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="pls_eval_PLS.html"><a href="pls_eval_PLS.html"><i class="fa fa-check"></i><b>26</b> Evaluating PLS outputs</a>
<ul>
<li class="chapter" data-level="" data-path="pls_eval_PLS.html"><a href="pls_eval_PLS.html#goals_PLS_eval"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="26.1" data-path="pls_eval_PLS.html"><a href="pls_eval_PLS.html#chilling-and-forcing-requirements"><i class="fa fa-check"></i><b>26.1</b> Chilling and forcing requirements</a></li>
<li class="chapter" data-level="26.2" data-path="pls_eval_PLS.html"><a href="pls_eval_PLS.html#response-to-seasonal-temperature"><i class="fa fa-check"></i><b>26.2</b> Response to seasonal temperature</a></li>
<li class="chapter" data-level="26.3" data-path="pls_eval_PLS.html"><a href="pls_eval_PLS.html#applying-our-functions-to-california-walnuts"><i class="fa fa-check"></i><b>26.3</b> Applying our functions to California walnuts</a></li>
<li class="chapter" data-level="" data-path="pls_eval_PLS.html"><a href="pls_eval_PLS.html#exercises_PLS_eval"><i class="fa fa-check"></i><code>Exercises</code> on evaluating PLS regression results</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="pls_chillforce_relimp.html"><a href="pls_chillforce_relimp.html"><i class="fa fa-check"></i><b>27</b> The relative importance of chill and heat</a>
<ul>
<li class="chapter" data-level="" data-path="pls_chillforce_relimp.html"><a href="pls_chillforce_relimp.html#goals_PLS_chillforce_relimp"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="27.1" data-path="pls_chillforce_relimp.html"><a href="pls_chillforce_relimp.html#chilling-vs.-forcing-temperatures"><i class="fa fa-check"></i><b>27.1</b> Chilling vs. forcing temperatures</a></li>
<li class="chapter" data-level="27.2" data-path="pls_chillforce_relimp.html"><a href="pls_chillforce_relimp.html#patterns-in-temperature-responses"><i class="fa fa-check"></i><b>27.2</b> Patterns in temperature responses</a></li>
<li class="chapter" data-level="27.3" data-path="pls_chillforce_relimp.html"><a href="pls_chillforce_relimp.html#the-warm-end-of-the-spectrum"><i class="fa fa-check"></i><b>27.3</b> The warm end of the spectrum</a></li>
<li class="chapter" data-level="27.4" data-path="pls_chillforce_relimp.html"><a href="pls_chillforce_relimp.html#implications-of-our-hypothesis"><i class="fa fa-check"></i><b>27.4</b> Implications of our hypothesis</a></li>
<li class="chapter" data-level="" data-path="pls_chillforce_relimp.html"><a href="pls_chillforce_relimp.html#exercises_PLS_chillforce_relimp"><i class="fa fa-check"></i><code>Exercises</code> on the relative importance of chill and heat</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="exp_PLS.html"><a href="exp_PLS.html"><i class="fa fa-check"></i><b>28</b> Experimentally enhanced PLS</a>
<ul>
<li class="chapter" data-level="" data-path="exp_PLS.html"><a href="exp_PLS.html#goals_exp_PLS"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="28.1" data-path="exp_PLS.html"><a href="exp_PLS.html#enhanced-phenology-data"><i class="fa fa-check"></i><b>28.1</b> Enhanced phenology data</a></li>
<li class="chapter" data-level="" data-path="exp_PLS.html"><a href="exp_PLS.html#exc_exp_PLS"><i class="fa fa-check"></i><code>Exercises</code> on experimental PLS</a></li>
</ul></li>
<li class="chapter" data-level="29" data-path="model_validity.html"><a href="model_validity.html"><i class="fa fa-check"></i><b>29</b> Making valid tree phenology models</a>
<ul>
<li class="chapter" data-level="" data-path="model_validity.html"><a href="model_validity.html#goals_model_validity"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="29.1" data-path="model_validity.html"><a href="model_validity.html#the-modeling-challenge"><i class="fa fa-check"></i><b>29.1</b> The modeling challenge</a></li>
<li class="chapter" data-level="29.2" data-path="model_validity.html"><a href="model_validity.html#validating-models"><i class="fa fa-check"></i><b>29.2</b> Validating models</a></li>
<li class="chapter" data-level="29.3" data-path="model_validity.html"><a href="model_validity.html#mapping-validity-domains"><i class="fa fa-check"></i><b>29.3</b> Mapping validity domains</a></li>
<li class="chapter" data-level="29.4" data-path="model_validity.html"><a href="model_validity.html#one-last-thought-on-model-validity"><i class="fa fa-check"></i><b>29.4</b> One last thought on model validity</a></li>
<li class="chapter" data-level="" data-path="model_validity.html"><a href="model_validity.html#ex_model_validity"><i class="fa fa-check"></i><code>Exercises</code> on making valid tree phenology models</a></li>
</ul></li>
<li class="chapter" data-level="30" data-path="phenoflex.html"><a href="phenoflex.html"><i class="fa fa-check"></i><b>30</b> The <code>PhenoFlex</code> model</a>
<ul>
<li class="chapter" data-level="" data-path="phenoflex.html"><a href="phenoflex.html#goals_phenoflex"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="30.1" data-path="phenoflex.html"><a href="phenoflex.html#ingredients-of-this-lesson"><i class="fa fa-check"></i><b>30.1</b> Ingredients of this lesson</a></li>
<li class="chapter" data-level="30.2" data-path="phenoflex.html"><a href="phenoflex.html#towards-credible-phenology-models"><i class="fa fa-check"></i><b>30.2</b> Towards credible phenology models</a></li>
<li class="chapter" data-level="30.3" data-path="phenoflex.html"><a href="phenoflex.html#the-phenoflex-framework"><i class="fa fa-check"></i><b>30.3</b> The PhenoFlex framework</a></li>
<li class="chapter" data-level="30.4" data-path="phenoflex.html"><a href="phenoflex.html#running-phenoflex"><i class="fa fa-check"></i><b>30.4</b> Running <code>PhenoFlex</code></a></li>
<li class="chapter" data-level="30.5" data-path="phenoflex.html"><a href="phenoflex.html#parameterizing-phenoflex"><i class="fa fa-check"></i><b>30.5</b> Parameterizing <code>PhenoFlex</code></a></li>
<li class="chapter" data-level="30.6" data-path="phenoflex.html"><a href="phenoflex.html#conclusions-on-phenoflex"><i class="fa fa-check"></i><b>30.6</b> Conclusions on <code>PhenoFlex</code></a></li>
<li class="chapter" data-level="" data-path="phenoflex.html"><a href="phenoflex.html#ex_model_phenoflex"><i class="fa fa-check"></i><code>Exercises</code> on the <code>PhenoFlex</code> model</a></li>
</ul></li>
<li class="chapter" data-level="31" data-path="phenoflex2.html"><a href="phenoflex2.html"><i class="fa fa-check"></i><b>31</b> The <code>PhenoFlex</code> model - a second look</a>
<ul>
<li class="chapter" data-level="" data-path="phenoflex2.html"><a href="phenoflex2.html#goals_phenoflex2"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="31.1" data-path="phenoflex2.html"><a href="phenoflex2.html#some-basic-diagnostics-for-our-phenoflex-fit"><i class="fa fa-check"></i><b>31.1</b> Some basic diagnostics for our <code>PhenoFlex</code> fit</a></li>
<li class="chapter" data-level="31.2" data-path="phenoflex2.html"><a href="phenoflex2.html#temperature-response-of-the-phenoflex-components"><i class="fa fa-check"></i><b>31.2</b> Temperature response of the <code>PhenoFlex</code> components</a></li>
<li class="chapter" data-level="31.3" data-path="phenoflex2.html"><a href="phenoflex2.html#overall-impression"><i class="fa fa-check"></i><b>31.3</b> Overall impression</a></li>
<li class="chapter" data-level="31.4" data-path="phenoflex2.html"><a href="phenoflex2.html#caveats-and-assumptions"><i class="fa fa-check"></i><b>31.4</b> Caveats and assumptions</a></li>
<li class="chapter" data-level="31.5" data-path="phenoflex2.html"><a href="phenoflex2.html#outlook"><i class="fa fa-check"></i><b>31.5</b> Outlook</a></li>
<li class="chapter" data-level="" data-path="phenoflex2.html"><a href="phenoflex2.html#ex_phenoflex2"><i class="fa fa-check"></i><code>Exercises</code> on basic <code>PhenoFlex</code> diagnostics</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="phenoflex3.html"><a href="phenoflex3.html"><i class="fa fa-check"></i><b>32</b> Can we improve the performance of <code>PhenoFlex</code>?</a>
<ul>
<li class="chapter" data-level="" data-path="phenoflex3.html"><a href="phenoflex3.html#goals_phenoflex3"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="32.1" data-path="phenoflex3.html"><a href="phenoflex3.html#the-motivation"><i class="fa fa-check"></i><b>32.1</b> The motivation</a></li>
<li class="chapter" data-level="32.2" data-path="phenoflex3.html"><a href="phenoflex3.html#using-experimental-phenology-data-for-assessing-the-performance-of-phenoflex"><i class="fa fa-check"></i><b>32.2</b> Using experimental phenology data for assessing the performance of <code>PhenoFlex</code></a></li>
<li class="chapter" data-level="32.3" data-path="phenoflex3.html"><a href="phenoflex3.html#validation"><i class="fa fa-check"></i><b>32.3</b> Validation</a></li>
<li class="chapter" data-level="32.4" data-path="phenoflex3.html"><a href="phenoflex3.html#conclusions"><i class="fa fa-check"></i><b>32.4</b> Conclusions</a></li>
<li class="chapter" data-level="" data-path="phenoflex3.html"><a href="phenoflex3.html#ex_phenoflex3"><i class="fa fa-check"></i><code>Exercises</code> on improving the performance of <code>PhenoFlex</code></a></li>
</ul></li>
<li class="chapter" data-level="33" data-path="frost-risk-analysis.html"><a href="frost-risk-analysis.html"><i class="fa fa-check"></i><b>33</b> Frost risk analysis</a>
<ul>
<li class="chapter" data-level="" data-path="frost-risk-analysis.html"><a href="frost-risk-analysis.html#goals_frost_risk"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="33.1" data-path="frost-risk-analysis.html"><a href="frost-risk-analysis.html#spring-frost"><i class="fa fa-check"></i><b>33.1</b> Spring frost</a></li>
<li class="chapter" data-level="33.2" data-path="frost-risk-analysis.html"><a href="frost-risk-analysis.html#phenology-trend-analysis"><i class="fa fa-check"></i><b>33.2</b> Phenology trend analysis</a></li>
<li class="chapter" data-level="33.3" data-path="frost-risk-analysis.html"><a href="frost-risk-analysis.html#frost-risk"><i class="fa fa-check"></i><b>33.3</b> Frost risk</a></li>
<li class="chapter" data-level="" data-path="frost-risk-analysis.html"><a href="frost-risk-analysis.html#exercises_frost_risk"><i class="fa fa-check"></i><code>Exercises</code> on frost risk analysis</a></li>
</ul></li>
<li class="chapter" data-level="34" data-path="a-robust-method-to-estimate-future-frost-risks.html"><a href="a-robust-method-to-estimate-future-frost-risks.html"><i class="fa fa-check"></i><b>34</b> A robust method to estimate future frost risks (?)</a>
<ul>
<li class="chapter" data-level="" data-path="a-robust-method-to-estimate-future-frost-risks.html"><a href="a-robust-method-to-estimate-future-frost-risks.html#goals_future_frost_risk"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="34.1" data-path="a-robust-method-to-estimate-future-frost-risks.html"><a href="a-robust-method-to-estimate-future-frost-risks.html#frost-risk-for-future-scenarios"><i class="fa fa-check"></i><b>34.1</b> Frost risk for future scenarios</a></li>
<li class="chapter" data-level="34.2" data-path="a-robust-method-to-estimate-future-frost-risks.html"><a href="a-robust-method-to-estimate-future-frost-risks.html#validation-1"><i class="fa fa-check"></i><b>34.2</b> Validation</a></li>
<li class="chapter" data-level="34.3" data-path="a-robust-method-to-estimate-future-frost-risks.html"><a href="a-robust-method-to-estimate-future-frost-risks.html#exercises-for-this-chapter"><i class="fa fa-check"></i><b>34.3</b> <code>Exercises</code> for this chapter</a></li>
</ul></li>
<li class="chapter" data-level="35" data-path="major_concepts.html"><a href="major_concepts.html"><i class="fa fa-check"></i><b>35</b> Major concepts</a>
<ul>
<li class="chapter" data-level="" data-path="major_concepts.html"><a href="major_concepts.html#goals_major_concepts"><i class="fa fa-check"></i>Learning goals for this lesson</a></li>
<li class="chapter" data-level="35.1" data-path="major_concepts.html"><a href="major_concepts.html#key-insights"><i class="fa fa-check"></i><b>35.1</b> Key insights</a>
<ul>
<li class="chapter" data-level="35.1.1" data-path="major_concepts.html"><a href="major_concepts.html#tree-dormancy-1"><i class="fa fa-check"></i><b>35.1.1</b> Tree dormancy</a></li>
<li class="chapter" data-level="35.1.2" data-path="major_concepts.html"><a href="major_concepts.html#climate-change"><i class="fa fa-check"></i><b>35.1.2</b> Climate change</a></li>
<li class="chapter" data-level="35.1.3" data-path="major_concepts.html"><a href="major_concepts.html#phenology-modeling"><i class="fa fa-check"></i><b>35.1.3</b> Phenology modeling</a></li>
<li class="chapter" data-level="35.1.4" data-path="major_concepts.html"><a href="major_concepts.html#phenology-responses-to-global-warming"><i class="fa fa-check"></i><b>35.1.4</b> Phenology responses to global warming</a></li>
<li class="chapter" data-level="35.1.5" data-path="major_concepts.html"><a href="major_concepts.html#the-phenoflex-modeling-framework"><i class="fa fa-check"></i><b>35.1.5</b> The <code>PhenoFlex</code> modeling framework</a></li>
</ul></li>
<li class="chapter" data-level="35.2" data-path="major_concepts.html"><a href="major_concepts.html#major-concepts-weve-encountered"><i class="fa fa-check"></i><b>35.2</b> Major concepts we’ve encountered</a>
<ul>
<li class="chapter" data-level="35.2.1" data-path="major_concepts.html"><a href="major_concepts.html#reproducibility-and-transparency"><i class="fa fa-check"></i><b>35.2.1</b> Reproducibility and transparency</a></li>
<li class="chapter" data-level="35.2.2" data-path="major_concepts.html"><a href="major_concepts.html#tools"><i class="fa fa-check"></i><b>35.2.2</b> Tools</a></li>
<li class="chapter" data-level="35.2.3" data-path="major_concepts.html"><a href="major_concepts.html#automate-and-move-on"><i class="fa fa-check"></i><b>35.2.3</b> Automate and move on</a></li>
<li class="chapter" data-level="35.2.4" data-path="major_concepts.html"><a href="major_concepts.html#the-power-of-r"><i class="fa fa-check"></i><b>35.2.4</b> The power of R</a></li>
<li class="chapter" data-level="35.2.5" data-path="major_concepts.html"><a href="major_concepts.html#curiosity-and-interdisciplinarity"><i class="fa fa-check"></i><b>35.2.5</b> Curiosity and interdisciplinarity</a></li>
<li class="chapter" data-level="35.2.6" data-path="major_concepts.html"><a href="major_concepts.html#uncertainty"><i class="fa fa-check"></i><b>35.2.6</b> Uncertainty</a></li>
<li class="chapter" data-level="35.2.7" data-path="major_concepts.html"><a href="major_concepts.html#p-hacking-1"><i class="fa fa-check"></i><b>35.2.7</b> p-hacking</a></li>
<li class="chapter" data-level="35.2.8" data-path="major_concepts.html"><a href="major_concepts.html#the-dangers-of-machine-learning"><i class="fa fa-check"></i><b>35.2.8</b> The dangers of machine learning</a></li>
<li class="chapter" data-level="35.2.9" data-path="major_concepts.html"><a href="major_concepts.html#rationalizing"><i class="fa fa-check"></i><b>35.2.9</b> Rationalizing</a></li>
<li class="chapter" data-level="35.2.10" data-path="major_concepts.html"><a href="major_concepts.html#overfitting"><i class="fa fa-check"></i><b>35.2.10</b> Overfitting</a></li>
<li class="chapter" data-level="35.2.11" data-path="major_concepts.html"><a href="major_concepts.html#the-process-that-generated-the-data"><i class="fa fa-check"></i><b>35.2.11</b> The process that generated the data</a></li>
<li class="chapter" data-level="35.2.12" data-path="major_concepts.html"><a href="major_concepts.html#the-importance-of-theory"><i class="fa fa-check"></i><b>35.2.12</b> The importance of theory</a></li>
<li class="chapter" data-level="35.2.13" data-path="major_concepts.html"><a href="major_concepts.html#conceptual-modeling"><i class="fa fa-check"></i><b>35.2.13</b> Conceptual modeling</a></li>
<li class="chapter" data-level="35.2.14" data-path="major_concepts.html"><a href="major_concepts.html#consistency-with-existing-theory-and-prior-knowledge"><i class="fa fa-check"></i><b>35.2.14</b> Consistency with existing theory and prior knowledge</a></li>
<li class="chapter" data-level="35.2.15" data-path="major_concepts.html"><a href="major_concepts.html#model-validity-and-model-validation"><i class="fa fa-check"></i><b>35.2.15</b> Model validity and model validation</a></li>
<li class="chapter" data-level="35.2.16" data-path="major_concepts.html"><a href="major_concepts.html#our-role-in-research"><i class="fa fa-check"></i><b>35.2.16</b> Our role in research</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="major_concepts.html"><a href="major_concepts.html#ex_majorconcepts"><i class="fa fa-check"></i><code>Exercises</code> on major concepts</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="refs.html"><a href="refs.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tree phenology analysis with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="a-robust-method-to-estimate-future-frost-risks" class="section level1 hasAnchor" number="34">
<h1><span class="header-section-number">Chapter 34</span> A robust method to estimate future frost risks (?)<a href="a-robust-method-to-estimate-future-frost-risks.html#a-robust-method-to-estimate-future-frost-risks" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="goals_future_frost_risk" class="section level2 unnumbered hasAnchor">
<h2>Learning goals for this lesson<a href="a-robust-method-to-estimate-future-frost-risks.html#goals_future_frost_risk" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Apply the concepts learned in chapter <a href="model_validity.html#model_validity">Making valid tree phenology models</a></li>
<li>Implement a robust (and hopefully valid) methodology to forecast spring phenology under future scenarios</li>
<li>Assess the risk of frost events under future scenarios</li>
</ul>
</div>
<div id="frost-risk-for-future-scenarios" class="section level2 hasAnchor" number="34.1">
<h2><span class="header-section-number">34.1</span> Frost risk for future scenarios<a href="a-robust-method-to-estimate-future-frost-risks.html#frost-risk-for-future-scenarios" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We have seen in the previous chapter the importance of analyzing the risk of spring frost events in temperate fruit trees for historic periods. However, such analysis provides little information for planning strategies to adapt fruit orchards to potential frost events occurring in the future. What we actually need for supporting farmers in making decisions is an assessment of the probability of experiencing frost events (and ideally also their severity) in the future. Such an assessment should consider the prospective impacts of climate change.</p>
<p>This is not an easy task. On the one hand, spring frosts result from the occurrence of temperatures below the sensitivity threshold of the tree, which varies according to which kind of plant tissue is exposed to the cold. Plants become more sensitive to freezing temperatures as they develop from dormancy to harvest. On the other hand, tree development during and after dormancy is itself driven by temperature, with advancing or delaying effects depending on particular factors such as the species, cultivar and ultimately the place.</p>
<p>In our lab, we therefore believe that conducting a proper frost risk analysis for future scenarios requires i) a robust method for estimating future temperatures, and ii) a valid modeling framework to predict bloom dates in temperate fruit trees. Fortunately, we may be very close to fulfilling these two requirements as we have seen in chapters <a href="future-temperature-scenarios.html#future-temperature-scenarios">Future temperature scenarios</a> and, most recently, <a href="phenoflex.html#phenoflex">The <code>PhenoFlex</code> model</a>.</p>
<p>We will use some content of the chapter <a href="model_validity.html#model_validity">Making valid tree phenology models</a>. As you (hopefully) remember, in that chapter we combined our dataset of past conditions in Campus Klein-Altendorf with the simulated conditions from our <a href="exp_PLS.html#exp_PLS">Experimentally enhanced PLS</a> chapter. We used this to determine to what extent the combined temperature domain of these datasets covers the climatic conditions that are projected for future climate scenarios.</p>
<p>Here’s how we can create such a plot (very similar to what we did before):</p>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb482-1" tabindex="-1"></a><span class="co"># Load all the required packages for this lesson</span></span>
<span id="cb482-2"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb482-2" tabindex="-1"></a><span class="fu">library</span>(chillR)</span>
<span id="cb482-3"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb482-3" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb482-4"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb482-4" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span></code></pre></div>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-1" tabindex="-1"></a><span class="co"># Import the past weather dataset to build the hull plots for model validity domains</span></span>
<span id="cb483-2"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-2" tabindex="-1"></a><span class="co"># Note: data from 01.01.1958 to 20.06.2019. Not complete season for bloom in 1958 (missing Oct-Dec 1957). Barely passing the threshold for bloom in 2019 (need to set mrange to c(9, 5) in genSeasonList for PhenoFlex calibration)</span></span>
<span id="cb483-3"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-3" tabindex="-1"></a>past_weather <span class="ot">&lt;-</span> <span class="fu">read_tab</span>(<span class="st">&quot;data/TMaxTMin1958-2019_patched.csv&quot;</span>)</span>
<span id="cb483-4"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-4" tabindex="-1"></a></span>
<span id="cb483-5"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-5" tabindex="-1"></a><span class="co"># Add the column SSP_Time for further discrimination with future scenarios</span></span>
<span id="cb483-6"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-6" tabindex="-1"></a>past_weather<span class="sc">$</span>SSP_Time <span class="ot">&lt;-</span> <span class="st">&quot;Past&quot;</span></span>
<span id="cb483-7"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-7" tabindex="-1"></a></span>
<span id="cb483-8"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-8" tabindex="-1"></a><span class="co"># Summarize the data by month. Compute the mean of Tmin and Tmax by RCP_Time, Year, and Month</span></span>
<span id="cb483-9"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-9" tabindex="-1"></a>past_months <span class="ot">&lt;-</span> past_weather <span class="sc">%&gt;%</span></span>
<span id="cb483-10"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-10" tabindex="-1"></a>  <span class="fu">group_by</span>(SSP_Time, Year, Month) <span class="sc">%&gt;%</span></span>
<span id="cb483-11"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-11" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Tmin =</span> <span class="fu">mean</span>(Tmin, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb483-12"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-12" tabindex="-1"></a>            <span class="at">Tmax =</span> <span class="fu">mean</span>(Tmax, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb483-13"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-13" tabindex="-1"></a></span>
<span id="cb483-14"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-14" tabindex="-1"></a></span>
<span id="cb483-15"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-15" tabindex="-1"></a>unstructured_future_temps <span class="ot">&lt;-</span> <span class="fu">load_temperature_scenarios</span>(<span class="st">&quot;data/future_climate&quot;</span>,</span>
<span id="cb483-16"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-16" tabindex="-1"></a>                                                        <span class="st">&quot;Bonn_futuretemps&quot;</span>)</span>
<span id="cb483-17"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-17" tabindex="-1"></a></span>
<span id="cb483-18"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-18" tabindex="-1"></a>future_temps <span class="ot">&lt;-</span></span>
<span id="cb483-19"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-19" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="fu">bind_rows</span>(<span class="fu">lapply</span>(unstructured_future_temps, bind_rows),</span>
<span id="cb483-20"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-20" tabindex="-1"></a>                       <span class="at">.id =</span> <span class="st">&quot;List&quot;</span>))</span>
<span id="cb483-21"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-21" tabindex="-1"></a></span>
<span id="cb483-22"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-22" tabindex="-1"></a>future_temps <span class="ot">&lt;-</span> future_temps <span class="sc">%&gt;%</span></span>
<span id="cb483-23"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-23" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GCM =</span> <span class="fu">strsplit</span>(List, <span class="st">&#39;</span><span class="sc">\\</span><span class="st">.&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb483-24"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-24" tabindex="-1"></a>           <span class="fu">map</span>(<span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb483-25"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-25" tabindex="-1"></a>           <span class="fu">unlist</span>(),</span>
<span id="cb483-26"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-26" tabindex="-1"></a>         <span class="at">SSP =</span> <span class="fu">strsplit</span>(List, <span class="st">&#39;</span><span class="sc">\\</span><span class="st">.&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb483-27"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-27" tabindex="-1"></a>           <span class="fu">map</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb483-28"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-28" tabindex="-1"></a>           <span class="fu">unlist</span>(),</span>
<span id="cb483-29"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-29" tabindex="-1"></a>         <span class="at">Time =</span> <span class="fu">strsplit</span>(List, <span class="st">&#39;</span><span class="sc">\\</span><span class="st">.&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb483-30"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-30" tabindex="-1"></a>           <span class="fu">map</span>(<span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb483-31"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-31" tabindex="-1"></a>           <span class="fu">unlist</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb483-32"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-32" tabindex="-1"></a>  <span class="fu">select</span>(DATE, Year, Month, Day, Tmin, Tmax, SSP, Time, GCM)</span>
<span id="cb483-33"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-33" tabindex="-1"></a></span>
<span id="cb483-34"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-34" tabindex="-1"></a>future_temps[future_temps<span class="sc">$</span>SSP <span class="sc">==</span> <span class="st">&quot;ssp126&quot;</span>,<span class="st">&quot;SSP_Time&quot;</span>] <span class="ot">&lt;-</span></span>
<span id="cb483-35"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-35" tabindex="-1"></a>  <span class="fu">paste</span>(<span class="st">&quot;SSP1&quot;</span>, future_temps[future_temps<span class="sc">$</span>SSP <span class="sc">==</span> <span class="st">&quot;ssp126&quot;</span>,<span class="st">&quot;Time&quot;</span>])</span>
<span id="cb483-36"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-36" tabindex="-1"></a></span>
<span id="cb483-37"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-37" tabindex="-1"></a>future_temps[future_temps<span class="sc">$</span>SSP <span class="sc">==</span> <span class="st">&quot;ssp245&quot;</span>,<span class="st">&quot;SSP_Time&quot;</span>] <span class="ot">&lt;-</span></span>
<span id="cb483-38"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-38" tabindex="-1"></a>  <span class="fu">paste</span>(<span class="st">&quot;SSP2&quot;</span>, future_temps[future_temps<span class="sc">$</span>SSP <span class="sc">==</span> <span class="st">&quot;ssp245&quot;</span>,<span class="st">&quot;Time&quot;</span>])</span>
<span id="cb483-39"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-39" tabindex="-1"></a></span>
<span id="cb483-40"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-40" tabindex="-1"></a>future_temps[future_temps<span class="sc">$</span>SSP <span class="sc">==</span> <span class="st">&quot;ssp370&quot;</span>,<span class="st">&quot;SSP_Time&quot;</span>] <span class="ot">&lt;-</span></span>
<span id="cb483-41"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-41" tabindex="-1"></a>  <span class="fu">paste</span>(<span class="st">&quot;SSP3&quot;</span>, future_temps[future_temps<span class="sc">$</span>SSP <span class="sc">==</span> <span class="st">&quot;ssp370&quot;</span>,<span class="st">&quot;Time&quot;</span>])</span>
<span id="cb483-42"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-42" tabindex="-1"></a></span>
<span id="cb483-43"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-43" tabindex="-1"></a>future_temps[future_temps<span class="sc">$</span>SSP <span class="sc">==</span> <span class="st">&quot;ssp585&quot;</span>,<span class="st">&quot;SSP_Time&quot;</span>] <span class="ot">&lt;-</span></span>
<span id="cb483-44"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-44" tabindex="-1"></a>  <span class="fu">paste</span>(<span class="st">&quot;SSP5&quot;</span>, future_temps[future_temps<span class="sc">$</span>SSP <span class="sc">==</span> <span class="st">&quot;ssp585&quot;</span>,<span class="st">&quot;Time&quot;</span>])</span>
<span id="cb483-45"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-45" tabindex="-1"></a></span>
<span id="cb483-46"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-46" tabindex="-1"></a></span>
<span id="cb483-47"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-47" tabindex="-1"></a><span class="co"># Summarize the data by month. Compute the mean of Tmin and Tmax by RCP_Time, Year, and Month</span></span>
<span id="cb483-48"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-48" tabindex="-1"></a>future_months <span class="ot">&lt;-</span> future_temps <span class="sc">%&gt;%</span></span>
<span id="cb483-49"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-49" tabindex="-1"></a>  <span class="fu">group_by</span>(SSP_Time, Year, Month) <span class="sc">%&gt;%</span></span>
<span id="cb483-50"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-50" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Tmin =</span> <span class="fu">mean</span>(Tmin, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb483-51"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-51" tabindex="-1"></a>            <span class="at">Tmax =</span> <span class="fu">mean</span>(Tmax, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb483-52"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-52" tabindex="-1"></a>  </span>
<span id="cb483-53"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-53" tabindex="-1"></a></span>
<span id="cb483-54"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-54" tabindex="-1"></a><span class="co"># Merge the past and future months to plot them together</span></span>
<span id="cb483-55"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-55" tabindex="-1"></a>all_months <span class="ot">&lt;-</span> <span class="fu">rbind</span>(past_months,</span>
<span id="cb483-56"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-56" tabindex="-1"></a>                    future_months)</span>
<span id="cb483-57"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-57" tabindex="-1"></a></span>
<span id="cb483-58"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-58" tabindex="-1"></a><span class="co"># Add a column for the name of the month </span></span>
<span id="cb483-59"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-59" tabindex="-1"></a>all_months<span class="sc">$</span>month_name <span class="ot">&lt;-</span> <span class="fu">factor</span>(all_months<span class="sc">$</span>Month,</span>
<span id="cb483-60"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-60" tabindex="-1"></a>                                <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">6</span> <span class="sc">:</span> <span class="dv">12</span>, <span class="dv">1</span> <span class="sc">:</span> <span class="dv">5</span>), </span>
<span id="cb483-61"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-61" tabindex="-1"></a>                                <span class="at">labels =</span> month.name[<span class="fu">c</span>(<span class="dv">6</span> <span class="sc">:</span> <span class="dv">12</span>, <span class="dv">1</span> <span class="sc">:</span> <span class="dv">5</span>)])</span>
<span id="cb483-62"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-62" tabindex="-1"></a></span>
<span id="cb483-63"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-63" tabindex="-1"></a><span class="co"># Calculate the hulls for each group</span></span>
<span id="cb483-64"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-64" tabindex="-1"></a>hull_temps <span class="ot">&lt;-</span> all_months <span class="sc">%&gt;%</span> </span>
<span id="cb483-65"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-65" tabindex="-1"></a>  <span class="fu">group_by</span>(SSP_Time, month_name) <span class="sc">%&gt;%</span></span>
<span id="cb483-66"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-66" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="fu">chull</span>(Tmin, Tmax))</span>
<span id="cb483-67"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-67" tabindex="-1"></a></span>
<span id="cb483-68"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-68" tabindex="-1"></a><span class="co"># Load the weather data from the experimental seasons to generate an &quot;Enhanced&quot; temps category</span></span>
<span id="cb483-69"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-69" tabindex="-1"></a>enhanced <span class="ot">&lt;-</span> <span class="fu">read_tab</span>(<span class="st">&quot;data/final_weather_data_S1_S2_pear_hourly.csv&quot;</span>)</span>
<span id="cb483-70"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-70" tabindex="-1"></a></span>
<span id="cb483-71"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-71" tabindex="-1"></a><span class="co"># Summarize the data. Compute the minimum and maximum records in a daily basis</span></span>
<span id="cb483-72"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-72" tabindex="-1"></a>enhanced <span class="ot">&lt;-</span> enhanced <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEARMODA, Treatment, Year, Month ) <span class="sc">%&gt;%</span> </span>
<span id="cb483-73"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-73" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Tmin =</span> <span class="fu">min</span>(Temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb483-74"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-74" tabindex="-1"></a>            <span class="at">Tmax =</span> <span class="fu">max</span>(Temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb483-75"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-75" tabindex="-1"></a></span>
<span id="cb483-76"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-76" tabindex="-1"></a><span class="co"># Summarize the data by month now. Compute mean across minimum and maximum records</span></span>
<span id="cb483-77"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-77" tabindex="-1"></a>enhanced <span class="ot">&lt;-</span> enhanced <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Treatment, Month) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">Tmin =</span> <span class="fu">mean</span>(Tmin),</span>
<span id="cb483-78"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-78" tabindex="-1"></a>                                                                  <span class="at">Tmax =</span> <span class="fu">mean</span>(Tmax))</span>
<span id="cb483-79"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-79" tabindex="-1"></a></span>
<span id="cb483-80"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-80" tabindex="-1"></a><span class="co"># Re-format the column Year and add the column RCP_Time</span></span>
<span id="cb483-81"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-81" tabindex="-1"></a>enhanced<span class="sc">$</span>Year <span class="ot">&lt;-</span> enhanced<span class="sc">$</span>Treatment</span>
<span id="cb483-82"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-82" tabindex="-1"></a>enhanced<span class="sc">$</span>SSP_Time <span class="ot">&lt;-</span> <span class="st">&quot;Past_enhanced&quot;</span></span>
<span id="cb483-83"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-83" tabindex="-1"></a></span>
<span id="cb483-84"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-84" tabindex="-1"></a><span class="co"># Combining the past and the enhanced temps</span></span>
<span id="cb483-85"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-85" tabindex="-1"></a>past_months<span class="sc">$</span>SSP_Time <span class="ot">&lt;-</span> <span class="st">&quot;Past combined&quot;</span></span>
<span id="cb483-86"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-86" tabindex="-1"></a>enhanced<span class="sc">$</span>SSP_Time <span class="ot">&lt;-</span> <span class="st">&quot;Past combined&quot;</span></span>
<span id="cb483-87"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-87" tabindex="-1"></a></span>
<span id="cb483-88"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-88" tabindex="-1"></a><span class="co"># Merge all the data. Simulated scenarios, observed scenarios, and enhanced temps</span></span>
<span id="cb483-89"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-89" tabindex="-1"></a>all_months_both <span class="ot">&lt;-</span> <span class="fu">rbind</span>(enhanced, past_months, future_months)</span>
<span id="cb483-90"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-90" tabindex="-1"></a></span>
<span id="cb483-91"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-91" tabindex="-1"></a><span class="co"># Add the labels for the month no</span></span>
<span id="cb483-92"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-92" tabindex="-1"></a>all_months_both<span class="sc">$</span>month_name <span class="ot">&lt;-</span> <span class="fu">factor</span>(all_months_both<span class="sc">$</span>Month, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">6</span> <span class="sc">:</span> <span class="dv">12</span>, <span class="dv">1</span> <span class="sc">:</span> <span class="dv">5</span>), <span class="at">labels =</span> month.name[<span class="fu">c</span>(<span class="dv">6</span> <span class="sc">:</span> <span class="dv">12</span>, <span class="dv">1</span> <span class="sc">:</span> <span class="dv">5</span>)])</span>
<span id="cb483-93"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-93" tabindex="-1"></a></span>
<span id="cb483-94"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-94" tabindex="-1"></a><span class="co"># Create the hull</span></span>
<span id="cb483-95"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-95" tabindex="-1"></a>hull_temps_both <span class="ot">&lt;-</span> all_months_both <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(SSP_Time, month_name) <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="fu">chull</span>(Tmin, Tmax))</span>
<span id="cb483-96"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-96" tabindex="-1"></a></span>
<span id="cb483-97"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-97" tabindex="-1"></a><span class="co"># Remove the temperature for the treatments excluded from the analysis. These treatments may be a bit unrealistic and therefore</span></span>
<span id="cb483-98"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-98" tabindex="-1"></a><span class="co"># difficult to be explained by the model</span></span>
<span id="cb483-99"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-99" tabindex="-1"></a>all_months_both_conference <span class="ot">&lt;-</span> <span class="fu">filter</span>(all_months_both, <span class="sc">!</span>(Year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">14</span>, <span class="dv">15</span>, <span class="dv">19</span>,</span>
<span id="cb483-100"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-100" tabindex="-1"></a>                                                                    <span class="dv">23</span>, <span class="dv">25</span>, <span class="dv">26</span>, <span class="dv">27</span>, <span class="dv">28</span>, <span class="dv">29</span>, <span class="dv">32</span>)))</span>
<span id="cb483-101"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-101" tabindex="-1"></a><span class="co"># Create the hull again</span></span>
<span id="cb483-102"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-102" tabindex="-1"></a>hull_temps_both_conference <span class="ot">&lt;-</span> all_months_both_conference <span class="sc">%&gt;%</span></span>
<span id="cb483-103"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-103" tabindex="-1"></a>  <span class="fu">group_by</span>(SSP_Time,month_name) <span class="sc">%&gt;%</span></span>
<span id="cb483-104"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-104" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="fu">chull</span>(Tmin, Tmax))</span>
<span id="cb483-105"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-105" tabindex="-1"></a></span>
<span id="cb483-106"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-106" tabindex="-1"></a><span class="fu">write.csv</span>(hull_temps_both,<span class="st">&quot;data/hull_temps_both.csv&quot;</span>,<span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb483-107"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb483-107" tabindex="-1"></a><span class="fu">write.csv</span>(hull_temps_both_conference, <span class="st">&quot;data/hull_temps_both_conference.csv&quot;</span>,<span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb484-1" tabindex="-1"></a>hull_temps_both <span class="ot">&lt;-</span> <span class="fu">read_tab</span>(<span class="st">&quot;data/hull_temps_both.csv&quot;</span>)</span>
<span id="cb484-2"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb484-2" tabindex="-1"></a></span>
<span id="cb484-3"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb484-3" tabindex="-1"></a><span class="co"># Implement the plot showing the overlap among conditions</span></span>
<span id="cb484-4"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb484-4" tabindex="-1"></a><span class="fu">ggplot</span>(hull_temps_both[<span class="fu">which</span>(hull_temps_both<span class="sc">$</span>Month <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)),],</span>
<span id="cb484-5"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb484-5" tabindex="-1"></a>       <span class="fu">aes</span>(Tmin, Tmax, <span class="at">fill =</span> <span class="fu">factor</span>(SSP_Time))) <span class="sc">+</span></span>
<span id="cb484-6"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb484-6" tabindex="-1"></a>  <span class="fu">geom_polygon</span>() <span class="sc">+</span></span>
<span id="cb484-7"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb484-7" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(month_name)) <span class="sc">+</span></span>
<span id="cb484-8"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb484-8" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name=</span><span class="st">&quot;Scenario&quot;</span>,</span>
<span id="cb484-9"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb484-9" tabindex="-1"></a>                    <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">&quot;Past combined&quot;</span>,</span>
<span id="cb484-10"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb484-10" tabindex="-1"></a>                             <span class="st">&quot;SSP1 2050&quot;</span>,</span>
<span id="cb484-11"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb484-11" tabindex="-1"></a>                             <span class="st">&quot;SSP1 2085&quot;</span>,</span>
<span id="cb484-12"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb484-12" tabindex="-1"></a>                             <span class="st">&quot;SSP2 2050&quot;</span>,</span>
<span id="cb484-13"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb484-13" tabindex="-1"></a>                             <span class="st">&quot;SSP2 2085&quot;</span>,</span>
<span id="cb484-14"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb484-14" tabindex="-1"></a>                             <span class="st">&quot;SSP3 2050&quot;</span>,</span>
<span id="cb484-15"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb484-15" tabindex="-1"></a>                             <span class="st">&quot;SSP3 2085&quot;</span>,</span>
<span id="cb484-16"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb484-16" tabindex="-1"></a>                             <span class="st">&quot;SSP5 2050&quot;</span>,</span>
<span id="cb484-17"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb484-17" tabindex="-1"></a>                             <span class="st">&quot;SSP5 2085&quot;</span>),</span>
<span id="cb484-18"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb484-18" tabindex="-1"></a>                    <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>,</span>
<span id="cb484-19"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb484-19" tabindex="-1"></a>                             <span class="fu">alpha</span>(<span class="st">&quot;light green&quot;</span>,<span class="fl">0.4</span>),</span>
<span id="cb484-20"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb484-20" tabindex="-1"></a>                             <span class="fu">alpha</span>(<span class="st">&quot;dark green&quot;</span>,<span class="fl">0.4</span>),</span>
<span id="cb484-21"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb484-21" tabindex="-1"></a>                             <span class="fu">alpha</span>(<span class="st">&quot;coral&quot;</span>,<span class="fl">0.4</span>),</span>
<span id="cb484-22"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb484-22" tabindex="-1"></a>                             <span class="fu">alpha</span>(<span class="st">&quot;dark red&quot;</span>,<span class="fl">0.4</span>),</span>
<span id="cb484-23"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb484-23" tabindex="-1"></a>                             <span class="fu">alpha</span>(<span class="st">&quot;yellow&quot;</span>,<span class="fl">0.4</span>),</span>
<span id="cb484-24"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb484-24" tabindex="-1"></a>                             <span class="fu">alpha</span>(<span class="st">&quot;orange&quot;</span>,<span class="fl">0.4</span>),                 </span>
<span id="cb484-25"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb484-25" tabindex="-1"></a>                             <span class="fu">alpha</span>(<span class="st">&quot;light blue&quot;</span>,<span class="fl">0.4</span>),</span>
<span id="cb484-26"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb484-26" tabindex="-1"></a>                             <span class="fu">alpha</span>(<span class="st">&quot;dark blue&quot;</span>,<span class="fl">0.4</span>))) <span class="sc">+</span></span>
<span id="cb484-27"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb484-27" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Mean daily minimum temperature (°C)&quot;</span>) <span class="sc">+</span></span>
<span id="cb484-28"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb484-28" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Mean daily maximum temperature (°C)&quot;</span>) <span class="sc">+</span></span>
<span id="cb484-29"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb484-29" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>)</span></code></pre></div>
<p><img src="Book_files/figure-html/plot_model_validity-1.png" width="672" /></p>
<p>This <em>convex-hull</em> plot is showing the coverage considering temperatures in CKA between 1958 and 2019 as well as all experimental seasons analyzed in chapter <a href="exp_PLS.html#exp_PLS">Experimentally enhanced PLS</a>. To make the phenology modelling approach work with historic and experimental data, we would need to use phenology records from the same species and cultivar (pear cultivar ‘Conference’). Fortunately, we do have historic records for full bloom for this cultivar between 1958 and 2019. However, we may want to subset the experimental data used for the <em>convex-hull</em> plot to only retain seasons that were more or less normal. This is to reduce the misleading effects we may have introduced by using extremely warm treatments.</p>
<p>So let’s draw a new <em>convex-hull</em> plot without these unusually warm seasons.</p>
<p><img src="Book_files/figure-html/plot_conference_subset-1.png" width="672" /></p>
<p>This is not a perfect coverage of course but we don’t have more data (for now) for October and November. There is little we can do to fill the coverage gap as we did not include warmer conditions in our experiments during these months.</p>
<p><em>We will proceed with these data hoping that in the near future we are able to identify ‘normal seasons’ in the experimental dataset that help us to improve our modelling validity domain.</em></p>
<p>We can now implement our dormancy modelling framework <code>PhenoFlex</code> by combining historic and experimental records. In this code chunk, we will import and format the data so we can calibrate the model using these records.</p>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-1" tabindex="-1"></a><span class="co"># Import the phenology data for the historic period 1958-2019</span></span>
<span id="cb485-2"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-2" tabindex="-1"></a><span class="co"># Note that we are selecting only the Year and full bloom columns</span></span>
<span id="cb485-3"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-3" tabindex="-1"></a>historic_pheno_conference <span class="ot">&lt;-</span> </span>
<span id="cb485-4"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-4" tabindex="-1"></a>  <span class="fu">read_tab</span>(<span class="st">&quot;data/Pheno_pear_conference_1958_2019.csv&quot;</span>)[<span class="fu">c</span>(<span class="st">&quot;Year&quot;</span>,</span>
<span id="cb485-5"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-5" tabindex="-1"></a>                                         <span class="st">&quot;Full_bloom&quot;</span>)]</span>
<span id="cb485-6"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-6" tabindex="-1"></a></span>
<span id="cb485-7"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-7" tabindex="-1"></a><span class="co"># Remove missing years</span></span>
<span id="cb485-8"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-8" tabindex="-1"></a>historic_pheno_conference <span class="ot">&lt;-</span> </span>
<span id="cb485-9"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-9" tabindex="-1"></a>  historic_pheno_conference[<span class="fu">which</span>(<span class="sc">!</span>historic_pheno_conference<span class="sc">$</span>Full_bloom<span class="sc">==</span><span class="st">&quot;&quot;</span>),]</span>
<span id="cb485-10"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-10" tabindex="-1"></a></span>
<span id="cb485-11"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-11" tabindex="-1"></a><span class="co"># Add a column for the JDay</span></span>
<span id="cb485-12"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-12" tabindex="-1"></a>historic_pheno_conference<span class="sc">$</span>Full_bloom <span class="ot">&lt;-</span> </span>
<span id="cb485-13"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-13" tabindex="-1"></a>  dormancyR<span class="sc">::</span><span class="fu">date_to_JDay</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(historic_pheno_conference<span class="sc">$</span>Full_bloom,</span>
<span id="cb485-14"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-14" tabindex="-1"></a>                                         <span class="at">format =</span> <span class="st">&quot;%d.%m.%Y&quot;</span>),</span>
<span id="cb485-15"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-15" tabindex="-1"></a>                          <span class="at">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>)</span>
<span id="cb485-16"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-16" tabindex="-1"></a></span>
<span id="cb485-17"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-17" tabindex="-1"></a><span class="co"># Rename the columns</span></span>
<span id="cb485-18"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-18" tabindex="-1"></a><span class="fu">colnames</span>(historic_pheno_conference) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Year&quot;</span>, <span class="st">&quot;pheno&quot;</span>)</span>
<span id="cb485-19"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-19" tabindex="-1"></a></span>
<span id="cb485-20"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-20" tabindex="-1"></a><span class="co"># Do the same for the weather data</span></span>
<span id="cb485-21"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-21" tabindex="-1"></a>past_weather <span class="ot">&lt;-</span> <span class="fu">read_tab</span>(<span class="st">&quot;data/TMaxTMin1958-2019_patched.csv&quot;</span>)</span>
<span id="cb485-22"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-22" tabindex="-1"></a></span>
<span id="cb485-23"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-23" tabindex="-1"></a><span class="co"># Create hourly temps for compatibility with the experimental data set</span></span>
<span id="cb485-24"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-24" tabindex="-1"></a>past_weather <span class="ot">&lt;-</span> <span class="fu">stack_hourly_temps</span>(<span class="at">weather =</span> past_weather, </span>
<span id="cb485-25"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-25" tabindex="-1"></a>                                   <span class="at">latitude =</span> <span class="fl">50.4</span>)[[<span class="st">&quot;hourtemps&quot;</span>]]</span>
<span id="cb485-26"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-26" tabindex="-1"></a></span>
<span id="cb485-27"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-27" tabindex="-1"></a></span>
<span id="cb485-28"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-28" tabindex="-1"></a><span class="co"># Load the experimental data</span></span>
<span id="cb485-29"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-29" tabindex="-1"></a><span class="co"># Load the data from the folder</span></span>
<span id="cb485-30"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-30" tabindex="-1"></a>exp_weather <span class="ot">&lt;-</span> <span class="fu">read_tab</span>(<span class="st">&quot;data/final_weather_data_S1_S2_pear_hourly.csv&quot;</span>)</span>
<span id="cb485-31"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-31" tabindex="-1"></a></span>
<span id="cb485-32"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-32" tabindex="-1"></a><span class="co"># Generate a new column (Year_2) to simulate the year and comply with the format of PhenoFlex functions</span></span>
<span id="cb485-33"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-33" tabindex="-1"></a>exp_weather[<span class="st">&quot;Year_2&quot;</span>] <span class="ot">&lt;-</span> exp_weather<span class="sc">$</span>Treatment <span class="sc">+</span> exp_weather<span class="sc">$</span>Year <span class="sc">+</span> <span class="dv">3</span></span>
<span id="cb485-34"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-34" tabindex="-1"></a></span>
<span id="cb485-35"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-35" tabindex="-1"></a><span class="co"># Since this experiment was conducted during two consecutive seasons, the next step will fix a small continuity issue</span></span>
<span id="cb485-36"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-36" tabindex="-1"></a><span class="co"># generated during the season 2</span></span>
<span id="cb485-37"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-37" tabindex="-1"></a>exp_weather[exp_weather<span class="sc">$</span>Treatment <span class="sc">&gt;=</span> <span class="dv">17</span>, <span class="st">&quot;Year_2&quot;</span>] <span class="ot">&lt;-</span></span>
<span id="cb485-38"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-38" tabindex="-1"></a>  exp_weather[exp_weather<span class="sc">$</span>Treatment <span class="sc">&gt;=</span> <span class="dv">17</span>, <span class="st">&quot;Year_2&quot;</span>] <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb485-39"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-39" tabindex="-1"></a></span>
<span id="cb485-40"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-40" tabindex="-1"></a><span class="co"># For further compatibility, I will now select the columns needed and will drop &quot;Year&quot; (the original one)</span></span>
<span id="cb485-41"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-41" tabindex="-1"></a>exp_weather <span class="ot">&lt;-</span> exp_weather[<span class="fu">c</span>(<span class="st">&quot;YEARMODA&quot;</span>,</span>
<span id="cb485-42"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-42" tabindex="-1"></a>                             <span class="st">&quot;Year_2&quot;</span>, </span>
<span id="cb485-43"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-43" tabindex="-1"></a>                             <span class="st">&quot;Month&quot;</span>, </span>
<span id="cb485-44"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-44" tabindex="-1"></a>                             <span class="st">&quot;Day&quot;</span>,</span>
<span id="cb485-45"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-45" tabindex="-1"></a>                             <span class="st">&quot;Hour&quot;</span>, </span>
<span id="cb485-46"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-46" tabindex="-1"></a>                             <span class="st">&quot;JDay&quot;</span>, </span>
<span id="cb485-47"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-47" tabindex="-1"></a>                             <span class="st">&quot;Temp&quot;</span>)]</span>
<span id="cb485-48"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-48" tabindex="-1"></a></span>
<span id="cb485-49"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-49" tabindex="-1"></a><span class="co"># To replace the missing &quot;Year&quot; column, I will now change the name of the column</span></span>
<span id="cb485-50"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-50" tabindex="-1"></a><span class="fu">colnames</span>(exp_weather)[<span class="fu">which</span>(<span class="fu">colnames</span>(exp_weather) <span class="sc">==</span> <span class="st">&quot;Year_2&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;Year&quot;</span></span>
<span id="cb485-51"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-51" tabindex="-1"></a></span>
<span id="cb485-52"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-52" tabindex="-1"></a></span>
<span id="cb485-53"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-53" tabindex="-1"></a><span class="co"># Import the phenology data from the repository</span></span>
<span id="cb485-54"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-54" tabindex="-1"></a>exp_pheno <span class="ot">&lt;-</span> <span class="fu">read_tab</span>(<span class="st">&quot;data/final_bio_data_S1_S2_pear.csv&quot;</span>)</span>
<span id="cb485-55"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-55" tabindex="-1"></a></span>
<span id="cb485-56"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-56" tabindex="-1"></a>exp_pheno[<span class="st">&quot;Treatment&quot;</span>] <span class="ot">&lt;-</span> exp_pheno<span class="sc">$</span>Treatment <span class="sc">+</span> <span class="dv">2019</span> <span class="sc">+</span> <span class="dv">3</span></span>
<span id="cb485-57"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-57" tabindex="-1"></a></span>
<span id="cb485-58"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-58" tabindex="-1"></a><span class="co"># Remove conflictive treatments</span></span>
<span id="cb485-59"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-59" tabindex="-1"></a>exp_pheno <span class="ot">&lt;-</span> exp_pheno[<span class="sc">!</span>(exp_pheno<span class="sc">$</span>Treatment <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2025</span>, <span class="dv">2030</span>, <span class="dv">2031</span>, <span class="dv">2034</span>, <span class="dv">2035</span>, <span class="dv">2036</span>, <span class="dv">2037</span>, <span class="dv">2041</span>,</span>
<span id="cb485-60"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-60" tabindex="-1"></a>                                                    <span class="dv">2045</span>, <span class="dv">2047</span>, <span class="dv">2048</span>, <span class="dv">2049</span>, <span class="dv">2050</span>, <span class="dv">2051</span>, <span class="dv">2054</span>)),</span>
<span id="cb485-61"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-61" tabindex="-1"></a>                       <span class="fu">c</span>(<span class="st">&quot;Treatment&quot;</span>, <span class="st">&quot;pheno&quot;</span>)]</span>
<span id="cb485-62"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-62" tabindex="-1"></a></span>
<span id="cb485-63"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-63" tabindex="-1"></a><span class="co"># Rename the columns to match the names of the historic dataset</span></span>
<span id="cb485-64"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-64" tabindex="-1"></a><span class="fu">colnames</span>(exp_pheno) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Year&quot;</span>, <span class="st">&quot;pheno&quot;</span>)</span>
<span id="cb485-65"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-65" tabindex="-1"></a></span>
<span id="cb485-66"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-66" tabindex="-1"></a></span>
<span id="cb485-67"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-67" tabindex="-1"></a><span class="co"># Merge the historic and experimental phenology data</span></span>
<span id="cb485-68"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-68" tabindex="-1"></a>pheno_merged <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(<span class="fu">filter</span>(historic_pheno_conference, Year <span class="sc">!=</span> <span class="dv">1958</span>),</span>
<span id="cb485-69"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-69" tabindex="-1"></a>                          exp_pheno)</span>
<span id="cb485-70"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-70" tabindex="-1"></a></span>
<span id="cb485-71"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-71" tabindex="-1"></a></span>
<span id="cb485-72"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-72" tabindex="-1"></a><span class="co"># Merge the historic and experimental phenology data</span></span>
<span id="cb485-73"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-73" tabindex="-1"></a>weather_merged <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(past_weather[, <span class="fu">colnames</span>(past_weather) <span class="sc">%in%</span> <span class="fu">names</span>(exp_weather)],</span>
<span id="cb485-74"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb485-74" tabindex="-1"></a>                            exp_weather)</span></code></pre></div>
<p>For phenology and weather records, we now have the historic and experimental data in the same dataset. We can follow the same procedure we implemented in the chapter <a href="phenoflex3.html#phenoflex3">Can we improve the performance of <code>PhenoFlex</code>?</a> to fit the parameters of <code>PhenoFlex</code> to data.</p>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb486-1" tabindex="-1"></a><span class="co"># Define the season used for calibration and validation in the PhenoFlex modelling approach</span></span>
<span id="cb486-2"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb486-2" tabindex="-1"></a>calibration_seasons <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">sample</span>(pheno_merged<span class="sc">$</span>Year, <span class="dv">50</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>))</span>
<span id="cb486-3"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb486-3" tabindex="-1"></a>validation_seasons <span class="ot">&lt;-</span> <span class="fu">sort</span>(pheno_merged[<span class="sc">!</span>(pheno_merged<span class="sc">$</span>Year <span class="sc">%in%</span> calibration_seasons), <span class="st">&quot;Year&quot;</span>])</span>
<span id="cb486-4"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb486-4" tabindex="-1"></a></span>
<span id="cb486-5"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb486-5" tabindex="-1"></a><span class="co"># Define the list of seasons (weather data)</span></span>
<span id="cb486-6"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb486-6" tabindex="-1"></a>weather_season_list <span class="ot">&lt;-</span> <span class="fu">genSeasonList</span>(weather_merged, <span class="at">mrange =</span> <span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">5</span>), <span class="at">years =</span> calibration_seasons)</span></code></pre></div>
<p>Now we can apply what we learned in the chapter <a href="phenoflex.html#phenoflex">The <code>PhenoFlex</code> model</a> and fit the model parameters to data. Note that we start the fitting procedure with wide ranges (particularly for <code>yc</code> and <code>zc</code>) in order to let the model find the best estimates. We are saving the parameters and the predicted bloom to our <code>data</code> folder.</p>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb487-1" tabindex="-1"></a><span class="co"># Set the initial parameters (wide ranges)</span></span>
<span id="cb487-2"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb487-2" tabindex="-1"></a><span class="co">#          yc,  zc,  s1, Tu,     E0,      E1,     A0,          A1,   Tf, Tc, Tb, slope</span></span>
<span id="cb487-3"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb487-3" tabindex="-1"></a>lower <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">100</span>, <span class="fl">0.1</span>,  <span class="dv">0</span>, <span class="fl">3000.0</span>,  <span class="fl">9000.0</span>, <span class="fl">6000.0</span>,       <span class="dv">5</span>.e13,    <span class="dv">0</span>,  <span class="dv">0</span>,  <span class="dv">0</span>,  <span class="fl">0.05</span>)</span>
<span id="cb487-4"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb487-4" tabindex="-1"></a>par   <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">190</span>, <span class="fl">0.5</span>, <span class="dv">25</span>, <span class="fl">3372.8</span>,  <span class="fl">9900.3</span>, <span class="fl">6319.5</span>, <span class="fl">5.939917e13</span>,    <span class="dv">4</span>, <span class="dv">36</span>,  <span class="dv">4</span>,  <span class="fl">1.60</span>)</span>
<span id="cb487-5"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb487-5" tabindex="-1"></a>upper <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">500</span>, <span class="fl">1.0</span>, <span class="dv">30</span>, <span class="fl">4000.0</span>, <span class="fl">10000.0</span>, <span class="fl">7000.0</span>,       <span class="dv">6</span>.e13,   <span class="dv">10</span>, <span class="dv">40</span>, <span class="dv">10</span>, <span class="fl">50.00</span>)</span>
<span id="cb487-6"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb487-6" tabindex="-1"></a></span>
<span id="cb487-7"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb487-7" tabindex="-1"></a><span class="co"># Run the fitter</span></span>
<span id="cb487-8"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb487-8" tabindex="-1"></a>pheno_fit <span class="ot">&lt;-</span> <span class="fu">phenologyFitter</span>(<span class="at">par.guess =</span> par,</span>
<span id="cb487-9"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb487-9" tabindex="-1"></a>                             <span class="at">modelfn =</span> PhenoFlex_GDHwrapper,</span>
<span id="cb487-10"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb487-10" tabindex="-1"></a>                             <span class="at">bloomJDays =</span> pheno_merged[pheno_merged<span class="sc">$</span>Year <span class="sc">%in%</span></span>
<span id="cb487-11"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb487-11" tabindex="-1"></a>                                                         calibration_seasons, <span class="st">&quot;pheno&quot;</span>],</span>
<span id="cb487-12"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb487-12" tabindex="-1"></a>                             <span class="at">SeasonList =</span> weather_season_list,</span>
<span id="cb487-13"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb487-13" tabindex="-1"></a>                             <span class="at">lower =</span> lower,</span>
<span id="cb487-14"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb487-14" tabindex="-1"></a>                             <span class="at">upper =</span> upper,</span>
<span id="cb487-15"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb487-15" tabindex="-1"></a>                             <span class="at">control =</span> <span class="fu">list</span>(<span class="at">smooth =</span> <span class="cn">FALSE</span>,</span>
<span id="cb487-16"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb487-16" tabindex="-1"></a>                                            <span class="at">verbose =</span> <span class="cn">FALSE</span>,</span>
<span id="cb487-17"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb487-17" tabindex="-1"></a>                                            <span class="at">maxit =</span> <span class="dv">2000</span>,</span>
<span id="cb487-18"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb487-18" tabindex="-1"></a>                                            <span class="at">nb.stop.improvement =</span> <span class="dv">20</span>))</span>
<span id="cb487-19"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb487-19" tabindex="-1"></a></span>
<span id="cb487-20"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb487-20" tabindex="-1"></a><span class="co"># Save the resulting parameters to folder (to avoid having to run the phenology fitter again)</span></span>
<span id="cb487-21"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb487-21" tabindex="-1"></a><span class="fu">write.csv</span>(pheno_fit<span class="sc">$</span>par, <span class="st">&quot;data/PhenoFlex_hist_exp_pear.csv&quot;</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb487-22"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb487-22" tabindex="-1"></a></span>
<span id="cb487-23"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb487-23" tabindex="-1"></a><span class="co"># Save the results of the predicted phenology for the calibration seasons</span></span>
<span id="cb487-24"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb487-24" tabindex="-1"></a><span class="fu">write.csv</span>(<span class="fu">data.frame</span>(pheno_merged[pheno_merged<span class="sc">$</span>Year <span class="sc">%in%</span> calibration_seasons, ],</span>
<span id="cb487-25"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb487-25" tabindex="-1"></a>                     <span class="st">&quot;Predicted&quot;</span> <span class="ot">=</span> pheno_fit<span class="sc">$</span>pbloomJDays), <span class="st">&quot;data/PhenoFlex_hist_exp_predicted_bloom_pear.csv&quot;</span>,</span>
<span id="cb487-26"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb487-26" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>Let’s take a look at some results from the fitting procedure. We can feed our model with the fitted parameters and then estimate the prediction error by comparing predicted with observed bloom dates.</p>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb488-1" tabindex="-1"></a><span class="co"># Read the parameters</span></span>
<span id="cb488-2"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb488-2" tabindex="-1"></a>params <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/PhenoFlex_hist_exp_pear.csv&quot;</span>)[[<span class="dv">1</span>]]</span>
<span id="cb488-3"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb488-3" tabindex="-1"></a></span>
<span id="cb488-4"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb488-4" tabindex="-1"></a><span class="co"># Generate a data set to collect the outputs of the fitting for the calibration data </span></span>
<span id="cb488-5"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb488-5" tabindex="-1"></a>out_df <span class="ot">&lt;-</span> <span class="fu">read_tab</span>(<span class="st">&quot;data/PhenoFlex_hist_exp_predicted_bloom_pear.csv&quot;</span>)</span>
<span id="cb488-6"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb488-6" tabindex="-1"></a></span>
<span id="cb488-7"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb488-7" tabindex="-1"></a><span class="co"># Compute the error (observed - predicted)</span></span>
<span id="cb488-8"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb488-8" tabindex="-1"></a>out_df[[<span class="st">&quot;Error&quot;</span>]] <span class="ot">&lt;-</span> out_df<span class="sc">$</span>pheno <span class="sc">-</span> out_df<span class="sc">$</span>Predicted</span></code></pre></div>
<p>We can now compute some model performance metrics based on the prediction errors estimated above. This is not very relevant during the calibration procedure, but it can give us an idea on how successful our calibration attempt has been.</p>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb489-1" tabindex="-1"></a>calibration_metrics</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Metric</th>
<th align="right">Calibration</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">RMSEP</td>
<td align="right">6.14</td>
</tr>
<tr class="even">
<td align="left">RPIQ</td>
<td align="right">3.54</td>
</tr>
</tbody>
</table>
<p>There is certainly room for improvement (consider though that we only used 10 iterations of the fitting procedure), but this gives us a relatively small <code>RMSEP</code> for calibration. Let’s plot the results to see the big picture.</p>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb490-1" tabindex="-1"></a><span class="co"># Plot the results to see the overall fitting</span></span>
<span id="cb490-2"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb490-2" tabindex="-1"></a><span class="fu">ggplot</span>(out_df, <span class="fu">aes</span>(pheno, Predicted)) <span class="sc">+</span></span>
<span id="cb490-3"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb490-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb490-4"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb490-4" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb490-5"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb490-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Observed&quot;</span>) <span class="sc">+</span></span>
<span id="cb490-6"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb490-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="Book_files/figure-html/plotting_frost-1.png" width="672" /></p>
<p>Once again, this is a good preliminary fitting for calibration but it may worth trying a different <code>par.guess</code> and other arguments within <code>phenologyFitter()</code> during model calibration.</p>
</div>
<div id="validation-1" class="section level2 hasAnchor" number="34.2">
<h2><span class="header-section-number">34.2</span> Validation<a href="a-robust-method-to-estimate-future-frost-risks.html#validation-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We should probably now take a look at how well this phenology model can predict bloom dates for seasons not used in the calibration data set. We need to extract the model parameters and use the function <code>PhenoFlex_GDHwrapper()</code> to complete this task.</p>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb491-1" tabindex="-1"></a><span class="co"># Generate a validation data set with phenology data</span></span>
<span id="cb491-2"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb491-2" tabindex="-1"></a>valid_df <span class="ot">&lt;-</span> pheno_merged[pheno_merged<span class="sc">$</span>Year <span class="sc">%in%</span> validation_seasons, ]</span>
<span id="cb491-3"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb491-3" tabindex="-1"></a></span>
<span id="cb491-4"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb491-4" tabindex="-1"></a><span class="co"># Generate a list of seasons with weather data for the validation procedure</span></span>
<span id="cb491-5"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb491-5" tabindex="-1"></a>valid_season_list <span class="ot">&lt;-</span> <span class="fu">genSeasonList</span>(weather_merged, <span class="at">mrange =</span> <span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">7</span>), </span>
<span id="cb491-6"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb491-6" tabindex="-1"></a>                                   <span class="at">years =</span> validation_seasons)</span>
<span id="cb491-7"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb491-7" tabindex="-1"></a></span>
<span id="cb491-8"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb491-8" tabindex="-1"></a><span class="co"># Estimate the bloom dates with PhenoFlexGDHwrapper</span></span>
<span id="cb491-9"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb491-9" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span> <span class="sc">:</span> <span class="fu">nrow</span>(valid_df)) {</span>
<span id="cb491-10"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb491-10" tabindex="-1"></a>  </span>
<span id="cb491-11"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb491-11" tabindex="-1"></a>  valid_df[i, <span class="st">&quot;Predicted&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">PhenoFlex_GDHwrapper</span>(valid_season_list[[i]],</span>
<span id="cb491-12"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb491-12" tabindex="-1"></a>                                                   params)</span>
<span id="cb491-13"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb491-13" tabindex="-1"></a>}</span>
<span id="cb491-14"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb491-14" tabindex="-1"></a></span>
<span id="cb491-15"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb491-15" tabindex="-1"></a><span class="co"># Compute the error (observed - predicted)</span></span>
<span id="cb491-16"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb491-16" tabindex="-1"></a>valid_df[[<span class="st">&quot;Error&quot;</span>]] <span class="ot">&lt;-</span> valid_df<span class="sc">$</span>pheno <span class="sc">-</span> valid_df<span class="sc">$</span>Predicted</span></code></pre></div>
<p>Since we already know the difference between the observed values and the values predicted by the model (i.e. the prediction error) in the validation data set, we can estimate some model performance metrics such as RMSEP and RPIQ. To this end, we can use the functions <code>RMSEP()</code> and <code>RPIQ()</code> from <code>chillR</code>.</p>
<table>
<thead>
<tr class="header">
<th align="left">Metric</th>
<th align="right">PhenoFlex_marginal</th>
<th align="right">PhenoFlex_normal</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">RMSEP</td>
<td align="right">10.801206</td>
<td align="right">4.131548</td>
</tr>
<tr class="even">
<td align="left">RPIQ</td>
<td align="right">4.930005</td>
<td align="right">12.888630</td>
</tr>
</tbody>
</table>
<p>The results shown in the table above represent a good preliminary performance of the model in forecasting bloom dates in pear trees for conditions we may expect in the future. Note that for a more robust analysis, we should try fitting <code>PhenoFlex</code> many times in order to achieve lower <code>RMSEP</code> values. We could also consider limiting the number of experimental seasons (which may be adding somewhat ‘extreme’ values) to narrow the range of conditions observed in the warm part of the model validity domain. Additional errors may originate from merging two data sets obtained with different methodologies (mature trees in the orchard vs. young potted trees, different observers across experiments, etc.). Let’s take a look at the fitting outcomes. We added labels to show the season presenting an error greater than 10 days.</p>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb492-1"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb492-1" tabindex="-1"></a><span class="co"># Plot the validation and calibration results (highlight seasons with 10 or more days of error)</span></span>
<span id="cb492-2"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb492-2" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb492-3"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb492-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> out_df, <span class="fu">aes</span>(pheno, Predicted, <span class="at">color =</span> <span class="st">&quot;Calibration&quot;</span>)) <span class="sc">+</span></span>
<span id="cb492-4"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb492-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> valid_df, <span class="fu">aes</span>(pheno, Predicted, <span class="at">color =</span> <span class="st">&quot;Validation&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb492-5"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb492-5" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_label_repel</span>(<span class="fu">aes</span>(pheno, Predicted, <span class="at">label =</span> Year),</span>
<span id="cb492-6"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb492-6" tabindex="-1"></a>                            <span class="at">data =</span> <span class="fu">filter</span>(out_df, <span class="fu">abs</span>(Error) <span class="sc">&gt;</span> <span class="dv">10</span>), <span class="at">nudge_y =</span> <span class="dv">2</span>, <span class="at">nudge_x =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb492-7"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb492-7" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_label_repel</span>(<span class="fu">aes</span>(pheno, Predicted, <span class="at">label =</span> Year),</span>
<span id="cb492-8"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb492-8" tabindex="-1"></a>                            <span class="at">data =</span> <span class="fu">filter</span>(valid_df, <span class="fu">abs</span>(Error) <span class="sc">&gt;</span> <span class="dv">10</span>), <span class="at">nudge_y =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">nudge_x =</span> <span class="dv">9</span>, <span class="at">force =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb492-9"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb492-9" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;cadetblue&quot;</span>, <span class="st">&quot;firebrick&quot;</span>)) <span class="sc">+</span></span>
<span id="cb492-10"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb492-10" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb492-11"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb492-11" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Observed&quot;</span>,</span>
<span id="cb492-12"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb492-12" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Dataset&quot;</span>) <span class="sc">+</span></span>
<span id="cb492-13"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb492-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="Book_files/figure-html/validation_plot_frost-1.png" width="672" /></p>
<p>Let’s say that we are happy with our validation approach. Using the set of parameters fitted in the previous model runs, we can predict bloom dates for future scenarios. To this end, we will need to use the data generated in chapter <a href="future-temperature-scenarios.html#future-temperature-scenarios">Future temperature scenarios</a>. Fortunately, we already loaded that data into <code>R</code> when generating the <em>convex-hull</em> plots.</p>
<p>We will use the function <code>PhenoFlex_GDHwrapper()</code> to estimate the date of bloom for future scenarios. The first two sections of the <em>for</em> loop are commands to get the data into a good format for estimating bloom dates. We need to derive hourly records using <code>stack_hourly_temps()</code> and then define the seasons with <code>genSeasonList()</code>.</p>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-1" tabindex="-1"></a><span class="co"># Create a primer data frame to allocate the results for future bloom</span></span>
<span id="cb493-2"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-2" tabindex="-1"></a>future_bloom <span class="ot">&lt;-</span> future_temps <span class="sc">%&gt;%</span> </span>
<span id="cb493-3"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-3" tabindex="-1"></a>  <span class="fu">group_by</span>(SSP_Time, </span>
<span id="cb493-4"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-4" tabindex="-1"></a>           GCM, </span>
<span id="cb493-5"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-5" tabindex="-1"></a>           Year) <span class="sc">%&gt;%</span> </span>
<span id="cb493-6"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-6" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Pheno =</span> <span class="cn">NA</span>)</span>
<span id="cb493-7"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-7" tabindex="-1"></a></span>
<span id="cb493-8"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-8" tabindex="-1"></a><span class="co"># Define the scenarios to be used in the for loop</span></span>
<span id="cb493-9"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-9" tabindex="-1"></a>scenarios <span class="ot">&lt;-</span> <span class="fu">unique</span>(future_temps<span class="sc">$</span>SSP_Time)</span>
<span id="cb493-10"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-10" tabindex="-1"></a></span>
<span id="cb493-11"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-11" tabindex="-1"></a><span class="co"># Define the climate models to be used in the for loop</span></span>
<span id="cb493-12"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-12" tabindex="-1"></a>climate_models <span class="ot">&lt;-</span> <span class="fu">unique</span>(future_temps<span class="sc">$</span>GCM)</span>
<span id="cb493-13"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-13" tabindex="-1"></a></span>
<span id="cb493-14"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-14" tabindex="-1"></a><span class="co"># Implement the for loop</span></span>
<span id="cb493-15"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-15" tabindex="-1"></a><span class="cf">for</span> (scenario <span class="cf">in</span> scenarios){</span>
<span id="cb493-16"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-16" tabindex="-1"></a>  scen_file <span class="ot">&lt;-</span> future_temps <span class="sc">%&gt;%</span> </span>
<span id="cb493-17"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-17" tabindex="-1"></a>    <span class="fu">filter</span>(SSP_Time <span class="sc">==</span> scenario)</span>
<span id="cb493-18"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-18" tabindex="-1"></a>  </span>
<span id="cb493-19"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-19" tabindex="-1"></a>  climate_models <span class="ot">&lt;-</span> <span class="fu">unique</span>(scen_file<span class="sc">$</span>GCM)</span>
<span id="cb493-20"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-20" tabindex="-1"></a>  </span>
<span id="cb493-21"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-21" tabindex="-1"></a>  <span class="cf">for</span> (climate_model <span class="cf">in</span> climate_models){</span>
<span id="cb493-22"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-22" tabindex="-1"></a>    </span>
<span id="cb493-23"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-23" tabindex="-1"></a>    <span class="co"># Subset a temporary data frame according to scenario and climate model</span></span>
<span id="cb493-24"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-24" tabindex="-1"></a>    <span class="co"># and generate hourly temperatures</span></span>
<span id="cb493-25"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-25" tabindex="-1"></a>    temp_df <span class="ot">&lt;-</span> <span class="fu">filter</span>(scen_file,</span>
<span id="cb493-26"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-26" tabindex="-1"></a>                      GCM <span class="sc">==</span> climate_model) <span class="sc">%&gt;%</span></span>
<span id="cb493-27"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-27" tabindex="-1"></a>      <span class="fu">stack_hourly_temps</span>(<span class="at">latitude =</span> <span class="fl">50.4</span>)</span>
<span id="cb493-28"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-28" tabindex="-1"></a>    </span>
<span id="cb493-29"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-29" tabindex="-1"></a>    <span class="co"># Define the saeasons to be used for predicting the phenology</span></span>
<span id="cb493-30"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-30" tabindex="-1"></a>    temp_seasons_list <span class="ot">&lt;-</span> <span class="fu">genSeasonList</span>(temp_df<span class="sc">$</span>hourtemps, </span>
<span id="cb493-31"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-31" tabindex="-1"></a>                                       <span class="at">mrange =</span> <span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">7</span>),</span>
<span id="cb493-32"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-32" tabindex="-1"></a>                                       <span class="at">years =</span> <span class="fu">c</span>(<span class="dv">2002</span> <span class="sc">:</span> <span class="dv">2101</span>))</span>
<span id="cb493-33"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-33" tabindex="-1"></a>    </span>
<span id="cb493-34"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-34" tabindex="-1"></a>    <span class="co"># Change the names of the list of seasons to be used as index in the next for loop</span></span>
<span id="cb493-35"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-35" tabindex="-1"></a>    <span class="fu">names</span>(temp_seasons_list) <span class="ot">&lt;-</span> <span class="dv">2002</span> <span class="sc">:</span> <span class="dv">2101</span></span>
<span id="cb493-36"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-36" tabindex="-1"></a>    </span>
<span id="cb493-37"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-37" tabindex="-1"></a>    <span class="co"># Implement a for loop that runs over the list of seasons to estimate the bloom date using the parameters fitted by the</span></span>
<span id="cb493-38"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-38" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb493-39"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-39" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span> <span class="sc">:</span> <span class="fu">length</span>(temp_seasons_list)){</span>
<span id="cb493-40"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-40" tabindex="-1"></a>      </span>
<span id="cb493-41"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-41" tabindex="-1"></a>      <span class="co"># Add the bloom date to the primer data set</span></span>
<span id="cb493-42"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-42" tabindex="-1"></a>      future_bloom[future_bloom<span class="sc">$</span>SSP_Time <span class="sc">==</span> scenario <span class="sc">&amp;</span> </span>
<span id="cb493-43"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-43" tabindex="-1"></a>                     future_bloom<span class="sc">$</span>GCM <span class="sc">==</span> climate_model <span class="sc">&amp;</span> </span>
<span id="cb493-44"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-44" tabindex="-1"></a>                     future_bloom<span class="sc">$</span>Year <span class="sc">==</span> <span class="fu">names</span>(temp_seasons_list)[i], </span>
<span id="cb493-45"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-45" tabindex="-1"></a>                   <span class="st">&quot;Pheno&quot;</span>] <span class="ot">&lt;-</span></span>
<span id="cb493-46"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-46" tabindex="-1"></a>        <span class="fu">PhenoFlex_GDHwrapper</span>(temp_seasons_list[[i]],</span>
<span id="cb493-47"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-47" tabindex="-1"></a>                             params)</span>
<span id="cb493-48"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-48" tabindex="-1"></a>    }</span>
<span id="cb493-49"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-49" tabindex="-1"></a>  }</span>
<span id="cb493-50"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb493-50" tabindex="-1"></a>}</span></code></pre></div>
<p>We can now implement the same procedure to estimate bloom dates for historic simulated scenarios.</p>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb494-1"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-1" tabindex="-1"></a><span class="co"># Bloom for past simulated scenarios ####</span></span>
<span id="cb494-2"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-2" tabindex="-1"></a><span class="co"># Load the historic simulated scenarios</span></span>
<span id="cb494-3"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-3" tabindex="-1"></a>temps_past_scenarios <span class="ot">&lt;-</span> <span class="fu">load_temperature_scenarios</span>(<span class="st">&quot;data&quot;</span>,</span>
<span id="cb494-4"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-4" tabindex="-1"></a>                                    <span class="st">&quot;Bonn_hist_scenarios&quot;</span>)</span>
<span id="cb494-5"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-5" tabindex="-1"></a></span>
<span id="cb494-6"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-6" tabindex="-1"></a><span class="co"># Create a single dataset for all the simulated years</span></span>
<span id="cb494-7"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-7" tabindex="-1"></a>temps_past_scenarios <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(temps_past_scenarios,</span>
<span id="cb494-8"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-8" tabindex="-1"></a>                                  <span class="at">.id =</span> <span class="st">&quot;Scen_year&quot;</span>)</span>
<span id="cb494-9"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-9" tabindex="-1"></a></span>
<span id="cb494-10"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-10" tabindex="-1"></a><span class="co"># Make a primer dataset to allocate the results of the bloom projection</span></span>
<span id="cb494-11"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-11" tabindex="-1"></a>simulated_bloom <span class="ot">&lt;-</span> temps_past_scenarios <span class="sc">%&gt;%</span> </span>
<span id="cb494-12"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-12" tabindex="-1"></a>  <span class="fu">group_by</span>(Scen_year, Year) <span class="sc">%&gt;%</span> </span>
<span id="cb494-13"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-13" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Pheno =</span> <span class="cn">NA</span>)</span>
<span id="cb494-14"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-14" tabindex="-1"></a></span>
<span id="cb494-15"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-15" tabindex="-1"></a><span class="co"># Define the scenario years to be used in the loop</span></span>
<span id="cb494-16"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-16" tabindex="-1"></a>scen_years <span class="ot">&lt;-</span> <span class="fu">unique</span>(simulated_bloom<span class="sc">$</span>Scen_year)</span>
<span id="cb494-17"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-17" tabindex="-1"></a></span>
<span id="cb494-18"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-18" tabindex="-1"></a><span class="co"># Implement the for loop</span></span>
<span id="cb494-19"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-19" tabindex="-1"></a><span class="cf">for</span> (scen_year <span class="cf">in</span> scen_years){</span>
<span id="cb494-20"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-20" tabindex="-1"></a>  </span>
<span id="cb494-21"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-21" tabindex="-1"></a>  <span class="co"># Subset a temporary data frame according to scenario and climate model</span></span>
<span id="cb494-22"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-22" tabindex="-1"></a>  temp_df <span class="ot">&lt;-</span> <span class="fu">filter</span>(temps_past_scenarios, </span>
<span id="cb494-23"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-23" tabindex="-1"></a>                    Scen_year <span class="sc">==</span> scen_year)</span>
<span id="cb494-24"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-24" tabindex="-1"></a>  </span>
<span id="cb494-25"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-25" tabindex="-1"></a>  <span class="co"># Generate hourly temperatures in the temporary data frame</span></span>
<span id="cb494-26"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-26" tabindex="-1"></a>  temp_df <span class="ot">&lt;-</span> <span class="fu">stack_hourly_temps</span>(temp_df,</span>
<span id="cb494-27"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-27" tabindex="-1"></a>                                <span class="at">latitude =</span> <span class="fl">50.4</span>)</span>
<span id="cb494-28"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-28" tabindex="-1"></a>  </span>
<span id="cb494-29"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-29" tabindex="-1"></a>  <span class="co"># Define the saeasons to be used for predicting the phenology</span></span>
<span id="cb494-30"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-30" tabindex="-1"></a>  temp_seasons_list <span class="ot">&lt;-</span> <span class="fu">genSeasonList</span>(temp_df<span class="sc">$</span>hourtemps, </span>
<span id="cb494-31"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-31" tabindex="-1"></a>                                     <span class="at">mrange =</span> <span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">7</span>), </span>
<span id="cb494-32"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-32" tabindex="-1"></a>                                     <span class="at">years =</span> <span class="fu">c</span>(<span class="dv">2002</span> <span class="sc">:</span> <span class="dv">2101</span>))</span>
<span id="cb494-33"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-33" tabindex="-1"></a>  </span>
<span id="cb494-34"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-34" tabindex="-1"></a>  <span class="co"># Change the names of the list of seasons to be used as index in the next for loop</span></span>
<span id="cb494-35"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-35" tabindex="-1"></a>  <span class="fu">names</span>(temp_seasons_list) <span class="ot">&lt;-</span> <span class="dv">2002</span> <span class="sc">:</span> <span class="dv">2101</span></span>
<span id="cb494-36"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-36" tabindex="-1"></a>  </span>
<span id="cb494-37"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-37" tabindex="-1"></a>  <span class="co"># Implement a for loop that runs over the list of seasons to estimate the bloom date using the parameters fitted by the</span></span>
<span id="cb494-38"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-38" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb494-39"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-39" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span> <span class="sc">:</span> <span class="fu">length</span>(temp_seasons_list)){</span>
<span id="cb494-40"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-40" tabindex="-1"></a>    </span>
<span id="cb494-41"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-41" tabindex="-1"></a>    <span class="co"># Add the bloom date to the primer data set</span></span>
<span id="cb494-42"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-42" tabindex="-1"></a>    simulated_bloom[simulated_bloom<span class="sc">$</span>Scen_year <span class="sc">==</span> scen_year <span class="sc">&amp;</span> </span>
<span id="cb494-43"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-43" tabindex="-1"></a>                      simulated_bloom<span class="sc">$</span>Year <span class="sc">==</span> <span class="fu">names</span>(temp_seasons_list)[i], </span>
<span id="cb494-44"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-44" tabindex="-1"></a>                    <span class="st">&quot;Pheno&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb494-45"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-45" tabindex="-1"></a>      <span class="fu">PhenoFlex_GDHwrapper</span>(temp_seasons_list[[i]],</span>
<span id="cb494-46"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-46" tabindex="-1"></a>                                                                                                            params)</span>
<span id="cb494-47"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-47" tabindex="-1"></a>  }</span>
<span id="cb494-48"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-48" tabindex="-1"></a>}</span>
<span id="cb494-49"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-49" tabindex="-1"></a></span>
<span id="cb494-50"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb494-50" tabindex="-1"></a><span class="fu">write.csv</span>(simulated_bloom, <span class="st">&quot;data/frost_simulated_bloom.csv&quot;</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>We are going to produce a plot now to show the likely bloom dates for historic and future scenarios. We will also add the data used for calibration of the PhenoFlex model. The plot is a bit complicated, because it’s difficult to plot two datasets with different axes in the same plot panel. The plotting strategy below goes as follows:</p>
<ul>
<li>We start with a violin plot of the simulated bloom data for the past scenarios.</li>
<li>Then we extract the x and y axis limits from this plot (using the <code>layer_scales</code> command).</li>
<li>We make a density plot of the calibration data (distinguishing between the historic and experimental data), but only to extract the data from it (the <code>ggplot_build</code> part below).</li>
<li>We convert the density data that we extracted from the plot into numeric values that can be plotted on the same axis as the years in the first plot.</li>
<li>We then add these data to the first plot as a <code>geom_ribbon</code>.</li>
<li>We make a plot of the future data (much easier).</li>
<li>We combine both plots using the patchwork package.</li>
<li>We save this as an image using the <code>ggsave</code> function.</li>
<li>We still had to adjust all kinds of settings…</li>
</ul>
<p>So this wasn’t easy but in the end we got something that was pretty close to what we had in mind.</p>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-1" tabindex="-1"></a><span class="co"># Plot all bloom prediction results</span></span>
<span id="cb495-2"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-2" tabindex="-1"></a></span>
<span id="cb495-3"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-3" tabindex="-1"></a><span class="co"># Plot showing the violins for historic simulated scenarios</span></span>
<span id="cb495-4"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-4" tabindex="-1"></a>past_simulated_plot <span class="ot">&lt;-</span></span>
<span id="cb495-5"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> simulated_bloom) <span class="sc">+</span></span>
<span id="cb495-6"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-6" tabindex="-1"></a>  <span class="fu">geom_violin</span>(</span>
<span id="cb495-7"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-7" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> Scen_year,</span>
<span id="cb495-8"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-8" tabindex="-1"></a>        <span class="at">group =</span> Scen_year, </span>
<span id="cb495-9"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-9" tabindex="-1"></a>        <span class="at">y =</span> Pheno),</span>
<span id="cb495-10"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-10" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.35</span>,</span>
<span id="cb495-11"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-11" tabindex="-1"></a>    <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>),</span>
<span id="cb495-12"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-12" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb495-13"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-13" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> <span class="st">&quot;Historic&quot;</span>) <span class="sc">+</span></span>
<span id="cb495-14"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-14" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb495-15"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-15" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb495-16"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-16" tabindex="-1"></a>        <span class="at">axis.title.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb495-17"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-17" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>),</span>
<span id="cb495-18"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-18" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb495-19"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-19" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb495-20"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-20" tabindex="-1"></a>        <span class="at">aspect.ratio =</span> <span class="dv">4</span>)</span>
<span id="cb495-21"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-21" tabindex="-1"></a></span>
<span id="cb495-22"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-22" tabindex="-1"></a>past_xlim <span class="ot">&lt;-</span> <span class="fu">layer_scales</span>(past_simulated_plot)<span class="sc">$</span>x<span class="sc">$</span>range<span class="sc">$</span>range</span>
<span id="cb495-23"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-23" tabindex="-1"></a>past_ylim <span class="ot">&lt;-</span> <span class="fu">layer_scales</span>(past_simulated_plot)<span class="sc">$</span>y<span class="sc">$</span>range<span class="sc">$</span>range</span>
<span id="cb495-24"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-24" tabindex="-1"></a></span>
<span id="cb495-25"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-25" tabindex="-1"></a><span class="co"># Make a density plot to show the distribution of the seasons used for calibration of the PhenoFlex modelling framework</span></span>
<span id="cb495-26"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-26" tabindex="-1"></a><span class="co"># Create a dataframe with columns to be used in the plot</span></span>
<span id="cb495-27"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-27" tabindex="-1"></a>observed_bloom_calibration <span class="ot">&lt;-</span></span>
<span id="cb495-28"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-28" tabindex="-1"></a>  <span class="fu">data.frame</span>(out_df,</span>
<span id="cb495-29"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-29" tabindex="-1"></a>             <span class="at">Facet =</span> <span class="st">&quot;Past scenarios&quot;</span>,</span>
<span id="cb495-30"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-30" tabindex="-1"></a>             <span class="at">Dataset =</span> <span class="fu">if_else</span>(out_df<span class="sc">$</span>Year <span class="sc">&gt;</span> <span class="dv">2010</span>, </span>
<span id="cb495-31"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-31" tabindex="-1"></a>                               <span class="st">&quot;Experimental&quot;</span>, </span>
<span id="cb495-32"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-32" tabindex="-1"></a>                               <span class="st">&quot;Historic&quot;</span>))</span>
<span id="cb495-33"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-33" tabindex="-1"></a></span>
<span id="cb495-34"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-34" tabindex="-1"></a><span class="co"># Make a density plot of the bloom dates included in the calibration dataset</span></span>
<span id="cb495-35"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-35" tabindex="-1"></a>gg_density_plot <span class="ot">&lt;-</span>   </span>
<span id="cb495-36"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-36" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb495-37"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-37" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">data =</span> observed_bloom_calibration,</span>
<span id="cb495-38"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-38" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">y =</span> pheno, </span>
<span id="cb495-39"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-39" tabindex="-1"></a>                   <span class="at">fill =</span> Dataset)</span>
<span id="cb495-40"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-40" tabindex="-1"></a>  )</span>
<span id="cb495-41"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-41" tabindex="-1"></a></span>
<span id="cb495-42"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-42" tabindex="-1"></a><span class="co"># Extract data from the plot</span></span>
<span id="cb495-43"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-43" tabindex="-1"></a>density_data <span class="ot">&lt;-</span> </span>
<span id="cb495-44"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-44" tabindex="-1"></a>  gg_density_plot <span class="sc">%&gt;%</span> </span>
<span id="cb495-45"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-45" tabindex="-1"></a>  <span class="fu">ggplot_build</span>() <span class="sc">%&gt;%</span></span>
<span id="cb495-46"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-46" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="dv">1</span>,<span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb495-47"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-47" tabindex="-1"></a>  <span class="fu">select</span>(x<span class="sc">:</span>y,group)</span>
<span id="cb495-48"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-48" tabindex="-1"></a></span>
<span id="cb495-49"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-49" tabindex="-1"></a></span>
<span id="cb495-50"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-50" tabindex="-1"></a><span class="co"># Scale data so that they can be plotted on the Year axis</span></span>
<span id="cb495-51"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-51" tabindex="-1"></a>density_data[density_data<span class="sc">$</span>group <span class="sc">==</span> <span class="dv">1</span>, <span class="st">&quot;Dataset&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Experimental&quot;</span></span>
<span id="cb495-52"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-52" tabindex="-1"></a>density_data[density_data<span class="sc">$</span>group <span class="sc">==</span> <span class="dv">2</span>, <span class="st">&quot;Dataset&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Historic&quot;</span></span>
<span id="cb495-53"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-53" tabindex="-1"></a>density_data <span class="ot">&lt;-</span> </span>
<span id="cb495-54"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-54" tabindex="-1"></a>  density_data <span class="sc">%&gt;%</span></span>
<span id="cb495-55"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-55" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">density_scaled =</span> x <span class="sc">/</span> <span class="fu">max</span>(x),</span>
<span id="cb495-56"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-56" tabindex="-1"></a>         <span class="at">density_scaled =</span> density_scaled <span class="sc">*</span> (past_xlim[<span class="dv">2</span>] <span class="sc">-</span> </span>
<span id="cb495-57"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-57" tabindex="-1"></a>                                              past_xlim[<span class="dv">1</span>]) <span class="sc">*</span> <span class="fl">0.9</span> <span class="sc">+</span> past_xlim[<span class="dv">1</span>])</span>
<span id="cb495-58"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-58" tabindex="-1"></a></span>
<span id="cb495-59"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-59" tabindex="-1"></a><span class="co"># merge the two plots (and plot the violin plot again, so that it&#39;s placed</span></span>
<span id="cb495-60"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-60" tabindex="-1"></a><span class="co"># on top)</span></span>
<span id="cb495-61"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-61" tabindex="-1"></a></span>
<span id="cb495-62"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-62" tabindex="-1"></a>past_observed_plot <span class="ot">&lt;-</span> </span>
<span id="cb495-63"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-63" tabindex="-1"></a>  past_simulated_plot <span class="sc">+</span></span>
<span id="cb495-64"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-64" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> density_data,</span>
<span id="cb495-65"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-65" tabindex="-1"></a>            <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>,</span>
<span id="cb495-66"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-66" tabindex="-1"></a>            <span class="at">position =</span> <span class="st">&quot;identity&quot;</span>,</span>
<span id="cb495-67"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-67" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">xmin =</span> past_xlim[<span class="dv">1</span>],</span>
<span id="cb495-68"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-68" tabindex="-1"></a>                <span class="at">xmax =</span> density_scaled,</span>
<span id="cb495-69"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-69" tabindex="-1"></a>                <span class="at">y =</span> y,</span>
<span id="cb495-70"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-70" tabindex="-1"></a>                <span class="at">fill =</span> Dataset),</span>
<span id="cb495-71"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-71" tabindex="-1"></a>         <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb495-72"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-72" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">data =</span> simulated_bloom,</span>
<span id="cb495-73"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-73" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> Scen_year,</span>
<span id="cb495-74"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-74" tabindex="-1"></a>        <span class="at">group =</span> Scen_year, </span>
<span id="cb495-75"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-75" tabindex="-1"></a>        <span class="at">y =</span> Pheno),</span>
<span id="cb495-76"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-76" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">0.35</span>,</span>
<span id="cb495-77"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-77" tabindex="-1"></a>    <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>),</span>
<span id="cb495-78"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-78" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb495-79"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-79" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">160</span>),</span>
<span id="cb495-80"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-80" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="cf">function</span> (x) </span>
<span id="cb495-81"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-81" tabindex="-1"></a>                       <span class="fu">format</span>(dormancyR<span class="sc">::</span><span class="fu">JDay_to_date</span>(x, </span>
<span id="cb495-82"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-82" tabindex="-1"></a>                                                      <span class="dv">2001</span>,</span>
<span id="cb495-83"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-83" tabindex="-1"></a>                                                      <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb495-84"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-84" tabindex="-1"></a>                              <span class="st">&quot;%b %d&quot;</span>)) <span class="sc">+</span></span>
<span id="cb495-85"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-85" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.1</span>),</span>
<span id="cb495-86"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-86" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, </span>
<span id="cb495-87"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-87" tabindex="-1"></a>                                   <span class="at">angle =</span> <span class="dv">45</span>,</span>
<span id="cb495-88"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-88" tabindex="-1"></a>                                   <span class="at">vjust =</span> .<span class="dv">4</span>, </span>
<span id="cb495-89"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-89" tabindex="-1"></a>                                   <span class="at">hjust =</span> .<span class="dv">6</span>),</span>
<span id="cb495-90"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-90" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>),</span>
<span id="cb495-91"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-91" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>))</span>
<span id="cb495-92"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-92" tabindex="-1"></a></span>
<span id="cb495-93"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-93" tabindex="-1"></a></span>
<span id="cb495-94"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-94" tabindex="-1"></a><span class="co"># Create a violin plot to show future bloom dates</span></span>
<span id="cb495-95"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-95" tabindex="-1"></a>future_bloom_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">na.omit</span>(future_bloom),</span>
<span id="cb495-96"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-96" tabindex="-1"></a>                            <span class="fu">aes</span>(GCM, Pheno, <span class="at">fill =</span> GCM)) <span class="sc">+</span></span>
<span id="cb495-97"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-97" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">size =</span> <span class="fl">0.35</span>,</span>
<span id="cb495-98"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-98" tabindex="-1"></a>              <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>)) <span class="sc">+</span></span>
<span id="cb495-99"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-99" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">&quot;median&quot;</span>, </span>
<span id="cb495-100"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-100" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb495-101"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-101" tabindex="-1"></a>               <span class="at">shape =</span> <span class="dv">4</span>,</span>
<span id="cb495-102"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-102" tabindex="-1"></a>               <span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb495-103"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-103" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">160</span>),</span>
<span id="cb495-104"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-104" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="cf">function</span> (x)</span>
<span id="cb495-105"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-105" tabindex="-1"></a>                       <span class="fu">format</span>(dormancyR<span class="sc">::</span><span class="fu">JDay_to_date</span>(x,</span>
<span id="cb495-106"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-106" tabindex="-1"></a>                                                      <span class="dv">2001</span>,</span>
<span id="cb495-107"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-107" tabindex="-1"></a>                                                      <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb495-108"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-108" tabindex="-1"></a>                              <span class="st">&quot;%b %d&quot;</span>))  <span class="sc">+</span></span>
<span id="cb495-109"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-109" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> SSP_Time) <span class="sc">+</span></span>
<span id="cb495-110"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-110" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb495-111"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-111" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb495-112"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-112" tabindex="-1"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb495-113"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-113" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb495-114"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-114" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb495-115"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-115" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb495-116"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-116" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>()</span>
<span id="cb495-117"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-117" tabindex="-1"></a>       )</span>
<span id="cb495-118"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-118" tabindex="-1"></a></span>
<span id="cb495-119"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-119" tabindex="-1"></a><span class="co"># Combine plots</span></span>
<span id="cb495-120"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-120" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb495-121"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-121" tabindex="-1"></a></span>
<span id="cb495-122"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-122" tabindex="-1"></a>past_observed_plot <span class="sc">+</span></span>
<span id="cb495-123"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb495-123" tabindex="-1"></a>             future_bloom_plot</span></code></pre></div>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb496-1"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb496-1" tabindex="-1"></a><span class="co"># Save the plot to the folder</span></span>
<span id="cb496-2"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb496-2" tabindex="-1"></a></span>
<span id="cb496-3"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb496-3" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;pictures/future_pheno_pear.png&quot;</span>, </span>
<span id="cb496-4"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb496-4" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>, </span>
<span id="cb496-5"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb496-5" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">19</span>, </span>
<span id="cb496-6"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb496-6" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">15</span>,</span>
<span id="cb496-7"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb496-7" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>, </span>
<span id="cb496-8"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb496-8" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">600</span>)</span></code></pre></div>
<p><img src="pictures/future_pheno_pear.png" style="width:90.0%" /></p>
<p>This looks pretty good. We can see that bloom in pear cv. Conference is expected to advance slightly under future scenarios. What we need to know now is the probability of observing frost events during the flowering period. To this end, we will assume a bloom period of 10 days around the expected date for full bloom for each simulated year and take a look at the temperatures during these days.</p>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb497-1" tabindex="-1"></a><span class="co"># Frost risk part ####</span></span>
<span id="cb497-2"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb497-2" tabindex="-1"></a><span class="co"># Add the &quot;buffer&quot; around the estimated bloom dates to compute the number of hours below 0 °C in this period. Hypothetically, this represents the</span></span>
<span id="cb497-3"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb497-3" tabindex="-1"></a><span class="co"># period of bloom in all scenarios</span></span>
<span id="cb497-4"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb497-4" tabindex="-1"></a></span>
<span id="cb497-5"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb497-5" tabindex="-1"></a><span class="co"># Define the buffer only once</span></span>
<span id="cb497-6"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb497-6" tabindex="-1"></a>bloom_buffer <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb497-7"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb497-7" tabindex="-1"></a></span>
<span id="cb497-8"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb497-8" tabindex="-1"></a><span class="co"># Mutate the future bloom dataset to add the beggining and end for bloom</span></span>
<span id="cb497-9"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb497-9" tabindex="-1"></a>future_bloom <span class="ot">&lt;-</span> future_bloom <span class="sc">%&gt;%</span> </span>
<span id="cb497-10"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb497-10" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Beginning =</span> Pheno <span class="sc">-</span> bloom_buffer,</span>
<span id="cb497-11"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb497-11" tabindex="-1"></a>         <span class="at">End =</span> Pheno <span class="sc">+</span> bloom_buffer)</span>
<span id="cb497-12"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb497-12" tabindex="-1"></a></span>
<span id="cb497-13"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb497-13" tabindex="-1"></a><span class="co"># Do the same with the observed bloom dataset (i.e. calibration)</span></span>
<span id="cb497-14"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb497-14" tabindex="-1"></a>observed_bloom_calibration <span class="ot">&lt;-</span> observed_bloom_calibration <span class="sc">%&gt;%</span> </span>
<span id="cb497-15"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb497-15" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Beginning =</span> pheno <span class="sc">-</span> bloom_buffer,</span>
<span id="cb497-16"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb497-16" tabindex="-1"></a>         <span class="at">End =</span> pheno <span class="sc">+</span> bloom_buffer)</span>
<span id="cb497-17"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb497-17" tabindex="-1"></a></span>
<span id="cb497-18"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb497-18" tabindex="-1"></a><span class="co"># Same with the past simulated data from historic scenarios</span></span>
<span id="cb497-19"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb497-19" tabindex="-1"></a>simulated_bloom <span class="ot">&lt;-</span> simulated_bloom <span class="sc">%&gt;%</span></span>
<span id="cb497-20"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb497-20" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Beginning =</span> Pheno <span class="sc">-</span> bloom_buffer,</span>
<span id="cb497-21"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb497-21" tabindex="-1"></a>         <span class="at">End =</span> Pheno <span class="sc">+</span> bloom_buffer)</span></code></pre></div>
<p>We will now compute the number of frost hours expected to occur under future scenarios as well as under historic simulated scenarios. We implement this by using several <em>for</em> loops.</p>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb498-1"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb498-1" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span> <span class="sc">:</span> <span class="fu">nrow</span>(observed_bloom_calibration)){</span>
<span id="cb498-2"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb498-2" tabindex="-1"></a>  </span>
<span id="cb498-3"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb498-3" tabindex="-1"></a>  <span class="co"># Extract the beginning and end date for observed bloom</span></span>
<span id="cb498-4"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb498-4" tabindex="-1"></a>  beg_bloom <span class="ot">&lt;-</span> observed_bloom_calibration[i, <span class="st">&quot;Beginning&quot;</span>]</span>
<span id="cb498-5"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb498-5" tabindex="-1"></a>  </span>
<span id="cb498-6"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb498-6" tabindex="-1"></a>  end_bloom <span class="ot">&lt;-</span> observed_bloom_calibration[i, <span class="st">&quot;End&quot;</span>]</span>
<span id="cb498-7"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb498-7" tabindex="-1"></a>  </span>
<span id="cb498-8"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb498-8" tabindex="-1"></a>  <span class="co"># Subset a temporary dataframe of weather records for the year of interest</span></span>
<span id="cb498-9"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb498-9" tabindex="-1"></a>  temp_df <span class="ot">&lt;-</span> <span class="fu">filter</span>(weather_merged, </span>
<span id="cb498-10"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb498-10" tabindex="-1"></a>                    Year <span class="sc">==</span> observed_bloom_calibration[i, <span class="st">&quot;Year&quot;</span>])</span>
<span id="cb498-11"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb498-11" tabindex="-1"></a>  </span>
<span id="cb498-12"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb498-12" tabindex="-1"></a>  <span class="co"># Add the Julian date</span></span>
<span id="cb498-13"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb498-13" tabindex="-1"></a>  temp_df <span class="ot">&lt;-</span> <span class="fu">make_JDay</span>(temp_df)</span>
<span id="cb498-14"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb498-14" tabindex="-1"></a>  </span>
<span id="cb498-15"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb498-15" tabindex="-1"></a>  <span class="co"># Filter only the period for bloom</span></span>
<span id="cb498-16"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb498-16" tabindex="-1"></a>  temp_df <span class="ot">&lt;-</span> <span class="fu">filter</span>(temp_df,</span>
<span id="cb498-17"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb498-17" tabindex="-1"></a>                    JDay <span class="sc">%in%</span> <span class="fu">c</span>(beg_bloom <span class="sc">:</span> end_bloom))</span>
<span id="cb498-18"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb498-18" tabindex="-1"></a>  </span>
<span id="cb498-19"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb498-19" tabindex="-1"></a>  <span class="co"># Calculate the number of hours below 0 °C</span></span>
<span id="cb498-20"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb498-20" tabindex="-1"></a>  frost_hours <span class="ot">&lt;-</span> <span class="fu">max</span>(dormancyR<span class="sc">::</span><span class="fu">frost_risk</span>(temp_df<span class="sc">$</span>Temp, </span>
<span id="cb498-21"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb498-21" tabindex="-1"></a>                                           <span class="at">threshold =</span> <span class="dv">0</span>))</span>
<span id="cb498-22"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb498-22" tabindex="-1"></a>  </span>
<span id="cb498-23"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb498-23" tabindex="-1"></a>  <span class="co"># Add the number of hours to the original dataframe</span></span>
<span id="cb498-24"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb498-24" tabindex="-1"></a>  observed_bloom_calibration[i, <span class="st">&quot;Frost&quot;</span>] <span class="ot">&lt;-</span> frost_hours</span>
<span id="cb498-25"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb498-25" tabindex="-1"></a>  </span>
<span id="cb498-26"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb498-26" tabindex="-1"></a>}</span></code></pre></div>
<p>We repeat the procedure for past simulated and future scenarios.</p>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-1" tabindex="-1"></a><span class="co"># Make a primer dataset to allocate the results of the frost projections</span></span>
<span id="cb499-2"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-2" tabindex="-1"></a>simulated_frost <span class="ot">&lt;-</span> temps_past_scenarios <span class="sc">%&gt;%</span> </span>
<span id="cb499-3"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-3" tabindex="-1"></a>  <span class="fu">group_by</span>(Scen_year, Year) <span class="sc">%&gt;%</span> </span>
<span id="cb499-4"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Frost =</span> <span class="cn">NA</span>)</span>
<span id="cb499-5"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-5" tabindex="-1"></a></span>
<span id="cb499-6"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-6" tabindex="-1"></a><span class="co"># Implement the loop over scenario years and simulated years </span></span>
<span id="cb499-7"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-7" tabindex="-1"></a><span class="cf">for</span> (scen_year <span class="cf">in</span> scen_years)</span>
<span id="cb499-8"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-8" tabindex="-1"></a>  <span class="cf">for</span> (year <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">2002</span> <span class="sc">:</span> <span class="dv">2100</span>)){</span>
<span id="cb499-9"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-9" tabindex="-1"></a>    </span>
<span id="cb499-10"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-10" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">filter</span>(simulated_bloom, </span>
<span id="cb499-11"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-11" tabindex="-1"></a>                     Scen_year <span class="sc">==</span> scen_year <span class="sc">&amp;</span> </span>
<span id="cb499-12"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-12" tabindex="-1"></a>                     Year <span class="sc">==</span> year)[[<span class="st">&quot;Pheno&quot;</span>]]   ))</span>
<span id="cb499-13"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-13" tabindex="-1"></a>      {</span>
<span id="cb499-14"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-14" tabindex="-1"></a>      </span>
<span id="cb499-15"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-15" tabindex="-1"></a>      <span class="co"># Extract the beginning and end of the blooming period</span></span>
<span id="cb499-16"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-16" tabindex="-1"></a>      beg_bloom <span class="ot">&lt;-</span> <span class="fu">filter</span>(<span class="fu">na.omit</span>(simulated_bloom), </span>
<span id="cb499-17"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-17" tabindex="-1"></a>                          Scen_year <span class="sc">==</span> scen_year <span class="sc">&amp;</span> </span>
<span id="cb499-18"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-18" tabindex="-1"></a>                            Year <span class="sc">==</span> year)[[<span class="st">&quot;Beginning&quot;</span>]]</span>
<span id="cb499-19"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-19" tabindex="-1"></a>      </span>
<span id="cb499-20"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-20" tabindex="-1"></a>      beg_bloom <span class="ot">&lt;-</span> <span class="fu">trunc</span>(beg_bloom)</span>
<span id="cb499-21"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-21" tabindex="-1"></a>      </span>
<span id="cb499-22"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-22" tabindex="-1"></a>      end_bloom <span class="ot">&lt;-</span> <span class="fu">filter</span>(<span class="fu">na.omit</span>(simulated_bloom), </span>
<span id="cb499-23"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-23" tabindex="-1"></a>                          Scen_year <span class="sc">==</span> scen_year, </span>
<span id="cb499-24"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-24" tabindex="-1"></a>                          Year <span class="sc">==</span> year)[[<span class="st">&quot;End&quot;</span>]]</span>
<span id="cb499-25"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-25" tabindex="-1"></a>      </span>
<span id="cb499-26"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-26" tabindex="-1"></a>      end_bloom <span class="ot">&lt;-</span> <span class="fu">trunc</span>(end_bloom)</span>
<span id="cb499-27"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-27" tabindex="-1"></a>      </span>
<span id="cb499-28"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-28" tabindex="-1"></a>      <span class="co"># Filter the weather data according to the relevant scenario year and simulated year</span></span>
<span id="cb499-29"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-29" tabindex="-1"></a>      </span>
<span id="cb499-30"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-30" tabindex="-1"></a>      temp_df <span class="ot">&lt;-</span> <span class="fu">filter</span>(temps_past_scenarios, </span>
<span id="cb499-31"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-31" tabindex="-1"></a>                        Scen_year <span class="sc">==</span> scen_year <span class="sc">&amp;</span></span>
<span id="cb499-32"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-32" tabindex="-1"></a>                          Year <span class="sc">==</span> year)</span>
<span id="cb499-33"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-33" tabindex="-1"></a>      </span>
<span id="cb499-34"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-34" tabindex="-1"></a>      <span class="co"># Derive hourly temperatures based on the latitude of Campus Klein-Altendorf</span></span>
<span id="cb499-35"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-35" tabindex="-1"></a>      temp_df <span class="ot">&lt;-</span> <span class="fu">stack_hourly_temps</span>(temp_df,</span>
<span id="cb499-36"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-36" tabindex="-1"></a>                                    <span class="at">latitude =</span> <span class="fl">50.4</span>)[[<span class="st">&quot;hourtemps&quot;</span>]]</span>
<span id="cb499-37"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-37" tabindex="-1"></a>      </span>
<span id="cb499-38"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-38" tabindex="-1"></a>      <span class="co"># Filter the relevant period when bloom is likely to occurs</span></span>
<span id="cb499-39"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-39" tabindex="-1"></a>      </span>
<span id="cb499-40"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-40" tabindex="-1"></a>      temp_df <span class="ot">&lt;-</span> <span class="fu">filter</span>(temp_df, </span>
<span id="cb499-41"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-41" tabindex="-1"></a>                        JDay <span class="sc">%in%</span> <span class="fu">c</span>(beg_bloom <span class="sc">:</span> end_bloom))</span>
<span id="cb499-42"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-42" tabindex="-1"></a>      </span>
<span id="cb499-43"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-43" tabindex="-1"></a>      <span class="co"># Compute the number of frost hours</span></span>
<span id="cb499-44"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-44" tabindex="-1"></a>      frost_hours <span class="ot">&lt;-</span> <span class="fu">max</span>(dormancyR<span class="sc">::</span><span class="fu">frost_risk</span>(temp_df<span class="sc">$</span>Temp, </span>
<span id="cb499-45"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-45" tabindex="-1"></a>                                               <span class="at">threshold =</span> <span class="dv">0</span>))</span>
<span id="cb499-46"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-46" tabindex="-1"></a>      } <span class="cf">else</span> frost_hours <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb499-47"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-47" tabindex="-1"></a>      </span>
<span id="cb499-48"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-48" tabindex="-1"></a>      <span class="co"># Add the number of frost events to the primer dataset</span></span>
<span id="cb499-49"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-49" tabindex="-1"></a>      </span>
<span id="cb499-50"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-50" tabindex="-1"></a>      simulated_frost[simulated_frost<span class="sc">$</span>Scen_year <span class="sc">==</span> scen_year <span class="sc">&amp;</span> </span>
<span id="cb499-51"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-51" tabindex="-1"></a>                      simulated_frost<span class="sc">$</span>Year <span class="sc">==</span> year, <span class="st">&quot;Frost&quot;</span>] <span class="ot">&lt;-</span> frost_hours</span>
<span id="cb499-52"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-52" tabindex="-1"></a></span>
<span id="cb499-53"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-53" tabindex="-1"></a>}</span>
<span id="cb499-54"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-54" tabindex="-1"></a></span>
<span id="cb499-55"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-55" tabindex="-1"></a><span class="co"># Remove NA cells since the first year has no bloom</span></span>
<span id="cb499-56"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb499-56" tabindex="-1"></a>simulated_frost <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(simulated_frost)</span></code></pre></div>
<p>Now we process the future scenarios.</p>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb500-1"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-1" tabindex="-1"></a><span class="co"># Create a primer data frame to allocate the results for future bloom</span></span>
<span id="cb500-2"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-2" tabindex="-1"></a>future_frost <span class="ot">&lt;-</span> future_temps <span class="sc">%&gt;%</span></span>
<span id="cb500-3"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-3" tabindex="-1"></a>  <span class="fu">group_by</span>(SSP_Time, GCM, Year) <span class="sc">%&gt;%</span> </span>
<span id="cb500-4"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Frost =</span> <span class="cn">NA</span>)</span>
<span id="cb500-5"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-5" tabindex="-1"></a></span>
<span id="cb500-6"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-6" tabindex="-1"></a><span class="co"># Implement the for loop</span></span>
<span id="cb500-7"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-7" tabindex="-1"></a><span class="cf">for</span> (scenario <span class="cf">in</span> scenarios)</span>
<span id="cb500-8"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-8" tabindex="-1"></a>    {scen_file <span class="ot">&lt;-</span> future_bloom <span class="sc">%&gt;%</span> </span>
<span id="cb500-9"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-9" tabindex="-1"></a>      <span class="fu">filter</span>(SSP_Time <span class="sc">==</span> scenario)</span>
<span id="cb500-10"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-10" tabindex="-1"></a>    climate_models <span class="ot">&lt;-</span> <span class="fu">unique</span>(scen_file<span class="sc">$</span>GCM)</span>
<span id="cb500-11"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-11" tabindex="-1"></a>    </span>
<span id="cb500-12"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-12" tabindex="-1"></a>    <span class="cf">for</span> (climate_model <span class="cf">in</span> climate_models)</span>
<span id="cb500-13"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-13" tabindex="-1"></a>      <span class="cf">for</span> (year <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">2002</span> <span class="sc">:</span> <span class="dv">2100</span>)){</span>
<span id="cb500-14"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-14" tabindex="-1"></a>      </span>
<span id="cb500-15"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-15" tabindex="-1"></a>        <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">filter</span>(scen_file,</span>
<span id="cb500-16"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-16" tabindex="-1"></a>                         GCM <span class="sc">==</span> climate_model <span class="sc">&amp;</span> </span>
<span id="cb500-17"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-17" tabindex="-1"></a>                         Year <span class="sc">==</span> year)[[<span class="st">&quot;Pheno&quot;</span>]]   ))</span>
<span id="cb500-18"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-18" tabindex="-1"></a>        {</span>
<span id="cb500-19"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-19" tabindex="-1"></a>          beg_bloom <span class="ot">&lt;-</span> <span class="fu">filter</span>(<span class="fu">na.omit</span>(scen_file),</span>
<span id="cb500-20"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-20" tabindex="-1"></a>                              GCM <span class="sc">==</span> climate_model <span class="sc">&amp;</span></span>
<span id="cb500-21"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-21" tabindex="-1"></a>                                Year <span class="sc">==</span> year)[[<span class="st">&quot;Beginning&quot;</span>]]</span>
<span id="cb500-22"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-22" tabindex="-1"></a>          </span>
<span id="cb500-23"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-23" tabindex="-1"></a>          beg_bloom <span class="ot">&lt;-</span> <span class="fu">trunc</span>(beg_bloom)</span>
<span id="cb500-24"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-24" tabindex="-1"></a>          </span>
<span id="cb500-25"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-25" tabindex="-1"></a>          end_bloom <span class="ot">&lt;-</span> <span class="fu">filter</span>(<span class="fu">na.omit</span>(scen_file),</span>
<span id="cb500-26"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-26" tabindex="-1"></a>                              GCM <span class="sc">==</span> climate_model <span class="sc">&amp;</span></span>
<span id="cb500-27"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-27" tabindex="-1"></a>                                Year <span class="sc">==</span> year)[[<span class="st">&quot;End&quot;</span>]]</span>
<span id="cb500-28"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-28" tabindex="-1"></a>          </span>
<span id="cb500-29"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-29" tabindex="-1"></a>          end_bloom <span class="ot">&lt;-</span> <span class="fu">trunc</span>(end_bloom)</span>
<span id="cb500-30"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-30" tabindex="-1"></a>          </span>
<span id="cb500-31"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-31" tabindex="-1"></a>          <span class="co"># Derive hourly temperatures based on the latitude of Campus Klein-Altendorf</span></span>
<span id="cb500-32"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-32" tabindex="-1"></a>          </span>
<span id="cb500-33"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-33" tabindex="-1"></a>          temp_df <span class="ot">&lt;-</span> <span class="fu">filter</span>(future_temps,</span>
<span id="cb500-34"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-34" tabindex="-1"></a>                            SSP_Time <span class="sc">==</span> scenario <span class="sc">&amp;</span> </span>
<span id="cb500-35"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-35" tabindex="-1"></a>                              GCM <span class="sc">==</span> climate_model <span class="sc">&amp;</span></span>
<span id="cb500-36"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-36" tabindex="-1"></a>                              Year <span class="sc">==</span> year)</span>
<span id="cb500-37"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-37" tabindex="-1"></a>          </span>
<span id="cb500-38"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-38" tabindex="-1"></a>          temp_df <span class="ot">&lt;-</span> <span class="fu">stack_hourly_temps</span>(temp_df,</span>
<span id="cb500-39"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-39" tabindex="-1"></a>                                        <span class="at">latitude =</span> <span class="fl">50.4</span>)[[<span class="st">&quot;hourtemps&quot;</span>]]</span>
<span id="cb500-40"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-40" tabindex="-1"></a>          </span>
<span id="cb500-41"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-41" tabindex="-1"></a>          temp_df <span class="ot">&lt;-</span> <span class="fu">filter</span>(temp_df,</span>
<span id="cb500-42"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-42" tabindex="-1"></a>                            JDay <span class="sc">%in%</span> <span class="fu">c</span>(beg_bloom <span class="sc">:</span> end_bloom))</span>
<span id="cb500-43"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-43" tabindex="-1"></a>          </span>
<span id="cb500-44"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-44" tabindex="-1"></a>          frost_hours <span class="ot">&lt;-</span> <span class="fu">max</span>(dormancyR<span class="sc">::</span><span class="fu">frost_risk</span>(temp_df<span class="sc">$</span>Temp,</span>
<span id="cb500-45"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-45" tabindex="-1"></a>                                                   <span class="at">threshold =</span> <span class="dv">0</span>))</span>
<span id="cb500-46"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-46" tabindex="-1"></a>          } <span class="cf">else</span> frost_hours <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb500-47"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-47" tabindex="-1"></a>          </span>
<span id="cb500-48"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-48" tabindex="-1"></a>          future_frost[future_frost<span class="sc">$</span>SSP_Time <span class="sc">==</span> scenario <span class="sc">&amp;</span> </span>
<span id="cb500-49"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-49" tabindex="-1"></a>                         future_frost<span class="sc">$</span>GCM <span class="sc">==</span> climate_model <span class="sc">&amp;</span></span>
<span id="cb500-50"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-50" tabindex="-1"></a>                         future_frost<span class="sc">$</span>Year <span class="sc">==</span> year, <span class="st">&quot;Frost&quot;</span>] <span class="ot">&lt;-</span> frost_hours</span>
<span id="cb500-51"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-51" tabindex="-1"></a>      }</span>
<span id="cb500-52"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-52" tabindex="-1"></a>    }</span>
<span id="cb500-53"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-53" tabindex="-1"></a><span class="co"># Remove NA cells since the first year has no bloom</span></span>
<span id="cb500-54"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb500-54" tabindex="-1"></a>future_frost <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(future_frost)</span></code></pre></div>
<p>We can now plot the results to see the overall picture. We will use the same kind of plot we normally use to show the projections of agro-climatic-related metrics. In brief, we create two plots and combine them using the <code>patchwork</code> package.</p>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-1" tabindex="-1"></a><span class="co"># Plots</span></span>
<span id="cb501-2"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-2" tabindex="-1"></a>past_frost_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(simulated_frost,</span>
<span id="cb501-3"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-3" tabindex="-1"></a>                          <span class="fu">aes</span>(Scen_year, </span>
<span id="cb501-4"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-4" tabindex="-1"></a>                              Frost,</span>
<span id="cb501-5"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-5" tabindex="-1"></a>                              <span class="at">group =</span> Scen_year)) <span class="sc">+</span></span>
<span id="cb501-6"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-6" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">&quot;cadetblue&quot;</span>,</span>
<span id="cb501-7"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-7" tabindex="-1"></a>               <span class="at">outlier.size =</span> <span class="fl">0.8</span>, </span>
<span id="cb501-8"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-8" tabindex="-1"></a>               <span class="at">outlier.alpha =</span> <span class="fl">0.5</span>, </span>
<span id="cb501-9"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-9" tabindex="-1"></a>               <span class="at">outlier.shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb501-10"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-10" tabindex="-1"></a>  <span class="co">#geom_point(data = observed_bloom_calibration, aes(as.character(Year), Frost)) +</span></span>
<span id="cb501-11"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-11" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">90</span>), </span>
<span id="cb501-12"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-12" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb501-13"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb501-14"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-14" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Spring frost (hours &lt;0 °C)&quot;</span>) <span class="sc">+</span></span>
<span id="cb501-15"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-15" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> <span class="st">&quot;Historic&quot;</span>) <span class="sc">+</span></span>
<span id="cb501-16"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-16" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb501-17"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-17" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>, </span>
<span id="cb501-18"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-18" tabindex="-1"></a>                                   <span class="at">angle =</span> <span class="dv">60</span>, </span>
<span id="cb501-19"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-19" tabindex="-1"></a>                                   <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb501-20"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-20" tabindex="-1"></a></span>
<span id="cb501-21"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-21" tabindex="-1"></a>future_frost_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(future_frost,</span>
<span id="cb501-22"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-22" tabindex="-1"></a>                            <span class="fu">aes</span>(GCM, </span>
<span id="cb501-23"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-23" tabindex="-1"></a>                                Frost, </span>
<span id="cb501-24"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-24" tabindex="-1"></a>                                <span class="at">fill =</span> GCM)) <span class="sc">+</span></span>
<span id="cb501-25"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-25" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.8</span>, </span>
<span id="cb501-26"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-26" tabindex="-1"></a>               <span class="at">outlier.alpha =</span> <span class="fl">0.5</span>, </span>
<span id="cb501-27"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-27" tabindex="-1"></a>               <span class="at">outlier.shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb501-28"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-28" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">90</span>),</span>
<span id="cb501-29"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-29" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb501-30"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-30" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> SSP_Time) <span class="sc">+</span></span>
<span id="cb501-31"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-31" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb501-32"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-32" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb501-33"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-33" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb501-34"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-34" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb501-35"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-35" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb501-36"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-36" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fl">7.5</span>),</span>
<span id="cb501-37"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-37" tabindex="-1"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">&quot;cm&quot;</span>))</span>
<span id="cb501-38"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-38" tabindex="-1"></a></span>
<span id="cb501-39"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-39" tabindex="-1"></a>past_frost_plot <span class="sc">+</span> </span>
<span id="cb501-40"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-40" tabindex="-1"></a>  future_frost_plot <span class="sc">+</span> </span>
<span id="cb501-41"><a href="a-robust-method-to-estimate-future-frost-risks.html#cb501-41" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="Book_files/figure-html/plotting_frost_risk-1.png" width="672" /></p>
<p>One interesting feature here is the large number of outliers we generated for each simulated scenario. The overall trend suggests there may be a slight decline in the risk of spring frost events for pear cv. Conference under future scenarios although the projections for bloom suggested an advance in the occurrence of the flowering period.</p>
</div>
<div id="exercises-for-this-chapter" class="section level2 hasAnchor" number="34.3">
<h2><span class="header-section-number">34.3</span> <code>Exercises</code> for this chapter<a href="a-robust-method-to-estimate-future-frost-risks.html#exercises-for-this-chapter" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>No exercises for this one. Maybe you still have some work to do on your logbook?</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="frost-risk-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="major_concepts.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Book.pdf", "Book.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
